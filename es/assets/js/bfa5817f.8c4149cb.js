"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[7607],{60009:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"end-user-flows/account-settings/by-account-api","title":"Configuraci\xf3n de cuenta mediante Account API","description":"Aprende c\xf3mo usar el Account API para gestionar usuarios","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","sourceDirName":"end-user-flows/account-settings","slug":"/end-user-flows/account-settings/by-account-api","permalink":"/es/end-user-flows/account-settings/by-account-api","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"description":"Aprende c\xf3mo usar el Account API para gestionar usuarios","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Configuraci\xf3n de cuenta","permalink":"/es/end-user-flows/account-settings/"},"next":{"title":"Configuraci\xf3n de cuenta mediante Management API","permalink":"/es/end-user-flows/account-settings/by-management-api"}}');var c=a(25105),o=a(79621);const r={description:"Aprende c\xf3mo usar el Account API para gestionar usuarios",sidebar_position:1},s="Configuraci\xf3n de cuenta mediante Account API",t={},l=[{value:"\xbfQu\xe9 es el Account API de Logto?",id:"what-is-logto-account-api",level:2},{value:"C\xf3mo habilitar el Account API",id:"how-to-enable-account-api",level:2},{value:"C\xf3mo acceder al Account API",id:"how-to-access-account-api",level:2},{value:"Obtener un token de acceso",id:"fetch-an-access-token",level:3},{value:"Acceder al Account API usando el token de acceso",id:"access-account-api-using-access-token",level:3},{value:"Gestionar informaci\xf3n b\xe1sica de la cuenta",id:"manage-basic-account-information",level:2},{value:"Recuperar informaci\xf3n de la cuenta de usuario",id:"retrieve-user-account-information",level:3},{value:"Actualizar informaci\xf3n b\xe1sica de la cuenta",id:"update-basic-account-information",level:3},{value:"Gestionar identificadores y otra informaci\xf3n sensible",id:"manage-identifiers-and-other-sensitive-information",level:2},{value:"Obtener un id de registro de verificaci\xf3n",id:"get-a-verification-record-id",level:3},{value:"Verificar la contrase\xf1a del usuario",id:"verify-the-users-password",level:4},{value:"Verificar enviando un c\xf3digo de verificaci\xf3n al correo electr\xf3nico o tel\xe9fono del usuario",id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",level:4},{value:"Enviar solicitud con id de registro de verificaci\xf3n",id:"send-request-with-verification-record-id",level:3},{value:"Actualizar o vincular un nuevo correo electr\xf3nico",id:"update-or-link-new-email",level:3},{value:"Eliminar el correo electr\xf3nico del usuario",id:"remove-the-users-email",level:3},{value:"Gestionar tel\xe9fono",id:"manage-phone",level:3},{value:"Vincular una nueva conexi\xf3n social",id:"link-a-new-social-connection",level:3},{value:"Eliminar una conexi\xf3n social",id:"remove-a-social-connection",level:3},{value:"Vincular una nueva clave de acceso WebAuthn",id:"link-a-new-webauthn-passkey",level:3},{value:"Gestionar clave de acceso WebAuthn existente",id:"manage-existing-webauthn-passkey",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"configuraci\xf3n-de-cuenta-mediante-account-api",children:"Configuraci\xf3n de cuenta mediante Account API"})}),"\n",(0,c.jsx)(n.h2,{id:"what-is-logto-account-api",children:"\xbfQu\xe9 es el Account API de Logto?"}),"\n",(0,c.jsx)(n.p,{children:"El Account API de Logto es un conjunto completo de APIs que brinda a los usuarios finales acceso directo a la API sin necesidad de pasar por el Management API. Aqu\xed tienes los aspectos destacados:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Acceso directo: El Account API permite a los usuarios finales acceder y gestionar directamente sus propios perfiles de cuenta sin requerir el relay del Management API."}),"\n",(0,c.jsx)(n.li,{children:"Gesti\xf3n de perfil de usuario e identidades: Los usuarios pueden gestionar completamente sus perfiles y configuraciones de seguridad, incluyendo la capacidad de actualizar informaci\xf3n de identidad como correo electr\xf3nico, tel\xe9fono y contrase\xf1a, as\xed como gestionar conexiones sociales. El soporte para MFA y SSO llegar\xe1 pronto."}),"\n",(0,c.jsx)(n.li,{children:"Control de acceso global: Los administradores tienen control total y global sobre la configuraci\xf3n de acceso y pueden personalizar cada campo."}),"\n",(0,c.jsxs)(n.li,{children:["Autorizaci\xf3n sin complicaciones: \xa1La autorizaci\xf3n es m\xe1s f\xe1cil que nunca! Simplemente usa ",(0,c.jsx)(n.code,{children:"client.getAccessToken()"})," para obtener un token de acceso opaco para OP (Logto), y adj\xfantalo en el encabezado Authorization como ",(0,c.jsx)(n.code,{children:"Bearer <access_token>"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.admonition,{type:"note",children:[(0,c.jsx)(n.p,{children:"Para asegurar que el token de acceso tenga los permisos apropiados, aseg\xfarate de haber configurado correctamente los alcances correspondientes en tu configuraci\xf3n de Logto."}),(0,c.jsxs)(n.p,{children:["Por ejemplo, para la API ",(0,c.jsx)(n.code,{children:"POST /api/my-account/primary-email"}),", necesitas configurar el alcance ",(0,c.jsx)(n.code,{children:"email"}),"; para la API ",(0,c.jsx)(n.code,{children:"POST /api/my-account/primary-phone"}),", necesitas configurar el alcance ",(0,c.jsx)(n.code,{children:"phone"}),"."]}),(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:"import { type LogtoConfig, UserScope } from '@logto/js';\n\nconst config: LogtoConfig = {\n  // ...otras opciones\n  // A\xf1ade los alcances adecuados que se ajusten a tus casos de uso.\n  scopes: [\n    UserScope.Email, // Para las APIs `{POST,DELETE} /api/my-account/primary-email`\n    UserScope.Phone, // Para las APIs `{POST,DELETE} /api/my-account/primary-phone`\n    UserScope.CustomData, // Para gestionar datos personalizados\n    UserScope.Address, // Para gestionar direcci\xf3n\n    UserScope.Identities, // Para APIs relacionadas con identidad y MFA\n    UserScope.Profile, // Para gestionar el perfil de usuario\n  ],\n};\n"})})]}),"\n",(0,c.jsx)(n.p,{children:"Con el Account API de Logto, puedes construir un sistema personalizado de gesti\xf3n de cuentas como una p\xe1gina de perfil totalmente integrada con Logto."}),"\n",(0,c.jsx)(n.p,{children:"Algunos casos de uso frecuentes se listan a continuaci\xf3n:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Recuperar el perfil de usuario"}),"\n",(0,c.jsx)(n.li,{children:"Actualizar el perfil de usuario"}),"\n",(0,c.jsx)(n.li,{children:"Actualizar la contrase\xf1a del usuario"}),"\n",(0,c.jsx)(n.li,{children:"Actualizar identidades del usuario incluyendo correo electr\xf3nico, tel\xe9fono y conexiones sociales"}),"\n",(0,c.jsx)(n.li,{children:"Gestionar factores de MFA (verificaciones)"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Para conocer m\xe1s sobre las APIs disponibles, visita ",(0,c.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-my-account",children:"Referencia de Logto Account API"})," y ",(0,c.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-verifications",children:"Referencia de Logto Verification API"}),"."]}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Pr\xf3ximamente estar\xe1n disponibles Account APIs dedicadas para las siguientes configuraciones: MFA, SSO, datos personalizados (usuario) y eliminaci\xf3n de cuenta. Mientras tanto, puedes implementar estas funciones usando las Management APIs de Logto. Consulta ",(0,c.jsx)(n.a,{href:"/end-user-flows/account-settings/by-management-api",children:"Configuraci\xf3n de cuenta mediante Management API"})," para m\xe1s detalles."]})}),"\n",(0,c.jsx)(n.h2,{id:"how-to-enable-account-api",children:"C\xf3mo habilitar el Account API"}),"\n",(0,c.jsxs)(n.p,{children:["Por defecto, el Account API est\xe1 deshabilitado. Para habilitarlo, necesitas usar el ",(0,c.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," para actualizar la configuraci\xf3n global."]}),"\n",(0,c.jsxs)(n.p,{children:["El endpoint ",(0,c.jsx)(n.code,{children:"/api/account-center"})," puede usarse para recuperar y actualizar la configuraci\xf3n del centro de cuentas. Puedes usarlo para habilitar o deshabilitar el Account API y personalizar los campos."]}),"\n",(0,c.jsx)(n.p,{children:"Ejemplo de solicitud:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/account-center \\\n  -H \'authorization: Bearer <access_token for Logto Management API>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"enabled":true,"fields":{"username":"Edit"}}\'\n'})}),"\n",(0,c.jsxs)(n.p,{children:["El campo ",(0,c.jsx)(n.code,{children:"enabled"})," se usa para habilitar o deshabilitar el Account API, y el campo ",(0,c.jsx)(n.code,{children:"fields"})," se usa para personalizar los campos, el valor puede ser ",(0,c.jsx)(n.code,{children:"Off"}),", ",(0,c.jsx)(n.code,{children:"Edit"}),", ",(0,c.jsx)(n.code,{children:"ReadOnly"}),". El valor por defecto es ",(0,c.jsx)(n.code,{children:"Off"}),". Lista de campos:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"name"}),": El campo de nombre."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"avatar"}),": El campo de avatar."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"profile"}),": El campo de perfil, incluyendo sus subcampos."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"username"}),": El campo de nombre de usuario."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"email"}),": El campo de correo electr\xf3nico."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"phone"}),": El campo de tel\xe9fono."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"password"}),": El campo de contrase\xf1a, al obtenerlo, devolver\xe1 ",(0,c.jsx)(n.code,{children:"true"})," si el usuario ha establecido una contrase\xf1a, de lo contrario ",(0,c.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"social"}),": Conexiones sociales."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"mfa"}),": Factores de MFA."]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Aprende m\xe1s sobre los detalles de la API en la ",(0,c.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-account-center",children:"Referencia de Logto Management API"}),"."]}),"\n",(0,c.jsx)(n.h2,{id:"how-to-access-account-api",children:"C\xf3mo acceder al Account API"}),"\n",(0,c.jsx)(n.h3,{id:"fetch-an-access-token",children:"Obtener un token de acceso"}),"\n",(0,c.jsxs)(n.p,{children:["Despu\xe9s de configurar el SDK en tu aplicaci\xf3n, puedes usar el m\xe9todo ",(0,c.jsx)(n.code,{children:"client.getAccessToken()"})," para obtener un token de acceso. Este token es un token opaco que puede usarse para acceder al Account API."]}),"\n",(0,c.jsxs)(n.p,{children:["Si no est\xe1s usando el SDK oficial, debes establecer el ",(0,c.jsx)(n.code,{children:"resource"})," como vac\xedo para la solicitud de concesi\xf3n de token de acceso a ",(0,c.jsx)(n.code,{children:"/oidc/token"}),"."]}),"\n",(0,c.jsx)(n.h3,{id:"access-account-api-using-access-token",children:"Acceder al Account API usando el token de acceso"}),"\n",(0,c.jsxs)(n.p,{children:["Debes incluir el token de acceso en el campo ",(0,c.jsx)(n.code,{children:"Authorization"})," de los encabezados HTTP con el formato Bearer (",(0,c.jsx)(n.code,{children:"Bearer YOUR_TOKEN"}),") al interactuar con el Account API."]}),"\n",(0,c.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo para obtener la informaci\xf3n de la cuenta de usuario:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,c.jsx)(n.h2,{id:"manage-basic-account-information",children:"Gestionar informaci\xf3n b\xe1sica de la cuenta"}),"\n",(0,c.jsx)(n.h3,{id:"retrieve-user-account-information",children:"Recuperar informaci\xf3n de la cuenta de usuario"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,c.jsx)(n.p,{children:"El cuerpo de la respuesta ser\xeda as\xed:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\n  "id": "...",\n  "username": "...",\n  "name": "...",\n  "avatar": "..."\n}\n'})}),"\n",(0,c.jsx)(n.p,{children:"Los campos de la respuesta pueden variar dependiendo de la configuraci\xf3n del centro de cuentas."}),"\n",(0,c.jsx)(n.h3,{id:"update-basic-account-information",children:"Actualizar informaci\xf3n b\xe1sica de la cuenta"}),"\n",(0,c.jsx)(n.p,{children:"La informaci\xf3n b\xe1sica de la cuenta incluye el nombre de usuario, nombre, avatar y perfil."}),"\n",(0,c.jsxs)(n.p,{children:["Para actualizar el nombre de usuario, nombre y avatar, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"PATCH /api/my-account"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"username":"...","name":"...","avatar":"..."}\'\n'})}),"\n",(0,c.jsxs)(n.p,{children:["Para actualizar el perfil, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"PATCH /api/my-account/profile"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account/profile \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"familyName":"...","givenName":"..."}\'\n'})}),"\n",(0,c.jsx)(n.h2,{id:"manage-identifiers-and-other-sensitive-information",children:"Gestionar identificadores y otra informaci\xf3n sensible"}),"\n",(0,c.jsx)(n.p,{children:"Por razones de seguridad, el Account API requiere una capa adicional de autorizaci\xf3n para operaciones que involucren identificadores y otra informaci\xf3n sensible."}),"\n",(0,c.jsx)(n.h3,{id:"get-a-verification-record-id",children:"Obtener un id de registro de verificaci\xf3n"}),"\n",(0,c.jsx)(n.p,{children:"Primero, necesitas obtener un ID de registro de verificaci\xf3n. Esto puede usarse para verificar la identidad del usuario al actualizar identificadores."}),"\n",(0,c.jsx)(n.p,{children:"Para obtener un ID de registro de verificaci\xf3n, puedes verificar la contrase\xf1a del usuario o enviar un c\xf3digo de verificaci\xf3n al correo electr\xf3nico o tel\xe9fono del usuario."}),"\n",(0,c.jsxs)(n.p,{children:["Para saber m\xe1s sobre verificaciones, consulta ",(0,c.jsx)(n.a,{href:"/end-user-flows/security-verification",children:"Verificaci\xf3n de seguridad mediante Account API"}),"."]}),"\n",(0,c.jsx)(n.h4,{id:"verify-the-users-password",children:"Verificar la contrase\xf1a del usuario"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/password \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"password\":\"...\"}'\n"})}),"\n",(0,c.jsx)(n.p,{children:"El cuerpo de la respuesta ser\xeda as\xed:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,c.jsx)(n.h4,{id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",children:"Verificar enviando un c\xf3digo de verificaci\xf3n al correo electr\xf3nico o tel\xe9fono del usuario"}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Para usar este m\xe9todo, necesitas ",(0,c.jsx)(n.a,{href:"/connectors/email-connectors/",children:"configurar el conector de correo electr\xf3nico"})," o ",(0,c.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"conector SMS"}),", y asegurarte de que la plantilla ",(0,c.jsx)(n.code,{children:"UserPermissionValidation"})," est\xe9 configurada."]})}),"\n",(0,c.jsx)(n.p,{children:"Tomando el correo electr\xf3nico como ejemplo, solicita un nuevo c\xf3digo de verificaci\xf3n y obt\xe9n el ID de registro de verificaci\xf3n:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,c.jsx)(n.p,{children:"El cuerpo de la respuesta ser\xeda as\xed:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,c.jsx)(n.p,{children:"Al recibir el c\xf3digo de verificaci\xf3n, puedes usarlo para actualizar el estado de verificaci\xf3n del registro de verificaci\xf3n."}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"123456"}\'\n'})}),"\n",(0,c.jsx)(n.p,{children:"Despu\xe9s de verificar el c\xf3digo, ahora puedes usar el ID de registro de verificaci\xf3n para actualizar el identificador del usuario."}),"\n",(0,c.jsx)(n.h3,{id:"send-request-with-verification-record-id",children:"Enviar solicitud con id de registro de verificaci\xf3n"}),"\n",(0,c.jsxs)(n.p,{children:["Al enviar una solicitud para actualizar el identificador del usuario, debes incluir el ID de registro de verificaci\xf3n en el encabezado de la solicitud con el campo ",(0,c.jsx)(n.code,{children:"logto-verification-id"}),"."]}),"\n",(0,c.jsx)(n.h3,{id:"update-or-link-new-email",children:"Actualizar o vincular un nuevo correo electr\xf3nico"}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Para usar este m\xe9todo, necesitas ",(0,c.jsx)(n.a,{href:"/connectors/email-connectors/",children:"configurar el conector de correo electr\xf3nico"}),", y asegurarte de que la plantilla ",(0,c.jsx)(n.code,{children:"BindNewIdentifier"})," est\xe9 configurada."]})}),"\n",(0,c.jsx)(n.p,{children:"Para actualizar o vincular un nuevo correo electr\xf3nico, primero debes demostrar la propiedad del correo."}),"\n",(0,c.jsxs)(n.p,{children:["Llama al endpoint ",(0,c.jsx)(n.code,{children:"POST /api/verifications/verification-code"})," para solicitar un c\xf3digo de verificaci\xf3n."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,c.jsxs)(n.p,{children:["Encontrar\xe1s un ",(0,c.jsx)(n.code,{children:"verificationId"})," en la respuesta, y recibir\xe1s un c\xf3digo de verificaci\xf3n en el correo electr\xf3nico, \xfasalo para verificar el correo."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"..."}\'\n'})}),"\n",(0,c.jsxs)(n.p,{children:["Despu\xe9s de verificar el c\xf3digo, ahora puedes actualizar el correo electr\xf3nico del usuario, establece el ",(0,c.jsx)(n.code,{children:"verificationId"})," en el cuerpo de la solicitud como ",(0,c.jsx)(n.code,{children:"newIdentifierVerificationRecordId"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"email\":\"...\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,c.jsx)(n.h3,{id:"remove-the-users-email",children:"Eliminar el correo electr\xf3nico del usuario"}),"\n",(0,c.jsxs)(n.p,{children:["Para eliminar el correo electr\xf3nico del usuario, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"DELETE /api/my-account/primary-email"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,c.jsx)(n.h3,{id:"manage-phone",children:"Gestionar tel\xe9fono"}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Para usar este m\xe9todo, necesitas ",(0,c.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"configurar el conector SMS"}),", y asegurarte de que la plantilla ",(0,c.jsx)(n.code,{children:"BindNewIdentifier"})," est\xe9 configurada."]})}),"\n",(0,c.jsxs)(n.p,{children:["Similar a la actualizaci\xf3n de correo electr\xf3nico, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"PATCH /api/my-account/primary-phone"})," para actualizar o vincular un nuevo tel\xe9fono. Y usar el endpoint ",(0,c.jsx)(n.code,{children:"DELETE /api/my-account/primary-phone"})," para eliminar el tel\xe9fono del usuario."]}),"\n",(0,c.jsx)(n.h3,{id:"link-a-new-social-connection",children:"Vincular una nueva conexi\xf3n social"}),"\n",(0,c.jsx)(n.p,{children:"Para vincular una nueva conexi\xf3n social, primero debes solicitar una URL de autorizaci\xf3n:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorId":"...","redirectUri":"...","state":"..."}\'\n'})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"connectorId"}),": El ID del ",(0,c.jsx)(n.a,{href:"/connectors/social-connectors/",children:"conector social"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"redirectUri"}),": La URI de redirecci\xf3n despu\xe9s de que el usuario autorice la aplicaci\xf3n, debes alojar una p\xe1gina web en esta URL y capturar el callback."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"state"}),": El estado que se devolver\xe1 despu\xe9s de que el usuario autorice la aplicaci\xf3n, es una cadena aleatoria que se usa para prevenir ataques CSRF."]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["En la respuesta, encontrar\xe1s un ",(0,c.jsx)(n.code,{children:"verificationRecordId"}),", gu\xe1rdalo para usarlo m\xe1s adelante."]}),"\n",(0,c.jsxs)(n.p,{children:["Despu\xe9s de que el usuario autorice la aplicaci\xf3n, recibir\xe1s un callback en el ",(0,c.jsx)(n.code,{children:"redirectUri"})," con el par\xe1metro ",(0,c.jsx)(n.code,{children:"state"}),". Luego puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"POST /api/verifications/social/verify"})," para verificar la conexi\xf3n social."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorData":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,c.jsxs)(n.p,{children:["El ",(0,c.jsx)(n.code,{children:"connectorData"})," son los datos devueltos por el conector social despu\xe9s de que el usuario autoriza la aplicaci\xf3n, necesitas analizar y obtener los par\xe1metros de consulta del ",(0,c.jsx)(n.code,{children:"redirectUri"})," en tu p\xe1gina de callback, y envolverlos como un JSON como valor del campo ",(0,c.jsx)(n.code,{children:"connectorData"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["Finalmente, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"POST /api/my-account/identities"})," para vincular la conexi\xf3n social."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/identities \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,c.jsx)(n.h3,{id:"remove-a-social-connection",children:"Eliminar una conexi\xf3n social"}),"\n",(0,c.jsxs)(n.p,{children:["Para eliminar una conexi\xf3n social, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"DELETE /api/my-account/identities"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/identities/[connector_target_id] \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,c.jsx)(n.h3,{id:"link-a-new-webauthn-passkey",children:"Vincular una nueva clave de acceso WebAuthn"}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Recuerda ",(0,c.jsx)(n.a,{href:"/end-user-flows/mfa",children:"habilitar MFA y WebAuthn"})," primero."]})}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["Para usar este m\xe9todo, necesitas habilitar el campo ",(0,c.jsx)(n.code,{children:"mfa"})," en la configuraci\xf3n del centro de cuentas."]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Paso 0: A\xf1ade el origen de tu app front-end a los or\xedgenes relacionados."})}),"\n",(0,c.jsx)(n.p,{children:"Una clave de acceso en el navegador est\xe1 vinculada a un hostname espec\xedfico (RP ID), y solo el origen del RP ID puede usarse para registrar o verificar una clave de acceso. Sin embargo, tu app front-end que env\xeda la solicitud al Account API no es la misma que la p\xe1gina de inicio de sesi\xf3n de Logto, as\xed que necesitas a\xf1adir el origen de tu app front-end a la lista de or\xedgenes relacionados. Esto permitir\xe1 que tu app front-end registre y verifique una clave de acceso bajo otros RP IDs."}),"\n",(0,c.jsxs)(n.p,{children:["Por defecto, Logto establecer\xe1 el RP ID al dominio del tenant, por ejemplo, si tu dominio de tenant es ",(0,c.jsx)(n.code,{children:"https://example.logto.app"}),", el RP ID ser\xe1 ",(0,c.jsx)(n.code,{children:"example.logto.app"}),". Si usas un dominio personalizado, el RP ID ser\xe1 el dominio personalizado, por ejemplo, si tu dominio personalizado es ",(0,c.jsx)(n.code,{children:"https://auth.example.com"}),", el RP ID ser\xe1 ",(0,c.jsx)(n.code,{children:"auth.example.com"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["Ahora, a\xf1ade el origen de tu app front-end a los or\xedgenes relacionados, por ejemplo, si el origen de tu app front-end es ",(0,c.jsx)(n.code,{children:"https://account.example.com"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/webauthn-connectors \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"webauthnRelatedOrigins\":[\"https://account.example.com\"]}'\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Para saber m\xe1s sobre los or\xedgenes relacionados, consulta la documentaci\xf3n de ",(0,c.jsx)(n.a,{href:"https://passkeys.dev/docs/advanced/related-origins/",children:"Related Origin Requests"}),"."]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Paso 1: solicita nuevas opciones de registro."})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,c.jsx)(n.p,{children:"Recibir\xe1s una respuesta como:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'{\n  "registrationOptions": "...",\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Paso 2: registra la clave de acceso en el navegador local."})}),"\n",(0,c.jsxs)(n.p,{children:["Tomando ",(0,c.jsx)(n.a,{href:"https://simplewebauthn.dev/",children:(0,c.jsx)(n.code,{children:"@simplewebauthn/browser"})})," como ejemplo, puedes usar la funci\xf3n ",(0,c.jsx)(n.code,{children:"startRegistration"})," para registrar la clave de acceso en el navegador local."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:"import { startRegistration } from '@simplewebauthn/browser';\n\n// ...\nconst response = await startRegistration({\n  optionsJSON: registrationOptions, // Los datos devueltos por el servidor en el paso 1\n});\n// Guarda la respuesta para usarla despu\xe9s\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Paso 3: verifica la clave de acceso."})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"payload":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"payload"}),": La respuesta del navegador local en el paso 2."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"verificationRecordId"}),": El ID de registro de verificaci\xf3n devuelto por el servidor en el paso 1."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Paso 4: finalmente, puedes vincular la clave de acceso."})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"type\":\"WebAuthn\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"verification_record_id"}),": un ID de registro de verificaci\xf3n v\xe1lido, otorgado al verificar el factor existente del usuario, puedes consultar la secci\xf3n ",(0,c.jsx)(n.a,{href:"#get-a-verification-record-id",children:"Obtener un ID de registro de verificaci\xf3n"})," para m\xe1s detalles."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"type"}),": el tipo del factor MFA, actualmente solo se admite ",(0,c.jsx)(n.code,{children:"WebAuthn"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"newIdentifierVerificationRecordId"}),": el ID de registro de verificaci\xf3n devuelto por el servidor en el paso 1."]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"manage-existing-webauthn-passkey",children:"Gestionar clave de acceso WebAuthn existente"}),"\n",(0,c.jsxs)(n.p,{children:["Para gestionar una clave de acceso WebAuthn existente, puedes usar el endpoint ",(0,c.jsx)(n.code,{children:"GET /api/my-account/mfa-verifications"})," para obtener las claves actuales y otros factores de verificaci\xf3n MFA."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,c.jsx)(n.p,{children:"El cuerpo de la respuesta ser\xeda as\xed:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "id": "...",\n    "type": "WebAuthn",\n    "name": "...",\n    "agent": "...",\n    "createdAt": "...",\n    "updatedAt": "..."\n  }\n]\n'})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"id"}),": el ID de la verificaci\xf3n."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"type"}),": el tipo de la verificaci\xf3n, ",(0,c.jsx)(n.code,{children:"WebAuthn"})," para clave de acceso WebAuthn."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"name"}),": el nombre de la clave de acceso, campo opcional."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"agent"}),": el user agent de la clave de acceso."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Actualizar el nombre de la clave de acceso:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId}/name \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"name\":\"...\"}'\n"})}),"\n",(0,c.jsx)(n.p,{children:"Eliminar la clave de acceso:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId} \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},79621:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>s});var i=a(58101);const c={},o=i.createContext(c);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);