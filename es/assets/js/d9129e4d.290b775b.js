"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[4673],{46759:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"user-management/user-migration","title":"Migraci\xf3n de usuarios","description":"Logto admite la migraci\xf3n manual de usuarios existentes desde otra plataforma. Esta gu\xeda te mostrar\xe1 c\xf3mo importar usuarios existentes a trav\xe9s de la Management API (Management API) y hablar\xe1 sobre aspectos que debes considerar antes de migrar.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","sourceDirName":"user-management","slug":"/user-management/user-migration","permalink":"/es/user-management/user-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Token de acceso personal (Personal access token)","permalink":"/es/user-management/personal-access-token"},"next":{"title":"Gesti\xf3n de usuarios","permalink":"/es/user-management/"}}');var n=a(25105),o=a(79621);const i={sidebar_position:5},t="Migraci\xf3n de usuarios",d={},l=[{value:"Esquema de usuario",id:"user-schema",level:2},{value:"Hashing de contrase\xf1as",id:"password-hashing",level:2},{value:"Pasos para migrar",id:"steps-to-migrate",level:2},{value:"Recursos relacionados",id:"related-resources",level:2}];function c(e){const s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components},{Url:a}=s;return a||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"migraci\xf3n-de-usuarios",children:"Migraci\xf3n de usuarios"})}),"\n",(0,n.jsx)(s.p,{children:"Logto admite la migraci\xf3n manual de usuarios existentes desde otra plataforma. Esta gu\xeda te mostrar\xe1 c\xf3mo importar usuarios existentes a trav\xe9s de la Management API (Management API) y hablar\xe1 sobre aspectos que debes considerar antes de migrar."}),"\n",(0,n.jsx)(s.h2,{id:"user-schema",children:"Esquema de usuario"}),"\n",(0,n.jsxs)(s.p,{children:["Antes de comenzar, echemos un vistazo al ",(0,n.jsx)(s.a,{href:"/user-management/user-data/#user-profile",children:"esquema de usuario"})," en Logto. Hay 3 partes del esquema de usuario que debes conocer:"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Datos b\xe1sicos"}),": es la informaci\xf3n b\xe1sica del perfil del usuario, puedes hacer coincidir los datos desde tu perfil de usuario existente."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Datos personalizados"}),": almacena informaci\xf3n adicional del usuario, puedes usar esto para guardar archivos que no puedan coincidir con los datos b\xe1sicos."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Identidades sociales"}),": almacena la informaci\xf3n del usuario obtenida del inicio de sesi\xf3n social."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Puedes crear un mapeo para hacer coincidir la informaci\xf3n del usuario de tu perfil existente con los ",(0,n.jsx)(s.strong,{children:"datos b\xe1sicos"})," y ",(0,n.jsx)(s.strong,{children:"datos personalizados"}),". Para el inicio de sesi\xf3n social, necesitar\xe1s pasos adicionales para importar las identidades sociales; consulta la API de ",(0,n.jsx)(s.a,{href:"https://openapi.logto.io/operation/operation-createuseridentity",children:"Vincular identidad social al usuario"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"password-hashing",children:"Hashing de contrase\xf1as"}),"\n",(0,n.jsxs)(s.p,{children:["Logto utiliza ",(0,n.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Argon2",children:"Argon2"})," para hashear la contrase\xf1a del usuario, y tambi\xe9n admite otros algoritmos como ",(0,n.jsx)(s.code,{children:"MD5"}),", ",(0,n.jsx)(s.code,{children:"SHA1"}),", ",(0,n.jsx)(s.code,{children:"SHA256"})," y ",(0,n.jsx)(s.code,{children:"Bcrypt"})," para facilitar la migraci\xf3n. Esos algoritmos se consideran inseguros; los hashes de contrase\xf1a correspondientes se migrar\xe1n a Argon2 en el primer inicio de sesi\xf3n exitoso del usuario."]}),"\n",(0,n.jsxs)(s.p,{children:["Si est\xe1s utilizando otros algoritmos de hash o salt, puedes establecer ",(0,n.jsx)(s.code,{children:"passwordAlgorithm"})," en ",(0,n.jsx)(s.code,{children:"Legacy"}),". Esto te permite usar cualquier algoritmo de hash soportado por Node.js. Puedes encontrar la lista de algoritmos soportados en la ",(0,n.jsx)(s.a,{href:"https://nodejs.org/api/crypto.html#cryptogethashes",children:"documentaci\xf3n de Node.js crypto"}),". En este caso, el ",(0,n.jsx)(s.code,{children:"passwordDigest"})," ser\xe1 una cadena JSON que contiene el algoritmo de hash y otros par\xe1metros espec\xedficos del algoritmo."]}),"\n",(0,n.jsx)(s.p,{children:"El formato de la cadena JSON es el siguiente:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'["hash_algorithm", ["argument1", "argument2", ...], "expected_hashed_value"]\n'})}),"\n",(0,n.jsxs)(s.p,{children:["Y puedes usar ",(0,n.jsx)(s.code,{children:"@"})," como marcador de posici\xf3n para el valor real de la contrase\xf1a en los argumentos."]}),"\n",(0,n.jsx)(s.p,{children:"Por ejemplo, si usas SHA256 con un salt, puedes almacenar la contrase\xf1a en el siguiente formato:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'["sha256", ["salt123", "@"], "c465f66c6ac481a7a17e9ed5b4e2e7e7288d892f12bf1c95c140901e9a70436e"]\n'})}),"\n",(0,n.jsx)(s.p,{children:"Esto equivale al siguiente c\xf3digo:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:"const hash = crypto.createHash('sha256');\nhash.update('salt123' + 'password123');\nconst expectedHashedValue = hash.digest('hex');\n"})}),"\n",(0,n.jsx)(s.h2,{id:"steps-to-migrate",children:"Pasos para migrar"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Preparar los datos de usuario"}),(0,n.jsx)(s.br,{}),"\n","Primero debes exportar los datos de usuario de tu plataforma existente y luego mapear la informaci\xf3n del usuario al esquema de usuario de Logto. Te recomendamos preparar los datos mapeados en formato JSON. Aqu\xed tienes un ejemplo de los datos de usuario:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'[\n  {\n    "username": "user1",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  },\n  {\n    "username": "user2",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  }\n]\n'})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Crear un tenant de Logto"}),(0,n.jsx)(s.br,{}),"\n","Necesitar\xe1s configurar un tenant en Logto. Puedes usar Logto Cloud o Logto OSS. Si a\xfan no lo has hecho, consulta la gu\xeda ",(0,n.jsx)(s.a,{href:"/introduction/set-up-logto-cloud/#create-logto-tenant",children:"Configurar Logto cloud"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Configurar la conexi\xf3n de la Management API"}),(0,n.jsx)(s.br,{}),"\n","Usaremos la Management API (Management API) para importar los datos de usuario. Puedes consultar la ",(0,n.jsx)(s.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," para aprender c\xf3mo configurar la conexi\xf3n en tu entorno de desarrollo."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Importar los datos de usuario"}),(0,n.jsx)(s.br,{}),"\n","Se recomienda preparar un script para importar los datos de usuario uno por uno. Llamaremos a la API de ",(0,n.jsx)(s.a,{href:"https://openapi.logto.io/operation/operation-createuser",children:"crear usuario"})," para importar los datos de usuario. Aqu\xed tienes un ejemplo de script:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-jsx",children:"const users = require('./users.json');\n\nconst importUsers = async () => {\n  for (const user of users) {\n    try {\n      await fetch('https://[tenant_id].logto.app/api/users', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer [your-access-token]',\n        },\n        body: JSON.stringify(user),\n      });\n      // Dormir un momento para evitar el l\xedmite de tasa\n      await new Promise((resolve) => setTimeout(resolve, 200));\n    } catch (error) {\n      console.error(`No se pudo importar el usuario ${user.username}: ${error.message}`);\n    }\n  }\n};\n\nimportUsers();\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Ten en cuenta que el endpoint de la API tiene l\xedmite de tasa; debes a\xf1adir una pausa entre cada solicitud para evitar el l\xedmite. Consulta nuestra p\xe1gina de ",(0,n.jsx)(s.a,{href:"/integrate-logto/interact-with-management-api/#rate-limit",children:"l\xedmites de tasa"})," para m\xe1s detalles."]}),"\n",(0,n.jsxs)(s.p,{children:["Si tienes una gran cantidad de datos de usuario (m\xe1s de 100k usuarios), puedes ",(0,n.jsx)(s.a,{href:"https://logto.io/contact",children:"contactarnos"})," para aumentar el l\xedmite de tasa."]}),"\n",(0,n.jsx)(s.h2,{id:"related-resources",children:"Recursos relacionados"}),"\n",(0,n.jsx)(a,{href:"https://blog.logto.io/general-migration-guide",children:(0,n.jsx)(s.p,{children:"Una gu\xeda general para migrar tu base de datos de usuarios existente a Logto"})})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},79621:(e,s,a)=>{a.d(s,{R:()=>i,x:()=>t});var r=a(58101);const n={},o=r.createContext(n);function i(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);