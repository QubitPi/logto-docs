"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[575],{41462:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"end-user-flows/one-time-token","title":"Magic link (Token de un solo uso)","description":"Similar al c\xf3digo de un solo uso (OTP), un token de un solo uso es otro m\xe9todo de autenticaci\xf3n sin contrase\xf1a que puede utilizarse para verificar la identidad de un usuario.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","sourceDirName":"end-user-flows","slug":"/end-user-flows/one-time-token","permalink":"/es/end-user-flows/one-time-token","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Inicio de sesi\xf3n directo","permalink":"/es/end-user-flows/authentication-parameters/direct-sign-in"},"next":{"title":"Pantalla de consentimiento (Consent screen)","permalink":"/es/end-user-flows/consent-screen"}}');var o=i(25105),s=i(79621),l=i(88969);const c={sidebar_position:5},r="Magic link (Token de un solo uso)",t={},d=[{value:"Flujo de token de un solo uso",id:"one-time-token-flow",level:2},{value:"Gu\xeda de implementaci\xf3n",id:"implementation-guide",level:2},{value:"Paso 1: Solicita el token de un solo uso",id:"step-1-request-one-time-token",level:3},{value:"Paso 2: Comp\xf3n tu magic link",id:"step-2-compose-your-magic-link",level:3},{value:"Paso 3: Dispara el flujo de autenticaci\xf3n v\xeda Logto SDK",id:"step-3-trigger-the-authentication-flow-via-logto-sdk",level:3},{value:"Paso 4: (Opcional) Limpia los tokens en cach\xe9 en la p\xe1gina de callback de inicio de sesi\xf3n",id:"step-4-clear-cached-tokens-in-sign-in-callback-page",level:3},{value:"Preguntas frecuentes (FAQs)",id:"faqs",level:2},{value:"\xbfPuedo usar el magic link para invitar nuevos usuarios a mis organizaciones?",id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",level:3},{value:"\xbfEl token de un solo uso expira?",id:"does-the-one-time-token-expire",level:3},{value:"Si desactivo el registro de usuarios en &quot;Experiencia de inicio de sesi\xf3n&quot;, \xbfpuedo seguir usando magic link para invitar usuarios?",id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",level:3},{value:"\xbfQu\xe9 sucede si un usuario ya ha iniciado sesi\xf3n y luego hace clic en otro magic link?",id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"magic-link-token-de-un-solo-uso",children:"Magic link (Token de un solo uso)"})}),"\n","\n",(0,o.jsx)(l.A,{cloud:!0,oss:{major:1,minor:27}}),"\n",(0,o.jsx)(n.p,{children:"Similar al c\xf3digo de un solo uso (OTP), un token de un solo uso es otro m\xe9todo de autenticaci\xf3n sin contrase\xf1a que puede utilizarse para verificar la identidad de un usuario.\nEl token es v\xe1lido por un per\xedodo de tiempo limitado y est\xe1 asociado con una direcci\xf3n de correo electr\xf3nico del usuario final."}),"\n",(0,o.jsx)(n.p,{children:'A veces, es posible que desees invitar a nuevos usuarios a tu aplicaci\xf3n / organizaci\xf3n sin requerir que creen una cuenta primero.\nO puedes olvidar tu contrase\xf1a y querer iniciar sesi\xf3n / restablecer tu contrase\xf1a verificando r\xe1pidamente tu identidad por correo electr\xf3nico.\nEn tales casos, la aplicaci\xf3n puede enviar un "magic link" a tu correo electr\xf3nico. Y ser\xe1s autenticado inmediatamente al hacer clic en el enlace.'}),"\n",(0,o.jsx)(n.p,{children:"Los desarrolladores de aplicaciones pueden usar el token de un solo uso para componer un magic link y enviarlo a la direcci\xf3n de correo electr\xf3nico del usuario final."}),"\n",(0,o.jsx)(n.h2,{id:"one-time-token-flow",children:"Flujo de token de un solo uso"}),"\n",(0,o.jsx)(n.p,{children:"Aqu\xed tienes el diagrama de secuencia del flujo de autenticaci\xf3n usando el token de un solo uso:"}),"\n",(0,o.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant U as Usuario final\n  participant C as Tu aplicaci\xf3n\n  participant L as Logto\n\n  U ->> C: (Opcional) El usuario solicita un magic link desde tu aplicaci\xf3n\n  C ->> L: Solicita token de un solo uso\n  L --\x3e> C: Devuelve token de un solo uso\n  C --\x3e> U: Compone un magic link que contiene el token de un solo uso y lo env\xeda al correo electr\xf3nico del usuario final\n  U ->> C: El usuario hace clic en el magic link y es redirigido a una p\xe1gina de destino de tu aplicaci\xf3n\n  C ->> L: Extrae el token de un solo uso del magic link y dispara el flujo de autenticaci\xf3n\n  L --\x3e> C: Logto verifica el token de un solo uso y devuelve el resultado\n  C --\x3e> U: El usuario es autenticado y se devuelve la informaci\xf3n del usuario"}),"\n",(0,o.jsx)(n.h2,{id:"implementation-guide",children:"Gu\xeda de implementaci\xf3n"}),"\n",(0,o.jsx)(n.p,{children:"Logto ofrece un conjunto de Management API (Management APIs) y Experience API (Experience APIs) para facilitar la implementaci\xf3n de tu magic link."}),"\n",(0,o.jsxs)(n.p,{children:["Antes de comenzar, aseg\xfarate de tener una instancia de Logto lista y haber establecido la conexi\xf3n M\xe1quina a m\xe1quina entre tu servidor de aplicaciones\ny el endpoint de Logto (requerido para las Management API). Aprende m\xe1s sobre ",(0,o.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Logto Management API"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"step-1-request-one-time-token",children:"Paso 1: Solicita el token de un solo uso"}),"\n",(0,o.jsx)(n.p,{children:"Utiliza Logto Management API para crear un token de un solo uso."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"POST /api/one-time-tokens\n"})}),"\n",(0,o.jsx)(n.p,{children:"Ejemplo de payload del cuerpo de la solicitud:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "email": "user@example.com",\n  // Opcional. Por defecto es 600 (10 minutos).\n  "expiresIn": 3600,\n  // Opcional. El usuario ser\xe1 aprovisionado a las organizaciones especificadas tras la verificaci\xf3n exitosa.\n  "context": {\n    "jitOrganizationIds": ["abcdefgh1234"]\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"step-2-compose-your-magic-link",children:"Paso 2: Comp\xf3n tu magic link"}),"\n",(0,o.jsxs)(n.p,{children:["Despu\xe9s de obtener el token de un solo uso, puedes componer un magic link y enviarlo a la direcci\xf3n de correo electr\xf3nico del usuario final.\nEl magic link debe contener al menos el token y el correo electr\xf3nico del usuario como par\xe1metros, y debe navegar a una p\xe1gina de destino en tu propia aplicaci\xf3n.\nPor ejemplo: ",(0,o.jsx)(n.code,{children:"https://yourapp.com/landing-page"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo simple de c\xf3mo podr\xeda verse el magic link:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"https://yourapp.com/landing-page?token=YHwbXSXxQfL02IoxFqr1hGvkB13uTqcd&email=user@example.com\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"Los nombres de los par\xe1metros en el magic link pueden ser completamente personalizados.\nPuedes a\xf1adir informaci\xf3n adicional al magic link seg\xfan los requisitos de tu aplicaci\xf3n,\nas\xed como codificar todos los par\xe1metros de la URL."})}),"\n",(0,o.jsx)(n.h3,{id:"step-3-trigger-the-authentication-flow-via-logto-sdk",children:"Paso 3: Dispara el flujo de autenticaci\xf3n v\xeda Logto SDK"}),"\n",(0,o.jsxs)(n.p,{children:["Despu\xe9s de que el usuario final haga clic en el magic link y navegue a tu aplicaci\xf3n, puedes extraer los par\xe1metros ",(0,o.jsx)(n.code,{children:"token"})," y ",(0,o.jsx)(n.code,{children:"email"})," de la URL, y luego llamar a la funci\xf3n ",(0,o.jsx)(n.code,{children:"signIn()"})," de Logto SDK para iniciar el flujo de autenticaci\xf3n."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",metastring:'title="TokenLandingPage.tsx"',children:"// Ejemplo en React\nimport { useLogto } from '@logto/react';\nimport { useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\n\nconst TokenLandingPage = () => {\n  const { signIn } = useLogto();\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    // Extrae el token y el email del magic link\n    const oneTimeToken = searchParams.get('token');\n    const email = searchParams.get('email');\n\n    // Suponiendo que esta es tu URI de redirecci\xf3n de inicio de sesi\xf3n\n    const redirectUri = 'https://yourapp.com/callback';\n\n    if (oneTimeToken && email) {\n      signIn({\n        redirectUri,\n        clearTokens: false, // Opcional. Ver mensaje de advertencia abajo\n        extraParams: {\n          'one_time_token': oneTimeToken,\n          'login_hint': email,\n        },\n      });\n    }\n  }, [searchParams, signIn]);\n\n  return <>Por favor, espera...</>;\n};\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"warning",children:[(0,o.jsxs)(n.p,{children:["Si un usuario ya ha iniciado sesi\xf3n, llamar a la funci\xf3n ",(0,o.jsx)(n.code,{children:"signIn()"})," del SDK limpiar\xe1 autom\xe1ticamente todos los tokens almacenados en cach\xe9 (Token de ID, Token de acceso y Token de actualizaci\xf3n) del almacenamiento del cliente,\nlo que termina perdiendo el estado de autenticaci\xf3n del usuario actual."]}),(0,o.jsxs)(n.p,{children:["Por lo tanto, debes especificar un par\xe1metro adicional de inicio de sesi\xf3n ",(0,o.jsx)(n.code,{children:"clearTokens: false"})," para evitar limpiar los tokens existentes.\nSi esto se especifica, tambi\xe9n tendr\xe1s que limpiar manualmente los tokens en la p\xe1gina de callback de inicio de sesi\xf3n."]}),(0,o.jsx)(n.p,{children:"Ignora esto si tus magic links no est\xe1n dise\xf1ados para usuarios autenticados."})]}),"\n",(0,o.jsx)(n.h3,{id:"step-4-clear-cached-tokens-in-sign-in-callback-page",children:"Paso 4: (Opcional) Limpia los tokens en cach\xe9 en la p\xe1gina de callback de inicio de sesi\xf3n"}),"\n",(0,o.jsxs)(n.p,{children:["Si especificas ",(0,o.jsx)(n.code,{children:"clearTokens: false"})," en la funci\xf3n de inicio de sesi\xf3n, necesitas limpiar manualmente los tokens en la p\xe1gina de callback de inicio de sesi\xf3n."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",metastring:'title="Callback.tsx"',children:"// Ejemplo en React\nimport { useHandleSignInCallback, useLogto } from '@logto/react';\nimport { useEffect } from 'react';\n\nconst Callback = () => {\n  const { clearAllTokens } = useLogto();\n\n  useEffect(() => {\n    void clearAllTokens();\n  }, [clearAllTokens]);\n\n  useHandleSignInCallback(() => {\n    // Navega a tu p\xe1gina de inicio\n  });\n\n  return <>Por favor, espera...</>;\n};\n"})}),"\n",(0,o.jsx)(n.h2,{id:"faqs",children:"Preguntas frecuentes (FAQs)"}),"\n",(0,o.jsxs)(i,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(n.h3,{id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",children:"\xbfPuedo usar el magic link para invitar nuevos usuarios a mis organizaciones?"})}),(0,o.jsxs)(n.p,{children:["S\xed, puedes usar el magic link para invitar nuevos usuarios a tu aplicaci\xf3n, as\xed como a organizaciones.\nSi deseas invitar nuevos usuarios a tu organizaci\xf3n, simplemente especifica los ",(0,o.jsx)(n.code,{children:"jitOrganizationIds"})," en el cuerpo de la solicitud."]}),(0,o.jsx)(n.p,{children:'El usuario se unir\xe1 autom\xe1ticamente a las organizaciones tras la verificaci\xf3n exitosa, y se asignar\xe1n los roles predeterminados de la organizaci\xf3n.\nConsulta la secci\xf3n "Just-in-time provisioning" en la p\xe1gina de detalles de tu organizaci\xf3n y configura los roles predeterminados para tus organizaciones.'})]}),"\n",(0,o.jsxs)(i,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(n.h3,{id:"does-the-one-time-token-expire",children:"\xbfEl token de un solo uso expira?"})}),(0,o.jsxs)(n.p,{children:["S\xed, el token de un solo uso expirar\xe1 despu\xe9s del tiempo especificado en ",(0,o.jsx)(n.code,{children:"expiresIn"})," (en segundos). El tiempo de expiraci\xf3n por defecto es de 10 minutos."]})]}),"\n",(0,o.jsxs)(i,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(n.h3,{id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",children:'Si desactivo el registro de usuarios en "Experiencia de inicio de sesi\xf3n", \xbfpuedo seguir usando magic link para invitar usuarios?'})}),(0,o.jsx)(n.p,{children:'S\xed, puedes seguir usando magic link para invitar usuarios incluso si desactivas el registro de usuarios en "Experiencia de inicio de sesi\xf3n".'})]}),"\n",(0,o.jsxs)(i,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(n.h3,{id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",children:"\xbfQu\xe9 sucede si un usuario ya ha iniciado sesi\xf3n y luego hace clic en otro magic link?"})}),(0,o.jsx)(n.p,{children:"Existen varios escenarios posibles:"}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"El usuario ya ha iniciado sesi\xf3n y luego hace clic en un magic link que est\xe1 asociado con la cuenta de usuario actual. En este caso, Logto seguir\xe1 verificando el token de un solo uso y aprovisionar\xe1 al usuario a las organizaciones especificadas si es necesario."}),"\n",(0,o.jsxs)(n.li,{children:["El usuario ya ha iniciado sesi\xf3n y luego hace clic en un magic link que est\xe1 asociado con una cuenta diferente. En este caso, Logto le pedir\xe1 al usuario continuar como la nueva cuenta o regresar a la aplicaci\xf3n con la cuenta actual.","\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Si el usuario elige continuar como la nueva cuenta, Logto cambiar\xe1 a la nueva cuenta despu\xe9s de que la verificaci\xf3n del token sea exitosa."}),"\n",(0,o.jsx)(n.li,{children:"Si el usuario elige permanecer con la cuenta actual, Logto no verificar\xe1 el token y regresar\xe1 a la aplicaci\xf3n con la cuenta actual."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:'Si tu prompt de inicio de sesi\xf3n est\xe1 configurado como "login" o contiene "login", Logto iniciar\xe1 sesi\xf3n autom\xe1ticamente con la cuenta asociada al token de un solo uso sin solicitar el cambio.'}),"\n"]})]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},88969:(e,n,i)=>{i.d(n,{A:()=>l});const a="availability_kRMk";var o=i(25105);const s=e=>"comingSoon"===e?"coming soon-blue":"boolean"==typeof e?e?"\u2713 available-4EA254":"not applicable-78767F":`since v${e.major}.${e.minor}-4EA254`,l=e=>{let{cloud:n,oss:i}=e;return(0,o.jsxs)("div",{className:a,children:[(0,o.jsx)("img",{alt:"Cloud availability",src:`https://img.shields.io/badge/Cloud-${s(n)}`}),(0,o.jsx)("img",{alt:"OSS availability",src:`https://img.shields.io/badge/OSS-${s(i)}`})]})}},79621:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var a=i(58101);const o={},s=a.createContext(o);function l(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);