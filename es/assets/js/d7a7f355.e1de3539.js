"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[3295],{25853:(e,n,o)=>{o.d(n,{Ay:()=>l,RM:()=>r});var a=o(25105),i=o(79621);const r=[];function s(e){const n={admonition:"admonition",code:"code",p:"p",...(0,i.R)(),...e.components};return(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Inspecciona el reclamo ",(0,a.jsx)(n.code,{children:"organizations"})," en el token de ID (ID token) para obtener una lista de los IDs de las organizaciones a las que pertenece el usuario. Este reclamo enumera todas las organizaciones de las que el usuario es miembro, lo que facilita enumerar o cambiar de organizaci\xf3n en tu aplicaci\xf3n."]})})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(s,{...e})}):s(e)}},23405:(e,n,o)=>{o.d(n,{Ay:()=>l,RM:()=>r});var a=o(25105),i=o(79621);const r=[];function s(e){const n={admonition:"admonition",p:"p",...(0,i.R)(),...e.components};return(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsx)(n.p,{children:"Por el momento, Logto no admite la obtenci\xf3n de tokens de organizaci\xf3n (Organization tokens) directamente desde el flujo de c\xf3digo de autorizaci\xf3n. Deber\xe1s utilizar el flujo de token de actualizaci\xf3n (Refresh token) para obtener un token de organizaci\xf3n (Organization token)."})})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(s,{...e})}):s(e)}},5073:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>j,contentTitle:()=>m,default:()=>v,frontMatter:()=>h,metadata:()=>a,resource:()=>x,toc:()=>z});const a=JSON.parse('{"id":"authorization/organization-level-api-resources","title":"Protege recursos de API a nivel de organizaci\xf3n","description":"Combina recursos de API con la plantilla de organizaci\xf3n para restringir el acceso a las APIs y datos dentro de cada organizaci\xf3n, asegurando el aislamiento a nivel de inquilino en tu SaaS.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/authorization/organization-level-api-resources.mdx","sourceDirName":"authorization","slug":"/authorization/organization-level-api-resources","permalink":"/es/authorization/organization-level-api-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/authorization/organization-level-api-resources.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Protege los permisos de organizaci\xf3n (no API)","permalink":"/es/authorization/organization-permissions"},"next":{"title":"Validar tokens de acceso en la API","permalink":"/es/authorization/validate-access-tokens/"}}');var i=o(25105),r=o(79621),s=o(1242),l=o(39088),c=o(78506),t=o(42372),d=o(38552),u=o(22002),p=o(25853),g=o(23405);const h={sidebar_position:5},m="Protege recursos de API a nivel de organizaci\xf3n",j={},x="https://api.your-app.com/organizations",z=[{value:"\xbfQu\xe9 son los recursos de API a nivel de organizaci\xf3n?",id:"what-are-organization-level-api-resources",level:2},{value:"C\xf3mo funciona en Logto",id:"how-it-works-in-logto",level:2},{value:"Resumen de la implementaci\xf3n",id:"implementation-overview",level:3},{value:"C\xf3mo aplica Logto el RBAC de organizaci\xf3n",id:"how-logto-applies-organization-rbac",level:3},{value:"Flujo de autorizaci\xf3n: autenticando y asegurando APIs con contexto de organizaci\xf3n",id:"authorization-flow-authenticating-and-securing-apis-with-organization-context",level:3},{value:"Pasos de implementaci\xf3n",id:"implementation-steps",level:2},{value:"Registra tu recurso de API",id:"register-your-api-resource",level:3},{value:"Configura roles de organizaci\xf3n",id:"set-up-organization-roles",level:3},{value:"Obt\xe9n tokens de organizaci\xf3n para recursos de API",id:"obtain-organization-tokens-for-api-resources",level:3},{value:"Flujo de token de actualizaci\xf3n",id:"refresh-token-flow",level:4},...p.RM,...g.RM,...p.RM,{value:"Flujo de credenciales de cliente",id:"client-credentials-flow",level:4},{value:"Valida los tokens de organizaci\xf3n",id:"validate-organization-tokens",level:3},{value:"Mejores pr\xe1cticas y consejos de seguridad",id:"best-practices-and-security-tips",level:2},{value:"Preguntas frecuentes",id:"faqs",level:2},{value:"\xbfQu\xe9 pasa si no incluyo <code>organization_id</code> en mi solicitud de token?",id:"what-if-i-don-t-include-organization-id-in-my-token-request",level:3},{value:"\xbfPuedo mezclar permisos de organizaci\xf3n y no organizaci\xf3n en un solo rol?",id:"can-i-mix-organization-and-non-organization-permissions-in-a-single-role",level:3},{value:"M\xe1s informaci\xf3n",id:"further-reading",level:2}];function f(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{CloudLink:o,Details:a,Url:h}=n;return o||b("CloudLink",!0),a||b("Details",!0),h||b("Url",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"protege-recursos-de-api-a-nivel-de-organizaci\xf3n",children:"Protege recursos de API a nivel de organizaci\xf3n"})}),"\n","\n",(0,i.jsx)(n.p,{children:"Combina recursos de API con la plantilla de organizaci\xf3n para restringir el acceso a las APIs y datos dentro de cada organizaci\xf3n, asegurando el aislamiento a nivel de inquilino en tu SaaS."}),"\n",(0,i.jsx)(n.h2,{id:"what-are-organization-level-api-resources",children:"\xbfQu\xe9 son los recursos de API a nivel de organizaci\xf3n?"}),"\n",(0,i.jsxs)(n.p,{children:["Los recursos de API a nivel de organizaci\xf3n son endpoints o servicios en tu aplicaci\xf3n que est\xe1n ",(0,i.jsx)(n.strong,{children:"limitados a una organizaci\xf3n espec\xedfica"}),". Estas APIs aplican autorizaci\xf3n y acceso basados en el contexto de la organizaci\xf3n, asegurando que los usuarios o clientes solo accedan a datos y acciones relevantes para su organizaci\xf3n."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Los casos de uso incluyen"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["APIs para gestionar miembros, roles o configuraciones de la organizaci\xf3n (por ejemplo, ",(0,i.jsx)(n.code,{children:"/organizations/{organizationId}/members"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Paneles, anal\xedticas o informes limitados a la organizaci\xf3n"}),"\n",(0,i.jsx)(n.li,{children:"Endpoints de facturaci\xf3n, suscripci\xf3n o auditor\xeda vinculados a una organizaci\xf3n"}),"\n",(0,i.jsx)(n.li,{children:"Cualquier API donde las acciones y los datos est\xe9n aislados por inquilino"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Logto te permite asegurar estas APIs de organizaci\xf3n usando OAuth 2.1 y control de acceso basado en roles (RBAC), mientras soporta arquitecturas SaaS multi-inquilino."}),"\n",(0,i.jsxs)(n.p,{children:["Estos permisos se gestionan a trav\xe9s de ",(0,i.jsx)(n.strong,{children:"roles de organizaci\xf3n"})," definidos en la ",(0,i.jsx)(n.a,{href:"/authorization/organization-template",children:"plantilla de organizaci\xf3n"}),". Cada organizaci\xf3n utiliza la misma plantilla, asegurando un modelo de permisos consistente en todas las organizaciones."]}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works-in-logto",children:"C\xf3mo funciona en Logto"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Los recursos de API y permisos se registran globalmente:"})," Cada recurso de API se define con un indicador de recurso \xfanico (URI) y un conjunto de permisos (alcances) en Logto."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Roles a nivel de organizaci\xf3n:"})," Los roles de organizaci\xf3n se definen en la plantilla de organizaci\xf3n. Los permisos de recursos de API (alcances) se asignan a los roles de organizaci\xf3n, que luego se asignan a usuarios o clientes ",(0,i.jsx)(n.strong,{children:"dentro de cada organizaci\xf3n"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Autorizaci\xf3n consciente del contexto:"})," Cuando un cliente solicita un token de acceso con un recurso de API y un ",(0,i.jsx)(n.code,{children:"organization_id"}),", Logto emite un token que incluye tanto el contexto de la organizaci\xf3n como la audiencia de la API. Los permisos (alcances) del token se determinan por los roles de organizaci\xf3n del usuario para la organizaci\xf3n especificada."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Separaci\xf3n de recursos globales:"})," Los recursos de API pueden ser accedidos con o sin contexto de organizaci\xf3n. El RBAC de organizaci\xf3n solo se aplica si se incluye un ",(0,i.jsx)(n.code,{children:"organization_id"})," en la solicitud. Para APIs compartidas entre todos los usuarios, consulta ",(0,i.jsx)(n.a,{href:"/authorization/global-api-resources",children:"Protege recursos de API globales"}),"."]}),"\n"]}),"\n",(0,i.jsx)("img",{src:s.A,alt:"Recursos de API a nivel de organizaci\xf3n RBAC",style:{maxWidth:"100%"}}),"\n",(0,i.jsx)(n.h3,{id:"implementation-overview",children:"Resumen de la implementaci\xf3n"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Registra tu recurso de API"})," y define sus permisos (alcances) en Logto."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Define roles de organizaci\xf3n"})," en la plantilla de organizaci\xf3n y asigna los permisos de API relevantes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asigna roles"})," a usuarios o clientes dentro de cada organizaci\xf3n."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Solicita un token de acceso"})," para la API con un ",(0,i.jsx)(n.code,{children:"organization_id"})," para incluir el contexto de la organizaci\xf3n."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Valida los tokens de acceso"})," en tu API, aplicando tanto el contexto de organizaci\xf3n como los permisos."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"how-logto-applies-organization-rbac",children:"C\xf3mo aplica Logto el RBAC de organizaci\xf3n"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Si solicitas un token de acceso ",(0,i.jsx)(n.strong,{children:"sin"})," un ",(0,i.jsx)(n.code,{children:"organization_id"}),", solo se consideran los roles/permisos globales."]}),"\n",(0,i.jsxs)(n.li,{children:["Si solicitas un token de acceso ",(0,i.jsx)(n.strong,{children:"con"})," un ",(0,i.jsx)(n.code,{children:"organization_id"}),", Logto eval\xfaa los roles de organizaci\xf3n del usuario y sus permisos asociados para esa organizaci\xf3n."]}),"\n",(0,i.jsxs)(n.li,{children:["El JWT resultante contendr\xe1 tanto la audiencia de la API (reclamo ",(0,i.jsx)(n.code,{children:"aud"}),") como el contexto de la organizaci\xf3n (reclamo ",(0,i.jsx)(n.code,{children:"organization_id"}),"), con los alcances filtrados a los otorgados por los roles de organizaci\xf3n del usuario."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"authorization-flow-authenticating-and-securing-apis-with-organization-context",children:"Flujo de autorizaci\xf3n: autenticando y asegurando APIs con contexto de organizaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:"El siguiente flujo muestra c\xf3mo un cliente (web, m\xf3vil o backend) obtiene y utiliza tokens de organizaci\xf3n para acceder a recursos de API a nivel de organizaci\xf3n."}),"\n",(0,i.jsx)(n.p,{children:"Ten en cuenta que el flujo no incluye detalles exhaustivos sobre los par\xe1metros o encabezados requeridos, sino que se centra en los pasos clave involucrados. Contin\xfaa leyendo para ver c\xf3mo funciona el flujo en la pr\xe1ctica."}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Cliente\n    participant Logto\n    participant API as Recurso de API\n\n    alt Autenticaci\xf3n de usuario\n        Cliente->>Logto: GET /oidc/auth\n        Logto->>Logto: Redirige al usuario a la p\xe1gina de inicio de sesi\xf3n\n        Logto->>Cliente: Redirige de vuelta con `authorization_code`\n        Cliente->>Logto: POST /oidc/token con `grant_type=authorization_code`\n        Logto->>Cliente: Devuelve token de actualizaci\xf3n\n        Cliente->>Logto: POST /oidc/token con `grant_type=refresh_token`<br/>+ recurso + organization_id\n    else Autenticaci\xf3n de cliente m\xe1quina a m\xe1quina (M2M)\n        Cliente->>Logto: POST /oidc/token con `grant_type=client_credentials`<br/>+ recurso + organization_id\n    end\n\n    Logto->>Cliente: Devuelve token de acceso (JWT)\n    Cliente->>API: Solicitud con token Bearer\n    API->>API: Valida el token, verifica contexto de organizaci\xf3n y permisos\n\n    alt Token v\xe1lido\n      API->>Cliente: Devuelve datos de la organizaci\xf3n\n    else Token inv\xe1lido\n      API->>Cliente: 401 No autorizado\n    end"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Autenticaci\xf3n de usuario = navegador/app. M2M = servicio backend o script usando credenciales de cliente + contexto de organizaci\xf3n."})}),"\n",(0,i.jsx)(n.h2,{id:"implementation-steps",children:"Pasos de implementaci\xf3n"}),"\n",(0,i.jsx)(n.h3,{id:"register-your-api-resource",children:"Registra tu recurso de API"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Ve a ",(0,i.jsx)(o,{to:"/api-resources",children:"Consola \u2192 Recursos de API"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Crea un nuevo recurso de API (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.yourapp.com/org"}),") y define sus permisos (alcances)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Para ver los pasos completos de configuraci\xf3n, consulta ",(0,i.jsx)(n.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"Definir recursos de API con permisos"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"set-up-organization-roles",children:"Configura roles de organizaci\xf3n"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Ve a ",(0,i.jsx)(o,{to:"/organization-template/organization-roles",children:"Consola \u2192 Plantilla de organizaci\xf3n \u2192 Roles de organizaci\xf3n"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Crea roles de organizaci\xf3n (por ejemplo, ",(0,i.jsx)(n.code,{children:"admin"}),", ",(0,i.jsx)(n.code,{children:"member"}),") y asigna permisos de API a cada rol."]}),"\n",(0,i.jsx)(n.li,{children:"Asigna roles a usuarios o clientes dentro de cada organizaci\xf3n. Si a\xfan no son miembros, inv\xedtalos o agr\xe9galos primero."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Para ver los pasos completos de configuraci\xf3n, consulta ",(0,i.jsx)(n.a,{href:"/authorization/role-based-access-control#configure-organization-roles",children:"Usar roles de organizaci\xf3n"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"obtain-organization-tokens-for-api-resources",children:"Obt\xe9n tokens de organizaci\xf3n para recursos de API"}),"\n",(0,i.jsxs)(n.p,{children:["Tu cliente/app debe solicitar un token con ambos par\xe1metros, ",(0,i.jsx)(n.code,{children:"resource"})," y ",(0,i.jsx)(n.code,{children:"organization_id"}),", para acceder a APIs a nivel de organizaci\xf3n. Logto emite tokens de organizaci\xf3n como ",(0,i.jsx)(n.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"}),". Puedes obtenerlos usando el ",(0,i.jsx)(n.a,{href:"https://auth.wiki/refresh-token",children:"flujo de token de actualizaci\xf3n"})," o el ",(0,i.jsx)(n.a,{href:"https://auth.wiki/client-credentials-flow",children:"flujo de credenciales de cliente"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"refresh-token-flow",children:"Flujo de token de actualizaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:"Casi todos los SDK oficiales de Logto admiten la obtenci\xf3n de tokens de organizaci\xf3n usando el flujo de token de actualizaci\xf3n de forma nativa. Tambi\xe9n se puede usar una biblioteca est\xe1ndar de cliente OAuth 2.0 / OIDC para implementar este flujo."}),"\n",(0,i.jsxs)(u.A,{groupId:"user-client",children:[(0,i.jsxs)(d.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,i.jsxs)(n.p,{children:["Al inicializar el Logto SDK, a\xf1ade el alcance ",(0,i.jsx)(n.code,{children:"urn:logto:scope:organizations"})," y los permisos de organizaci\xf3n deseados (alcances) al par\xe1metro ",(0,i.jsx)(n.code,{children:"scopes"}),"."]}),(0,i.jsxs)(n.p,{children:["Algunos SDK de Logto tienen un alcance predefinido para organizaciones, como ",(0,i.jsx)(n.code,{children:"UserScope.Organizations"})," en los SDK de JavaScript."]}),(0,i.jsx)(p.Ay,{}),(0,i.jsxs)(n.p,{children:["Al llamar a ",(0,i.jsx)(n.code,{children:"getAccessToken()"}),", especifica tanto el recurso de API (",(0,i.jsx)(n.code,{children:"resource"}),") como el ID de la organizaci\xf3n (",(0,i.jsx)(n.code,{children:"organizationId"}),") para obtener un token de organizaci\xf3n."]}),(0,i.jsxs)(n.p,{children:["Para detalles sobre cada SDK, consulta ",(0,i.jsx)(n.a,{href:"/quick-starts",children:"Gu\xedas r\xe1pidas"}),"."]})]}),(0,i.jsxs)(d.A,{value:"oauth-client",label:"OAuth 2.0 / OIDC client library",children:[(0,i.jsx)(n.p,{children:"Al configurar tu cliente OAuth 2.0 o inicializar el flujo de c\xf3digo de autorizaci\xf3n, aseg\xfarate de incluir los siguientes par\xe1metros:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"resource"}),": Establece el identificador del recurso de API registrado en Logto (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.your-app.com/organizations"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scope"}),": Incluye el alcance predefinido de organizaci\xf3n (",(0,i.jsx)(n.code,{children:"urn:logto:scope:organizations"}),"), ",(0,i.jsx)(n.code,{children:"offline_access"})," (para obtener tokens de actualizaci\xf3n) y cualquier permiso espec\xedfico de API que necesites (por ejemplo, ",(0,i.jsx)(n.code,{children:"manage:members view:analytics"}),")."]}),"\n"]}),(0,i.jsxs)(n.p,{children:["Algunas bibliotecas pueden no soportar el par\xe1metro ",(0,i.jsx)(n.code,{children:"resource"})," de forma nativa, pero normalmente permiten pasar par\xe1metros adicionales en la solicitud de autorizaci\xf3n. Consulta la documentaci\xf3n de tu biblioteca para m\xe1s detalles."]}),(0,i.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo no normativo de c\xf3mo podr\xeda verse la solicitud de autorizaci\xf3n:"}),(0,i.jsx)(l.A,{resource:x,scope:"urn:logto:scope:organizations invite:member manage:billing"}),(0,i.jsxs)(n.p,{children:["Una vez que el usuario est\xe9 autenticado, recibir\xe1s un c\xf3digo de autorizaci\xf3n. Usa este c\xf3digo haciendo una solicitud POST al endpoint ",(0,i.jsx)(n.code,{children:"/oidc/token"})," de Logto."]}),(0,i.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo no normativo de la solicitud de token:"}),(0,i.jsx)(t.A,{grantType:"authorization_code"}),(0,i.jsx)(g.Ay,{}),(0,i.jsx)(n.p,{children:"Recibir\xe1s un token de actualizaci\xf3n que puede usarse para obtener tokens de organizaci\xf3n."}),(0,i.jsx)(p.Ay,{}),(0,i.jsxs)(n.p,{children:["Finalmente, usa el token de actualizaci\xf3n para obtener un token de organizaci\xf3n haciendo una solicitud POST al endpoint ",(0,i.jsx)(n.code,{children:"/oidc/token"})," de Logto. Recuerda incluir:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["El par\xe1metro ",(0,i.jsx)(n.code,{children:"resource"})," establecido al identificador del recurso de API (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.yourapp.com/org"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["El par\xe1metro ",(0,i.jsx)(n.code,{children:"organization_id"})," establecido al ID de la organizaci\xf3n deseada."]}),"\n",(0,i.jsxs)(n.li,{children:["(Opcional) El par\xe1metro ",(0,i.jsx)(n.code,{children:"scope"})," para reducir a\xfan m\xe1s los permisos que necesitas (por ejemplo, ",(0,i.jsx)(n.code,{children:"manage:members view:reports"}),")."]}),"\n"]}),(0,i.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo no normativo de c\xf3mo podr\xeda verse la solicitud de token:"}),(0,i.jsx)(t.A,{grantType:"refresh_token",resource:x,organizationId:"your-organization-id"})]})]}),"\n",(0,i.jsx)(n.h4,{id:"client-credentials-flow",children:"Flujo de credenciales de cliente"}),"\n",(0,i.jsxs)(n.p,{children:["Para escenarios m\xe1quina a m\xe1quina (M2M), puedes usar el flujo de credenciales de cliente para obtener un token de acceso con permisos de recursos de API a nivel de organizaci\xf3n. Haciendo una solicitud POST al endpoint ",(0,i.jsx)(n.code,{children:"/oidc/token"})," de Logto con los par\xe1metros de organizaci\xf3n, puedes solicitar un token de organizaci\xf3n usando tu client ID y secret."]}),"\n",(0,i.jsx)(n.p,{children:"Estos son los par\xe1metros clave que debes incluir en la solicitud:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"resource"}),": El identificador del recurso de API (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.yourapp.com/org"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"organization_id"}),": El ID de la organizaci\xf3n para la que deseas el token."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scope"}),": Los permisos de recursos de API a nivel de organizaci\xf3n que deseas solicitar (por ejemplo, ",(0,i.jsx)(n.code,{children:"invite:member"}),", ",(0,i.jsx)(n.code,{children:"manage:billing"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo no normativo de la solicitud de token usando el tipo de concesi\xf3n de credenciales de cliente:"}),"\n",(0,i.jsx)(c.A,{resource:"https://api.yourapp.com/org",organizationId:"your-organization-id",scope:"invite:member manage:billing"}),"\n",(0,i.jsx)(n.h3,{id:"validate-organization-tokens",children:"Valida los tokens de organizaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:"Los tokens de organizaci\xf3n emitidos por Logto (JWTs) contienen reclamos que tu API puede usar para aplicar el control de acceso a nivel de organizaci\xf3n."}),"\n",(0,i.jsx)(n.p,{children:"Cuando tu app reciba un token de organizaci\xf3n, deber\xedas:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verificar la firma del token (usando los JWKs de Logto)."}),"\n",(0,i.jsxs)(n.li,{children:["Confirmar que el token no est\xe9 expirado (reclamo ",(0,i.jsx)(n.code,{children:"exp"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Comprobar que el ",(0,i.jsx)(n.code,{children:"iss"})," (emisor) coincida con tu endpoint de Logto."]}),"\n",(0,i.jsxs)(n.li,{children:["Asegurarte de que el ",(0,i.jsx)(n.code,{children:"aud"})," (audiencia) coincida con el identificador del recurso de API que registraste (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.yourapp.com/org"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Validar el reclamo ",(0,i.jsx)(n.code,{children:"organization_id"})," para asegurar que el token est\xe9 limitado a la organizaci\xf3n correcta."]}),"\n",(0,i.jsxs)(n.li,{children:["Separar el reclamo ",(0,i.jsx)(n.code,{children:"scope"})," (separado por espacios) y comprobar los permisos requeridos."]}),"\n",(0,i.jsxs)(n.li,{children:["Si la ruta de tu API incluye el ID de la organizaci\xf3n (por ejemplo, ",(0,i.jsx)(n.code,{children:"/organizations/{organizationId}/members"}),"), aseg\xfarate de que el reclamo ",(0,i.jsx)(n.code,{children:"organization_id"})," coincida con el par\xe1metro de la ruta."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Para gu\xedas paso a paso y espec\xedficas por lenguaje, consulta ",(0,i.jsx)(n.a,{href:"/authorization/validate-access-tokens",children:"C\xf3mo validar tokens de acceso"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices-and-security-tips",children:"Mejores pr\xe1cticas y consejos de seguridad"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Valida siempre el contexto de la organizaci\xf3n:"})," No conf\xedes solo en el token; revisa el reclamo ",(0,i.jsx)(n.code,{children:"organization_id"})," en cada llamada a una API limitada por organizaci\xf3n."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Usa restricciones de audiencia:"})," Revisa siempre el reclamo ",(0,i.jsx)(n.code,{children:"aud"})," para asegurar que el token sea para la organizaci\xf3n prevista."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mant\xe9n los permisos orientados al negocio:"})," Usa nombres claros que correspondan a acciones reales; otorga solo lo necesario para cada rol de organizaci\xf3n."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Separa permisos de API y no-API"})," donde sea posible (pero ambos pueden estar en un solo rol)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mant\xe9n los tiempos de vida de los tokens cortos:"})," Reduce el riesgo si un token se filtra."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Revisa regularmente tu plantilla de organizaci\xf3n:"})," Actualiza roles y permisos a medida que tu producto evoluciona."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"faqs",children:"Preguntas frecuentes"}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:(0,i.jsxs)(n.h3,{id:"what-if-i-don-t-include-organization-id-in-my-token-request",children:["\xbfQu\xe9 pasa si no incluyo ",(0,i.jsx)(n.code,{children:"organization_id"})," en mi solicitud de token?"]})}),(0,i.jsx)(n.p,{children:"Solo se evaluar\xe1n los roles/permisos globales. No se aplicar\xe1 el RBAC de organizaci\xf3n."})]}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.h3,{id:"can-i-mix-organization-and-non-organization-permissions-in-a-single-role",children:"\xbfPuedo mezclar permisos de organizaci\xf3n y no organizaci\xf3n en un solo rol?"})}),(0,i.jsx)(n.p,{children:"No, los permisos de organizaci\xf3n (incluidos los permisos de API a nivel de organizaci\xf3n) se definen por la plantilla de organizaci\xf3n y no pueden mezclarse con permisos globales de API. Sin embargo, puedes crear roles que incluyan tanto permisos de organizaci\xf3n como permisos de API a nivel de organizaci\xf3n."})]}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"M\xe1s informaci\xf3n"}),"\n",(0,i.jsx)(h,{href:"/authorization/validate-access-tokens",children:"C\xf3mo validar tokens de acceso"}),"\n",(0,i.jsx)(h,{href:"/developers/custom-token-claims",children:"Personalizaci\xf3n de reclamos de tokens"}),"\n",(0,i.jsx)(h,{href:"/use-cases/multi-tenancy/build-multi-tenant-saas-application",children:(0,i.jsx)(n.p,{children:"Caso de uso: Construir una aplicaci\xf3n SaaS multi-inquilino"})}),"\n",(0,i.jsx)(h,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Indicadores de recurso"})]})}function v(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(f,{...e})}):f(e)}function b(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,n,o)=>{o.d(n,{A:()=>r});var a=o(80173),i=o(25105);const r=e=>{let{resource:n,scope:o}=e;return(0,i.jsx)(a.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${o}\n&resource=${n}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,n,o)=>{o.d(n,{A:()=>r});var a=o(80173),i=o(25105);const r=e=>{let{resource:n,organizationId:o,scope:r}=e;return(0,i.jsxs)(a.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",n&&`&resource=${n}\n`,o&&`&organization_id=${o}\n`,`&scope=${r}\n`]})}},42372:(e,n,o)=>{o.d(n,{A:()=>r});var a=o(80173),i=o(25105);const r=e=>{let{grantType:n,resource:o,organizationId:r}=e;const s=[`grant_type=${n}`,"authorization_code"===n&&"code=authorization-code-received","authorization_code"===n&&"redirect_uri=https://your-app.com/callback","refresh_token"===n&&"refresh_token=your-refresh-token",o&&`resource=${o}`,r&&`organization_id=${r}`].filter(Boolean);return(0,i.jsx)(a.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${s.join("\n&")}`})}},38552:(e,n,o)=>{o.d(n,{A:()=>s});o(58101);var a=o(13526);const i={tabItem:"tabItem_dgSZ"};var r=o(25105);function s(e){let{children:n,hidden:o,className:s}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,s),hidden:o,children:n})}},22002:(e,n,o)=>{o.d(n,{A:()=>k});var a=o(58101),i=o(13526),r=o(60755),s=o(55234),l=o(6635),c=o(4100),t=o(35661),d=o(42752);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:o}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:o,attributes:a,default:i}}=e;return{value:n,label:o,attributes:a,default:i}}))}(o);return function(e){const n=(0,t.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,o])}function g(e){let{value:n,tabValues:o}=e;return o.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:o}=e;const i=(0,s.W6)(),r=function(e){let{queryString:n=!1,groupId:o}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!o)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:n,groupId:o});return[(0,c.aZ)(r),(0,a.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})}),[r,i])]}function m(e){const{defaultValue:n,queryString:o=!1,groupId:i}=e,r=p(e),[s,c]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:o}=e;if(0===o.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:o}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${o.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=o.find((e=>e.default))??o[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r}))),[t,u]=h({queryString:o,groupId:i}),[m,j]=function(e){let{groupId:n}=e;const o=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,r]=(0,d.Dv)(o);return[i,(0,a.useCallback)((e=>{o&&r.set(e)}),[o,r])]}({groupId:i}),x=(()=>{const e=t??m;return g({value:e,tabValues:r})?e:null})();(0,l.A)((()=>{x&&c(x)}),[x]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!g({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),j(e)}),[u,j,r]),tabValues:r}}var j=o(21929);const x={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var z=o(25105);function f(e){let{className:n,block:o,selectedValue:a,selectValue:s,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:t}=(0,r.a_)(),d=e=>{const n=e.currentTarget,o=c.indexOf(n),i=l[o].value;i!==a&&(t(n),s(i))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const o=c.indexOf(e.currentTarget)+1;n=c[o]??c[0];break}case"ArrowLeft":{const o=c.indexOf(e.currentTarget)-1;n=c[o]??c[c.length-1];break}}n?.focus()};return(0,z.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":o},n),children:l.map((e=>{let{value:n,label:o,attributes:r}=e;return(0,z.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{c.push(e)},onKeyDown:u,onClick:d,...r,className:(0,i.A)("tabs__item",x.tabItem,r?.className,{"tabs__item--active":a===n}),children:o??n},n)}))})}function v(e){let{lazy:n,children:o,selectedValue:r}=e;const s=(Array.isArray(o)?o:[o]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,z.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function b(e){const n=m(e);return(0,z.jsxs)("div",{className:(0,i.A)("tabs-container",x.tabList),children:[(0,z.jsx)(f,{...n,...e}),(0,z.jsx)(v,{...n,...e})]})}function k(e){const n=(0,j.A)();return(0,z.jsx)(b,{...e,children:u(e.children)},String(n))}},55138:(e,n,o)=>{o.d(n,{A:()=>m});var a=o(28259),i=o(6097),r=o(58574),s=o(9484),l=o(76566),c=o(26346),t=o(17867),d=o(17510),u=o(13526),p=o(72355);const g={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var h=o(25105);function m(e){let{children:n,className:o="",metastring:m,title:j,showLineNumbers:x,language:z}=e;const{prism:{defaultLanguage:f,magicComments:v}}=(0,a.p)(),b=function(e){return e?.toLowerCase()}(z??(0,r.Op)(o)??f),k=(0,i.A)(),A=(0,s.f)(),y=(0,r.wt)(m)||j,{lineClassNames:I,code:P}=(0,r.Li)(n,{metastring:m,language:b,magicComments:v}),w=x??(0,r._u)(m);return(0,h.jsxs)(l.A,{as:"div",className:(0,u.A)(o,b&&!o.includes(`language-${b}`)&&`language-${b}`),children:[y&&(0,h.jsx)("div",{className:g.codeBlockTitle,children:y}),(0,h.jsxs)("div",{className:g.codeBlockContent,children:[(0,h.jsx)(p.f4,{theme:k,code:P,language:b??"text",children:e=>{let{className:n,tokens:o,getLineProps:a,getTokenProps:i}=e;return(0,h.jsx)("pre",{ref:A.codeBlockRef,tabIndex:0,className:(0,u.A)(n,g.codeBlock,"thin-scrollbar"),children:(0,h.jsx)("code",{className:(0,u.A)(g.codeBlockLines,w&&g.codeBlockLinesWithNumbering),children:o.map(((e,n)=>(0,h.jsx)(t.A,{line:e,getLineProps:a,getTokenProps:i,classNames:I[n],showLineNumbers:w},n)))})})}}),(0,h.jsxs)("div",{className:g.buttonGroup,children:[(A.isEnabled||A.isCodeScrollable)&&(0,h.jsx)(d.A,{className:g.codeButton,isEnabled:A.isEnabled,onClick:()=>{A.toggle()}}),(0,h.jsx)(c.A,{className:g.codeButton,code:P})]})]})]})}},1242:(e,n,o)=>{o.d(n,{A:()=>a});const a=o.p+"assets/images/rbac-organization-level-api-resources-9533c281f3ee1cf52aefe821717e1fef.png"}}]);