"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[3133],{10809:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>m,contentTitle:()=>h,default:()=>b,frontMatter:()=>p,metadata:()=>s,resource:()=>g,toc:()=>j});const s=JSON.parse('{"id":"authorization/global-api-resources","title":"Protege recursos globales de API","description":"Protege las APIs de todo el producto utilizando el control de acceso basado en roles (RBAC) en Logto. Asigna roles y permisos globales para controlar el acceso de todos los usuarios y clientes en tu aplicaci\xf3n.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","sourceDirName":"authorization","slug":"/authorization/global-api-resources","permalink":"/es/authorization/global-api-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Plantilla de organizaci\xf3n","permalink":"/es/authorization/organization-template"},"next":{"title":"Protege los permisos de organizaci\xf3n (no API)","permalink":"/es/authorization/organization-permissions"}}');var r=n(25105),a=n(79621),i=n(46643),t=n(39088),l=n(78506),c=n(42372),d=n(38552),u=n(22002);const p={sidebar_position:3},h="Protege recursos globales de API",m={},g="https://api.your-app.com",j=[{value:"\xbfQu\xe9 son los recursos globales de API?",id:"what-are-global-api-resources",level:2},{value:"C\xf3mo funciona en Logto",id:"how-it-works-in-logto",level:2},{value:"Resumen de la implementaci\xf3n",id:"implementation-overview",level:3},{value:"Entendiendo los indicadores de recurso",id:"understanding-resource-indicators",level:3},{value:"Flujo de autorizaci\xf3n: autenticando y asegurando tu API",id:"authorization-flow-authenticating-and-securing-your-api",level:3},{value:"Pasos de implementaci\xf3n",id:"implementation-steps",level:2},{value:"Registra tus recursos de API",id:"register-your-api-resources",level:3},{value:"Configura roles globales",id:"set-up-global-roles",level:3},{value:"Obt\xe9n tokens de acceso para recursos globales de API",id:"obtain-access-tokens-for-global-api-resources",level:3},{value:"Flujo de c\xf3digo de autorizaci\xf3n o refresh token",id:"authorization-code-or-refresh-token-flow",level:4},{value:"Flujo de credenciales de cliente",id:"client-credentials-flow",level:4},{value:"Validando tokens de acceso JWT en tu API",id:"validating-jwt-access-tokens-in-your-api",level:3},{value:"Opcional: Manejar cambios de permisos de usuario",id:"optional-handle-user-permission-change",level:3},{value:"Mejores pr\xe1cticas y consejos de seguridad",id:"best-practices-and-security-tips",level:2},{value:"Preguntas frecuentes",id:"faqs",level:2},{value:"\xbfQu\xe9 pasa si mi cliente no soporta el par\xe1metro resource?",id:"what-if-my-client-doesn-t-support-the-resource-parameter",level:3},{value:"\xbfPor qu\xe9 recibo 401 No autorizado de mi API?",id:"why-do-i-get-401-unauthorized-from-my-api",level:3},{value:"\xbfC\xf3mo pruebo sin un cliente completo?",id:"how-do-i-test-without-a-full-client",level:3},{value:"Lecturas adicionales",id:"further-reading",level:2}];function x(e){const o={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{CloudLink:n,Details:s,Url:p}=o;return n||f("CloudLink",!0),s||f("Details",!0),p||f("Url",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.header,{children:(0,r.jsx)(o.h1,{id:"protege-recursos-globales-de-api",children:"Protege recursos globales de API"})}),"\n","\n",(0,r.jsx)(o.p,{children:"Protege las APIs de todo el producto utilizando el control de acceso basado en roles (RBAC) en Logto. Asigna roles y permisos globales para controlar el acceso de todos los usuarios y clientes en tu aplicaci\xf3n."}),"\n",(0,r.jsx)(o.h2,{id:"what-are-global-api-resources",children:"\xbfQu\xe9 son los recursos globales de API?"}),"\n",(0,r.jsx)(o.p,{children:"Los recursos globales de API son endpoints o servicios en tu aplicaci\xf3n que son accesibles para todos los usuarios, sin importar la organizaci\xf3n o el inquilino. Normalmente, estos son APIs p\xfablicos, servicios centrales del producto o cualquier endpoint que no est\xe9 limitado a una organizaci\xf3n espec\xedfica."}),"\n",(0,r.jsx)(o.p,{children:(0,r.jsx)(o.strong,{children:"Casos de uso incluyen"})}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"APIs p\xfablicas o endpoints compartidos entre toda tu base de usuarios."}),"\n",(0,r.jsx)(o.li,{children:"Microservicios que no est\xe1n ligados a la multi-tenencia."}),"\n",(0,r.jsxs)(o.li,{children:["APIs centrales de la aplicaci\xf3n (por ejemplo, ",(0,r.jsx)(o.code,{children:"/api/users"}),", ",(0,r.jsx)(o.code,{children:"/api/products"}),") utilizadas por todos los clientes."]}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"Logto te permite asegurar estas APIs usando OAuth 2.1, combinado con un control de acceso flexible basado en roles."}),"\n",(0,r.jsx)(o.h2,{id:"how-it-works-in-logto",children:"C\xf3mo funciona en Logto"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Los recursos de API y permisos se registran globalmente:"})," Cada API que deseas proteger se define con un indicador de recurso \xfanico (URI) y un conjunto de permisos (alcances) que controlan el acceso."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"El acceso se controla mediante roles globales:"})," Puedes asignar permisos a roles, que luego se asignan a usuarios o clientes."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Separado de los permisos a nivel de organizaci\xf3n:"})," Los recursos globales de API no tienen contexto de organizaci\xf3n. Sin embargo, pueden usarse junto con roles de organizaci\xf3n para proporcionar una capa adicional de contexto si es necesario. Para proteger APIs a nivel de organizaci\xf3n, consulta ",(0,r.jsx)(o.a,{href:"/authorization/organization-level-api-resources",children:"Proteger recursos de API a nivel de organizaci\xf3n"}),"."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:i.A,alt:"Recursos globales de API RBAC",style:{maxWidth:"100%"}}),"\n",(0,r.jsx)(o.h3,{id:"implementation-overview",children:"Resumen de la implementaci\xf3n"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Registra tu recurso de API"})," y define sus permisos en Logto."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Define roles"})," con los permisos necesarios para acceder a la API."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Asigna roles"})," a usuarios o clientes."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Utiliza los flujos de autorizaci\xf3n OAuth 2.0"})," para obtener tokens de acceso para la API (el par\xe1metro resource debe coincidir con el identificador de API registrado)."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Valida los tokens de acceso"})," en tu API para hacer cumplir los permisos."]}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:"understanding-resource-indicators",children:"Entendiendo los indicadores de recurso"}),"\n",(0,r.jsxs)(o.p,{children:["Logto modela los recursos de API seg\xfan ",(0,r.jsx)(o.a,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Indicadores de recurso para OAuth 2.0"}),". Un ",(0,r.jsx)(o.strong,{children:"indicador de recurso"})," es un URI que identifica de manera \xfanica la API o servicio objetivo solicitado."]}),"\n",(0,r.jsx)(o.p,{children:(0,r.jsx)(o.strong,{children:"Puntos clave"})}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["Los indicadores de recurso deben ser URIs absolutas (por ejemplo, ",(0,r.jsx)(o.code,{children:"https://api.example.com"}),")"]}),"\n",(0,r.jsx)(o.li,{children:"Sin componente de fragmento; evita usar cadenas de consulta cuando sea posible."}),"\n",(0,r.jsx)(o.li,{children:"Los indicadores de recurso permiten tokens restringidos por audiencia y soporte para arquitecturas multi-API."}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:(0,r.jsx)(o.strong,{children:"Ejemplo"})}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["Management API: ",(0,r.jsx)(o.code,{children:"https://my-tenant.logto.app/api"})]}),"\n",(0,r.jsxs)(o.li,{children:["API global personalizada: ",(0,r.jsx)(o.code,{children:"https://api.yourapp.com"})]}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:"authorization-flow-authenticating-and-securing-your-api",children:"Flujo de autorizaci\xf3n: autenticando y asegurando tu API"}),"\n",(0,r.jsx)(o.p,{children:"El siguiente flujo aplica tanto para la autenticaci\xf3n interactiva de usuarios (navegador / app) como para escenarios backend m\xe1quina a m\xe1quina (M2M)."}),"\n",(0,r.jsx)(o.p,{children:"Ten en cuenta que el flujo no incluye todos los detalles sobre los par\xe1metros o encabezados requeridos, sino que se enfoca en los pasos clave involucrados. Contin\xfaa leyendo para ver c\xf3mo funciona el flujo en la pr\xe1ctica."}),"\n",(0,r.jsx)(o.mermaid,{value:"sequenceDiagram\n    participant Cliente\n    participant Logto\n    participant API as Recurso de API\n\n    alt Autenticaci\xf3n de usuario\n        Cliente->>Logto: GET /oidc/auth\n        Logto->>Logto: Redirige al usuario a la p\xe1gina de inicio de sesi\xf3n\n        Logto->>Cliente: Redirige de vuelta con `authorization_code`\n        alt Usar el grant de authorization_code\n            Cliente->>Logto: POST /oidc/token con `grant_type=authorization_code`<br/>y par\xe1metro `resource`\n        else Usar el grant de refresh_token\n            Cliente->>Logto: POST /oidc/token con `grant_type=authorization_code`\n            Logto->>Cliente: Devuelve refresh token\n            Cliente->>Logto: POST /oidc/token con `grant_type=refresh_token`<br/>y par\xe1metro `resource`\n        end\n    else Autenticaci\xf3n de cliente m\xe1quina a m\xe1quina (M2M)\n        Cliente->>Logto: POST /oidc/token con `grant_type=client_credentials`<br/>y par\xe1metro `resource`\n    end\n\n    Logto->>Cliente: Devuelve token de acceso (JSON Web Token)\n    Cliente->>API: Solicitud con token Bearer\n    API->>API: Valida el token de acceso\n\n    alt El token es v\xe1lido\n      API->>Cliente: Devuelve datos del recurso protegido\n    else El token no es v\xe1lido\n      API->>Cliente: 401 No autorizado\n    end"}),"\n",(0,r.jsx)(o.p,{children:(0,r.jsx)(o.em,{children:"Autenticaci\xf3n de usuario = navegador / app. M2M = servicio backend o script usando credenciales de cliente."})}),"\n",(0,r.jsx)(o.admonition,{type:"note",children:(0,r.jsxs)(o.p,{children:["El par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," debe coincidir exactamente con el identificador de API (indicador de recurso) que registraste en Logto."]})}),"\n",(0,r.jsx)(o.h2,{id:"implementation-steps",children:"Pasos de implementaci\xf3n"}),"\n",(0,r.jsx)(o.h3,{id:"register-your-api-resources",children:"Registra tus recursos de API"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsxs)(o.li,{children:["Ve a ",(0,r.jsx)(n,{to:"/api-resources",children:"Consola \u2192 Recursos de API"}),"."]}),"\n",(0,r.jsxs)(o.li,{children:["Crea un nuevo recurso de API (por ejemplo, ",(0,r.jsx)(o.code,{children:"https://api.yourapp.com/org"}),") y define sus permisos (alcances)."]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["Para ver los pasos completos de configuraci\xf3n, consulta ",(0,r.jsx)(o.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"Definir recursos de API con permisos"}),"."]}),"\n",(0,r.jsx)(o.h3,{id:"set-up-global-roles",children:"Configura roles globales"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsxs)(o.li,{children:["Ve a ",(0,r.jsx)(n,{to:"/roles",children:"Consola \u2192 Roles"}),"."]}),"\n",(0,r.jsxs)(o.li,{children:["Crea roles que correspondan a los permisos de tu API (por ejemplo, ",(0,r.jsx)(o.code,{children:"read:products"}),", ",(0,r.jsx)(o.code,{children:"write:products"}),")."]}),"\n",(0,r.jsx)(o.li,{children:"Asigna estos roles a los usuarios o clientes que necesiten acceso a la API."}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["Para ver los pasos completos de configuraci\xf3n, consulta ",(0,r.jsx)(o.a,{href:"/authorization/role-based-access-control#configure-global-roles",children:"Usar roles globales"}),"."]}),"\n",(0,r.jsx)(o.h3,{id:"obtain-access-tokens-for-global-api-resources",children:"Obt\xe9n tokens de acceso para recursos globales de API"}),"\n",(0,r.jsxs)(o.p,{children:["Antes de acceder a un recurso global de API, tu cliente debe obtener un token de acceso. Logto emite ",(0,r.jsx)(o.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"})," como tokens de acceso para recursos globales de API. Esto normalmente se realiza usando el ",(0,r.jsx)(o.a,{href:"https://auth.wiki/authorization-code-flow",children:"flujo de c\xf3digo de autorizaci\xf3n OAuth 2.0"}),", ",(0,r.jsx)(o.a,{href:"https://auth.wiki/refresh-token",children:"flujo de refresh token"}),", o el ",(0,r.jsx)(o.a,{href:"https://auth.wiki/client-credentials-flow",children:"flujo de credenciales de cliente"}),"."]}),"\n",(0,r.jsx)(o.h4,{id:"authorization-code-or-refresh-token-flow",children:"Flujo de c\xf3digo de autorizaci\xf3n o refresh token"}),"\n",(0,r.jsx)(o.p,{children:"Todos los SDK oficiales de Logto admiten la obtenci\xf3n de tokens de acceso para recursos globales de API usando el flujo de refresh token de forma predeterminada. Tambi\xe9n se puede usar una biblioteca cliente est\xe1ndar de OAuth 2.0 / OIDC para implementar este flujo."}),"\n",(0,r.jsxs)(u.A,{groupId:"user-client",children:[(0,r.jsxs)(d.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,r.jsxs)(o.p,{children:["Al inicializar el cliente Logto, a\xf1ade el indicador de recurso al par\xe1metro ",(0,r.jsx)(o.code,{children:"resources"})," (array), luego a\xf1ade los permisos deseados (alcances) al par\xe1metro ",(0,r.jsx)(o.code,{children:"scopes"}),"."]}),(0,r.jsxs)(o.p,{children:["Una vez que el usuario est\xe1 autenticado, pasa el indicador de recurso en el par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," o en un par\xe1metro de nombre similar al solicitar el token de acceso (por ejemplo, llamando a ",(0,r.jsx)(o.code,{children:"getAccessToken()"}),")."]}),(0,r.jsxs)(o.p,{children:["Para detalles sobre cada SDK, consulta los ",(0,r.jsx)(o.a,{href:"/quick-starts",children:"Inicios r\xe1pidos"}),"."]})]}),(0,r.jsxs)(d.A,{value:"oauth-client",label:"OAuth 2.0 / OIDC client library",children:[(0,r.jsxs)(o.p,{children:["Al configurar tu cliente OAuth 2.0 o inicializar el flujo de c\xf3digo de autorizaci\xf3n, aseg\xfarate de incluir el par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," y los alcances deseados en la solicitud de autorizaci\xf3n."]}),(0,r.jsxs)(o.p,{children:["Algunas bibliotecas pueden no soportar el par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," de forma nativa, pero normalmente permiten pasar par\xe1metros adicionales en la solicitud de autorizaci\xf3n. Consulta la documentaci\xf3n de tu biblioteca para m\xe1s detalles."]}),(0,r.jsxs)(o.p,{children:["Aqu\xed tienes un ejemplo no normativo de la solicitud de autorizaci\xf3n con los par\xe1metros ",(0,r.jsx)(o.code,{children:"resource"})," y ",(0,r.jsx)(o.code,{children:"scope"}),":"]}),(0,r.jsx)(t.A,{resource:g,scope:"read:products write:products"}),(0,r.jsxs)(o.p,{children:["Una vez que el usuario est\xe1 autenticado, recibir\xe1s un authorization code. Intercambia este c\xf3digo por un token de acceso haciendo una solicitud POST al endpoint ",(0,r.jsx)(o.code,{children:"/oidc/token"})," de Logto, incluyendo el par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," en el cuerpo de la solicitud."]}),(0,r.jsx)(o.p,{children:"Aqu\xed tienes un ejemplo no normativo de la solicitud de token usando el grant type authorization_code:"}),(0,r.jsx)(c.A,{grantType:"authorization_code",resource:g}),(0,r.jsxs)(o.p,{children:["Tambi\xe9n puedes usar el grant type ",(0,r.jsx)(o.code,{children:"refresh_token"})," para obtener un nuevo token de acceso sin interacci\xf3n del usuario, siempre que el par\xe1metro ",(0,r.jsx)(o.code,{children:"resource"})," est\xe9 incluido en la solicitud."]}),(0,r.jsx)(o.p,{children:"Aqu\xed tienes un ejemplo no normativo de la solicitud de token usando el grant type refresh_token:"}),(0,r.jsx)(c.A,{grantType:"refresh_token",resource:g})]})]}),"\n",(0,r.jsx)(o.h4,{id:"client-credentials-flow",children:"Flujo de credenciales de cliente"}),"\n",(0,r.jsxs)(o.p,{children:["Para escenarios m\xe1quina a m\xe1quina (M2M), puedes usar el flujo de credenciales de cliente para obtener un token de acceso para tu recurso global de API. Haciendo una solicitud POST al endpoint ",(0,r.jsx)(o.code,{children:"/oidc/token"})," de Logto, puedes solicitar un token de acceso usando tu client ID y secret."]}),"\n",(0,r.jsx)(o.p,{children:"Hay dos par\xe1metros clave que debes incluir en la solicitud:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.code,{children:"resource"}),": El URI indicador de recurso de la API a la que deseas acceder (por ejemplo, ",(0,r.jsx)(o.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.code,{children:"scope"}),": Los permisos que deseas solicitar para la API (por ejemplo, ",(0,r.jsx)(o.code,{children:"read:products write:products"}),")."]}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"Aqu\xed tienes un ejemplo no normativo de la solicitud de token usando el grant type client_credentials:"}),"\n",(0,r.jsx)(l.A,{resource:"https://api.yourapp.com",scope:"read:products write:products"}),"\n",(0,r.jsx)(o.h3,{id:"validating-jwt-access-tokens-in-your-api",children:"Validando tokens de acceso JWT en tu API"}),"\n",(0,r.jsx)(o.p,{children:"Los JWTs emitidos por Logto contienen reclamos que tu API puede usar para hacer cumplir la autorizaci\xf3n."}),"\n",(0,r.jsx)(o.p,{children:"Cuando tu API recibe una solicitud con un token de acceso emitido por Logto, debes:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Verificar la firma del token (usando los JWKs de Logto)."}),"\n",(0,r.jsxs)(o.li,{children:["Confirmar que el token no ha expirado (reclamo ",(0,r.jsx)(o.code,{children:"exp"}),")."]}),"\n",(0,r.jsxs)(o.li,{children:["Comprobar que el ",(0,r.jsx)(o.code,{children:"iss"})," (emisor) coincide con tu endpoint de Logto."]}),"\n",(0,r.jsxs)(o.li,{children:["Asegurarte de que el ",(0,r.jsx)(o.code,{children:"aud"})," (audiencia) coincide con el identificador de recurso de API que registraste (por ejemplo, ",(0,r.jsx)(o.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,r.jsxs)(o.li,{children:["Separar el reclamo ",(0,r.jsx)(o.code,{children:"scope"})," (separado por espacios) y comprobar los permisos requeridos."]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["Para gu\xedas paso a paso y espec\xedficas por lenguaje, consulta ",(0,r.jsx)(o.a,{href:"/authorization/validate-access-tokens",children:"C\xf3mo validar tokens de acceso"}),"."]}),"\n",(0,r.jsx)(o.h3,{id:"optional-handle-user-permission-change",children:"Opcional: Manejar cambios de permisos de usuario"}),"\n",(0,r.jsx)(o.admonition,{type:"info",children:(0,r.jsx)(o.p,{children:"\ud83d\udc77 Trabajo en progreso. \ud83d\udea7"})}),"\n",(0,r.jsx)(o.h2,{id:"best-practices-and-security-tips",children:"Mejores pr\xe1cticas y consejos de seguridad"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Mant\xe9n los permisos orientados al negocio:"})," Usa nombres claros que correspondan a acciones reales."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Mant\xe9n la expiraci\xf3n de los tokens corta:"})," Reduce el riesgo si un token se filtra."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Limita los alcances concedidos:"})," Solo otorga a los tokens los permisos que realmente necesitan."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Usa restricci\xf3n de audiencia:"})," Verifica siempre el reclamo ",(0,r.jsx)(o.code,{children:"aud"})," para evitar usos indebidos."]}),"\n"]}),"\n",(0,r.jsx)(o.h2,{id:"faqs",children:"Preguntas frecuentes"}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(o.h3,{id:"what-if-my-client-doesn-t-support-the-resource-parameter",children:"\xbfQu\xe9 pasa si mi cliente no soporta el par\xe1metro resource?"})}),(0,r.jsx)(o.p,{children:"Configura un recurso de API predeterminado en la Consola de Logto. Los tokens usar\xe1n esta audiencia por defecto cuando no se especifique el par\xe1metro resource en la solicitud de token."})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(o.h3,{id:"why-do-i-get-401-unauthorized-from-my-api",children:"\xbfPor qu\xe9 recibo 401 No autorizado de mi API?"})}),(0,r.jsx)(o.p,{children:"Verifica los siguientes problemas comunes:"}),(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Firma del token"}),": Aseg\xfarate de que tu backend obtiene los JWKs correctos de Logto"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Expiraci\xf3n del token"}),": Verifica que el token no haya expirado (reclamo ",(0,r.jsx)(o.code,{children:"exp"}),")"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Audiencia"}),": Confirma que el reclamo ",(0,r.jsx)(o.code,{children:"aud"})," coincide con el indicador de recurso de API registrado"]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Alcances requeridos"}),": Verifica que el token contenga los permisos necesarios en el reclamo ",(0,r.jsx)(o.code,{children:"scope"})]}),"\n"]})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(o.h3,{id:"how-do-i-test-without-a-full-client",children:"\xbfC\xf3mo pruebo sin un cliente completo?"})}),(0,r.jsxs)(o.p,{children:["Utiliza un ",(0,r.jsx)(o.a,{href:"/user-management/personal-access-token",children:"token de acceso personal"})," para simular llamadas autenticadas. Esto te permite probar los endpoints de tu API sin implementar un flujo OAuth completo en tu aplicaci\xf3n cliente."]})]}),"\n",(0,r.jsx)(o.h2,{id:"further-reading",children:"Lecturas adicionales"}),"\n",(0,r.jsx)(p,{href:"/authorization/validate-access-tokens",children:"C\xf3mo validar tokens de acceso"}),"\n",(0,r.jsx)(p,{href:"/use-cases/authorization/rbac-in-practice",children:(0,r.jsx)(o.p,{children:"RBAC en la pr\xe1ctica: Implementando autorizaci\xf3n segura para tu aplicaci\xf3n"})}),"\n",(0,r.jsx)(p,{href:"/developers/custom-token-claims",children:"Personalizaci\xf3n de reclamos de tokens"}),"\n",(0,r.jsx)(p,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Indicadores de recurso"})]})}function b(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(x,{...e})}):x(e)}function f(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,o,n)=>{n.d(o,{A:()=>a});var s=n(80173),r=n(25105);const a=e=>{let{resource:o,scope:n}=e;return(0,r.jsx)(s.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${n}\n&resource=${o}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,o,n)=>{n.d(o,{A:()=>a});var s=n(80173),r=n(25105);const a=e=>{let{resource:o,organizationId:n,scope:a}=e;return(0,r.jsxs)(s.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",o&&`&resource=${o}\n`,n&&`&organization_id=${n}\n`,`&scope=${a}\n`]})}},42372:(e,o,n)=>{n.d(o,{A:()=>a});var s=n(80173),r=n(25105);const a=e=>{let{grantType:o,resource:n,organizationId:a}=e;const i=[`grant_type=${o}`,"authorization_code"===o&&"code=authorization-code-received","authorization_code"===o&&"redirect_uri=https://your-app.com/callback","refresh_token"===o&&"refresh_token=your-refresh-token",n&&`resource=${n}`,a&&`organization_id=${a}`].filter(Boolean);return(0,r.jsx)(s.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${i.join("\n&")}`})}},38552:(e,o,n)=>{n.d(o,{A:()=>i});n(58101);var s=n(13526);const r={tabItem:"tabItem_dgSZ"};var a=n(25105);function i(e){let{children:o,hidden:n,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,i),hidden:n,children:o})}},22002:(e,o,n)=>{n.d(o,{A:()=>k});var s=n(58101),r=n(13526),a=n(60755),i=n(55234),t=n(6635),l=n(4100),c=n(35661),d=n(42752);function u(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:o}=e;return!!o&&"object"==typeof o&&"value"in o}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:o,children:n}=e;return(0,s.useMemo)((()=>{const e=o??function(e){return u(e).map((e=>{let{props:{value:o,label:n,attributes:s,default:r}}=e;return{value:o,label:n,attributes:s,default:r}}))}(n);return function(e){const o=(0,c.XI)(e,((e,o)=>e.value===o.value));if(o.length>0)throw new Error(`Docusaurus error: Duplicate values "${o.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[o,n])}function h(e){let{value:o,tabValues:n}=e;return n.some((e=>e.value===o))}function m(e){let{queryString:o=!1,groupId:n}=e;const r=(0,i.W6)(),a=function(e){let{queryString:o=!1,groupId:n}=e;if("string"==typeof o)return o;if(!1===o)return null;if(!0===o&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:o,groupId:n});return[(0,l.aZ)(a),(0,s.useCallback)((e=>{if(!a)return;const o=new URLSearchParams(r.location.search);o.set(a,e),r.replace({...r.location,search:o.toString()})}),[a,r])]}function g(e){const{defaultValue:o,queryString:n=!1,groupId:r}=e,a=p(e),[i,l]=(0,s.useState)((()=>function(e){let{defaultValue:o,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(o){if(!h({value:o,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${o}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return o}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:o,tabValues:a}))),[c,u]=m({queryString:n,groupId:r}),[g,j]=function(e){let{groupId:o}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(o),[r,a]=(0,d.Dv)(n);return[r,(0,s.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:r}),x=(()=>{const e=c??g;return h({value:e,tabValues:a})?e:null})();(0,t.A)((()=>{x&&l(x)}),[x]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!h({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),j(e)}),[u,j,a]),tabValues:a}}var j=n(21929);const x={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var b=n(25105);function f(e){let{className:o,block:n,selectedValue:s,selectValue:i,tabValues:t}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),d=e=>{const o=e.currentTarget,n=l.indexOf(o),r=t[n].value;r!==s&&(c(o),i(r))},u=e=>{let o=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;o=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;o=l[n]??l[l.length-1];break}}o?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},o),children:t.map((e=>{let{value:o,label:n,attributes:a}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:s===o?0:-1,"aria-selected":s===o,ref:e=>{l.push(e)},onKeyDown:u,onClick:d,...a,className:(0,r.A)("tabs__item",x.tabItem,a?.className,{"tabs__item--active":s===o}),children:n??o},o)}))})}function v(e){let{lazy:o,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(o){const e=i.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,o)=>(0,s.cloneElement)(e,{key:o,hidden:e.props.value!==a})))})}function A(e){const o=g(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",x.tabList),children:[(0,b.jsx)(f,{...o,...e}),(0,b.jsx)(v,{...o,...e})]})}function k(e){const o=(0,j.A)();return(0,b.jsx)(A,{...e,children:u(e.children)},String(o))}},55138:(e,o,n)=>{n.d(o,{A:()=>g});var s=n(28259),r=n(6097),a=n(58574),i=n(9484),t=n(76566),l=n(26346),c=n(17867),d=n(17510),u=n(13526),p=n(72355);const h={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var m=n(25105);function g(e){let{children:o,className:n="",metastring:g,title:j,showLineNumbers:x,language:b}=e;const{prism:{defaultLanguage:f,magicComments:v}}=(0,s.p)(),A=function(e){return e?.toLowerCase()}(b??(0,a.Op)(n)??f),k=(0,r.A)(),y=(0,i.f)(),P=(0,a.wt)(g)||j,{lineClassNames:I,code:z}=(0,a.Li)(o,{metastring:g,language:A,magicComments:v}),w=x??(0,a._u)(g);return(0,m.jsxs)(t.A,{as:"div",className:(0,u.A)(n,A&&!n.includes(`language-${A}`)&&`language-${A}`),children:[P&&(0,m.jsx)("div",{className:h.codeBlockTitle,children:P}),(0,m.jsxs)("div",{className:h.codeBlockContent,children:[(0,m.jsx)(p.f4,{theme:k,code:z,language:A??"text",children:e=>{let{className:o,tokens:n,getLineProps:s,getTokenProps:r}=e;return(0,m.jsx)("pre",{ref:y.codeBlockRef,tabIndex:0,className:(0,u.A)(o,h.codeBlock,"thin-scrollbar"),children:(0,m.jsx)("code",{className:(0,u.A)(h.codeBlockLines,w&&h.codeBlockLinesWithNumbering),children:n.map(((e,o)=>(0,m.jsx)(c.A,{line:e,getLineProps:s,getTokenProps:r,classNames:I[o],showLineNumbers:w},o)))})})}}),(0,m.jsxs)("div",{className:h.buttonGroup,children:[(y.isEnabled||y.isCodeScrollable)&&(0,m.jsx)(d.A,{className:h.codeButton,isEnabled:y.isEnabled,onClick:()=>{y.toggle()}}),(0,m.jsx)(l.A,{className:h.codeButton,code:z})]})]})]})}},46643:(e,o,n)=>{n.d(o,{A:()=>s});const s=n.p+"assets/images/rbac-global-api-resources-33fafc263308d3f769c62cbcdb8d7829.png"}}]);