"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[8772],{78989:(e,n,r)=>{r.d(n,{Ay:()=>k,RM:()=>I});var i=r(25105),a=r(79621),o=r(42962),s=r(48911),t=r(91678),c=r(20760);const l=r.p+"assets/images/guide-focus-8b3e94dddfb8a3c19b5bdd8a343fc29f.png";var d=r(33435);function u(e){const n={a:"a",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"before-you-start",children:"Antes de comenzar"}),"\n",(0,i.jsxs)(n.p,{children:["Tus aplicaciones cliente necesitan obtener tokens de acceso (Access tokens) de Logto. Si a\xfan no has configurado la integraci\xf3n del cliente, consulta nuestras ",(0,i.jsx)(n.a,{href:"/quick-starts",children:"Gu\xedas r\xe1pidas"})," para React, Vue, Angular u otros frameworks de cliente, o revisa nuestra ",(0,i.jsx)(n.a,{href:"/quick-starts/m2m",children:"Gu\xeda de m\xe1quina a m\xe1quina"})," para el acceso de servidor a servidor."]}),"\n",(0,i.jsxs)(n.p,{children:["Esta gu\xeda se centra en la ",(0,i.jsx)(n.strong,{children:"validaci\xf3n del lado del servidor"})," de esos tokens en tu aplicaci\xf3n ",(0,d.My)(e.framework),"."]}),"\n",(0,i.jsx)("img",{src:l,alt:"Una figura que muestra el enfoque de esta gu\xeda",style:{width:"100%",maxWidth:"480px",margin:"20px auto"}}),"\n",(0,i.jsx)(n.h3,{id:"what-you-will-learn",children:"Lo que aprender\xe1s"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validaci\xf3n de JWT:"})," Aprende a validar tokens de acceso (Access tokens) y extraer informaci\xf3n de autenticaci\xf3n (Authentication)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implementaci\xf3n de middleware:"})," Crea middleware reutilizable para la protecci\xf3n de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Modelos de permisos:"})," Comprende e implementa diferentes patrones de autorizaci\xf3n (Authorization):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Recursos de API globales para endpoints a nivel de aplicaci\xf3n"}),"\n",(0,i.jsx)(n.li,{children:"Permisos de organizaci\xf3n para el control de funciones espec\xedficas de inquilinos"}),"\n",(0,i.jsx)(n.li,{children:"Recursos de API a nivel de organizaci\xf3n para el acceso a datos multi-inquilino"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integraci\xf3n de RBAC:"})," Aplica permisos y alcances (Scopes) basados en roles (Roles) en tus endpoints de API"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites",children:"Requisitos previos"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\xdaltima versi\xf3n estable de ",(0,d.Id)(e.framework)," instalada"]}),"\n",(0,i.jsxs)(n.li,{children:["Conocimientos b\xe1sicos de ",(0,d.My)(e.framework)," y desarrollo de API web"]}),"\n",(0,i.jsxs)(n.li,{children:["Una aplicaci\xf3n Logto configurada (consulta las ",(0,i.jsx)(n.a,{href:"/quick-starts",children:"Gu\xedas r\xe1pidas"})," si es necesario)"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}function g(e){const n={h2:"h2",p:"p",...(0,a.R)(),...e.components},{Url:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"further-reading",children:"Lecturas adicionales"}),"\n",(0,i.jsx)(r,{href:"/use-cases/authorization/rbac-in-practice",children:(0,i.jsx)(n.p,{children:"RBAC en la pr\xe1ctica: Implementando autorizaci\xf3n segura para tu aplicaci\xf3n"})}),"\n",(0,i.jsx)(r,{href:"/use-cases/multi-tenancy/build-multi-tenant-saas-application",children:(0,i.jsx)(n.p,{children:"Crea una aplicaci\xf3n SaaS multi-inquilino: Una gu\xeda completa desde el dise\xf1o hasta la\nimplementaci\xf3n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}var m=r(46643),x=r(1242),j=r(93855),v=r(38552),f=r(22002);function b(e){const n={a:"a",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"permission-models-overview",children:"Resumen de modelos de permisos"}),"\n",(0,i.jsxs)(n.p,{children:["Antes de implementar la protecci\xf3n, elige el modelo de permisos que se adapte a la arquitectura de tu aplicaci\xf3n. Esto se alinea con los tres principales ",(0,i.jsx)(n.a,{href:"/authorization#authorization-scenarios",children:"escenarios de autorizaci\xf3n"})," de Logto:"]}),"\n",(0,i.jsxs)(f.A,{groupId:"permission-models",children:[(0,i.jsxs)(v.A,{value:"global-api-resources",label:"Recursos de API globales",children:[(0,i.jsx)("img",{src:m.A,alt:"RBAC de recursos de API globales",style:{maxWidth:"100%"}}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Caso de uso:"})," Proteger recursos de API compartidos en toda tu aplicaci\xf3n (no espec\xedficos de una organizaci\xf3n)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tipo de token:"})," Token de acceso (Access token) con audiencia global"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ejemplos:"})," APIs p\xfablicas, servicios principales del producto, endpoints de administraci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ideal para:"})," Productos SaaS con APIs utilizadas por todos los clientes, microservicios sin aislamiento de inquilinos"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"M\xe1s informaci\xf3n:"})," ",(0,i.jsx)(n.a,{href:"/authorization/global-api-resources",children:"Proteger recursos de API globales"})]}),"\n"]})]}),(0,i.jsxs)(v.A,{value:"organization-permissions",label:"Permisos de organizaci\xf3n (no API)",children:[(0,i.jsx)("img",{src:j.A,alt:"RBAC de permisos de organizaci\xf3n",style:{maxWidth:"800px",width:"100%"}}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Caso de uso:"})," Controlar acciones espec\xedficas de la organizaci\xf3n, caracter\xedsticas de la interfaz de usuario o l\xf3gica de negocio (no APIs)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tipo de token:"})," Token de organizaci\xf3n (Organization token) con audiencia espec\xedfica de la organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ejemplos:"})," Control de caracter\xedsticas, permisos de panel de control, controles de invitaci\xf3n de miembros"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ideal para:"})," SaaS multi-inquilino con caracter\xedsticas y flujos de trabajo espec\xedficos de la organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"M\xe1s informaci\xf3n:"})," ",(0,i.jsx)(n.a,{href:"/authorization/organization-permissions",children:"Proteger permisos de organizaci\xf3n (no API)"})]}),"\n"]})]}),(0,i.jsxs)(v.A,{value:"organization-level-api-resources",label:"Recursos de API a nivel de organizaci\xf3n",children:[(0,i.jsx)("img",{src:x.A,alt:"RBAC de recursos de API a nivel de organizaci\xf3n",style:{width:"100%"}}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Caso de uso:"})," Proteger recursos de API accesibles dentro de un contexto de organizaci\xf3n espec\xedfico"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tipo de token:"})," Token de organizaci\xf3n (Organization token) con audiencia de recurso de API + contexto de organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ejemplos:"})," APIs multi-inquilino, endpoints de datos con alcance organizacional, microservicios espec\xedficos de inquilino"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ideal para:"})," SaaS multi-inquilino donde los datos de la API tienen alcance organizacional"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"M\xe1s informaci\xf3n:"})," ",(0,i.jsx)(n.a,{href:"/authorization/organization-level-api-resources",children:"Proteger recursos de API a nivel de organizaci\xf3n"})]}),"\n"]})]})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\ud83d\udca1 Elige tu modelo antes de continuar"}),": la implementaci\xf3n har\xe1 referencia a tu enfoque elegido a lo largo de esta gu\xeda."]})]})}function A(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(b,{...e})}):b(e)}function y(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"quick-preparation-steps",children:"Pasos r\xe1pidos de preparaci\xf3n"}),"\n",(0,i.jsx)(n.h3,{id:"configure-logto-resources-permissions",children:"Configura recursos y permisos de Logto"}),"\n",(0,i.jsxs)(f.A,{groupId:"permission-models",children:[(0,i.jsx)(v.A,{value:"global-api-resources",label:"Recursos de API globales",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Crea un recurso de API:"})," Ve a ",(0,i.jsx)(n.a,{href:"https://cloud.logto.io/api-resources",children:"Consola \u2192 Recursos de API"})," y registra tu API (por ejemplo, ",(0,i.jsx)(n.code,{children:"https://api.yourapp.com"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Define permisos:"})," A\xf1ade alcances como ",(0,i.jsx)(n.code,{children:"read:products"}),", ",(0,i.jsx)(n.code,{children:"write:orders"})," \u2013 consulta ",(0,i.jsx)(n.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"Definir recursos de API con permisos"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Crea roles globales:"})," Ve a ",(0,i.jsx)(n.a,{href:"https://cloud.logto.io/roles",children:"Consola \u2192 Roles"})," y crea roles que incluyan los permisos de tu API \u2013 consulta ",(0,i.jsx)(n.a,{href:"/authorization/role-based-access-control#configure-global-roles",children:"Configurar roles globales"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asigna roles:"})," Asigna roles a usuarios o aplicaciones M2M que necesiten acceso a la API"]}),"\n"]})}),(0,i.jsx)(v.A,{value:"organization-permissions",label:"Permisos de organizaci\xf3n (no API)",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Define permisos de organizaci\xf3n:"})," Crea permisos de organizaci\xf3n que no sean de API como ",(0,i.jsx)(n.code,{children:"invite:member"}),", ",(0,i.jsx)(n.code,{children:"manage:billing"})," en la plantilla de organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configura roles de organizaci\xf3n:"})," Configura la plantilla de organizaci\xf3n con roles espec\xedficos de la organizaci\xf3n y as\xedgnales permisos"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asigna roles de organizaci\xf3n:"})," Asigna usuarios a roles de organizaci\xf3n dentro de cada contexto de organizaci\xf3n"]}),"\n"]})}),(0,i.jsx)(v.A,{value:"organization-level-api-resources",label:"Recursos de API a nivel de organizaci\xf3n",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Crea un recurso de API:"})," Registra tu recurso de API como antes, pero se usar\xe1 en el contexto de organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Define permisos:"})," A\xf1ade alcances como ",(0,i.jsx)(n.code,{children:"read:data"}),", ",(0,i.jsx)(n.code,{children:"write:settings"})," que est\xe9n limitados al contexto de organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configura la plantilla de organizaci\xf3n:"})," Configura roles de organizaci\xf3n que incluyan los permisos de tu recurso de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asigna roles de organizaci\xf3n:"})," Asigna usuarios o aplicaciones M2M a roles de organizaci\xf3n que incluyan permisos de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configuraci\xf3n multi-tenant:"})," Aseg\xfarate de que tu API pueda manejar datos y validaciones con alcance de organizaci\xf3n"]}),"\n"]})})]}),"\n",(0,i.jsx)(n.admonition,{title:"\xbfNuevo en RBAC?",type:"tip",children:(0,i.jsxs)(n.p,{children:["Comienza con nuestra ",(0,i.jsx)(n.a,{href:"/authorization/role-based-access-control",children:"Gu\xeda de control de acceso basado en roles (RBAC)"})," para instrucciones paso a paso."]})}),"\n",(0,i.jsx)(n.h3,{id:"update-your-client-application",children:"Actualiza tu aplicaci\xf3n cliente"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Solicita los alcances apropiados en tu cliente:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Autenticaci\xf3n de usuario: ",(0,i.jsx)(n.a,{href:"/quick-starts",children:"Actualiza tu app \u2192"})," para solicitar los alcances de tu API y/o el contexto de organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:["M\xe1quina a m\xe1quina: ",(0,i.jsx)(n.a,{href:"/quick-starts/m2m",children:"Configura alcances M2M \u2192"})," para acceso de servidor a servidor"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"El proceso normalmente implica actualizar la configuraci\xf3n de tu cliente para incluir uno o m\xe1s de los siguientes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Par\xe1metro ",(0,i.jsx)(n.code,{children:"scope"})," en los flujos OAuth"]}),"\n",(0,i.jsxs)(n.li,{children:["Par\xe1metro ",(0,i.jsx)(n.code,{children:"resource"})," para acceso a recursos de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"organization_id"})," para el contexto de organizaci\xf3n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Antes de programar",type:"tip",children:(0,i.jsx)(n.p,{children:"Aseg\xfarate de que el usuario o la aplicaci\xf3n M2M que est\xe1s probando tenga asignados los roles o roles de organizaci\xf3n adecuados que incluyan los permisos necesarios para tu API."})})]})}function w(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(y,{...e})}):y(e)}const I=[{value:"Antes de comenzar",id:"before-you-start",level:2},{value:"Lo que aprender\xe1s",id:"what-you-will-learn",level:3},{value:"Requisitos previos",id:"prerequisites",level:3},{value:"Resumen de modelos de permisos",id:"permission-models-overview",level:2},{value:"Pasos r\xe1pidos de preparaci\xf3n",id:"quick-preparation-steps",level:2},{value:"Configura recursos y permisos de Logto",id:"configure-logto-resources-permissions",level:3},{value:"Actualiza tu aplicaci\xf3n cliente",id:"update-your-client-application",level:3},{value:"Inicializa tu proyecto de API",id:"initialize-your-api-project",level:2},{value:"Inicializa constantes y utilidades",id:"initialize-constants-and-utilities",level:2},...o.RM,{value:"Recupera informaci\xf3n sobre tu tenant de Logto",id:"retrieve-info-about-your-logto-tenant",level:2},...s.RM,{value:"Valida el token y los permisos",id:"validate-the-token-and-permissions",level:2},...c.RM,{value:"A\xf1ade la l\xf3gica de validaci\xf3n",id:"add-the-validation-logic",level:3},{value:"Aplica el middleware a tu API",id:"apply-the-middleware-to-your-api",level:2},{value:"Prueba tu API protegida",id:"test-your-protected-api",level:2},...t.RM,{value:"Lecturas adicionales",id:"further-reading",level:2}];function z(e){const n={h2:"h2",h3:"h3",p:"p",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p,{framework:e.framework}),"\n",(0,i.jsx)(A,{}),"\n",(0,i.jsx)(w,{}),"\n",(0,i.jsx)(n.h2,{id:"initialize-your-api-project",children:"Inicializa tu proyecto de API"}),"\n","\n",e.initializeProject,"\n",(0,i.jsx)(n.h2,{id:"initialize-constants-and-utilities",children:"Inicializa constantes y utilidades"}),"\n",(0,i.jsx)(o.Ay,{}),"\n","\n",e.languageInit,"\n",(0,i.jsx)(n.h2,{id:"retrieve-info-about-your-logto-tenant",children:"Recupera informaci\xf3n sobre tu tenant de Logto"}),"\n",(0,i.jsx)(s.Ay,{}),"\n",(0,i.jsx)(n.h2,{id:"validate-the-token-and-permissions",children:"Valida el token y los permisos"}),"\n",(0,i.jsx)(c.Ay,{}),"\n",(0,i.jsx)(n.h3,{id:"add-the-validation-logic",children:"A\xf1ade la l\xf3gica de validaci\xf3n"}),"\n","\n",e.addValidationLogic,"\n",(0,i.jsx)(n.h2,{id:"apply-the-middleware-to-your-api",children:"Aplica el middleware a tu API"}),"\n",(0,i.jsx)(n.p,{children:"Ahora, aplica el middleware a tus rutas de API protegidas."}),"\n","\n",e.applyMiddleware,"\n",(0,i.jsx)(n.h2,{id:"test-your-protected-api",children:"Prueba tu API protegida"}),"\n",(0,i.jsx)(t.Ay,{}),"\n",(0,i.jsx)(h,{})]})}function k(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(z,{...e})}):z(e)}},49796:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>g,default:()=>j,frontMatter:()=>p,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"api-protection/java/vertx-web/README","title":"Protege tu API de Vert.x Web con control de acceso basado en roles (RBAC) y validaci\xf3n de JWT","description":"Esta gu\xeda te ayudar\xe1 a implementar autorizaci\xf3n para asegurar tus APIs de Vert.x Web utilizando el control de acceso basado en roles (RBAC) y JSON Web Tokens (JWTs) emitidos por Logto.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/api-protection/java/vertx-web/README.mdx","sourceDirName":"api-protection/java/vertx-web","slug":"/api-protection/java/vertx-web/","permalink":"/es/api-protection/java/vertx-web/","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/es/docusaurus-plugin-content-docs/current/api-protection/java/vertx-web/README.mdx","tags":[],"version":"current","frontMatter":{"sidebar_label":"Vert.x Web"},"sidebar":"apiProtectionSidebar","previous":{"title":"Spring Boot","permalink":"/es/api-protection/java/spring-boot/"},"next":{"title":"Protege tu API de Node.js con RBAC y validaci\xf3n de JWT","permalink":"/es/api-protection/nodejs/"}}');var a=r(25105),o=r(79621),s=r(29628),t=r(31962),c=r(31904),l=r(78989);function d(e){const n={admonition:"admonition",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Para inicializar un nuevo proyecto Vert.x Web, puedes crear un proyecto Maven manualmente:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml"',children:'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n         http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.example</groupId>\n    <artifactId>your-api-name</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <properties>\n        <maven.compiler.source>17</maven.compiler.source>\n        <maven.compiler.target>17</maven.compiler.target>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <vertx.version>4.5.0</vertx.version>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>io.vertx</groupId>\n            <artifactId>vertx-web</artifactId>\n            <version>${vertx.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>io.vertx</groupId>\n            <artifactId>vertx-auth-jwt</artifactId>\n            <version>${vertx.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>io.vertx</groupId>\n            <artifactId>vertx-web-client</artifactId>\n            <version>${vertx.version}</version>\n        </dependency>\n    </dependencies>\n</project>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Crea un servidor b\xe1sico Vert.x Web:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",metastring:'title="src/main/java/com/example/MainVerticle.java"',children:'package com.example;\n\nimport io.vertx.core.AbstractVerticle;\nimport io.vertx.core.Promise;\nimport io.vertx.ext.web.Router;\nimport io.vertx.ext.web.handler.BodyHandler;\n\npublic class MainVerticle extends AbstractVerticle {\n\n    @Override\n    public void start(Promise<Void> startPromise) throws Exception {\n        Router router = Router.router(vertx);\n\n        router.route().handler(BodyHandler.create());\n\n        router.get("/hello").handler(ctx -> {\n            ctx.response()\n                .putHeader("content-type", "text/plain")\n                .end("Hello from Vert.x Web!");\n        });\n\n        vertx.createHttpServer()\n            .requestHandler(router)\n            .listen(3000, http -> {\n                if (http.succeeded()) {\n                    startPromise.complete();\n                    System.out.println("HTTP server started on port 3000");\n                } else {\n                    startPromise.fail(http.cause());\n                }\n            });\n    }\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",metastring:'title="src/main/java/com/example/Application.java"',children:"package com.example;\n\nimport io.vertx.core.Vertx;\n\npublic class Application {\n    public static void main(String[] args) {\n        Vertx vertx = Vertx.vertx();\n        vertx.deployVerticle(new MainVerticle());\n    }\n}\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"Consulta la documentaci\xf3n de Vert.x Web para m\xe1s detalles sobre c\xf3mo configurar rutas, manejadores y otras caracter\xedsticas."})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}const p={sidebar_label:"Vert.x Web"},g="Protege tu API de Vert.x Web con control de acceso basado en roles (RBAC) y validaci\xf3n de JWT",h={},m=[...l.RM];function x(e){const n={a:"a",h1:"h1",header:"header",p:"p",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"protege-tu-api-de-vertx-web-con-control-de-acceso-basado-en-roles-rbac-y-validaci\xf3n-de-jwt",children:"Protege tu API de Vert.x Web con control de acceso basado en roles (RBAC) y validaci\xf3n de JWT"})}),"\n",(0,a.jsxs)(n.p,{children:["Esta gu\xeda te ayudar\xe1 a implementar autorizaci\xf3n para asegurar tus APIs de Vert.x Web utilizando el ",(0,a.jsx)(n.a,{href:"/authorization/role-based-access-control",children:"control de acceso basado en roles (RBAC)"})," y ",(0,a.jsx)(n.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"})," emitidos por Logto."]}),"\n","\n",(0,a.jsx)(l.Ay,{framework:"vertx-web",initializeProject:(0,a.jsx)(u,{}),languageInit:(0,a.jsx)(t.Ay,{}),applyMiddleware:(0,a.jsx)(c.Ay,{}),addValidationLogic:(0,a.jsx)(s.Ay,{framework:"vertx-web"})})]})}function j(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(x,{...e})}):x(e)}},42962:(e,n,r)=>{r.d(n,{Ay:()=>t,RM:()=>o});var i=r(25105),a=r(79621);const o=[];function s(e){const n={code:"code",p:"p",...(0,a.R)(),...e.components};return(0,i.jsxs)(n.p,{children:["Define las constantes y utilidades necesarias en tu c\xf3digo para manejar la extracci\xf3n y validaci\xf3n de tokens. Una solicitud v\xe1lida debe incluir un encabezado ",(0,i.jsx)(n.code,{children:"Authorization"})," en la forma ",(0,i.jsx)(n.code,{children:"Bearer <token de acceso (access token)>"}),"."]})}function t(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},48911:(e,n,r)=>{r.d(n,{Ay:()=>t,RM:()=>o});var i=r(25105),a=r(79621);const o=[{value:"Obtener desde el endpoint de descubrimiento de OpenID Connect",id:"fetch-from-openid-connect-discovery-endpoint",level:3},{value:"Codificar directamente en tu c\xf3digo (no recomendado)",id:"hardcode-in-your-code-not-recommended",level:3}];function s(e){const n={code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Necesitar\xe1s los siguientes valores para validar los tokens emitidos por Logto:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"URI de JSON Web Key Set (JWKS): La URL a las claves p\xfablicas de Logto, utilizada para verificar las firmas de JWT."}),"\n",(0,i.jsx)(n.li,{children:"Emisor (Issuer): El valor esperado del emisor (la URL OIDC de Logto)."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Primero, encuentra el endpoint de tu tenant de Logto. Puedes encontrarlo en varios lugares:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["En la Consola de Logto, en ",(0,i.jsx)(n.strong,{children:"Configuraci\xf3n"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Dominios"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["En cualquier configuraci\xf3n de aplicaci\xf3n que hayas configurado en Logto, ",(0,i.jsx)(n.strong,{children:"Configuraci\xf3n"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Endpoints y Credenciales"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"fetch-from-openid-connect-discovery-endpoint",children:"Obtener desde el endpoint de descubrimiento de OpenID Connect"}),"\n",(0,i.jsx)(n.p,{children:"Estos valores pueden obtenerse desde el endpoint de descubrimiento de OpenID Connect de Logto:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc/.well-known/openid-configuration\n"})}),"\n",(0,i.jsx)(n.p,{children:"Aqu\xed tienes un ejemplo de respuesta (otros campos omitidos por brevedad):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jwks_uri": "https://your-tenant.logto.app/oidc/jwks",\n  "issuer": "https://your-tenant.logto.app/oidc"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"hardcode-in-your-code-not-recommended",children:"Codificar directamente en tu c\xf3digo (no recomendado)"}),"\n",(0,i.jsx)(n.p,{children:"Dado que Logto no permite personalizar la URI de JWKS ni el emisor, puedes codificar estos valores directamente en tu c\xf3digo. Sin embargo, esto no se recomienda para aplicaciones en producci\xf3n, ya que puede aumentar la carga de mantenimiento si alguna configuraci\xf3n cambia en el futuro."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["URI de JWKS: ",(0,i.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc/jwks"})]}),"\n",(0,i.jsxs)(n.li,{children:["Emisor: ",(0,i.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc"})]}),"\n"]})]})}function t(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},91678:(e,n,r)=>{r.d(n,{Ay:()=>l,RM:()=>t});var i=r(25105),a=r(79621),o=r(38552),s=r(22002);const t=[{value:"Obtener tokens de acceso (Access tokens)",id:"get-access-tokens",level:3},{value:"Probar endpoints protegidos",id:"test-protected-endpoints",level:3},{value:"Pruebas espec\xedficas del modelo de permisos",id:"permission-model-specific-testing",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h3,{id:"get-access-tokens",children:"Obtener tokens de acceso (Access tokens)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Desde tu aplicaci\xf3n cliente:"}),"\nSi has configurado una integraci\xf3n de cliente, tu aplicaci\xf3n puede obtener tokens autom\xe1ticamente. Extrae el token de acceso y \xfasalo en las solicitudes a la API."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Para pruebas con curl / Postman:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tokens de usuario:"})," Usa las herramientas de desarrollador de tu aplicaci\xf3n cliente para copiar el token de acceso desde localStorage o la pesta\xf1a de red."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tokens m\xe1quina a m\xe1quina:"})," Utiliza el flujo de credenciales de cliente. Aqu\xed tienes un ejemplo no normativo usando curl:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://your-tenant.logto.app/oidc/token \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "grant_type=client_credentials" \\\n  -d "client_id=your-m2m-client-id" \\\n  -d "client_secret=your-m2m-client-secret" \\\n  -d "resource=https://your-api-resource-indicator" \\\n  -d "scope=api:read api:write"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Puede que necesites ajustar los par\xe1metros ",(0,i.jsx)(n.code,{children:"resource"})," y ",(0,i.jsx)(n.code,{children:"scope"})," seg\xfan tu recurso de API y permisos; tambi\xe9n puede ser necesario un par\xe1metro ",(0,i.jsx)(n.code,{children:"organization_id"})," si tu API est\xe1 asociada a una organizaci\xf3n."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["\xbfNecesitas inspeccionar el contenido del token? Usa nuestro ",(0,i.jsx)(n.a,{href:"https://logto.io/jwt-decoder",children:"decodificador de JWT"})," para decodificar y verificar tus JWTs."]})}),"\n",(0,i.jsx)(n.h3,{id:"test-protected-endpoints",children:"Probar endpoints protegidos"}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.strong,{children:"Solicitud con token v\xe1lido"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..." \\\n  http://localhost:3000/api/protected\n'})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Respuesta esperada:"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "auth": {\n    "sub": "user123",\n    "clientId": "app456",\n    "organizationId": "org789",\n    "scopes": ["api:read", "api:write"],\n    "audience": ["https://your-api-resource-indicator"]\n  }\n}\n'})})]}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.strong,{children:"Token ausente"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:3000/api/protected\n"})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Respuesta esperada (401):"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Authorization header is missing"\n}\n'})})]}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.strong,{children:"Token inv\xe1lido"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer invalid-token" \\\n  http://localhost:3000/api/protected\n'})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Respuesta esperada (401):"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Invalid token"\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"permission-model-specific-testing",children:"Pruebas espec\xedficas del modelo de permisos"}),"\n",(0,i.jsxs)(s.A,{groupId:"permission-models",children:[(0,i.jsxs)(o.A,{value:"global-api-resources",label:"Recursos de API globales",children:[(0,i.jsx)(n.p,{children:"Escenarios de prueba para APIs protegidas con alcances globales:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alcances v\xe1lidos:"})," Prueba con tokens que incluyan los alcances de API requeridos (por ejemplo, ",(0,i.jsx)(n.code,{children:"api:read"}),", ",(0,i.jsx)(n.code,{children:"api:write"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alcances ausentes:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando el token no tenga los alcances requeridos"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Audiencia incorrecta:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando la audiencia no coincida con el recurso de API"]}),"\n"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Token sin los alcances requeridos - espera 403\ncurl -H "Authorization: Bearer token-without-required-scopes" \\\n  http://localhost:3000/api/protected\n'})})]}),(0,i.jsxs)(o.A,{value:"organization-permissions",label:"Permisos de organizaci\xf3n (no API)",children:[(0,i.jsx)(n.p,{children:"Escenarios de prueba para control de acceso espec\xedfico de organizaci\xf3n:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Token de organizaci\xf3n v\xe1lido:"})," Prueba con tokens que incluyan el contexto correcto de organizaci\xf3n (ID de organizaci\xf3n y alcances)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alcances ausentes:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando el usuario no tenga permisos para la acci\xf3n solicitada"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Organizaci\xf3n incorrecta:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando la audiencia no coincida con el contexto de la organizaci\xf3n (",(0,i.jsx)(n.code,{children:"urn:logto:organization:<organization_id>"}),")"]}),"\n"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Token para organizaci\xf3n incorrecta - espera 403\ncurl -H "Authorization: Bearer token-for-different-organization" \\\n  http://localhost:3000/api/protected\n'})})]}),(0,i.jsxs)(o.A,{value:"organization-level-api-resources",label:"Recursos de API a nivel de organizaci\xf3n",children:[(0,i.jsx)(n.p,{children:"Escenarios de prueba combinando validaci\xf3n de recursos de API con contexto de organizaci\xf3n:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Organizaci\xf3n v\xe1lida + alcances de API:"})," Prueba con tokens que tengan tanto el contexto de organizaci\xf3n como los alcances de API requeridos"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alcances de API ausentes:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando el token de organizaci\xf3n no tenga los permisos de API requeridos"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Organizaci\xf3n incorrecta:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," al acceder a la API con un token de otra organizaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Audiencia incorrecta:"})," Espera ",(0,i.jsx)(n.strong,{children:"403 Prohibido"})," cuando la audiencia no coincida con el recurso de API a nivel de organizaci\xf3n"]}),"\n"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Token de organizaci\xf3n sin alcances de API - espera 403\ncurl -H "Authorization: Bearer organization-token-without-api-scopes" \\\n  http://localhost:3000/api/protected\n'})})]})]})]})}function l(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},20760:(e,n,r)=>{r.d(n,{Ay:()=>l,RM:()=>t});var i=r(25105),a=r(79621),o=r(38552),s=r(22002);const t=[{value:"Qu\xe9 verificar para cada modelo de permisos",id:"what-to-check-for-each-permission-model",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Despu\xe9s de extraer el token y obtener la configuraci\xf3n OIDC, valida lo siguiente:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Firma:"})," El JWT debe ser v\xe1lido y estar firmado por Logto (a trav\xe9s de JWKS)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Emisor (Issuer):"})," Debe coincidir con el emisor de tu tenant de Logto."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Audiencia (Audience):"})," Debe coincidir con el indicador de recurso de la API registrado en Logto, o el contexto de la organizaci\xf3n si corresponde."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Expiraci\xf3n:"})," El token no debe estar expirado."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Permisos (Alcances / scopes):"})," El token debe incluir los alcances requeridos para tu API / acci\xf3n. Los alcances son cadenas separadas por espacios en el reclamo ",(0,i.jsx)(n.code,{children:"scope"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Contexto de organizaci\xf3n:"})," Si proteges recursos de API a nivel de organizaci\xf3n, valida el reclamo ",(0,i.jsx)(n.code,{children:"organization_id"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Consulta ",(0,i.jsx)(n.a,{href:"https://auth.wiki/jwt",children:"JSON Web Token"})," para aprender m\xe1s sobre la estructura y los reclamos de JWT."]}),"\n",(0,i.jsx)(n.h3,{id:"what-to-check-for-each-permission-model",children:"Qu\xe9 verificar para cada modelo de permisos"}),"\n",(0,i.jsxs)(s.A,{groupId:"permission-models",children:[(0,i.jsx)(o.A,{value:"global-api-resources",label:"Recursos de API globales",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de audiencia (",(0,i.jsx)(n.code,{children:"aud"}),"):"]})," Indicador de recurso de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de organizaci\xf3n (",(0,i.jsx)(n.code,{children:"organization_id"}),"):"]})," ",(0,i.jsx)(n.em,{children:"No presente"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Alcances (permisos) a verificar (",(0,i.jsx)(n.code,{children:"scope"}),"):"]})," Permisos de recurso de API"]}),"\n"]})}),(0,i.jsx)(o.A,{value:"organization-permissions",label:"Permisos de organizaci\xf3n (no API)",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de audiencia (",(0,i.jsx)(n.code,{children:"aud"}),"):"]})," ",(0,i.jsx)(n.code,{children:"urn:logto:organization:<id>"})," (el contexto de organizaci\xf3n est\xe1 en el reclamo ",(0,i.jsx)(n.code,{children:"aud"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de organizaci\xf3n (",(0,i.jsx)(n.code,{children:"organization_id"}),"):"]})," ",(0,i.jsx)(n.em,{children:"No presente"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Alcances (permisos) a verificar (",(0,i.jsx)(n.code,{children:"scope"}),"):"]})," Permisos de organizaci\xf3n"]}),"\n"]})}),(0,i.jsx)(o.A,{value:"organization-level-api-resources",label:"Recursos de API a nivel de organizaci\xf3n",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de audiencia (",(0,i.jsx)(n.code,{children:"aud"}),"):"]})," Indicador de recurso de API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Reclamo de organizaci\xf3n (",(0,i.jsx)(n.code,{children:"organization_id"}),"):"]})," ID de la organizaci\xf3n (debe coincidir con la solicitud)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Alcances (permisos) a verificar (",(0,i.jsx)(n.code,{children:"scope"}),"):"]})," Permisos de recurso de API"]}),"\n"]})})]}),"\n",(0,i.jsx)("small",{children:(0,i.jsxs)(n.p,{children:["Para los permisos de organizaci\xf3n que no son de API, el contexto de la organizaci\xf3n est\xe1\nrepresentado por el reclamo ",(0,i.jsx)(n.code,{children:"aud"})," (por ejemplo, ",(0,i.jsx)(n.code,{children:"urn:logto:organization:abc123"}),"). El reclamo\n",(0,i.jsx)(n.code,{children:"organization_id"})," solo est\xe1 presente para tokens de recursos de API a nivel de organizaci\xf3n."]})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Valida siempre tanto los permisos (alcances) como el contexto (audiencia, organizaci\xf3n) para APIs multi-tenant seguras."})})]})}function l(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},29628:(e,n,r)=>{r.d(n,{Ay:()=>m,RM:()=>g});var i=r(25105),a=r(79621),o=r(33435),s=r(38552),t=r(22002);function c(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Agrega a tu ",(0,i.jsx)(n.code,{children:"pom.xml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.micronaut.security</groupId>\n    <artifactId>micronaut-security-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.micronaut</groupId>\n    <artifactId>micronaut-http-server-netty</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="application.yml"',children:"micronaut:\n  security:\n    authentication: bearer\n    token:\n      jwt:\n        signatures:\n          jwks:\n            logto:\n              url: ${JWKS_URI:https://your-tenant.logto.app/oidc/jwks}\n        claims-validators:\n          issuer: ${JWT_ISSUER:https://your-tenant.logto.app/oidc}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="JwtClaimsValidator.java"',children:'import io.micronaut.security.token.Claims;\nimport io.micronaut.security.token.validator.TokenValidator;\nimport jakarta.inject.Singleton;\nimport org.reactivestreams.Publisher;\nimport reactor.core.publisher.Mono;\nimport java.util.Arrays;\nimport java.util.List;\n\n@Singleton\npublic class JwtClaimsValidator implements TokenValidator {\n\n    @Override\n    public Publisher<Boolean> validateToken(String token, Claims claims) {\n        try {\n            verifyPayload(claims);\n            return Mono.just(true);\n        } catch (AuthorizationException e) {\n            // Micronaut manejar\xe1 el c\xf3digo de estado apropiadamente\n            return Mono.just(false);\n        }\n    }\n\n    private void verifyPayload(Claims claims) {\n        // La validaci\xf3n del emisor (Issuer) se maneja autom\xe1ticamente por la configuraci\xf3n JWT de Micronaut\n        // Implementa aqu\xed tu l\xf3gica de verificaci\xf3n adicional basada en el modelo de permisos\n        // Utiliza los m\xe9todos auxiliares de abajo para la extracci\xf3n de reclamos (claims)\n\n        // Ejemplo: throw new AuthorizationException("Permisos insuficientes");\n    }\n\n    // M\xe9todos auxiliares para JWT en Micronaut\n    @SuppressWarnings("unchecked")\n    private List<String> extractAudiences(Claims claims) {\n        Object aud = claims.get("aud");\n        if (aud instanceof List) {\n            return (List<String>) aud;\n        } else if (aud instanceof String) {\n            return Arrays.asList((String) aud);\n        }\n        return List.of();\n    }\n\n    private String extractScopes(Claims claims) {\n        return (String) claims.get("scope");\n    }\n\n    private String extractOrganizationId(Claims claims) {\n        return (String) claims.get("organization_id");\n    }\n}\n'})})]})}function l(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Agrega a tu ",(0,i.jsx)(n.code,{children:"pom.xml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.quarkus</groupId>\n    <artifactId>quarkus-smallrye-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.quarkus</groupId>\n    <artifactId>quarkus-resteasy-reactive</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"# Configuraci\xf3n de JWT\nmp.jwt.verify.publickey.location=${JWKS_URI:https://your-tenant.logto.app/oidc/jwks}\nmp.jwt.verify.issuer=${JWT_ISSUER:https://your-tenant.logto.app/oidc}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="JwtVerificationFilter.java"',children:'import org.eclipse.microprofile.jwt.JsonWebToken;\nimport jakarta.enterprise.context.ApplicationScoped;\nimport jakarta.inject.Inject;\nimport jakarta.ws.rs.container.ContainerRequestContext;\nimport jakarta.ws.rs.container.ContainerRequestFilter;\nimport jakarta.ws.rs.core.Response;\nimport jakarta.ws.rs.ext.Provider;\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Provider\n@ApplicationScoped\npublic class JwtVerificationFilter implements ContainerRequestFilter {\n\n    @Inject\n    JsonWebToken jwt;\n\n    @Override\n    public void filter(ContainerRequestContext requestContext) {\n        if (requestContext.getUriInfo().getPath().startsWith("/api/protected")) {\n            try {\n                verifyPayload(jwt);\n                requestContext.setProperty("auth", jwt);\n            } catch (AuthorizationException e) {\n                requestContext.abortWith(\n                    Response.status(e.getStatusCode())\n                        .entity("{\\"error\\": \\"" + e.getMessage() + "\\"}")\n                        .build()\n                );\n            } catch (Exception e) {\n                requestContext.abortWith(\n                    Response.status(401)\n                        .entity("{\\"error\\": \\"Token inv\xe1lido\\"}")\n                        .build()\n                );\n            }\n        }\n    }\n\n    private void verifyPayload(JsonWebToken jwt) {\n        // La validaci\xf3n del emisor (Issuer) se maneja autom\xe1ticamente por la extensi\xf3n JWT de Quarkus\n        // Implementa aqu\xed tu l\xf3gica de verificaci\xf3n adicional basada en el modelo de permisos\n        // Utiliza los m\xe9todos auxiliares de abajo para la extracci\xf3n de reclamos (claims)\n    }\n\n    // M\xe9todos auxiliares para Quarkus JWT\n    private List<String> extractAudiences(JsonWebToken jwt) {\n        return new ArrayList<>(jwt.getAudience());\n    }\n\n    private String extractScopes(JsonWebToken jwt) {\n        return jwt.getClaim("scope");\n    }\n\n    private String extractOrganizationId(JsonWebToken jwt) {\n        return jwt.getClaim("organization_id");\n    }\n}\n'})})]})}function d(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Agrega a tu ",(0,i.jsx)(n.code,{children:"pom.xml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-security</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-oauth2-resource-server</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-oauth2-jose</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="JwtSecurityConfig.java"',children:'import org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\n@EnableWebSecurity\npublic class JwtSecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeHttpRequests(authz -> authz\n                .requestMatchers("/api/protected/**").authenticated()\n                .anyRequest().permitAll()\n            )\n            .oauth2ResourceServer(oauth2 -> oauth2\n                .jwt(jwt -> jwt.decoder(jwtDecoder()))\n            );\n        return http.build();\n    }\n\n    @Bean\n    public JwtDecoder jwtDecoder() {\n        // Recuerda establecer estas variables de entorno en tu despliegue\n        String jwksUri = System.getenv("JWKS_URI");\n        String issuer = System.getenv("JWT_ISSUER");\n\n        return NimbusJwtDecoder.withJwkSetUri(jwksUri)\n            .issuer(issuer)\n            .build();\n    }\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="JwtValidator.java"',children:'import org.springframework.security.oauth2.jwt.Jwt;\nimport org.springframework.stereotype.Component;\nimport java.util.List;\n\n@Component\npublic class JwtValidator {\n\n    public void verifyPayload(Jwt jwt) {\n        // La validaci\xf3n del emisor (Issuer) es manejada autom\xe1ticamente por el decodificador JWT de Spring Security\n        // Implementa aqu\xed tu l\xf3gica de verificaci\xf3n adicional basada en el modelo de permisos\n        // Usa los m\xe9todos auxiliares de abajo para la extracci\xf3n de reclamos (Claims)\n\n        // Ejemplo: throw new AuthorizationException("Permisos insuficientes");\n        // El c\xf3digo de estado ser\xe1 manejado por el manejo de excepciones de Spring Security\n    }\n\n    // M\xe9todos auxiliares para JWT en Spring Boot\n    private List<String> extractAudiences(Jwt jwt) {\n        return jwt.getAudience();\n    }\n\n    private String extractScopes(Jwt jwt) {\n        return jwt.getClaimAsString("scope");\n    }\n\n    private String extractOrganizationId(Jwt jwt) {\n        return jwt.getClaimAsString("organization_id");\n    }\n}\n'})})]})}function u(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Agrega a tu ",(0,i.jsx)(n.code,{children:"pom.xml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-web</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-auth-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-web-client</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="JwtAuthHandler.java"',children:'import io.vertx.core.Future;\nimport io.vertx.core.Handler;\nimport io.vertx.core.Vertx;\nimport io.vertx.core.json.JsonArray;\nimport io.vertx.core.json.JsonObject;\nimport io.vertx.ext.auth.jwt.JWTAuth;\nimport io.vertx.ext.auth.jwt.JWTAuthOptions;\nimport io.vertx.ext.web.RoutingContext;\nimport io.vertx.ext.web.client.WebClient;\nimport java.util.List;\nimport java.util.ArrayList;\n\npublic class JwtAuthHandler implements Handler<RoutingContext> {\n\n    private final JWTAuth jwtAuth;\n    private final WebClient webClient;\n    private final String expectedIssuer;\n    private final String jwksUri;\n\n    public JwtAuthHandler(Vertx vertx) {\n        this.webClient = WebClient.create(vertx);\n        this.jwtAuth = JWTAuth.create(vertx, new JWTAuthOptions());\n\n        // Recuerda establecer estas variables de entorno en tu despliegue\n        this.expectedIssuer = System.getenv("JWT_ISSUER");\n        this.jwksUri = System.getenv("JWKS_URI");\n\n        // Obtener JWKS y configurar la autenticaci\xf3n JWT\n        fetchJWKS().onSuccess(jwks -> {\n            // Configurar JWKS (simplificado - puede que necesites un parser JWKS adecuado)\n        });\n    }\n\n    @Override\n    public void handle(RoutingContext context) {\n        String authHeader = context.request().getHeader("Authorization");\n        if (authHeader == null || !authHeader.startsWith("Bearer ")) {\n            context.response()\n                .setStatusCode(401)\n                .putHeader("Content-Type", "application/json")\n                .end("{\\"error\\": \\"Authorization header missing or invalid\\"}");\n            return;\n        }\n\n        String token = authHeader.substring(7);\n        jwtAuth.authenticate(new JsonObject().put("jwt", token))\n            .onSuccess(user -> {\n                try {\n                    JsonObject principal = user.principal();\n                    verifyPayload(principal);\n                    context.put("auth", principal);\n                    context.next();\n                } catch (AuthorizationException e) {\n                    context.response()\n                        .setStatusCode(e.getStatusCode())  // Usa el c\xf3digo de estado de la excepci\xf3n\n                        .putHeader("Content-Type", "application/json")\n                        .end("{\\"error\\": \\"" + e.getMessage() + "\\"}");\n                } catch (Exception e) {\n                    context.response()\n                        .setStatusCode(401)\n                        .putHeader("Content-Type", "application/json")\n                        .end("{\\"error\\": \\"Invalid token\\"}");\n                }\n            })\n            .onFailure(err -> {\n                context.response()\n                    .setStatusCode(401)\n                    .putHeader("Content-Type", "application/json")\n                    .end("{\\"error\\": \\"Invalid token: " + err.getMessage() + "\\"}");\n            });\n    }\n\n    private Future<JsonObject> fetchJWKS() {\n        return webClient.getAbs(this.jwksUri)\n            .send()\n            .map(response -> response.bodyAsJsonObject());\n    }\n\n    private void verifyPayload(JsonObject principal) {\n        // Verifica el emisor manualmente para Vert.x\n        String issuer = principal.getString("iss");\n        if (issuer == null || !expectedIssuer.equals(issuer)) {\n            throw new AuthorizationException("Invalid issuer: " + issuer);\n        }\n\n        // Implementa aqu\xed tu l\xf3gica de verificaci\xf3n adicional basada en el modelo de permisos\n        // Usa los m\xe9todos auxiliares de abajo para la extracci\xf3n de reclamos\n    }\n\n    // M\xe9todos auxiliares para JWT en Vert.x\n    private List<String> extractAudiences(JsonObject principal) {\n        JsonArray audiences = principal.getJsonArray("aud");\n        if (audiences != null) {\n            List<String> result = new ArrayList<>();\n            for (Object aud : audiences) {\n                result.add(aud.toString());\n            }\n            return result;\n        }\n        return List.of();\n    }\n\n    private String extractScopes(JsonObject principal) {\n        return principal.getString("scope");\n    }\n\n    private String extractOrganizationId(JsonObject principal) {\n        return principal.getString("organization_id");\n    }\n}\n'})})]})}const p=Object.freeze({"spring-boot":(0,i.jsx)((function(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}),{}),quarkus:(0,i.jsx)((function(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}),{}),micronaut:(0,i.jsx)((function(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}),{}),"vertx-web":(0,i.jsx)((function(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}),{})}),g=[];function h(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Usamos diferentes bibliotecas JWT dependiendo del framework. Instala las dependencias requeridas:"}),"\n",e.framework?p[e.framework]:(0,i.jsx)(t.A,{groupId:"api-framework",children:Object.entries(p).map((([e,n])=>(0,i.jsx)(s.A,{value:e,label:(0,o.My)(e),children:n},e)))}),"\n",(0,i.jsx)(n.p,{children:"De acuerdo con tu modelo de permisos, implementa la l\xf3gica de verificaci\xf3n adecuada:"}),"\n",(0,i.jsxs)(t.A,{groupId:"permission-models",children:[(0,i.jsx)(s.A,{value:"global-api-resources",label:"Recursos de API globales",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Verifica que el reclamo de audiencia coincida con tu indicador de recurso de API\nList<String> audiences = extractAudiences(token); // Extracci\xf3n espec\xedfica del framework\nif (!audiences.contains("https://your-api-resource-indicator")) {\n    throw new AuthorizationException("Audiencia no v\xe1lida");\n}\n\n// Verifica los alcances requeridos para recursos de API globales\nList<String> requiredScopes = Arrays.asList("api:read", "api:write"); // Reemplaza con tus alcances requeridos reales\nString scopes = extractScopes(token); // Extracci\xf3n espec\xedfica del framework\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Alcance insuficiente");\n}\n'})})}),(0,i.jsx)(s.A,{value:"organization-permissions",label:"Permisos de organizaci\xf3n (no API)",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Verifica que el reclamo de audiencia coincida con el formato de organizaci\xf3n\nList<String> audiences = extractAudiences(token); // Extracci\xf3n espec\xedfica del framework\nboolean hasOrgAudience = audiences.stream()\n    .anyMatch(aud -> aud.startsWith("urn:logto:organization:"));\n\nif (!hasOrgAudience) {\n    throw new AuthorizationException("Audiencia no v\xe1lida para permisos de organizaci\xf3n");\n}\n\n// Verifica que el ID de la organizaci\xf3n coincida con el contexto (puede que necesites extraerlo del contexto de la solicitud)\nString expectedOrgId = "your-organization-id"; // Extrae del contexto de la solicitud\nString expectedAud = "urn:logto:organization:" + expectedOrgId;\nif (!audiences.contains(expectedAud)) {\n    throw new AuthorizationException("ID de organizaci\xf3n no coincide");\n}\n\n// Verifica los alcances requeridos de la organizaci\xf3n\nList<String> requiredScopes = Arrays.asList("invite:users", "manage:settings"); // Reemplaza con tus alcances requeridos reales\nString scopes = extractScopes(token); // Extracci\xf3n espec\xedfica del framework\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Alcance de organizaci\xf3n insuficiente");\n}\n'})})}),(0,i.jsx)(s.A,{value:"organization-level-api-resources",label:"Recursos de API a nivel de organizaci\xf3n",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Verifica que el reclamo de audiencia coincida con tu indicador de recurso de API\nList<String> audiences = extractAudiences(token); // Extracci\xf3n espec\xedfica del framework\nif (!audiences.contains("https://your-api-resource-indicator")) {\n    throw new AuthorizationException("Audiencia no v\xe1lida para recursos de API a nivel de organizaci\xf3n");\n}\n\n// Verifica que el ID de la organizaci\xf3n coincida con el contexto (puede que necesites extraerlo del contexto de la solicitud)\nString expectedOrgId = "your-organization-id"; // Extrae del contexto de la solicitud\nString orgId = extractOrganizationId(token); // Extracci\xf3n espec\xedfica del framework\nif (!expectedOrgId.equals(orgId)) {\n    throw new AuthorizationException("ID de organizaci\xf3n no coincide");\n}\n\n// Verifica los alcances requeridos para recursos de API a nivel de organizaci\xf3n\nList<String> requiredScopes = Arrays.asList("api:read", "api:write"); // Reemplaza con tus alcances requeridos reales\nString scopes = extractScopes(token); // Extracci\xf3n espec\xedfica del framework\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Alcances de API a nivel de organizaci\xf3n insuficientes");\n}\n'})})})]}),"\n",(0,i.jsx)(n.p,{children:"Los m\xe9todos auxiliares para extraer reclamos son espec\xedficos del framework. Consulta los detalles de implementaci\xf3n en los archivos de validaci\xf3n espec\xedficos del framework mencionados arriba."})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},31962:(e,n,r)=>{r.d(n,{Ay:()=>t,RM:()=>o});var i=r(25105),a=r(79621);const o=[];function s(e){const n={code:"code",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="AuthorizationException.java"',children:"public class AuthorizationException extends RuntimeException {\n    private final int statusCode;\n\n    public AuthorizationException(String message) {\n        this(message, 403); // Por defecto 403 Prohibido\n    }\n\n    public AuthorizationException(String message, int statusCode) {\n        super(message);\n        this.statusCode = statusCode;\n    }\n\n    public int getStatusCode() {\n        return statusCode;\n    }\n}\n"})})}function t(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},31904:(e,n,r)=>{r.d(n,{Ay:()=>t,RM:()=>o});var i=r(25105),a=r(79621);const o=[];function s(e){const n={code:"code",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="MainVerticle.java"',children:'import io.vertx.core.AbstractVerticle;\nimport io.vertx.core.Promise;\nimport io.vertx.core.json.JsonObject;\nimport io.vertx.ext.web.Router;\nimport io.vertx.ext.web.RoutingContext;\n\npublic class MainVerticle extends AbstractVerticle {\n\n    @Override\n    public void start(Promise<Void> startPromise) throws Exception {\n        Router router = Router.router(vertx);\n\n        // Aplica middleware a las rutas protegidas\n        router.route("/api/protected*").handler(new JwtAuthHandler(vertx));\n        router.get("/api/protected").handler(this::protectedEndpoint);\n\n        vertx.createHttpServer()\n            .requestHandler(router)\n            .listen(8080, result -> {\n                if (result.succeeded()) {\n                    startPromise.complete();\n                } else {\n                    startPromise.fail(result.cause());\n                }\n            });\n    }\n\n    private void protectedEndpoint(RoutingContext context) {\n        // Accede al principal JWT directamente desde el contexto\n        JsonObject principal = context.get("auth");\n        if (principal == null) {\n            context.response()\n                .setStatusCode(500)\n                .putHeader("Content-Type", "application/json")\n                .end("{\\"error\\": \\"Principal JWT no encontrado\\"}");\n            return;\n        }\n\n        String scopes = principal.getString("scope");\n        JsonObject response = new JsonObject()\n            .put("sub", principal.getString("sub"))\n            .put("client_id", principal.getString("client_id"))\n            .put("organization_id", principal.getString("organization_id"))\n            .put("scopes", scopes != null ? scopes.split(" ") : new String[0])\n            .put("audience", principal.getJsonArray("aud"));\n\n        context.response()\n            .putHeader("Content-Type", "application/json")\n            .end(response.encode());\n    }\n}\n'})})}function t(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},38552:(e,n,r)=>{r.d(n,{A:()=>s});r(58101);var i=r(13526);const a={tabItem:"tabItem_dgSZ"};var o=r(25105);function s(e){let{children:n,hidden:r,className:s}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,i.A)(a.tabItem,s),hidden:r,children:n})}},22002:(e,n,r)=>{r.d(n,{A:()=>y});var i=r(58101),a=r(13526),o=r(60755),s=r(55234),t=r(6635),c=r(4100),l=r(35661),d=r(42752);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:r}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:r,attributes:i,default:a}}=e;return{value:n,label:r,attributes:i,default:a}}))}(r);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function g(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:r}=e;const a=(0,s.W6)(),o=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,c.aZ)(o),(0,i.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(a.location.search);n.set(o,e),a.replace({...a.location,search:n.toString()})}),[o,a])]}function m(e){const{defaultValue:n,queryString:r=!1,groupId:a}=e,o=p(e),[s,c]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=r.find((e=>e.default))??r[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:o}))),[l,u]=h({queryString:r,groupId:a}),[m,x]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,o]=(0,d.Dv)(r);return[a,(0,i.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:a}),j=(()=>{const e=l??m;return g({value:e,tabValues:o})?e:null})();(0,t.A)((()=>{j&&c(j)}),[j]);return{selectedValue:s,selectValue:(0,i.useCallback)((e=>{if(!g({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),x(e)}),[u,x,o]),tabValues:o}}var x=r(21929);const j={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var v=r(25105);function f(e){let{className:n,block:r,selectedValue:i,selectValue:s,tabValues:t}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const n=e.currentTarget,r=c.indexOf(n),a=t[r].value;a!==i&&(l(n),s(a))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;n=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;n=c[r]??c[c.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":r},n),children:t.map((e=>{let{value:n,label:r,attributes:o}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>{c.push(e)},onKeyDown:u,onClick:d,...o,className:(0,a.A)("tabs__item",j.tabItem,o?.className,{"tabs__item--active":i===n}),children:r??n},n)}))})}function b(e){let{lazy:n,children:r,selectedValue:o}=e;const s=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===o));return e?(0,i.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function A(e){const n=m(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",j.tabList),children:[(0,v.jsx)(f,{...n,...e}),(0,v.jsx)(b,{...n,...e})]})}function y(e){const n=(0,x.A)();return(0,v.jsx)(A,{...e,children:u(e.children)},String(n))}},33435:(e,n,r)=>{r.d(n,{Id:()=>s,My:()=>o});const i=Object.freeze({dotnet:{name:".NET"},go:{name:"Go"},java:{name:"Java"},nodejs:{name:"Node.js"},php:{name:"PHP"},python:{name:"Python"},ruby:{name:"Ruby"},rust:{name:"Rust"}}),a=Object.freeze({express:{name:"Express.js",language:"nodejs"},koa:{name:"Koa.js",language:"nodejs"},fastify:{name:"Fastify",language:"nodejs"},hapi:{name:"Hapi.js",language:"nodejs"},nestjs:{name:"NestJS",language:"nodejs"},gin:{name:"Gin",language:"go"},fiber:{name:"Fiber",language:"go"},echo:{name:"Echo",language:"go"},chi:{name:"Chi",language:"go"},"spring-boot":{name:"Spring Boot",language:"java"},quarkus:{name:"Quarkus",language:"java"},micronaut:{name:"Micronaut",language:"java"},"vertx-web":{name:"Vert.x Web",language:"java"},laravel:{name:"Laravel",language:"php"},symfony:{name:"Symfony",language:"php"},slim:{name:"Slim",language:"php"},rails:{name:"Ruby on Rails",language:"ruby"},sinatra:{name:"Sinatra",language:"ruby"},grape:{name:"Grape",language:"ruby"},fastapi:{name:"FastAPI",language:"python"},flask:{name:"Flask",language:"python"},django:{name:"Django",language:"python"},"django-rest":{name:"Django REST Framework",language:"python"},axum:{name:"Axum",language:"rust"},"actix-web":{name:"Actix Web",language:"rust"},rocket:{name:"Rocket",language:"rust"},"aspnet-core":{name:"ASP.NET Core",language:"dotnet"}}),o=e=>a[e].name,s=e=>i[a[e].language].name},46643:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/rbac-global-api-resources-33fafc263308d3f769c62cbcdb8d7829.png"},1242:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/rbac-organization-level-api-resources-9533c281f3ee1cf52aefe821717e1fef.png"},93855:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/rbac-organization-permissions-3302be06221b4399f73ddceac8ca17e3.png"},79621:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>t});var i=r(58101);const a={},o=i.createContext(a);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);