"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[4089],{11071:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>d,contentTitle:()=>t,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"developers/custom-token-claims/README","title":"Reivindica\xe7\xf5es personalizadas de token","description":"O Logto oferece flexibilidade para adicionar reivindica\xe7\xf5es personalizadas dentro dos tokens de acesso (JWT / Token opaco). Com esse recurso, voc\xea pode incluir informa\xe7\xf5es adicionais para sua l\xf3gica de neg\xf3cio, todas transmitidas com seguran\xe7a nos tokens e recuper\xe1veis via introspec\xe7\xe3o no caso de tokens opacos.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","sourceDirName":"developers/custom-token-claims","slug":"/developers/custom-token-claims/","permalink":"/pt-BR/developers/custom-token-claims/","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Desenvolvedor","permalink":"/pt-BR/developers/"},"next":{"title":"Casos de uso comuns","permalink":"/pt-BR/developers/custom-token-claims/common-use-cases"}}');var i=s(25105),n=s(79621);const r={sidebar_position:2},t="Reivindica\xe7\xf5es personalizadas de token",d={},c=[{value:"Introdu\xe7\xe3o",id:"introduction",level:2},{value:"Como funcionam as reivindica\xe7\xf5es personalizadas de token?",id:"how-do-custom-token-claims-work",level:2},{value:"Recursos relacionados",id:"related-resources",level:2}];function l(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components},{Url:s}=o;return s||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"reivindica\xe7\xf5es-personalizadas-de-token",children:"Reivindica\xe7\xf5es personalizadas de token"})}),"\n",(0,i.jsx)(o.p,{children:"O Logto oferece flexibilidade para adicionar reivindica\xe7\xf5es personalizadas dentro dos tokens de acesso (JWT / Token opaco). Com esse recurso, voc\xea pode incluir informa\xe7\xf5es adicionais para sua l\xf3gica de neg\xf3cio, todas transmitidas com seguran\xe7a nos tokens e recuper\xe1veis via introspec\xe7\xe3o no caso de tokens opacos."}),"\n",(0,i.jsx)(o.h2,{id:"introduction",children:"Introdu\xe7\xe3o"}),"\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.a,{href:"https://auth.wiki/access-token",children:"Tokens de acesso (Access tokens)"})," desempenham um papel fundamental no processo de autentica\xe7\xe3o (Authentication) e autoriza\xe7\xe3o (Authorization), carregando as informa\xe7\xf5es de identidade e permiss\xf5es do sujeito, e s\xe3o passados entre o ",(0,i.jsx)(o.a,{href:"/concepts/core-service",children:"servidor Logto"})," (atua como servidor de autentica\xe7\xe3o ou provedor de identidade, IdP), seu servidor de servi\xe7o web (provedor de recurso) e aplicativos clientes (clientes)."]}),"\n",(0,i.jsxs)(o.p,{children:[(0,i.jsx)(o.a,{href:"https://auth.wiki/claim",children:"Reivindica\xe7\xf5es de token (Token claims)"})," s\xe3o pares chave-valor que fornecem informa\xe7\xf5es sobre uma entidade ou sobre o pr\xf3prio token. As reivindica\xe7\xf5es podem incluir informa\xe7\xf5es do usu\xe1rio, tempo de expira\xe7\xe3o do token, permiss\xf5es e outros metadados relevantes para o processo de autentica\xe7\xe3o (Authentication) e autoriza\xe7\xe3o (Authorization)."]}),"\n",(0,i.jsx)(o.p,{children:"Existem dois tipos de tokens de acesso no Logto:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"JSON Web Token:"})," ",(0,i.jsx)(o.a,{href:"https://auth.wiki/jwt",children:"JSON Web Token (JWT)"})," \xe9 um formato popular que codifica reivindica\xe7\xf5es de forma segura e leg\xedvel pelos clientes. Reivindica\xe7\xf5es comuns como ",(0,i.jsx)(o.code,{children:"sub"}),", ",(0,i.jsx)(o.code,{children:"iss"}),", ",(0,i.jsx)(o.code,{children:"aud"})," etc. s\xe3o usadas em conformidade com o protocolo OAuth 2.0 (Veja ",(0,i.jsx)(o.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519#section-4",children:"este link"})," para mais detalhes). JWTs permitem que consumidores acessem diretamente as reivindica\xe7\xf5es sem etapas adicionais de valida\xe7\xe3o. No Logto, tokens de acesso s\xe3o emitidos no formato JWT por padr\xe3o quando um cliente inicia solicita\xe7\xf5es de autoriza\xe7\xe3o de recursos ou organiza\xe7\xf5es espec\xedficas."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Token opaco (Opaque token):"})," Um ",(0,i.jsx)(o.a,{href:"http://localhost:3000/concepts/opaque-token",children:"token opaco"})," n\xe3o \xe9 autocontido e sempre requer uma etapa adicional de valida\xe7\xe3o via endpoint de ",(0,i.jsx)(o.a,{href:"https://auth.wiki/token-introspection",children:"introspec\xe7\xe3o de token"}),". Apesar do formato n\xe3o transparente, tokens opacos podem ajudar a obter reivindica\xe7\xf5es e serem transmitidos com seguran\xe7a entre as partes. As reivindica\xe7\xf5es do token s\xe3o armazenadas com seguran\xe7a no servidor Logto e acessadas pelos aplicativos clientes via endpoint de introspec\xe7\xe3o de token. Tokens de acesso s\xe3o emitidos no formato opaco quando nenhum recurso ou organiza\xe7\xe3o espec\xedfica \xe9 inclu\xeddo na solicita\xe7\xe3o de autoriza\xe7\xe3o. Esses tokens s\xe3o usados principalmente para acessar o endpoint OIDC ",(0,i.jsx)(o.code,{children:"userinfo"})," e outros prop\xf3sitos gerais."]}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"Em muitos casos, as reivindica\xe7\xf5es padr\xe3o n\xe3o s\xe3o suficientes para atender \xe0s necessidades espec\xedficas dos seus aplicativos, seja voc\xea usando JWT ou tokens opacos. Para resolver isso, o Logto oferece flexibilidade para adicionar reivindica\xe7\xf5es personalizadas dentro dos tokens de acesso. Com esse recurso, voc\xea pode incluir informa\xe7\xf5es adicionais para sua l\xf3gica de neg\xf3cio, todas transmitidas com seguran\xe7a nos tokens e recuper\xe1veis via introspec\xe7\xe3o no caso de tokens opacos."}),"\n",(0,i.jsx)(o.h2,{id:"how-do-custom-token-claims-work",children:"Como funcionam as reivindica\xe7\xf5es personalizadas de token?"}),"\n",(0,i.jsxs)(o.p,{children:["O Logto permite inserir reivindica\xe7\xf5es personalizadas no ",(0,i.jsx)(o.code,{children:"token de acesso (access token)"})," atrav\xe9s de uma fun\xe7\xe3o de callback ",(0,i.jsx)(o.code,{children:"getCustomJwtClaims"}),". Voc\xea pode fornecer sua implementa\xe7\xe3o da fun\xe7\xe3o ",(0,i.jsx)(o.code,{children:"getCustomJwtClaims"})," para retornar um objeto de reivindica\xe7\xf5es personalizadas. O valor retornado ser\xe1 mesclado com o payload original do token e assinado para gerar o token de acesso final."]}),"\n",(0,i.jsx)(o.mermaid,{value:"sequenceDiagram\n  participant U as Usu\xe1rio ou agente do usu\xe1rio\n  participant IdP as Logto (provedor de identidade)\n  participant SP as Provedor de Servi\xe7o\n\n  autonumber\n  U ->> IdP: Solicita\xe7\xe3o de autentica\xe7\xe3o (com credenciais)\n  activate IdP\n  IdP--\x3e>IdP: Validar credenciais &<br/>gerar payload bruto do token de acesso\n  rect var(--mermaid-rect-fill)\n  note over IdP: Reivindica\xe7\xf5es personalizadas de token\n  IdP->>IdP: Executar script de reivindica\xe7\xf5es personalizadas (`getCustomJwtClaims`) &<br/>obter reivindica\xe7\xf5es extras do token\n  end\n  IdP--\x3e>IdP: Mesclar payload bruto do token de acesso e reivindica\xe7\xf5es extras\n  IdP--\x3e>IdP: Assinar & criptografar payload para obter o token de acesso\n  deactivate IdP\n  IdP--\x3e>U: Emitir token de acesso no formato JWT\n  par Obter servi\xe7o via API\n  U->>SP: solicita\xe7\xe3o de servi\xe7o (com token de acesso JWT)\n  SP--\x3e>U: resposta do servi\xe7o\n  end"}),"\n",(0,i.jsx)(o.admonition,{type:"warning",children:(0,i.jsx)(o.p,{children:"As reivindica\xe7\xf5es internas do Logto N\xc3O podem ser sobrescritas ou modificadas. As reivindica\xe7\xf5es personalizadas ser\xe3o adicionadas ao token como reivindica\xe7\xf5es adicionais. Se alguma reivindica\xe7\xe3o personalizada conflitar com as reivindica\xe7\xf5es internas, essas reivindica\xe7\xf5es personalizadas ser\xe3o ignoradas."})}),"\n",(0,i.jsx)(o.h2,{id:"related-resources",children:"Recursos relacionados"}),"\n",(0,i.jsx)(s,{href:"https://blog.logto.io/glance-on-custom-jwt-access-token-claims",children:(0,i.jsx)(o.p,{children:"Adicione reivindica\xe7\xf5es personalizadas para tokens de acesso JWT com Logto para potencializar sua\nautoriza\xe7\xe3o (Authorization)"})})]})}function p(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},79621:(e,o,s)=>{s.d(o,{R:()=>r,x:()=>t});var a=s(58101);const i={},n=a.createContext(i);function r(e){const o=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(n.Provider,{value:o},e.children)}}}]);