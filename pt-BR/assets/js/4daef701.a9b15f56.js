"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[7241],{60744:(e,o,a)=>{a.d(o,{Ay:()=>t,RM:()=>s});var n=a(25105),i=a(79621);const s=[];function r(e){const o={admonition:"admonition",code:"code",p:"p",...(0,i.R)(),...e.components};return(0,n.jsx)(o.admonition,{type:"note",children:(0,n.jsxs)(o.p,{children:["Inspecione a reivindica\xe7\xe3o ",(0,n.jsx)(o.code,{children:"organizations"})," no Token de ID (ID token) para obter uma lista de IDs das organiza\xe7\xf5es \xe0s quais o usu\xe1rio pertence. Essa reivindica\xe7\xe3o lista todas as organiza\xe7\xf5es das quais o usu\xe1rio \xe9 membro, facilitando a enumera\xe7\xe3o ou troca de organiza\xe7\xf5es em seu aplicativo."]})})}function t(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(r,{...e})}):r(e)}},94803:(e,o,a)=>{a.d(o,{Ay:()=>t,RM:()=>s});var n=a(25105),i=a(79621);const s=[];function r(e){const o={admonition:"admonition",p:"p",...(0,i.R)(),...e.components};return(0,n.jsx)(o.admonition,{type:"warning",children:(0,n.jsx)(o.p,{children:"No momento, o Logto n\xe3o suporta a obten\xe7\xe3o de tokens de organiza\xe7\xe3o (organization tokens) diretamente pelo fluxo de c\xf3digo de autoriza\xe7\xe3o. Voc\xea precisar\xe1 usar o fluxo de token de atualiza\xe7\xe3o (refresh token) para obter um token de organiza\xe7\xe3o (organization token)."})})}function t(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(r,{...e})}):r(e)}},11053:(e,o,a)=>{a.r(o),a.d(o,{assets:()=>x,contentTitle:()=>h,default:()=>f,frontMatter:()=>g,metadata:()=>n,toc:()=>j});const n=JSON.parse('{"id":"authorization/organization-permissions","title":"Proteger permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)","description":"Use o template de organiza\xe7\xe3o para gerenciar e aplicar pap\xe9is e permiss\xf5es em n\xedvel de organiza\xe7\xe3o no Logto, controlando o acesso a funcionalidades e fluxos dentro do contexto de uma organiza\xe7\xe3o.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/authorization/organization-permissions.mdx","sourceDirName":"authorization","slug":"/authorization/organization-permissions","permalink":"/pt-BR/authorization/organization-permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/authorization/organization-permissions.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Proteger recursos globais de API","permalink":"/pt-BR/authorization/global-api-resources"},"next":{"title":"Proteger recursos de API em n\xedvel de organiza\xe7\xe3o","permalink":"/pt-BR/authorization/organization-level-api-resources"}}');var i=a(25105),s=a(79621),r=a(93855),t=a(39088),d=a(78506),l=a(42372),c=a(38552),u=a(22002),p=a(60744),m=a(94803);const g={sidebar_position:4},h="Proteger permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)",x={},j=[{value:"O que s\xe3o permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)?",id:"what-are-organization-non-api-permissions",level:2},{value:"Como funciona no Logto",id:"how-it-works-in-logto",level:2},{value:"Vis\xe3o geral da implementa\xe7\xe3o",id:"implementation-overview",level:3},{value:"Fluxo de autoriza\xe7\xe3o: autenticando e protegendo permiss\xf5es de organiza\xe7\xe3o",id:"authorization-flow-authenticating-and-securing-organization-permissions",level:3},{value:"Passos de implementa\xe7\xe3o",id:"implementation-steps",level:2},{value:"Registrar permiss\xf5es de organiza\xe7\xe3o",id:"register-organization-permissions",level:3},{value:"Configurar pap\xe9is de organiza\xe7\xe3o",id:"set-up-organization-roles",level:3},{value:"Obter tokens de organiza\xe7\xe3o (n\xe3o-API)",id:"obtain-organization-tokens-non-api",level:3},{value:"Fluxo de token de atualiza\xe7\xe3o",id:"refresh-token-flow",level:4},...p.RM,...m.RM,...p.RM,{value:"Fluxo client credentials",id:"client-credentials-flow",level:4},{value:"Validar tokens de organiza\xe7\xe3o",id:"validate-organization-tokens",level:3},{value:"Boas pr\xe1ticas e dicas de seguran\xe7a",id:"best-practices-and-security-tips",level:2},{value:"Perguntas frequentes",id:"faqs",level:2},{value:"Posso misturar permiss\xf5es de organiza\xe7\xe3o e n\xe3o-organiza\xe7\xe3o em um \xfanico papel?",id:"can-i-mix-organization-and-non-organization-permissions-in-a-single-role",level:3},{value:"Onde devo aplicar permiss\xf5es n\xe3o-API?",id:"where-should-i-enforce-non-api-permissions",level:3},{value:"Leitura adicional",id:"further-reading",level:2}];function z(e){const o={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{CloudLink:a,Details:n,Url:g}=o;return a||v("CloudLink",!0),n||v("Details",!0),g||v("Url",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"proteger-permiss\xf5es-de-organiza\xe7\xe3o-n\xe3o-api",children:"Proteger permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)"})}),"\n",(0,i.jsx)(o.p,{children:"Use o template de organiza\xe7\xe3o para gerenciar e aplicar pap\xe9is e permiss\xf5es em n\xedvel de organiza\xe7\xe3o no Logto, controlando o acesso a funcionalidades e fluxos dentro do contexto de uma organiza\xe7\xe3o."}),"\n",(0,i.jsx)(o.h2,{id:"what-are-organization-non-api-permissions",children:"O que s\xe3o permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)?"}),"\n",(0,i.jsxs)(o.p,{children:["As permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API) controlam o que os usu\xe1rios podem fazer ",(0,i.jsx)(o.strong,{children:"dentro do contexto de uma organiza\xe7\xe3o"}),", mas n\xe3o s\xe3o ",(0,i.jsx)(o.strong,{children:"aplicadas no n\xedvel da API"}),". Em vez disso, elas governam o acesso a funcionalidades do aplicativo, elementos da interface, fluxos de trabalho ou a\xe7\xf5es de neg\xf3cio, e n\xe3o a APIs de backend."]}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.strong,{children:"Casos de uso incluem"})}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Convidar ou gerenciar membros dentro de uma organiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.li,{children:"Atribuir ou alterar pap\xe9is da organiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.li,{children:"Gerenciar cobran\xe7a, configura\xe7\xf5es ou fun\xe7\xf5es administrativas de uma organiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.li,{children:"Acesso a dashboards, an\xe1lises ou ferramentas internas que n\xe3o possuem endpoints de API"}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"O Logto permite proteger essas permiss\xf5es de organiza\xe7\xe3o usando OAuth 2.1 e RBAC, al\xe9m de suportar arquiteturas SaaS multi-tenant."}),"\n",(0,i.jsxs)(o.p,{children:["Essas permiss\xf5es s\xe3o gerenciadas atrav\xe9s de ",(0,i.jsx)(o.strong,{children:"pap\xe9is de organiza\xe7\xe3o"})," definidos no ",(0,i.jsx)(o.a,{href:"/authorization/organization-template",children:"template de organiza\xe7\xe3o"}),". Todas as organiza\xe7\xf5es usam o mesmo template, garantindo um modelo de permiss\xf5es consistente entre todas as organiza\xe7\xf5es."]}),"\n",(0,i.jsx)(o.h2,{id:"how-it-works-in-logto",children:"Como funciona no Logto"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"RBAC em n\xedvel de organiza\xe7\xe3o:"})," Pap\xe9is e permiss\xf5es s\xe3o definidos no template de organiza\xe7\xe3o. Quando um usu\xe1rio entra em uma organiza\xe7\xe3o, ele recebe um ou mais pap\xe9is, concedendo permiss\xf5es espec\xedficas."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Aplica\xe7\xe3o n\xe3o-API:"})," As permiss\xf5es s\xe3o verificadas e aplicadas na interface do seu app, fluxo de trabalho ou l\xf3gica de backend, n\xe3o necessariamente por um gateway de API."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Separa\xe7\xe3o da prote\xe7\xe3o de API:"})," As permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API) s\xe3o distintas das permiss\xf5es de recursos de API. Voc\xea pode combinar ambas para cen\xe1rios avan\xe7ados."]}),"\n"]}),"\n",(0,i.jsx)("center",{children:(0,i.jsx)("img",{src:r.A,alt:"Permiss\xf5es de organiza\xe7\xe3o RBAC",style:{maxWidth:"800px",width:"100%"}})}),"\n",(0,i.jsx)(o.h3,{id:"implementation-overview",children:"Vis\xe3o geral da implementa\xe7\xe3o"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Defina as permiss\xf5es de organiza\xe7\xe3o"})," no Logto, dentro do template de organiza\xe7\xe3o."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Crie pap\xe9is de organiza\xe7\xe3o"})," que agrupem as permiss\xf5es necess\xe1rias para a\xe7\xf5es espec\xedficas da organiza\xe7\xe3o."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Atribua pap\xe9is"})," a usu\xe1rios ou clientes dentro de cada organiza\xe7\xe3o."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Obtenha um token de organiza\xe7\xe3o (JWT)"})," para a organiza\xe7\xe3o atual usando o fluxo de token de atualiza\xe7\xe3o ou client credentials."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Valide os tokens de acesso"})," na interface ou backend do seu app para aplicar as permiss\xf5es de organiza\xe7\xe3o."]}),"\n"]}),"\n",(0,i.jsx)(o.h3,{id:"authorization-flow-authenticating-and-securing-organization-permissions",children:"Fluxo de autoriza\xe7\xe3o: autenticando e protegendo permiss\xf5es de organiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.p,{children:"O fluxo a seguir mostra como um cliente (web, mobile ou backend) obt\xe9m e utiliza tokens de organiza\xe7\xe3o para aplica\xe7\xe3o de permiss\xf5es n\xe3o-API."}),"\n",(0,i.jsx)(o.p,{children:"Observe que o fluxo n\xe3o inclui detalhes exaustivos sobre os par\xe2metros ou cabe\xe7alhos necess\xe1rios, mas foca nos passos principais. Continue lendo para ver como o fluxo funciona na pr\xe1tica."}),"\n",(0,i.jsx)(o.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Logto\n    participant App as App/UI/backend\n\n    alt Autentica\xe7\xe3o do usu\xe1rio\n        Client->>Logto: GET /oidc/auth\n        Logto->>Logto: Redireciona usu\xe1rio para p\xe1gina de login\n        Logto->>Client: Redireciona de volta com `authorization_code`\n        Client->>Logto: POST /oidc/token com `grant_type=authorization_code`\n        Logto->>Client: Retorna token de atualiza\xe7\xe3o\n        Client->>Logto: POST /oidc/token com `grant_type=refresh_token` + par\xe2metros de organiza\xe7\xe3o\n    else Autentica\xe7\xe3o de cliente M2M\n        Client->>Logto: POST /oidc/token com `grant_type=client_credentials` + par\xe2metros de organiza\xe7\xe3o\n    end\n\n    Logto->>Client: Retorna token de organiza\xe7\xe3o (JWT)\n    Client->>App: Requisi\xe7\xe3o com Bearer token\n    App->>App: Valida token de organiza\xe7\xe3o, verifica contexto e permiss\xf5es da organiza\xe7\xe3o\n\n    alt Token \xe9 v\xe1lido\n        App->>Client: Permite a\xe7\xf5es/dados espec\xedficos da organiza\xe7\xe3o\n    else Token \xe9 inv\xe1lido\n        App->>Client: 401 N\xe3o autorizado ou nega acesso \xe0 interface\n    end"}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.em,{children:"Autentica\xe7\xe3o do usu\xe1rio = navegador/app. M2M = servi\xe7o de backend ou script usando client credentials + contexto de organiza\xe7\xe3o."})}),"\n",(0,i.jsx)(o.h2,{id:"implementation-steps",children:"Passos de implementa\xe7\xe3o"}),"\n",(0,i.jsx)(o.h3,{id:"register-organization-permissions",children:"Registrar permiss\xf5es de organiza\xe7\xe3o"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:["Acesse ",(0,i.jsx)(a,{to:"/organization-template/organization-permissions",children:"Console \u2192 Template de organiza\xe7\xe3o \u2192 Permiss\xf5es de organiza\xe7\xe3o"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Defina as permiss\xf5es de organiza\xe7\xe3o necess\xe1rias (ex.: ",(0,i.jsx)(o.code,{children:"invite:member"}),", ",(0,i.jsx)(o.code,{children:"manage:billing"}),", ",(0,i.jsx)(o.code,{children:"view:analytics"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Para o passo a passo completo, veja ",(0,i.jsx)(o.a,{href:"/authorization/role-based-access-control#define-organization-permissions",children:"Definir permiss\xf5es de organiza\xe7\xe3o"}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"set-up-organization-roles",children:"Configurar pap\xe9is de organiza\xe7\xe3o"}),"\n",(0,i.jsxs)(o.ol,{children:["\n",(0,i.jsxs)(o.li,{children:["Acesse ",(0,i.jsx)(a,{to:"/organization-template/organization-roles",children:"Console \u2192 Template de organiza\xe7\xe3o \u2192 Pap\xe9is de organiza\xe7\xe3o"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Crie pap\xe9is que agrupem as permiss\xf5es de organiza\xe7\xe3o definidas anteriormente (ex.: ",(0,i.jsx)(o.code,{children:"admin"}),", ",(0,i.jsx)(o.code,{children:"member"}),", ",(0,i.jsx)(o.code,{children:"billing"}),")."]}),"\n",(0,i.jsx)(o.li,{children:"Atribua esses pap\xe9is a usu\xe1rios ou clientes dentro de cada organiza\xe7\xe3o."}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Para o passo a passo completo, veja ",(0,i.jsx)(o.a,{href:"/authorization/role-based-access-control#configure-organization-roles",children:"Usar pap\xe9is de organiza\xe7\xe3o"}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"obtain-organization-tokens-non-api",children:"Obter tokens de organiza\xe7\xe3o (n\xe3o-API)"}),"\n",(0,i.jsxs)(o.p,{children:["Seu cliente/app deve obter um token de organiza\xe7\xe3o (n\xe3o-API) para acessar permiss\xf5es de organiza\xe7\xe3o. O Logto emite tokens de organiza\xe7\xe3o como ",(0,i.jsx)(o.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"}),". Voc\xea pode obt\xea-los usando o ",(0,i.jsx)(o.a,{href:"https://auth.wiki/refresh-token",children:"fluxo de token de atualiza\xe7\xe3o"})," ou o ",(0,i.jsx)(o.a,{href:"https://auth.wiki/client-credentials-flow",children:"fluxo client credentials"}),"."]}),"\n",(0,i.jsx)(o.h4,{id:"refresh-token-flow",children:"Fluxo de token de atualiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.p,{children:"Quase todos os SDKs oficiais do Logto suportam a obten\xe7\xe3o de tokens de organiza\xe7\xe3o usando o fluxo de token de atualiza\xe7\xe3o nativamente. Uma biblioteca padr\xe3o de cliente OAuth 2.0 / OIDC tamb\xe9m pode ser usada para implementar esse fluxo."}),"\n",(0,i.jsxs)(u.A,{groupId:"user-client",children:[(0,i.jsxs)(c.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,i.jsxs)(o.p,{children:["Ao inicializar o Logto SDK, adicione ",(0,i.jsx)(o.code,{children:"urn:logto:scope:organizations"})," e as permiss\xf5es de organiza\xe7\xe3o desejadas (escopos) ao par\xe2metro ",(0,i.jsx)(o.code,{children:"scopes"}),"."]}),(0,i.jsxs)(o.p,{children:["Alguns SDKs do Logto possuem um escopo pr\xe9-definido para organiza\xe7\xf5es, como ",(0,i.jsx)(o.code,{children:"UserScope.Organizations"})," em SDKs JavaScript."]}),(0,i.jsx)(p.Ay,{}),(0,i.jsxs)(o.p,{children:["Use ",(0,i.jsx)(o.code,{children:"getOrganizationToken"})," ou um m\xe9todo similar (como ",(0,i.jsx)(o.code,{children:"getAccessToken"})," com um ID de organiza\xe7\xe3o) para solicitar um token de organiza\xe7\xe3o para uma organiza\xe7\xe3o espec\xedfica."]}),(0,i.jsxs)(o.p,{children:["Para detalhes de cada SDK, veja ",(0,i.jsx)(o.a,{href:"/quick-starts",children:"In\xedcios r\xe1pidos"}),"."]})]}),(0,i.jsxs)(c.A,{value:"oauth-client",label:"OAuth 2.0 / OIDC client library",children:[(0,i.jsx)(o.p,{children:"Ao configurar seu cliente OAuth 2.0 ou inicializar o fluxo de c\xf3digo de autoriza\xe7\xe3o, certifique-se de incluir os seguintes par\xe2metros:"}),(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"resource"}),": Defina como ",(0,i.jsx)(o.code,{children:"urn:logto:resource:organizations"})," para indicar que deseja um token de organiza\xe7\xe3o."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"scope"}),": Inclua o escopo pr\xe9-definido de organiza\xe7\xe3o (",(0,i.jsx)(o.code,{children:"urn:logto:scope:organizations"}),"), ",(0,i.jsx)(o.code,{children:"offline_access"})," (para obter tokens de atualiza\xe7\xe3o) e quaisquer permiss\xf5es de organiza\xe7\xe3o espec\xedficas necess\xe1rias (ex.: ",(0,i.jsx)(o.code,{children:"invite:member"}),", ",(0,i.jsx)(o.code,{children:"manage:billing"}),")."]}),"\n"]}),(0,i.jsxs)(o.p,{children:["Algumas bibliotecas podem n\xe3o suportar o par\xe2metro ",(0,i.jsx)(o.code,{children:"resource"})," nativamente, mas geralmente permitem passar par\xe2metros adicionais na requisi\xe7\xe3o de autoriza\xe7\xe3o. Verifique a documenta\xe7\xe3o da sua biblioteca para detalhes."]}),(0,i.jsx)(o.p,{children:"Veja um exemplo n\xe3o normativo de como a requisi\xe7\xe3o de autoriza\xe7\xe3o pode ser:"}),(0,i.jsx)(t.A,{scope:"urn:logto:scope:organizations invite:member manage:billing",resource:"urn:logto:resource:organizations"}),(0,i.jsxs)(o.p,{children:["Ap\xf3s a autentica\xe7\xe3o do usu\xe1rio, voc\xea receber\xe1 um c\xf3digo de autoriza\xe7\xe3o. Use esse c\xf3digo fazendo uma requisi\xe7\xe3o POST para o endpoint ",(0,i.jsx)(o.code,{children:"/oidc/token"})," do Logto."]}),(0,i.jsx)(o.p,{children:"Veja um exemplo n\xe3o normativo da requisi\xe7\xe3o de token:"}),(0,i.jsx)(l.A,{grantType:"authorization_code"}),(0,i.jsx)(m.Ay,{}),(0,i.jsx)(o.p,{children:"Voc\xea receber\xe1 um token de atualiza\xe7\xe3o que pode ser usado para obter tokens de organiza\xe7\xe3o."}),(0,i.jsx)(p.Ay,{}),(0,i.jsxs)(o.p,{children:["Por fim, use o token de atualiza\xe7\xe3o para obter um token de organiza\xe7\xe3o fazendo uma requisi\xe7\xe3o POST para o endpoint ",(0,i.jsx)(o.code,{children:"/oidc/token"})," do Logto. Lembre-se de incluir:"]}),(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["O par\xe2metro ",(0,i.jsx)(o.code,{children:"organization_id"})," definido para o ID da organiza\xe7\xe3o desejada."]}),"\n",(0,i.jsxs)(o.li,{children:["(Opcional) O par\xe2metro ",(0,i.jsx)(o.code,{children:"scope"})," para restringir ainda mais as permiss\xf5es necess\xe1rias (ex.: ",(0,i.jsx)(o.code,{children:"manage:members view:reports"}),")."]}),"\n"]}),(0,i.jsx)(o.p,{children:"Veja um exemplo n\xe3o normativo de como a requisi\xe7\xe3o de token pode ser:"}),(0,i.jsx)(l.A,{grantType:"refresh_token",organizationId:"your-organization-id"})]})]}),"\n",(0,i.jsx)(o.h4,{id:"client-credentials-flow",children:"Fluxo client credentials"}),"\n",(0,i.jsxs)(o.p,{children:["Para cen\xe1rios m\xe1quina para m\xe1quina (M2M), voc\xea pode usar o fluxo client credentials para obter um token de acesso para permiss\xf5es de organiza\xe7\xe3o. Fazendo uma requisi\xe7\xe3o POST para o endpoint ",(0,i.jsx)(o.code,{children:"/oidc/token"})," do Logto com par\xe2metros de organiza\xe7\xe3o, voc\xea pode solicitar um token de organiza\xe7\xe3o usando seu client ID e secret."]}),"\n",(0,i.jsx)(o.p,{children:"Aqui est\xe3o os principais par\xe2metros a serem inclu\xeddos na requisi\xe7\xe3o:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"organization_id"}),": O ID da organiza\xe7\xe3o para a qual deseja o token."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"scope"}),": As permiss\xf5es de organiza\xe7\xe3o que deseja solicitar (ex.: ",(0,i.jsx)(o.code,{children:"invite:member"}),", ",(0,i.jsx)(o.code,{children:"manage:billing"}),")."]}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"Veja um exemplo n\xe3o normativo da requisi\xe7\xe3o de token usando o grant type client credentials:"}),"\n",(0,i.jsx)(d.A,{organizationId:"your-organization-id",scope:"invite:member manage:billing"}),"\n",(0,i.jsx)(o.h3,{id:"validate-organization-tokens",children:"Validar tokens de organiza\xe7\xe3o"}),"\n",(0,i.jsx)(o.p,{children:"Os tokens de organiza\xe7\xe3o emitidos pelo Logto (JWTs) cont\xeam reivindica\xe7\xf5es que seu app/interface/backend pode usar para aplicar o controle de acesso em n\xedvel de organiza\xe7\xe3o."}),"\n",(0,i.jsx)(o.p,{children:"Quando seu app recebe um token de organiza\xe7\xe3o, voc\xea deve:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Verificar a assinatura do token (usando os JWKs do Logto)."}),"\n",(0,i.jsxs)(o.li,{children:["Confirmar que o token n\xe3o est\xe1 expirado (reivindica\xe7\xe3o ",(0,i.jsx)(o.code,{children:"exp"}),")."]}),"\n",(0,i.jsxs)(o.li,{children:["Checar se o ",(0,i.jsx)(o.code,{children:"iss"})," (emissor) corresponde ao seu endpoint Logto."]}),"\n",(0,i.jsxs)(o.li,{children:["Garantir que o ",(0,i.jsx)(o.code,{children:"aud"})," (p\xfablico) corresponde ao identificador formatado da organiza\xe7\xe3o (ex.: ",(0,i.jsx)(o.code,{children:"urn:logto:organization:{organization_id}"}),")."]}),"\n",(0,i.jsxs)(o.li,{children:["Separar a reivindica\xe7\xe3o ",(0,i.jsx)(o.code,{children:"scope"})," (separada por espa\xe7o) e verificar as permiss\xf5es necess\xe1rias."]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Para guias passo a passo e espec\xedficos de linguagem, veja ",(0,i.jsx)(o.a,{href:"/authorization/validate-access-tokens",children:"Como validar tokens de acesso"}),"."]}),"\n",(0,i.jsx)(o.h2,{id:"best-practices-and-security-tips",children:"Boas pr\xe1ticas e dicas de seguran\xe7a"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Nunca confie apenas na aplica\xe7\xe3o na interface:"})," Sempre valide permiss\xf5es no backend para a\xe7\xf5es cr\xedticas."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Use restri\xe7\xf5es de p\xfablico:"})," Sempre verifique a reivindica\xe7\xe3o ",(0,i.jsx)(o.code,{children:"aud"})," para garantir que o token \xe9 para a organiza\xe7\xe3o pretendida."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Mantenha as permiss\xf5es orientadas ao neg\xf3cio:"})," Use nomes claros que correspondam a a\xe7\xf5es reais; conceda apenas o necess\xe1rio para cada papel de organiza\xe7\xe3o."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Separe permiss\xf5es de API e n\xe3o-API"})," sempre que poss\xedvel (mas ambas podem estar em um \xfanico papel)."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.strong,{children:"Revise o template de organiza\xe7\xe3o regularmente"})," conforme seu produto evolui."]}),"\n"]}),"\n",(0,i.jsx)(o.h2,{id:"faqs",children:"Perguntas frequentes"}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(o.h3,{id:"can-i-mix-organization-and-non-organization-permissions-in-a-single-role",children:"Posso misturar permiss\xf5es de organiza\xe7\xe3o e n\xe3o-organiza\xe7\xe3o em um \xfanico papel?"})}),(0,i.jsx)(o.p,{children:"N\xe3o, as permiss\xf5es de organiza\xe7\xe3o (incluindo permiss\xf5es de API em n\xedvel de organiza\xe7\xe3o) s\xe3o definidas pelo template de organiza\xe7\xe3o e n\xe3o podem ser misturadas com permiss\xf5es globais de API. No entanto, voc\xea pode criar pap\xe9is que incluam permiss\xf5es de organiza\xe7\xe3o e permiss\xf5es de API em n\xedvel de organiza\xe7\xe3o."})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(o.h3,{id:"where-should-i-enforce-non-api-permissions",children:"Onde devo aplicar permiss\xf5es n\xe3o-API?"})}),(0,i.jsx)(o.p,{children:"Verifique permiss\xf5es n\xe3o-API tanto na interface (para controle de funcionalidades) quanto na l\xf3gica do servidor para a\xe7\xf5es sens\xedveis."})]}),"\n",(0,i.jsx)(o.h2,{id:"further-reading",children:"Leitura adicional"}),"\n",(0,i.jsx)(g,{href:"/authorization/validate-access-tokens",children:"Como validar tokens de acesso"}),"\n",(0,i.jsx)(g,{href:"/developers/custom-token-claims",children:"Personalizando reivindica\xe7\xf5es de token"}),"\n",(0,i.jsx)(g,{href:"/use-cases/multi-tenancy/build-multi-tenant-saas-application",children:(0,i.jsx)(o.p,{children:"Caso de uso: Construir um aplicativo SaaS multi-tenant"})})]})}function f(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(z,{...e})}):z(e)}function v(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,o,a)=>{a.d(o,{A:()=>s});var n=a(80173),i=a(25105);const s=e=>{let{resource:o,scope:a}=e;return(0,i.jsx)(n.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${a}\n&resource=${o}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,o,a)=>{a.d(o,{A:()=>s});var n=a(80173),i=a(25105);const s=e=>{let{resource:o,organizationId:a,scope:s}=e;return(0,i.jsxs)(n.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",o&&`&resource=${o}\n`,a&&`&organization_id=${a}\n`,`&scope=${s}\n`]})}},42372:(e,o,a)=>{a.d(o,{A:()=>s});var n=a(80173),i=a(25105);const s=e=>{let{grantType:o,resource:a,organizationId:s}=e;const r=[`grant_type=${o}`,"authorization_code"===o&&"code=authorization-code-received","authorization_code"===o&&"redirect_uri=https://your-app.com/callback","refresh_token"===o&&"refresh_token=your-refresh-token",a&&`resource=${a}`,s&&`organization_id=${s}`].filter(Boolean);return(0,i.jsx)(n.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${r.join("\n&")}`})}},38552:(e,o,a)=>{a.d(o,{A:()=>r});a(58101);var n=a(13526);const i={tabItem:"tabItem_dgSZ"};var s=a(25105);function r(e){let{children:o,hidden:a,className:r}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(i.tabItem,r),hidden:a,children:o})}},22002:(e,o,a)=>{a.d(o,{A:()=>k});var n=a(58101),i=a(13526),s=a(60755),r=a(55234),t=a(6635),d=a(4100),l=a(35661),c=a(42752);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:o}=e;return!!o&&"object"==typeof o&&"value"in o}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:o,children:a}=e;return(0,n.useMemo)((()=>{const e=o??function(e){return u(e).map((e=>{let{props:{value:o,label:a,attributes:n,default:i}}=e;return{value:o,label:a,attributes:n,default:i}}))}(a);return function(e){const o=(0,l.XI)(e,((e,o)=>e.value===o.value));if(o.length>0)throw new Error(`Docusaurus error: Duplicate values "${o.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[o,a])}function m(e){let{value:o,tabValues:a}=e;return a.some((e=>e.value===o))}function g(e){let{queryString:o=!1,groupId:a}=e;const i=(0,r.W6)(),s=function(e){let{queryString:o=!1,groupId:a}=e;if("string"==typeof o)return o;if(!1===o)return null;if(!0===o&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:o,groupId:a});return[(0,d.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const o=new URLSearchParams(i.location.search);o.set(s,e),i.replace({...i.location,search:o.toString()})}),[s,i])]}function h(e){const{defaultValue:o,queryString:a=!1,groupId:i}=e,s=p(e),[r,d]=(0,n.useState)((()=>function(e){let{defaultValue:o,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(o){if(!m({value:o,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${o}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return o}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:o,tabValues:s}))),[l,u]=g({queryString:a,groupId:i}),[h,x]=function(e){let{groupId:o}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(o),[i,s]=(0,c.Dv)(a);return[i,(0,n.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:i}),j=(()=>{const e=l??h;return m({value:e,tabValues:s})?e:null})();(0,t.A)((()=>{j&&d(j)}),[j]);return{selectedValue:r,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);d(e),u(e),x(e)}),[u,x,s]),tabValues:s}}var x=a(21929);const j={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var z=a(25105);function f(e){let{className:o,block:a,selectedValue:n,selectValue:r,tabValues:t}=e;const d=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),c=e=>{const o=e.currentTarget,a=d.indexOf(o),i=t[a].value;i!==n&&(l(o),r(i))},u=e=>{let o=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=d.indexOf(e.currentTarget)+1;o=d[a]??d[0];break}case"ArrowLeft":{const a=d.indexOf(e.currentTarget)-1;o=d[a]??d[d.length-1];break}}o?.focus()};return(0,z.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":a},o),children:t.map((e=>{let{value:o,label:a,attributes:s}=e;return(0,z.jsx)("li",{role:"tab",tabIndex:n===o?0:-1,"aria-selected":n===o,ref:e=>{d.push(e)},onKeyDown:u,onClick:c,...s,className:(0,i.A)("tabs__item",j.tabItem,s?.className,{"tabs__item--active":n===o}),children:a??o},o)}))})}function v(e){let{lazy:o,children:a,selectedValue:s}=e;const r=(Array.isArray(a)?a:[a]).filter(Boolean);if(o){const e=r.find((e=>e.props.value===s));return e?(0,n.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,z.jsx)("div",{className:"margin-top--md",children:r.map(((e,o)=>(0,n.cloneElement)(e,{key:o,hidden:e.props.value!==s})))})}function b(e){const o=h(e);return(0,z.jsxs)("div",{className:(0,i.A)("tabs-container",j.tabList),children:[(0,z.jsx)(f,{...o,...e}),(0,z.jsx)(v,{...o,...e})]})}function k(e){const o=(0,x.A)();return(0,z.jsx)(b,{...e,children:u(e.children)},String(o))}},55138:(e,o,a)=>{a.d(o,{A:()=>h});var n=a(28259),i=a(6097),s=a(58574),r=a(9484),t=a(76566),d=a(26346),l=a(17867),c=a(17510),u=a(13526),p=a(72355);const m={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var g=a(25105);function h(e){let{children:o,className:a="",metastring:h,title:x,showLineNumbers:j,language:z}=e;const{prism:{defaultLanguage:f,magicComments:v}}=(0,n.p)(),b=function(e){return e?.toLowerCase()}(z??(0,s.Op)(a)??f),k=(0,i.A)(),A=(0,r.f)(),P=(0,s.wt)(h)||x,{lineClassNames:I,code:w}=(0,s.Li)(o,{metastring:h,language:b,magicComments:v}),y=j??(0,s._u)(h);return(0,g.jsxs)(t.A,{as:"div",className:(0,u.A)(a,b&&!a.includes(`language-${b}`)&&`language-${b}`),children:[P&&(0,g.jsx)("div",{className:m.codeBlockTitle,children:P}),(0,g.jsxs)("div",{className:m.codeBlockContent,children:[(0,g.jsx)(p.f4,{theme:k,code:w,language:b??"text",children:e=>{let{className:o,tokens:a,getLineProps:n,getTokenProps:i}=e;return(0,g.jsx)("pre",{ref:A.codeBlockRef,tabIndex:0,className:(0,u.A)(o,m.codeBlock,"thin-scrollbar"),children:(0,g.jsx)("code",{className:(0,u.A)(m.codeBlockLines,y&&m.codeBlockLinesWithNumbering),children:a.map(((e,o)=>(0,g.jsx)(l.A,{line:e,getLineProps:n,getTokenProps:i,classNames:I[o],showLineNumbers:y},o)))})})}}),(0,g.jsxs)("div",{className:m.buttonGroup,children:[(A.isEnabled||A.isCodeScrollable)&&(0,g.jsx)(c.A,{className:m.codeButton,isEnabled:A.isEnabled,onClick:()=>{A.toggle()}}),(0,g.jsx)(d.A,{className:m.codeButton,code:w})]})]})]})}},93855:(e,o,a)=>{a.d(o,{A:()=>n});const n=a.p+"assets/images/rbac-organization-permissions-3302be06221b4399f73ddceac8ca17e3.png"}}]);