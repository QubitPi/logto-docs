"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[1400],{49986:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"end-user-flows/account-settings/by-account-api","title":"Configura\xe7\xf5es de conta pela Account API","description":"Saiba como usar a Account API para gerenciar usu\xe1rios","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","sourceDirName":"end-user-flows/account-settings","slug":"/end-user-flows/account-settings/by-account-api","permalink":"/pt-BR/end-user-flows/account-settings/by-account-api","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"description":"Saiba como usar a Account API para gerenciar usu\xe1rios","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Configura\xe7\xf5es de conta","permalink":"/pt-BR/end-user-flows/account-settings/"},"next":{"title":"Configura\xe7\xf5es de conta pela Management API","permalink":"/pt-BR/end-user-flows/account-settings/by-management-api"}}');var i=o(25105),r=o(79621);const s={description:"Saiba como usar a Account API para gerenciar usu\xe1rios",sidebar_position:1},c="Configura\xe7\xf5es de conta pela Account API",t={},d=[{value:"O que \xe9 a Logto Account API",id:"what-is-logto-account-api",level:2},{value:"Como habilitar a Account API",id:"how-to-enable-account-api",level:2},{value:"Como acessar a Account API",id:"how-to-access-account-api",level:2},{value:"Buscar um token de acesso",id:"fetch-an-access-token",level:3},{value:"Acessar a Account API usando o token de acesso",id:"access-account-api-using-access-token",level:3},{value:"Gerenciar informa\xe7\xf5es b\xe1sicas da conta",id:"manage-basic-account-information",level:2},{value:"Recuperar informa\xe7\xf5es da conta do usu\xe1rio",id:"retrieve-user-account-information",level:3},{value:"Atualizar informa\xe7\xf5es b\xe1sicas da conta",id:"update-basic-account-information",level:3},{value:"Gerenciar identificadores e outras informa\xe7\xf5es sens\xedveis",id:"manage-identifiers-and-other-sensitive-information",level:2},{value:"Obter um ID de registro de verifica\xe7\xe3o",id:"get-a-verification-record-id",level:3},{value:"Verificar a senha do usu\xe1rio",id:"verify-the-users-password",level:4},{value:"Verificar enviando um c\xf3digo de verifica\xe7\xe3o para o email ou telefone do usu\xe1rio",id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",level:4},{value:"Enviar requisi\xe7\xe3o com ID de registro de verifica\xe7\xe3o",id:"send-request-with-verification-record-id",level:3},{value:"Atualizar ou vincular novo email",id:"update-or-link-new-email",level:3},{value:"Remover o email do usu\xe1rio",id:"remove-the-users-email",level:3},{value:"Gerenciar telefone",id:"manage-phone",level:3},{value:"Vincular uma nova conex\xe3o social",id:"link-a-new-social-connection",level:3},{value:"Remover uma conex\xe3o social",id:"remove-a-social-connection",level:3},{value:"Vincular uma nova chave de acesso WebAuthn",id:"link-a-new-webauthn-passkey",level:3},{value:"Gerenciar chave de acesso WebAuthn existente",id:"manage-existing-webauthn-passkey",level:3}];function l(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"configura\xe7\xf5es-de-conta-pela-account-api",children:"Configura\xe7\xf5es de conta pela Account API"})}),"\n",(0,i.jsx)(a.h2,{id:"what-is-logto-account-api",children:"O que \xe9 a Logto Account API"}),"\n",(0,i.jsx)(a.p,{children:"A Logto Account API \xe9 um conjunto abrangente de APIs que oferece aos usu\xe1rios finais acesso direto via API sem a necessidade de passar pela Management API. Aqui est\xe3o os destaques:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Acesso direto: A Account API permite que os usu\xe1rios finais acessem e gerenciem diretamente seus pr\xf3prios perfis de conta sem precisar do repasse pela Management API."}),"\n",(0,i.jsx)(a.li,{children:"Gerenciamento de perfil de usu\xe1rio e identidades: Os usu\xe1rios podem gerenciar totalmente seus perfis e configura\xe7\xf5es de seguran\xe7a, incluindo a capacidade de atualizar informa\xe7\xf5es de identidade como email, telefone e senha, al\xe9m de gerenciar conex\xf5es sociais. O suporte a MFA e SSO estar\xe1 dispon\xedvel em breve."}),"\n",(0,i.jsx)(a.li,{children:"Controle de acesso global: Os administradores t\xeam controle total e global sobre as configura\xe7\xf5es de acesso e podem personalizar cada campo."}),"\n",(0,i.jsxs)(a.li,{children:["Autoriza\xe7\xe3o perfeita: A autoriza\xe7\xe3o ficou mais f\xe1cil do que nunca! Basta usar ",(0,i.jsx)(a.code,{children:"client.getAccessToken()"})," para obter um token opaco de acesso para OP (Logto) e anex\xe1-lo ao cabe\xe7alho Authorization como ",(0,i.jsx)(a.code,{children:"Bearer <access_token>"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(a.admonition,{type:"note",children:[(0,i.jsx)(a.p,{children:"Para garantir que o token de acesso tenha as permiss\xf5es apropriadas, certifique-se de ter configurado corretamente os escopos correspondentes em sua configura\xe7\xe3o do Logto."}),(0,i.jsxs)(a.p,{children:["Por exemplo, para a API ",(0,i.jsx)(a.code,{children:"POST /api/my-account/primary-email"}),", voc\xea precisa configurar o escopo ",(0,i.jsx)(a.code,{children:"email"}),"; para a API ",(0,i.jsx)(a.code,{children:"POST /api/my-account/primary-phone"}),", voc\xea precisa configurar o escopo ",(0,i.jsx)(a.code,{children:"phone"}),"."]}),(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-ts",children:"import { type LogtoConfig, UserScope } from '@logto/js';\n\nconst config: LogtoConfig = {\n  // ...outras op\xe7\xf5es\n  // Adicione os escopos adequados para seus casos de uso.\n  scopes: [\n    UserScope.Email, // Para as APIs `{POST,DELETE} /api/my-account/primary-email`\n    UserScope.Phone, // Para as APIs `{POST,DELETE} /api/my-account/primary-phone`\n    UserScope.CustomData, // Para gerenciar dados personalizados\n    UserScope.Address, // Para gerenciar endere\xe7o\n    UserScope.Identities, // Para APIs relacionadas a identidade e MFA\n    UserScope.Profile, // Para gerenciar o perfil do usu\xe1rio\n  ],\n};\n"})})]}),"\n",(0,i.jsx)(a.p,{children:"Com a Logto Account API, voc\xea pode construir um sistema personalizado de gerenciamento de contas, como uma p\xe1gina de perfil totalmente integrada ao Logto."}),"\n",(0,i.jsx)(a.p,{children:"Alguns casos de uso frequentes est\xe3o listados abaixo:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Recuperar perfil do usu\xe1rio"}),"\n",(0,i.jsx)(a.li,{children:"Atualizar perfil do usu\xe1rio"}),"\n",(0,i.jsx)(a.li,{children:"Atualizar senha do usu\xe1rio"}),"\n",(0,i.jsx)(a.li,{children:"Atualizar identidades do usu\xe1rio, incluindo email, telefone e conex\xf5es sociais"}),"\n",(0,i.jsx)(a.li,{children:"Gerenciar fatores de MFA (verifica\xe7\xf5es)"}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["Para saber mais sobre as APIs dispon\xedveis, visite ",(0,i.jsx)(a.a,{href:"https://openapi.logto.io/group/endpoint-my-account",children:"Refer\xeancia da Logto Account API"})," e ",(0,i.jsx)(a.a,{href:"https://openapi.logto.io/group/endpoint-verifications",children:"Refer\xeancia da Logto Verification API"}),"."]}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["APIs dedicadas para as seguintes configura\xe7\xf5es estar\xe3o dispon\xedveis em breve: MFA, SSO, dados personalizados (usu\xe1rio) e exclus\xe3o de conta. Enquanto isso, voc\xea pode implementar esses recursos usando as Management APIs do Logto. Veja ",(0,i.jsx)(a.a,{href:"/end-user-flows/account-settings/by-management-api",children:"Configura\xe7\xf5es de conta pela Management API"})," para mais detalhes."]})}),"\n",(0,i.jsx)(a.h2,{id:"how-to-enable-account-api",children:"Como habilitar a Account API"}),"\n",(0,i.jsxs)(a.p,{children:["Por padr\xe3o, a Account API est\xe1 desabilitada. Para habilit\xe1-la, voc\xea precisa usar a ",(0,i.jsx)(a.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," para atualizar as configura\xe7\xf5es globais."]}),"\n",(0,i.jsxs)(a.p,{children:["O endpoint ",(0,i.jsx)(a.code,{children:"/api/account-center"})," pode ser usado para recuperar e atualizar as configura\xe7\xf5es do centro de contas. Voc\xea pode us\xe1-lo para habilitar ou desabilitar a Account API e personalizar os campos."]}),"\n",(0,i.jsx)(a.p,{children:"Exemplo de requisi\xe7\xe3o:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/account-center \\\n  -H \'authorization: Bearer <access_token for Logto Management API>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"enabled":true,"fields":{"username":"Edit"}}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["O campo ",(0,i.jsx)(a.code,{children:"enabled"})," \xe9 usado para habilitar ou desabilitar a Account API, e o campo ",(0,i.jsx)(a.code,{children:"fields"})," \xe9 usado para personalizar os campos, o valor pode ser ",(0,i.jsx)(a.code,{children:"Off"}),", ",(0,i.jsx)(a.code,{children:"Edit"}),", ",(0,i.jsx)(a.code,{children:"ReadOnly"}),". O valor padr\xe3o \xe9 ",(0,i.jsx)(a.code,{children:"Off"}),". A lista de campos:"]}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"name"}),": O campo nome."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"avatar"}),": O campo avatar."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"profile"}),": O campo perfil, incluindo seus subcampos."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"username"}),": O campo nome de usu\xe1rio."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"email"}),": O campo email."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"phone"}),": O campo telefone."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"password"}),": O campo senha; ao obter, retornar\xe1 ",(0,i.jsx)(a.code,{children:"true"})," se o usu\xe1rio tiver uma senha definida, caso contr\xe1rio, ",(0,i.jsx)(a.code,{children:"false"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"social"}),": Conex\xf5es sociais."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"mfa"}),": Fatores de MFA."]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["Saiba mais sobre os detalhes da API em ",(0,i.jsx)(a.a,{href:"https://openapi.logto.io/group/endpoint-account-center",children:"Refer\xeancia da Logto Management API"}),"."]}),"\n",(0,i.jsx)(a.h2,{id:"how-to-access-account-api",children:"Como acessar a Account API"}),"\n",(0,i.jsx)(a.h3,{id:"fetch-an-access-token",children:"Buscar um token de acesso"}),"\n",(0,i.jsxs)(a.p,{children:["Ap\xf3s configurar o SDK em seu aplicativo, voc\xea pode usar o m\xe9todo ",(0,i.jsx)(a.code,{children:"client.getAccessToken()"})," para buscar um token de acesso. Este token \xe9 um token opaco que pode ser usado para acessar a Account API."]}),"\n",(0,i.jsxs)(a.p,{children:["Se voc\xea n\xe3o estiver usando o SDK oficial, deve definir o ",(0,i.jsx)(a.code,{children:"resource"})," como vazio para a solicita\xe7\xe3o de concess\xe3o de token de acesso para ",(0,i.jsx)(a.code,{children:"/oidc/token"}),"."]}),"\n",(0,i.jsx)(a.h3,{id:"access-account-api-using-access-token",children:"Acessar a Account API usando o token de acesso"}),"\n",(0,i.jsxs)(a.p,{children:["Voc\xea deve incluir o token de acesso no campo ",(0,i.jsx)(a.code,{children:"Authorization"})," dos cabe\xe7alhos HTTP com o formato Bearer (",(0,i.jsx)(a.code,{children:"Bearer YOUR_TOKEN"}),") ao interagir com a Account API."]}),"\n",(0,i.jsx)(a.p,{children:"Veja um exemplo para obter as informa\xe7\xf5es da conta do usu\xe1rio:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,i.jsx)(a.h2,{id:"manage-basic-account-information",children:"Gerenciar informa\xe7\xf5es b\xe1sicas da conta"}),"\n",(0,i.jsx)(a.h3,{id:"retrieve-user-account-information",children:"Recuperar informa\xe7\xf5es da conta do usu\xe1rio"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,i.jsx)(a.p,{children:"O corpo da resposta ser\xe1 semelhante a:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-json",children:'{\n  "id": "...",\n  "username": "...",\n  "name": "...",\n  "avatar": "..."\n}\n'})}),"\n",(0,i.jsx)(a.p,{children:"Os campos da resposta podem variar dependendo das configura\xe7\xf5es do centro de contas."}),"\n",(0,i.jsx)(a.h3,{id:"update-basic-account-information",children:"Atualizar informa\xe7\xf5es b\xe1sicas da conta"}),"\n",(0,i.jsx)(a.p,{children:"As informa\xe7\xf5es b\xe1sicas da conta incluem nome de usu\xe1rio, nome, avatar e perfil."}),"\n",(0,i.jsxs)(a.p,{children:["Para atualizar nome de usu\xe1rio, nome e avatar, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"PATCH /api/my-account"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"username":"...","name":"...","avatar":"..."}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["Para atualizar o perfil, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"PATCH /api/my-account/profile"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account/profile \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"familyName":"...","givenName":"..."}\'\n'})}),"\n",(0,i.jsx)(a.h2,{id:"manage-identifiers-and-other-sensitive-information",children:"Gerenciar identificadores e outras informa\xe7\xf5es sens\xedveis"}),"\n",(0,i.jsx)(a.p,{children:"Por motivos de seguran\xe7a, a Account API exige uma camada adicional de autoriza\xe7\xe3o para opera\xe7\xf5es que envolvem identificadores e outras informa\xe7\xf5es sens\xedveis."}),"\n",(0,i.jsx)(a.h3,{id:"get-a-verification-record-id",children:"Obter um ID de registro de verifica\xe7\xe3o"}),"\n",(0,i.jsx)(a.p,{children:"Primeiro, voc\xea precisa obter um ID de registro de verifica\xe7\xe3o. Isso pode ser usado para verificar a identidade do usu\xe1rio ao atualizar identificadores."}),"\n",(0,i.jsx)(a.p,{children:"Para obter um ID de registro de verifica\xe7\xe3o, voc\xea pode verificar a senha do usu\xe1rio ou enviar um c\xf3digo de verifica\xe7\xe3o para o email ou telefone do usu\xe1rio."}),"\n",(0,i.jsxs)(a.p,{children:["Para saber mais sobre verifica\xe7\xf5es, consulte ",(0,i.jsx)(a.a,{href:"/end-user-flows/security-verification",children:"Verifica\xe7\xe3o de seguran\xe7a pela Account API"}),"."]}),"\n",(0,i.jsx)(a.h4,{id:"verify-the-users-password",children:"Verificar a senha do usu\xe1rio"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/password \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"password\":\"...\"}'\n"})}),"\n",(0,i.jsx)(a.p,{children:"O corpo da resposta ser\xe1 semelhante a:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,i.jsx)(a.h4,{id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",children:"Verificar enviando um c\xf3digo de verifica\xe7\xe3o para o email ou telefone do usu\xe1rio"}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["Para usar este m\xe9todo, voc\xea precisa ",(0,i.jsx)(a.a,{href:"/connectors/email-connectors/",children:"configurar o conector de email"})," ou ",(0,i.jsx)(a.a,{href:"/connectors/sms-connectors/",children:"conector SMS"}),", e garantir que o template ",(0,i.jsx)(a.code,{children:"UserPermissionValidation"})," esteja configurado."]})}),"\n",(0,i.jsx)(a.p,{children:"Usando email como exemplo, solicite um novo c\xf3digo de verifica\xe7\xe3o e obtenha o ID de registro de verifica\xe7\xe3o:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,i.jsx)(a.p,{children:"O corpo da resposta ser\xe1 semelhante a:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,i.jsx)(a.p,{children:"Ap\xf3s receber o c\xf3digo de verifica\xe7\xe3o, voc\xea pode us\xe1-lo para atualizar o status de verifica\xe7\xe3o do registro."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"123456"}\'\n'})}),"\n",(0,i.jsx)(a.p,{children:"Ap\xf3s verificar o c\xf3digo, agora voc\xea pode usar o ID de registro de verifica\xe7\xe3o para atualizar o identificador do usu\xe1rio."}),"\n",(0,i.jsx)(a.h3,{id:"send-request-with-verification-record-id",children:"Enviar requisi\xe7\xe3o com ID de registro de verifica\xe7\xe3o"}),"\n",(0,i.jsxs)(a.p,{children:["Ao enviar uma requisi\xe7\xe3o para atualizar o identificador do usu\xe1rio, voc\xea precisa incluir o ID de registro de verifica\xe7\xe3o no cabe\xe7alho da requisi\xe7\xe3o com o campo ",(0,i.jsx)(a.code,{children:"logto-verification-id"}),"."]}),"\n",(0,i.jsx)(a.h3,{id:"update-or-link-new-email",children:"Atualizar ou vincular novo email"}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["Para usar este m\xe9todo, voc\xea precisa ",(0,i.jsx)(a.a,{href:"/connectors/email-connectors/",children:"configurar o conector de email"})," e garantir que o template ",(0,i.jsx)(a.code,{children:"BindNewIdentifier"})," esteja configurado."]})}),"\n",(0,i.jsx)(a.p,{children:"Para atualizar ou vincular um novo email, primeiro voc\xea deve provar a propriedade do email."}),"\n",(0,i.jsxs)(a.p,{children:["Chame o endpoint ",(0,i.jsx)(a.code,{children:"POST /api/verifications/verification-code"})," para solicitar um c\xf3digo de verifica\xe7\xe3o."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["Voc\xea encontrar\xe1 um ",(0,i.jsx)(a.code,{children:"verificationId"})," na resposta e receber\xe1 um c\xf3digo de verifica\xe7\xe3o no email; use-o para verificar o email."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"..."}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["Ap\xf3s verificar o c\xf3digo, agora voc\xea pode atualizar o email do usu\xe1rio, definindo o ",(0,i.jsx)(a.code,{children:"verificationId"})," no corpo da requisi\xe7\xe3o como ",(0,i.jsx)(a.code,{children:"newIdentifierVerificationRecordId"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"email\":\"...\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,i.jsx)(a.h3,{id:"remove-the-users-email",children:"Remover o email do usu\xe1rio"}),"\n",(0,i.jsxs)(a.p,{children:["Para remover o email do usu\xe1rio, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"DELETE /api/my-account/primary-email"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,i.jsx)(a.h3,{id:"manage-phone",children:"Gerenciar telefone"}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["Para usar este m\xe9todo, voc\xea precisa ",(0,i.jsx)(a.a,{href:"/connectors/sms-connectors/",children:"configurar o conector SMS"})," e garantir que o template ",(0,i.jsx)(a.code,{children:"BindNewIdentifier"})," esteja configurado."]})}),"\n",(0,i.jsxs)(a.p,{children:["Semelhante \xe0 atualiza\xe7\xe3o de email, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"PATCH /api/my-account/primary-phone"})," para atualizar ou vincular um novo telefone. E usar o endpoint ",(0,i.jsx)(a.code,{children:"DELETE /api/my-account/primary-phone"})," para remover o telefone do usu\xe1rio."]}),"\n",(0,i.jsx)(a.h3,{id:"link-a-new-social-connection",children:"Vincular uma nova conex\xe3o social"}),"\n",(0,i.jsx)(a.p,{children:"Para vincular uma nova conex\xe3o social, primeiro voc\xea deve solicitar uma URL de autoriza\xe7\xe3o:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorId":"...","redirectUri":"...","state":"..."}\'\n'})}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"connectorId"}),": O ID do ",(0,i.jsx)(a.a,{href:"/connectors/social-connectors/",children:"conector social"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"redirectUri"}),": O URI de redirecionamento ap\xf3s o usu\xe1rio autorizar o aplicativo; voc\xea deve hospedar uma p\xe1gina web neste URL e capturar o callback."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"state"}),": O estado a ser retornado ap\xf3s o usu\xe1rio autorizar o aplicativo; \xe9 uma string aleat\xf3ria usada para prevenir ataques CSRF."]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["Na resposta, voc\xea encontrar\xe1 um ",(0,i.jsx)(a.code,{children:"verificationRecordId"}),", guarde-o para uso posterior."]}),"\n",(0,i.jsxs)(a.p,{children:["Ap\xf3s o usu\xe1rio autorizar o aplicativo, voc\xea receber\xe1 um callback no ",(0,i.jsx)(a.code,{children:"redirectUri"})," com o par\xe2metro ",(0,i.jsx)(a.code,{children:"state"}),". Ent\xe3o, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"POST /api/verifications/social/verify"})," para verificar a conex\xe3o social."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorData":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["O ",(0,i.jsx)(a.code,{children:"connectorData"})," s\xe3o os dados retornados pelo conector social ap\xf3s o usu\xe1rio autorizar o aplicativo; voc\xea precisa analisar e obter os par\xe2metros de consulta do ",(0,i.jsx)(a.code,{children:"redirectUri"})," em sua p\xe1gina de callback e empacot\xe1-los como um JSON no campo ",(0,i.jsx)(a.code,{children:"connectorData"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["Por fim, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"POST /api/my-account/identities"})," para vincular a conex\xe3o social."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/identities \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,i.jsx)(a.h3,{id:"remove-a-social-connection",children:"Remover uma conex\xe3o social"}),"\n",(0,i.jsxs)(a.p,{children:["Para remover uma conex\xe3o social, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"DELETE /api/my-account/identities"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/identities/[connector_target_id] \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,i.jsx)(a.h3,{id:"link-a-new-webauthn-passkey",children:"Vincular uma nova chave de acesso WebAuthn"}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["Lembre-se de ",(0,i.jsx)(a.a,{href:"/end-user-flows/mfa",children:"habilitar MFA e WebAuthn"})," primeiro."]})}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsxs)(a.p,{children:["Para usar este m\xe9todo, voc\xea precisa habilitar o campo ",(0,i.jsx)(a.code,{children:"mfa"})," nas configura\xe7\xf5es do centro de contas."]})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Passo 0: Adicione a origem do seu app front-end \xe0s origens relacionadas."})}),"\n",(0,i.jsx)(a.p,{children:"Uma chave de acesso no navegador est\xe1 vinculada a um hostname espec\xedfico (RP ID), e somente a origem do RP ID pode ser usada para registrar ou verificar uma chave de acesso. No entanto, seu app front-end que est\xe1 enviando a requisi\xe7\xe3o para a Account API n\xe3o \xe9 o mesmo que a p\xe1gina de login do Logto, ent\xe3o voc\xea precisa adicionar a origem do seu app front-end \xe0 lista de origens relacionadas. Isso permitir\xe1 que seu app front-end registre e verifique uma chave de acesso sob outros RP IDs."}),"\n",(0,i.jsxs)(a.p,{children:["Por padr\xe3o, o Logto define o RP ID como o dom\xednio do tenant, por exemplo, se seu dom\xednio for ",(0,i.jsx)(a.code,{children:"https://example.logto.app"}),", o RP ID ser\xe1 ",(0,i.jsx)(a.code,{children:"example.logto.app"}),". Se voc\xea estiver usando um dom\xednio personalizado, o RP ID ser\xe1 o dom\xednio personalizado, por exemplo, se seu dom\xednio for ",(0,i.jsx)(a.code,{children:"https://auth.example.com"}),", o RP ID ser\xe1 ",(0,i.jsx)(a.code,{children:"auth.example.com"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["Agora, adicione a origem do seu app front-end \xe0s origens relacionadas, por exemplo, se a origem do seu app for ",(0,i.jsx)(a.code,{children:"https://account.example.com"}),":"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/webauthn-connectors \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"webauthnRelatedOrigins\":[\"https://account.example.com\"]}'\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Para saber mais sobre origens relacionadas, consulte a documenta\xe7\xe3o ",(0,i.jsx)(a.a,{href:"https://passkeys.dev/docs/advanced/related-origins/",children:"Related Origin Requests"}),"."]}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Passo 1: solicitar novas op\xe7\xf5es de registro."})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,i.jsx)(a.p,{children:"Voc\xea receber\xe1 uma resposta como:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-json",children:'{\n  "registrationOptions": "...",\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Passo 2: registrar a chave de acesso no navegador local."})}),"\n",(0,i.jsxs)(a.p,{children:["Usando ",(0,i.jsx)(a.a,{href:"https://simplewebauthn.dev/",children:(0,i.jsx)(a.code,{children:"@simplewebauthn/browser"})})," como exemplo, voc\xea pode usar a fun\xe7\xe3o ",(0,i.jsx)(a.code,{children:"startRegistration"})," para registrar a chave de acesso no navegador local."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-ts",children:"import { startRegistration } from '@simplewebauthn/browser';\n\n// ...\nconst response = await startRegistration({\n  optionsJSON: registrationOptions, // Os dados retornados pelo servidor no passo 1\n});\n// Salve a resposta para uso posterior\n"})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Passo 3: verificar a chave de acesso."})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"payload":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"payload"}),": A resposta do navegador local no passo 2."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"verificationRecordId"}),": O ID de registro de verifica\xe7\xe3o retornado pelo servidor no passo 1."]}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Passo 4: por fim, voc\xea pode vincular a chave de acesso."})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"type\":\"WebAuthn\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"verification_record_id"}),": um ID de registro de verifica\xe7\xe3o v\xe1lido, concedido ao verificar o fator existente do usu\xe1rio; consulte a se\xe7\xe3o ",(0,i.jsx)(a.a,{href:"#get-a-verification-record-id",children:"Obter um ID de registro de verifica\xe7\xe3o"})," para mais detalhes."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"type"}),": o tipo do fator MFA, atualmente apenas ",(0,i.jsx)(a.code,{children:"WebAuthn"})," \xe9 suportado."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"newIdentifierVerificationRecordId"}),": o ID de registro de verifica\xe7\xe3o retornado pelo servidor no passo 1."]}),"\n"]}),"\n",(0,i.jsx)(a.h3,{id:"manage-existing-webauthn-passkey",children:"Gerenciar chave de acesso WebAuthn existente"}),"\n",(0,i.jsxs)(a.p,{children:["Para gerenciar uma chave de acesso WebAuthn existente, voc\xea pode usar o endpoint ",(0,i.jsx)(a.code,{children:"GET /api/my-account/mfa-verifications"})," para obter as chaves atuais e outros fatores de verifica\xe7\xe3o MFA."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,i.jsx)(a.p,{children:"O corpo da resposta ser\xe1 semelhante a:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-json",children:'[\n  {\n    "id": "...",\n    "type": "WebAuthn",\n    "name": "...",\n    "agent": "...",\n    "createdAt": "...",\n    "updatedAt": "..."\n  }\n]\n'})}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"id"}),": o ID da verifica\xe7\xe3o."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"type"}),": o tipo da verifica\xe7\xe3o, ",(0,i.jsx)(a.code,{children:"WebAuthn"})," para chave de acesso WebAuthn."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"name"}),": o nome da chave de acesso, campo opcional."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:"agent"}),": o user agent da chave de acesso."]}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"Atualizar o nome da chave de acesso:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId}/name \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"name\":\"...\"}'\n"})}),"\n",(0,i.jsx)(a.p,{children:"Excluir a chave de acesso:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId} \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})})]})}function p(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},79621:(e,a,o)=>{o.d(a,{R:()=>s,x:()=>c});var n=o(58101);const i={},r=n.createContext(i);function s(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);