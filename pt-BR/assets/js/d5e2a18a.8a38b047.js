"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[7788],{42597:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>m,contentTitle:()=>h,default:()=>f,frontMatter:()=>p,metadata:()=>r,resource:()=>x,toc:()=>g});const r=JSON.parse('{"id":"authorization/global-api-resources","title":"Proteger recursos globais de API","description":"Proteja APIs de todo o produto usando controle de acesso baseado em papel (RBAC) no Logto. Atribua pap\xe9is globais e permiss\xf5es para controlar o acesso de todos os usu\xe1rios e clientes em todo o seu aplicativo.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","sourceDirName":"authorization","slug":"/authorization/global-api-resources","permalink":"/pt-BR/authorization/global-api-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Template de organiza\xe7\xe3o","permalink":"/pt-BR/authorization/organization-template"},"next":{"title":"Proteger permiss\xf5es de organiza\xe7\xe3o (n\xe3o-API)","permalink":"/pt-BR/authorization/organization-permissions"}}');var a=s(25105),n=s(79621),i=s(46643),t=s(39088),c=s(78506),d=s(42372),l=s(38552),u=s(22002);const p={sidebar_position:3},h="Proteger recursos globais de API",m={},x="https://api.your-app.com",g=[{value:"O que s\xe3o recursos globais de API?",id:"what-are-global-api-resources",level:2},{value:"Como funciona no Logto",id:"how-it-works-in-logto",level:2},{value:"Vis\xe3o geral da implementa\xe7\xe3o",id:"implementation-overview",level:3},{value:"Entendendo indicadores de recurso",id:"understanding-resource-indicators",level:3},{value:"Fluxo de autoriza\xe7\xe3o: autenticando e protegendo sua API",id:"authorization-flow-authenticating-and-securing-your-api",level:3},{value:"Etapas de implementa\xe7\xe3o",id:"implementation-steps",level:2},{value:"Registre seus recursos de API",id:"register-your-api-resources",level:3},{value:"Configure pap\xe9is globais",id:"set-up-global-roles",level:3},{value:"Obtenha tokens de acesso para recursos globais de API",id:"obtain-access-tokens-for-global-api-resources",level:3},{value:"Fluxo de c\xf3digo de autoriza\xe7\xe3o ou refresh token",id:"authorization-code-or-refresh-token-flow",level:4},{value:"Fluxo de client credentials",id:"client-credentials-flow",level:4},{value:"Validando tokens de acesso JWT em sua API",id:"validating-jwt-access-tokens-in-your-api",level:3},{value:"Opcional: Lidar com altera\xe7\xe3o de permiss\xe3o do usu\xe1rio",id:"optional-handle-user-permission-change",level:3},{value:"Boas pr\xe1ticas e dicas de seguran\xe7a",id:"best-practices-and-security-tips",level:2},{value:"Perguntas frequentes",id:"faqs",level:2},{value:"E se meu cliente n\xe3o suportar o par\xe2metro resource?",id:"what-if-my-client-doesn-t-support-the-resource-parameter",level:3},{value:"Por que recebo 401 N\xe3o autorizado da minha API?",id:"why-do-i-get-401-unauthorized-from-my-api",level:3},{value:"Como testar sem um cliente completo?",id:"how-do-i-test-without-a-full-client",level:3},{value:"Leitura adicional",id:"further-reading",level:2}];function j(e){const o={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components},{CloudLink:s,Details:r,Url:p}=o;return s||b("CloudLink",!0),r||b("Details",!0),p||b("Url",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.header,{children:(0,a.jsx)(o.h1,{id:"proteger-recursos-globais-de-api",children:"Proteger recursos globais de API"})}),"\n","\n",(0,a.jsx)(o.p,{children:"Proteja APIs de todo o produto usando controle de acesso baseado em papel (RBAC) no Logto. Atribua pap\xe9is globais e permiss\xf5es para controlar o acesso de todos os usu\xe1rios e clientes em todo o seu aplicativo."}),"\n",(0,a.jsx)(o.h2,{id:"what-are-global-api-resources",children:"O que s\xe3o recursos globais de API?"}),"\n",(0,a.jsx)(o.p,{children:"Recursos globais de API s\xe3o endpoints ou servi\xe7os em seu aplicativo que s\xe3o acess\xedveis a todos os usu\xe1rios, independentemente de organiza\xe7\xe3o ou locat\xe1rio. Normalmente, s\xe3o APIs p\xfablicas, servi\xe7os centrais do produto ou qualquer endpoint que n\xe3o esteja vinculado a uma organiza\xe7\xe3o espec\xedfica."}),"\n",(0,a.jsx)(o.p,{children:(0,a.jsx)(o.strong,{children:"Casos de uso incluem"})}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsx)(o.li,{children:"APIs p\xfablicas ou endpoints compartilhados entre sua base de usu\xe1rios."}),"\n",(0,a.jsx)(o.li,{children:"Microsservi\xe7os que n\xe3o est\xe3o atrelados \xe0 multi-tenancy."}),"\n",(0,a.jsxs)(o.li,{children:["APIs centrais do aplicativo (por exemplo, ",(0,a.jsx)(o.code,{children:"/api/users"}),", ",(0,a.jsx)(o.code,{children:"/api/products"}),") usadas por todos os clientes."]}),"\n"]}),"\n",(0,a.jsx)(o.p,{children:"O Logto permite proteger essas APIs usando OAuth 2.1, combinado com controle de acesso flex\xedvel baseado em papel."}),"\n",(0,a.jsx)(o.h2,{id:"how-it-works-in-logto",children:"Como funciona no Logto"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Recursos de API e permiss\xf5es s\xe3o registrados globalmente:"})," Cada API que voc\xea deseja proteger \xe9 definida com um indicador de recurso \xfanico (URI) e um conjunto de permiss\xf5es (escopos) que controlam o acesso."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"O acesso \xe9 controlado por pap\xe9is globais:"})," Voc\xea pode atribuir permiss\xf5es a pap\xe9is, que ent\xe3o s\xe3o atribu\xeddos a usu\xe1rios ou clientes."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Separado das permiss\xf5es em n\xedvel de organiza\xe7\xe3o:"})," Recursos globais de API n\xe3o t\xeam contexto de organiza\xe7\xe3o. No entanto, podem ser usados em conjunto com pap\xe9is de organiza\xe7\xe3o para fornecer uma camada adicional de contexto, se necess\xe1rio. Para proteger APIs em n\xedvel de organiza\xe7\xe3o, veja ",(0,a.jsx)(o.a,{href:"/authorization/organization-level-api-resources",children:"Proteger recursos de API em n\xedvel de organiza\xe7\xe3o"}),"."]}),"\n"]}),"\n",(0,a.jsx)("img",{src:i.A,alt:"Recursos globais de API RBAC",style:{maxWidth:"100%"}}),"\n",(0,a.jsx)(o.h3,{id:"implementation-overview",children:"Vis\xe3o geral da implementa\xe7\xe3o"}),"\n",(0,a.jsxs)(o.ol,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Registre seu recurso de API"})," e defina suas permiss\xf5es no Logto."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Defina pap\xe9is"})," com as permiss\xf5es necess\xe1rias para acessar a API."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Atribua pap\xe9is"})," a usu\xe1rios ou clientes."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Use fluxos de autoriza\xe7\xe3o OAuth 2.0"})," para obter tokens de acesso para a API (o par\xe2metro resource deve corresponder ao identificador da API registrada)."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Valide os tokens de acesso"})," em sua API para aplicar as permiss\xf5es."]}),"\n"]}),"\n",(0,a.jsx)(o.h3,{id:"understanding-resource-indicators",children:"Entendendo indicadores de recurso"}),"\n",(0,a.jsxs)(o.p,{children:["O Logto modela recursos de API de acordo com ",(0,a.jsx)(o.a,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Indicadores de Recurso para OAuth 2.0"}),". Um ",(0,a.jsx)(o.strong,{children:"indicador de recurso"})," \xe9 um URI que identifica de forma \xfanica a API ou servi\xe7o de destino solicitado."]}),"\n",(0,a.jsx)(o.p,{children:(0,a.jsx)(o.strong,{children:"Pontos-chave"})}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["Indicadores de recurso devem ser URIs absolutos (por exemplo, ",(0,a.jsx)(o.code,{children:"https://api.example.com"}),")"]}),"\n",(0,a.jsx)(o.li,{children:"Sem componente de fragmento; evite usar query strings sempre que poss\xedvel."}),"\n",(0,a.jsx)(o.li,{children:"Indicadores de recurso permitem tokens restritos por p\xfablico e suporte para arquiteturas multi-API."}),"\n"]}),"\n",(0,a.jsx)(o.p,{children:(0,a.jsx)(o.strong,{children:"Exemplo"})}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["Management API: ",(0,a.jsx)(o.code,{children:"https://my-tenant.logto.app/api"})]}),"\n",(0,a.jsxs)(o.li,{children:["API global personalizada: ",(0,a.jsx)(o.code,{children:"https://api.yourapp.com"})]}),"\n"]}),"\n",(0,a.jsx)(o.h3,{id:"authorization-flow-authenticating-and-securing-your-api",children:"Fluxo de autoriza\xe7\xe3o: autenticando e protegendo sua API"}),"\n",(0,a.jsx)(o.p,{children:"O fluxo abaixo se aplica tanto \xe0 autentica\xe7\xe3o interativa do usu\xe1rio (navegador / aplicativo) quanto a cen\xe1rios backend m\xe1quina para m\xe1quina (M2M)."}),"\n",(0,a.jsx)(o.p,{children:"Observe que o fluxo n\xe3o inclui detalhes exaustivos sobre os par\xe2metros ou cabe\xe7alhos necess\xe1rios, mas foca nas etapas principais envolvidas. Continue lendo para ver como o fluxo funciona na pr\xe1tica."}),"\n",(0,a.jsx)(o.mermaid,{value:"sequenceDiagram\n    participant Client as Cliente\n    participant Logto as Logto\n    participant API as Recurso de API\n\n    alt Autentica\xe7\xe3o do usu\xe1rio\n        Cliente->>Logto: GET /oidc/auth\n        Logto->>Logto: Redireciona usu\xe1rio para p\xe1gina de login\n        Logto->>Cliente: Redireciona de volta com `authorization_code`\n        alt Usar concess\xe3o authorization_code\n            Cliente->>Logto: POST /oidc/token com `grant_type=authorization_code`<br/>e par\xe2metro `resource`\n        else Usar concess\xe3o refresh_token\n            Cliente->>Logto: POST /oidc/token com `grant_type=authorization_code`\n            Logto->>Cliente: Retorna refresh token\n            Cliente->>Logto: POST /oidc/token com `grant_type=refresh_token`<br/>e par\xe2metro `resource`\n        end\n    else Autentica\xe7\xe3o cliente m\xe1quina para m\xe1quina (M2M)\n        Cliente->>Logto: POST /oidc/token com `grant_type=client_credentials`<br/>e par\xe2metro `resource`\n    end\n\n    Logto->>Cliente: Retorna token de acesso (JSON Web Token)\n    Cliente->>Recurso de API: Requisi\xe7\xe3o com Bearer token\n    Recurso de API->>Recurso de API: Valida token de acesso\n\n    alt Token \xe9 v\xe1lido\n      Recurso de API->>Cliente: Retorna dados do recurso protegido\n    else Token \xe9 inv\xe1lido\n      Recurso de API->>Cliente: 401 N\xe3o autorizado\n    end"}),"\n",(0,a.jsx)(o.p,{children:(0,a.jsx)(o.em,{children:"Autentica\xe7\xe3o do usu\xe1rio = navegador / aplicativo. M2M = servi\xe7o backend ou script usando credenciais de cliente."})}),"\n",(0,a.jsx)(o.admonition,{type:"note",children:(0,a.jsxs)(o.p,{children:["O par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," deve corresponder exatamente ao identificador da API (indicador de recurso) que voc\xea registrou no Logto."]})}),"\n",(0,a.jsx)(o.h2,{id:"implementation-steps",children:"Etapas de implementa\xe7\xe3o"}),"\n",(0,a.jsx)(o.h3,{id:"register-your-api-resources",children:"Registre seus recursos de API"}),"\n",(0,a.jsxs)(o.ol,{children:["\n",(0,a.jsxs)(o.li,{children:["V\xe1 para ",(0,a.jsx)(s,{to:"/api-resources",children:"Console \u2192 Recursos de API"}),"."]}),"\n",(0,a.jsxs)(o.li,{children:["Crie um novo recurso de API (por exemplo, ",(0,a.jsx)(o.code,{children:"https://api.yourapp.com/org"}),") e defina suas permiss\xf5es (escopos)."]}),"\n"]}),"\n",(0,a.jsxs)(o.p,{children:["Para etapas completas de configura\xe7\xe3o, veja ",(0,a.jsx)(o.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"Definir recursos de API com permiss\xf5es"}),"."]}),"\n",(0,a.jsx)(o.h3,{id:"set-up-global-roles",children:"Configure pap\xe9is globais"}),"\n",(0,a.jsxs)(o.ol,{children:["\n",(0,a.jsxs)(o.li,{children:["V\xe1 para ",(0,a.jsx)(s,{to:"/roles",children:"Console \u2192 Pap\xe9is"}),"."]}),"\n",(0,a.jsxs)(o.li,{children:["Crie pap\xe9is que correspondam \xe0s permiss\xf5es da sua API (por exemplo, ",(0,a.jsx)(o.code,{children:"read:products"}),", ",(0,a.jsx)(o.code,{children:"write:products"}),")."]}),"\n",(0,a.jsx)(o.li,{children:"Atribua esses pap\xe9is a usu\xe1rios ou clientes que precisam de acesso \xe0 API."}),"\n"]}),"\n",(0,a.jsxs)(o.p,{children:["Para etapas completas de configura\xe7\xe3o, veja ",(0,a.jsx)(o.a,{href:"/authorization/role-based-access-control#configure-global-roles",children:"Usar pap\xe9is globais"}),"."]}),"\n",(0,a.jsx)(o.h3,{id:"obtain-access-tokens-for-global-api-resources",children:"Obtenha tokens de acesso para recursos globais de API"}),"\n",(0,a.jsxs)(o.p,{children:["Antes de acessar um recurso global de API, seu cliente deve obter um token de acesso. O Logto emite ",(0,a.jsx)(o.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"})," como tokens de acesso para recursos globais de API. Isso normalmente \xe9 feito usando o ",(0,a.jsx)(o.a,{href:"https://auth.wiki/authorization-code-flow",children:"fluxo de c\xf3digo de autoriza\xe7\xe3o OAuth 2.0"}),", ",(0,a.jsx)(o.a,{href:"https://auth.wiki/refresh-token",children:"fluxo de refresh token"})," ou o ",(0,a.jsx)(o.a,{href:"https://auth.wiki/client-credentials-flow",children:"fluxo de client credentials"}),"."]}),"\n",(0,a.jsx)(o.h4,{id:"authorization-code-or-refresh-token-flow",children:"Fluxo de c\xf3digo de autoriza\xe7\xe3o ou refresh token"}),"\n",(0,a.jsx)(o.p,{children:"Todos os SDKs oficiais do Logto suportam a obten\xe7\xe3o de tokens de acesso para recursos globais de API usando o fluxo de refresh token nativamente. Uma biblioteca padr\xe3o de cliente OAuth 2.0 / OIDC tamb\xe9m pode ser usada para implementar esse fluxo."}),"\n",(0,a.jsxs)(u.A,{groupId:"user-client",children:[(0,a.jsxs)(l.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,a.jsxs)(o.p,{children:["Ao inicializar o cliente Logto, adicione o indicador de recurso ao par\xe2metro ",(0,a.jsx)(o.code,{children:"resources"})," (array), depois adicione as permiss\xf5es desejadas (escopos) ao par\xe2metro ",(0,a.jsx)(o.code,{children:"scopes"}),"."]}),(0,a.jsxs)(o.p,{children:["Uma vez que o usu\xe1rio esteja autenticado, passe o indicador de recurso no par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," ou par\xe2metro de nome similar ao solicitar o token de acesso (por exemplo, ao chamar ",(0,a.jsx)(o.code,{children:"getAccessToken()"}),")."]}),(0,a.jsxs)(o.p,{children:["Para detalhes sobre cada SDK, veja os ",(0,a.jsx)(o.a,{href:"/quick-starts",children:"Comece r\xe1pido"}),"."]})]}),(0,a.jsxs)(l.A,{value:"oauth-client",label:"OAuth 2.0 / OIDC client library",children:[(0,a.jsxs)(o.p,{children:["Ao configurar seu cliente OAuth 2.0 ou inicializar o fluxo de c\xf3digo de autoriza\xe7\xe3o, certifique-se de incluir o par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," e os escopos desejados na solicita\xe7\xe3o de autoriza\xe7\xe3o."]}),(0,a.jsxs)(o.p,{children:["Algumas bibliotecas podem n\xe3o suportar o par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," nativamente, mas geralmente permitem passar par\xe2metros adicionais na solicita\xe7\xe3o de autoriza\xe7\xe3o. Verifique a documenta\xe7\xe3o da sua biblioteca para detalhes."]}),(0,a.jsxs)(o.p,{children:["Aqui est\xe1 um exemplo n\xe3o normativo da solicita\xe7\xe3o de autoriza\xe7\xe3o com os par\xe2metros ",(0,a.jsx)(o.code,{children:"resource"})," e ",(0,a.jsx)(o.code,{children:"scope"}),":"]}),(0,a.jsx)(t.A,{resource:x,scope:"read:products write:products"}),(0,a.jsxs)(o.p,{children:["Uma vez que o usu\xe1rio esteja autenticado, voc\xea receber\xe1 um c\xf3digo de autoriza\xe7\xe3o. Troque esse c\xf3digo por um token de acesso fazendo uma requisi\xe7\xe3o POST para o endpoint ",(0,a.jsx)(o.code,{children:"/oidc/token"})," do Logto, incluindo o par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," no corpo da requisi\xe7\xe3o."]}),(0,a.jsx)(o.p,{children:"Aqui est\xe1 um exemplo n\xe3o normativo da solicita\xe7\xe3o de token usando o tipo de concess\xe3o authorization code:"}),(0,a.jsx)(d.A,{grantType:"authorization_code",resource:x}),(0,a.jsxs)(o.p,{children:["Voc\xea tamb\xe9m pode usar o tipo de concess\xe3o ",(0,a.jsx)(o.code,{children:"refresh_token"})," para obter um novo token de acesso sem intera\xe7\xe3o do usu\xe1rio, desde que o par\xe2metro ",(0,a.jsx)(o.code,{children:"resource"})," seja inclu\xeddo na requisi\xe7\xe3o."]}),(0,a.jsx)(o.p,{children:"Aqui est\xe1 um exemplo n\xe3o normativo da solicita\xe7\xe3o de token usando o tipo de concess\xe3o refresh token:"}),(0,a.jsx)(d.A,{grantType:"refresh_token",resource:x})]})]}),"\n",(0,a.jsx)(o.h4,{id:"client-credentials-flow",children:"Fluxo de client credentials"}),"\n",(0,a.jsxs)(o.p,{children:["Para cen\xe1rios m\xe1quina para m\xe1quina (M2M), voc\xea pode usar o fluxo de client credentials para obter um token de acesso para seu recurso global de API. Fazendo uma requisi\xe7\xe3o POST para o endpoint ",(0,a.jsx)(o.code,{children:"/oidc/token"})," do Logto, voc\xea pode solicitar um token de acesso usando seu client ID e secret."]}),"\n",(0,a.jsx)(o.p,{children:"H\xe1 dois par\xe2metros principais a serem inclu\xeddos na requisi\xe7\xe3o:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"resource"}),": O URI indicador de recurso da API que voc\xea deseja acessar (por exemplo, ",(0,a.jsx)(o.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"scope"}),": As permiss\xf5es que voc\xea deseja solicitar para a API (por exemplo, ",(0,a.jsx)(o.code,{children:"read:products write:products"}),")."]}),"\n"]}),"\n",(0,a.jsx)(o.p,{children:"Aqui est\xe1 um exemplo n\xe3o normativo da solicita\xe7\xe3o de token usando o tipo de concess\xe3o client credentials:"}),"\n",(0,a.jsx)(c.A,{resource:"https://api.yourapp.com",scope:"read:products write:products"}),"\n",(0,a.jsx)(o.h3,{id:"validating-jwt-access-tokens-in-your-api",children:"Validando tokens de acesso JWT em sua API"}),"\n",(0,a.jsx)(o.p,{children:"Os JWTs emitidos pelo Logto cont\xeam reivindica\xe7\xf5es que sua API pode usar para aplicar autoriza\xe7\xe3o."}),"\n",(0,a.jsx)(o.p,{children:"Quando sua API recebe uma requisi\xe7\xe3o com um token de acesso emitido pelo Logto, voc\xea deve:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsx)(o.li,{children:"Verificar a assinatura do token (usando os JWKs do Logto)."}),"\n",(0,a.jsxs)(o.li,{children:["Confirmar que o token n\xe3o est\xe1 expirado (reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"exp"}),")."]}),"\n",(0,a.jsxs)(o.li,{children:["Verificar se o ",(0,a.jsx)(o.code,{children:"iss"})," (emissor) corresponde ao endpoint do seu Logto."]}),"\n",(0,a.jsxs)(o.li,{children:["Garantir que o ",(0,a.jsx)(o.code,{children:"aud"})," (p\xfablico) corresponde ao identificador do recurso de API que voc\xea registrou (por exemplo, ",(0,a.jsx)(o.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,a.jsxs)(o.li,{children:["Separar a reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"scope"})," (separada por espa\xe7o) e verificar as permiss\xf5es necess\xe1rias."]}),"\n"]}),"\n",(0,a.jsxs)(o.p,{children:["Para guias passo a passo e espec\xedficos por linguagem, veja ",(0,a.jsx)(o.a,{href:"/authorization/validate-access-tokens",children:"Como validar tokens de acesso"}),"."]}),"\n",(0,a.jsx)(o.h3,{id:"optional-handle-user-permission-change",children:"Opcional: Lidar com altera\xe7\xe3o de permiss\xe3o do usu\xe1rio"}),"\n",(0,a.jsx)(o.admonition,{type:"info",children:(0,a.jsx)(o.p,{children:"\ud83d\udc77 Trabalho em andamento. \ud83d\udea7"})}),"\n",(0,a.jsx)(o.h2,{id:"best-practices-and-security-tips",children:"Boas pr\xe1ticas e dicas de seguran\xe7a"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Mantenha as permiss\xf5es orientadas ao neg\xf3cio:"})," Use nomes claros que correspondam a a\xe7\xf5es reais."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Mantenha a expira\xe7\xe3o do token curta:"})," Reduz o risco caso um token seja vazado."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Limite os escopos concedidos:"})," D\xea aos tokens apenas as permiss\xf5es realmente necess\xe1rias."]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Use restri\xe7\xe3o de p\xfablico:"})," Sempre verifique a reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"aud"})," para evitar uso indevido."]}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"faqs",children:"Perguntas frequentes"}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(o.h3,{id:"what-if-my-client-doesn-t-support-the-resource-parameter",children:"E se meu cliente n\xe3o suportar o par\xe2metro resource?"})}),(0,a.jsx)(o.p,{children:"Defina um recurso de API padr\xe3o no Console do Logto. Os tokens ter\xe3o esse p\xfablico por padr\xe3o quando nenhum par\xe2metro resource for especificado na solicita\xe7\xe3o de token."})]}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(o.h3,{id:"why-do-i-get-401-unauthorized-from-my-api",children:"Por que recebo 401 N\xe3o autorizado da minha API?"})}),(0,a.jsx)(o.p,{children:"Verifique os seguintes problemas comuns:"}),(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Assinatura do token"}),": Verifique se seu backend est\xe1 buscando os JWKs corretos do Logto"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Expira\xe7\xe3o do token"}),": Certifique-se de que o token n\xe3o expirou (reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"exp"}),")"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"P\xfablico"}),": Confirme se a reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"aud"})," corresponde ao indicador de recurso de API registrado"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.strong,{children:"Escopos necess\xe1rios"}),": Verifique se o token cont\xe9m as permiss\xf5es necess\xe1rias na reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"scope"})]}),"\n"]})]}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(o.h3,{id:"how-do-i-test-without-a-full-client",children:"Como testar sem um cliente completo?"})}),(0,a.jsxs)(o.p,{children:["Use um ",(0,a.jsx)(o.a,{href:"/user-management/personal-access-token",children:"token de acesso pessoal"})," para simular chamadas autenticadas. Isso permite testar seus endpoints de API sem implementar um fluxo OAuth completo em seu aplicativo cliente."]})]}),"\n",(0,a.jsx)(o.h2,{id:"further-reading",children:"Leitura adicional"}),"\n",(0,a.jsx)(p,{href:"/authorization/validate-access-tokens",children:"Como validar tokens de acesso"}),"\n",(0,a.jsx)(p,{href:"/use-cases/authorization/rbac-in-practice",children:(0,a.jsx)(o.p,{children:"RBAC na pr\xe1tica: Implementando autoriza\xe7\xe3o segura para seu aplicativo"})}),"\n",(0,a.jsx)(p,{href:"/developers/custom-token-claims",children:"Personalizando reivindica\xe7\xf5es de token"}),"\n",(0,a.jsx)(p,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Indicadores de Recurso"})]})}function f(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,a.jsx)(o,{...e,children:(0,a.jsx)(j,{...e})}):j(e)}function b(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,o,s)=>{s.d(o,{A:()=>n});var r=s(80173),a=s(25105);const n=e=>{let{resource:o,scope:s}=e;return(0,a.jsx)(r.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${s}\n&resource=${o}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,o,s)=>{s.d(o,{A:()=>n});var r=s(80173),a=s(25105);const n=e=>{let{resource:o,organizationId:s,scope:n}=e;return(0,a.jsxs)(r.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",o&&`&resource=${o}\n`,s&&`&organization_id=${s}\n`,`&scope=${n}\n`]})}},42372:(e,o,s)=>{s.d(o,{A:()=>n});var r=s(80173),a=s(25105);const n=e=>{let{grantType:o,resource:s,organizationId:n}=e;const i=[`grant_type=${o}`,"authorization_code"===o&&"code=authorization-code-received","authorization_code"===o&&"redirect_uri=https://your-app.com/callback","refresh_token"===o&&"refresh_token=your-refresh-token",s&&`resource=${s}`,n&&`organization_id=${n}`].filter(Boolean);return(0,a.jsx)(r.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${i.join("\n&")}`})}},38552:(e,o,s)=>{s.d(o,{A:()=>i});s(58101);var r=s(13526);const a={tabItem:"tabItem_dgSZ"};var n=s(25105);function i(e){let{children:o,hidden:s,className:i}=e;return(0,n.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,i),hidden:s,children:o})}},22002:(e,o,s)=>{s.d(o,{A:()=>k});var r=s(58101),a=s(13526),n=s(60755),i=s(55234),t=s(6635),c=s(4100),d=s(35661),l=s(42752);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:o}=e;return!!o&&"object"==typeof o&&"value"in o}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:o,children:s}=e;return(0,r.useMemo)((()=>{const e=o??function(e){return u(e).map((e=>{let{props:{value:o,label:s,attributes:r,default:a}}=e;return{value:o,label:s,attributes:r,default:a}}))}(s);return function(e){const o=(0,d.XI)(e,((e,o)=>e.value===o.value));if(o.length>0)throw new Error(`Docusaurus error: Duplicate values "${o.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[o,s])}function h(e){let{value:o,tabValues:s}=e;return s.some((e=>e.value===o))}function m(e){let{queryString:o=!1,groupId:s}=e;const a=(0,i.W6)(),n=function(e){let{queryString:o=!1,groupId:s}=e;if("string"==typeof o)return o;if(!1===o)return null;if(!0===o&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:o,groupId:s});return[(0,c.aZ)(n),(0,r.useCallback)((e=>{if(!n)return;const o=new URLSearchParams(a.location.search);o.set(n,e),a.replace({...a.location,search:o.toString()})}),[n,a])]}function x(e){const{defaultValue:o,queryString:s=!1,groupId:a}=e,n=p(e),[i,c]=(0,r.useState)((()=>function(e){let{defaultValue:o,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(o){if(!h({value:o,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${o}" but none of its children has the corresponding value. Available values are: ${s.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return o}const r=s.find((e=>e.default))??s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:o,tabValues:n}))),[d,u]=m({queryString:s,groupId:a}),[x,g]=function(e){let{groupId:o}=e;const s=function(e){return e?`docusaurus.tab.${e}`:null}(o),[a,n]=(0,l.Dv)(s);return[a,(0,r.useCallback)((e=>{s&&n.set(e)}),[s,n])]}({groupId:a}),j=(()=>{const e=d??x;return h({value:e,tabValues:n})?e:null})();(0,t.A)((()=>{j&&c(j)}),[j]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:n}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),g(e)}),[u,g,n]),tabValues:n}}var g=s(21929);const j={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var f=s(25105);function b(e){let{className:o,block:s,selectedValue:r,selectValue:i,tabValues:t}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,n.a_)(),l=e=>{const o=e.currentTarget,s=c.indexOf(o),a=t[s].value;a!==r&&(d(o),i(a))},u=e=>{let o=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const s=c.indexOf(e.currentTarget)+1;o=c[s]??c[0];break}case"ArrowLeft":{const s=c.indexOf(e.currentTarget)-1;o=c[s]??c[c.length-1];break}}o?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":s},o),children:t.map((e=>{let{value:o,label:s,attributes:n}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===o?0:-1,"aria-selected":r===o,ref:e=>{c.push(e)},onKeyDown:u,onClick:l,...n,className:(0,a.A)("tabs__item",j.tabItem,n?.className,{"tabs__item--active":r===o}),children:s??o},o)}))})}function v(e){let{lazy:o,children:s,selectedValue:n}=e;const i=(Array.isArray(s)?s:[s]).filter(Boolean);if(o){const e=i.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,o)=>(0,r.cloneElement)(e,{key:o,hidden:e.props.value!==n})))})}function A(e){const o=x(e);return(0,f.jsxs)("div",{className:(0,a.A)("tabs-container",j.tabList),children:[(0,f.jsx)(b,{...o,...e}),(0,f.jsx)(v,{...o,...e})]})}function k(e){const o=(0,g.A)();return(0,f.jsx)(A,{...e,children:u(e.children)},String(o))}},55138:(e,o,s)=>{s.d(o,{A:()=>x});var r=s(28259),a=s(6097),n=s(58574),i=s(9484),t=s(76566),c=s(26346),d=s(17867),l=s(17510),u=s(13526),p=s(72355);const h={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var m=s(25105);function x(e){let{children:o,className:s="",metastring:x,title:g,showLineNumbers:j,language:f}=e;const{prism:{defaultLanguage:b,magicComments:v}}=(0,r.p)(),A=function(e){return e?.toLowerCase()}(f??(0,n.Op)(s)??b),k=(0,a.A)(),P=(0,i.f)(),I=(0,n.wt)(x)||g,{lineClassNames:z,code:w}=(0,n.Li)(o,{metastring:x,language:A,magicComments:v}),y=j??(0,n._u)(x);return(0,m.jsxs)(t.A,{as:"div",className:(0,u.A)(s,A&&!s.includes(`language-${A}`)&&`language-${A}`),children:[I&&(0,m.jsx)("div",{className:h.codeBlockTitle,children:I}),(0,m.jsxs)("div",{className:h.codeBlockContent,children:[(0,m.jsx)(p.f4,{theme:k,code:w,language:A??"text",children:e=>{let{className:o,tokens:s,getLineProps:r,getTokenProps:a}=e;return(0,m.jsx)("pre",{ref:P.codeBlockRef,tabIndex:0,className:(0,u.A)(o,h.codeBlock,"thin-scrollbar"),children:(0,m.jsx)("code",{className:(0,u.A)(h.codeBlockLines,y&&h.codeBlockLinesWithNumbering),children:s.map(((e,o)=>(0,m.jsx)(d.A,{line:e,getLineProps:r,getTokenProps:a,classNames:z[o],showLineNumbers:y},o)))})})}}),(0,m.jsxs)("div",{className:h.buttonGroup,children:[(P.isEnabled||P.isCodeScrollable)&&(0,m.jsx)(l.A,{className:h.codeButton,isEnabled:P.isEnabled,onClick:()=>{P.toggle()}}),(0,m.jsx)(c.A,{className:h.codeButton,code:w})]})]})]})}},46643:(e,o,s)=>{s.d(o,{A:()=>r});const r=s.p+"assets/images/rbac-global-api-resources-33fafc263308d3f769c62cbcdb8d7829.png"}}]);