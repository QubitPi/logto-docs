"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[2706],{22178:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"end-user-flows/account-settings/by-account-api","title":"Kontoeinstellungen \xfcber die Account API","description":"Erfahre, wie du die Account API zur Verwaltung von Benutzern nutzt","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","sourceDirName":"end-user-flows/account-settings","slug":"/end-user-flows/account-settings/by-account-api","permalink":"/de/end-user-flows/account-settings/by-account-api","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/de/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"description":"Erfahre, wie du die Account API zur Verwaltung von Benutzern nutzt","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Kontoeinstellungen","permalink":"/de/end-user-flows/account-settings/"},"next":{"title":"Kontoeinstellungen \xfcber Management API","permalink":"/de/end-user-flows/account-settings/by-management-api"}}');var t=i(25105),s=i(79621);const a={description:"Erfahre, wie du die Account API zur Verwaltung von Benutzern nutzt",sidebar_position:1},d="Kontoeinstellungen \xfcber die Account API",c={},o=[{value:"Was ist die Logto Account API",id:"what-is-logto-account-api",level:2},{value:"Wie aktiviere ich die Account API",id:"how-to-enable-account-api",level:2},{value:"Wie greife ich auf die Account API zu",id:"how-to-access-account-api",level:2},{value:"Zugangstoken (Access token) abrufen",id:"fetch-an-access-token",level:3},{value:"Zugriff auf die Account API mit Zugangstoken (Access token)",id:"access-account-api-using-access-token",level:3},{value:"Grundlegende Kontoinformationen verwalten",id:"manage-basic-account-information",level:2},{value:"Benutzerkontoinformationen abrufen",id:"retrieve-user-account-information",level:3},{value:"Grundlegende Kontoinformationen aktualisieren",id:"update-basic-account-information",level:3},{value:"Identifikatoren und andere sensible Informationen verwalten",id:"manage-identifiers-and-other-sensitive-information",level:2},{value:"Eine Verifizierungsdatensatz-ID erhalten",id:"get-a-verification-record-id",level:3},{value:"Passwort des Benutzers verifizieren",id:"verify-the-users-password",level:4},{value:"Verifizierungscode an die E-Mail oder das Telefon des Benutzers senden",id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",level:4},{value:"Anfrage mit Verifizierungsdatensatz-ID senden",id:"send-request-with-verification-record-id",level:3},{value:"Passwort des Benutzers aktualisieren",id:"update-users-password",level:3},{value:"Neue E-Mail aktualisieren oder verkn\xfcpfen",id:"update-or-link-new-email",level:3},{value:"E-Mail des Benutzers entfernen",id:"remove-the-users-email",level:3},{value:"Telefon verwalten",id:"manage-phone",level:3},{value:"Neue soziale Verbindung verkn\xfcpfen",id:"link-a-new-social-connection",level:3},{value:"Soziale Verbindung entfernen",id:"remove-a-social-connection",level:3},{value:"Neuen WebAuthn-Passkey verkn\xfcpfen",id:"link-a-new-webauthn-passkey",level:3},{value:"Bestehenden WebAuthn-Passkey verwalten",id:"manage-existing-webauthn-passkey",level:3},{value:"Neues TOTP verkn\xfcpfen",id:"link-a-new-totp",level:3},{value:"Backup-Codes verwalten",id:"manage-backup-codes",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"kontoeinstellungen-\xfcber-die-account-api",children:"Kontoeinstellungen \xfcber die Account API"})}),"\n",(0,t.jsx)(n.h2,{id:"what-is-logto-account-api",children:"Was ist die Logto Account API"}),"\n",(0,t.jsx)(n.p,{children:"Die Logto Account API ist eine umfassende Sammlung von APIs, die Endbenutzern direkten API-Zugang erm\xf6glicht, ohne die Management API verwenden zu m\xfcssen. Hier die wichtigsten Punkte:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Direkter Zugriff: Die Account API erm\xf6glicht es Endbenutzern, direkt auf ihr eigenes Konto-Profil zuzugreifen und dieses zu verwalten, ohne die Weiterleitung \xfcber die Management API zu ben\xf6tigen."}),"\n",(0,t.jsx)(n.li,{children:"Verwaltung von Benutzerprofilen und Identit\xe4ten: Benutzer k\xf6nnen ihre Profile und Sicherheitseinstellungen vollst\xe4ndig verwalten, einschlie\xdflich der M\xf6glichkeit, Identit\xe4tsinformationen wie E-Mail, Telefon und Passwort zu aktualisieren sowie soziale Verbindungen zu verwalten. MFA und SSO-Unterst\xfctzung folgen in K\xfcrze."}),"\n",(0,t.jsx)(n.li,{children:"Globale Zugangskontrolle: Administratoren haben vollst\xe4ndige, globale Kontrolle \xfcber die Zugriffseinstellungen und k\xf6nnen jedes Feld individuell anpassen."}),"\n",(0,t.jsxs)(n.li,{children:["Nahtlose Autorisierung (Authorization): Autorisierung (Authorization) war noch nie so einfach! Verwende einfach ",(0,t.jsx)(n.code,{children:"client.getAccessToken()"}),", um ein opakes Zugangstoken (Opaque token) f\xfcr OP (Logto) zu erhalten, und f\xfcge es dem Authorization-Header als ",(0,t.jsx)(n.code,{children:"Bearer <access_token>"})," hinzu."]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Um sicherzustellen, dass das Zugangstoken (Access token) die entsprechenden Berechtigungen (Permissions) hat, stelle sicher, dass du die entsprechenden Berechtigungen (Scopes) in deiner Logto-Konfiguration korrekt eingerichtet hast."}),(0,t.jsxs)(n.p,{children:["Zum Beispiel ben\xf6tigst du f\xfcr die ",(0,t.jsx)(n.code,{children:"POST /api/my-account/primary-email"})," API die Berechtigung (Scope) ",(0,t.jsx)(n.code,{children:"email"}),"; f\xfcr die ",(0,t.jsx)(n.code,{children:"POST /api/my-account/primary-phone"})," API die Berechtigung (Scope) ",(0,t.jsx)(n.code,{children:"phone"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { type LogtoConfig, UserScope } from '@logto/js';\n\nconst config: LogtoConfig = {\n  // ...weitere Optionen\n  // F\xfcge die passenden Berechtigungen (Scopes) hinzu, die zu deinem Anwendungsfall passen.\n  scopes: [\n    UserScope.Email, // F\xfcr `{POST,DELETE} /api/my-account/primary-email` APIs\n    UserScope.Phone, // F\xfcr `{POST,DELETE} /api/my-account/primary-phone` APIs\n    UserScope.CustomData, // Zur Verwaltung benutzerdefinierter Daten\n    UserScope.Address, // Zur Verwaltung der Adresse\n    UserScope.Identities, // F\xfcr Identit\xe4ts- und MFA-bezogene APIs\n    UserScope.Profile, // Zur Verwaltung des Benutzerprofils\n  ],\n};\n"})})]}),"\n",(0,t.jsx)(n.p,{children:"Mit der Logto Account API kannst du ein individuelles Kontoverwaltungssystem wie eine Profilseite erstellen, das vollst\xe4ndig mit Logto integriert ist."}),"\n",(0,t.jsx)(n.p,{children:"Einige h\xe4ufige Anwendungsf\xe4lle sind unten aufgef\xfchrt:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Benutzerprofil abrufen"}),"\n",(0,t.jsx)(n.li,{children:"Benutzerprofil aktualisieren"}),"\n",(0,t.jsx)(n.li,{children:"Benutzerpasswort aktualisieren"}),"\n",(0,t.jsx)(n.li,{children:"Benutzeridentit\xe4ten wie E-Mail, Telefon und soziale Verbindungen aktualisieren"}),"\n",(0,t.jsx)(n.li,{children:"MFA-Faktoren (Verifizierungen) verwalten"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Um mehr \xfcber die verf\xfcgbaren APIs zu erfahren, besuche bitte die ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-my-account",children:"Logto Account API Referenz"})," und die ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-verifications",children:"Logto Verification API Referenz"}),"."]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:["Dedizierte Account APIs f\xfcr die folgenden Einstellungen erscheinen in K\xfcrze: SSO, Benutzerdefinierte Daten (Custom data) und Kontol\xf6schung. In der Zwischenzeit kannst du diese Funktionen mit den Logto Management APIs umsetzen. Siehe ",(0,t.jsx)(n.a,{href:"/end-user-flows/account-settings/by-management-api",children:"Kontoeinstellungen \xfcber die Management API"})," f\xfcr weitere Details."]}),(0,t.jsxs)(n.p,{children:["MFA-Management-APIs (TOTP und Backup-Codes) befinden sich derzeit in der Entwicklung und sind nur verf\xfcgbar, wenn das Flag ",(0,t.jsx)(n.code,{children:"isDevFeaturesEnabled"})," auf ",(0,t.jsx)(n.code,{children:"true"})," gesetzt ist. WebAuthn-Passkey-Management ist vollst\xe4ndig verf\xfcgbar."]})]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-enable-account-api",children:"Wie aktiviere ich die Account API"}),"\n",(0,t.jsxs)(n.p,{children:["Standardm\xe4\xdfig ist die Account API deaktiviert. Um sie zu aktivieren, musst du die ",(0,t.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," verwenden, um die globalen Einstellungen zu aktualisieren."]}),"\n",(0,t.jsxs)(n.p,{children:["Der API-Endpunkt ",(0,t.jsx)(n.code,{children:"/api/account-center"})," kann verwendet werden, um die Einstellungen des Account Centers abzurufen und zu aktualisieren. Du kannst ihn nutzen, um die Account API zu aktivieren oder zu deaktivieren und die Felder anzupassen."]}),"\n",(0,t.jsx)(n.p,{children:"Beispielanfrage:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/account-center \\\n  -H \'authorization: Bearer <access_token for Logto Management API>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"enabled":true,"fields":{"username":"Edit"}}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Das Feld ",(0,t.jsx)(n.code,{children:"enabled"})," wird verwendet, um die Account API zu aktivieren oder zu deaktivieren, und das Feld ",(0,t.jsx)(n.code,{children:"fields"})," dient zur Anpassung der Felder. Der Wert kann ",(0,t.jsx)(n.code,{children:"Off"}),", ",(0,t.jsx)(n.code,{children:"Edit"}),", ",(0,t.jsx)(n.code,{children:"ReadOnly"})," sein. Der Standardwert ist ",(0,t.jsx)(n.code,{children:"Off"}),". Die Liste der Felder:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),": Das Namensfeld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"avatar"}),": Das Avatar-Feld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"profile"}),": Das Profilfeld, einschlie\xdflich seiner Unterfelder."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"username"}),": Das Benutzername-Feld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"email"}),": Das E-Mail-Feld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"phone"}),": Das Telefonfeld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"password"}),": Das Passwortfeld; beim Abrufen wird ",(0,t.jsx)(n.code,{children:"true"})," zur\xfcckgegeben, wenn der Benutzer ein Passwort gesetzt hat, andernfalls ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"social"}),": Soziale Verbindungen."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"mfa"}),": MFA-Faktoren."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Weitere Details zur API findest du in der ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-account-center",children:"Logto Management API Referenz"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-access-account-api",children:"Wie greife ich auf die Account API zu"}),"\n",(0,t.jsx)(n.h3,{id:"fetch-an-access-token",children:"Zugangstoken (Access token) abrufen"}),"\n",(0,t.jsxs)(n.p,{children:["Nachdem du das SDK in deiner Anwendung eingerichtet hast, kannst du die Methode ",(0,t.jsx)(n.code,{children:"client.getAccessToken()"})," verwenden, um ein Zugangstoken (Access token) abzurufen. Dieses Token ist ein opaker Token (Opaque token), das f\xfcr den Zugriff auf die Account API verwendet werden kann."]}),"\n",(0,t.jsxs)(n.p,{children:["Wenn du das offizielle SDK nicht verwendest, solltest du das Feld ",(0,t.jsx)(n.code,{children:"resource"})," f\xfcr die Access Token Grant-Anfrage an ",(0,t.jsx)(n.code,{children:"/oidc/token"})," leer lassen."]}),"\n",(0,t.jsx)(n.h3,{id:"access-account-api-using-access-token",children:"Zugriff auf die Account API mit Zugangstoken (Access token)"}),"\n",(0,t.jsxs)(n.p,{children:["Du solltest das Zugangstoken (Access token) im ",(0,t.jsx)(n.code,{children:"Authorization"}),"-Feld der HTTP-Header im Bearer-Format (",(0,t.jsx)(n.code,{children:"Bearer YOUR_TOKEN"}),") einf\xfcgen, wenn du mit der Account API interagierst."]}),"\n",(0,t.jsx)(n.p,{children:"Hier ein Beispiel, um die Benutzerkontoinformationen abzurufen:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"manage-basic-account-information",children:"Grundlegende Kontoinformationen verwalten"}),"\n",(0,t.jsx)(n.h3,{id:"retrieve-user-account-information",children:"Benutzerkontoinformationen abrufen"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "...",\n  "username": "...",\n  "name": "...",\n  "avatar": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwortfelder k\xf6nnen je nach Account Center-Einstellungen variieren."}),"\n",(0,t.jsx)(n.h3,{id:"update-basic-account-information",children:"Grundlegende Kontoinformationen aktualisieren"}),"\n",(0,t.jsx)(n.p,{children:"Grundlegende Kontoinformationen umfassen Benutzername, Name, Avatar und Profil."}),"\n",(0,t.jsxs)(n.p,{children:["Um Benutzername, Name und Avatar zu aktualisieren, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account"})," verwenden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"username":"...","name":"...","avatar":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Um das Profil zu aktualisieren, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account/profile"})," verwenden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account/profile \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"familyName":"...","givenName":"..."}\'\n'})}),"\n",(0,t.jsx)(n.h2,{id:"manage-identifiers-and-other-sensitive-information",children:"Identifikatoren und andere sensible Informationen verwalten"}),"\n",(0,t.jsx)(n.p,{children:"Aus Sicherheitsgr\xfcnden erfordert die Account API eine zus\xe4tzliche Autorisierungsebene f\xfcr Vorg\xe4nge, die Identifikatoren und andere sensible Informationen betreffen."}),"\n",(0,t.jsx)(n.h3,{id:"get-a-verification-record-id",children:"Eine Verifizierungsdatensatz-ID erhalten"}),"\n",(0,t.jsx)(n.p,{children:"Zuerst musst du eine Verifizierungsdatensatz-ID erhalten. Diese kann verwendet werden, um die Identit\xe4t des Benutzers beim Aktualisieren von Identifikatoren zu verifizieren."}),"\n",(0,t.jsx)(n.p,{children:"Um eine Verifizierungsdatensatz-ID zu erhalten, kannst du das Passwort des Benutzers verifizieren oder einen Verifizierungscode an die E-Mail oder das Telefon des Benutzers senden."}),"\n",(0,t.jsxs)(n.p,{children:["Weitere Informationen zu Verifizierungen findest du unter ",(0,t.jsx)(n.a,{href:"/end-user-flows/security-verification",children:"Sicherheitsverifizierung \xfcber die Account API"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"verify-the-users-password",children:"Passwort des Benutzers verifizieren"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/password \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"password\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",children:"Verifizierungscode an die E-Mail oder das Telefon des Benutzers senden"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du den ",(0,t.jsx)(n.a,{href:"/connectors/email-connectors/",children:"E-Mail-Connector konfigurieren"})," oder den ",(0,t.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"SMS-Connector konfigurieren"})," und sicherstellen, dass die ",(0,t.jsx)(n.code,{children:"UserPermissionValidation"}),"-Vorlage eingerichtet ist."]})}),"\n",(0,t.jsx)(n.p,{children:"Am Beispiel E-Mail: Fordere einen neuen Verifizierungscode an und erhalte die Verifizierungsdatensatz-ID:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Nach Erhalt des Verifizierungscodes kannst du ihn verwenden, um den Verifizierungsstatus des Verifizierungsdatensatzes zu aktualisieren."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"123456"}\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"Nach der Verifizierung des Codes kannst du nun die Verifizierungsdatensatz-ID verwenden, um den Identifikator des Benutzers zu aktualisieren."}),"\n",(0,t.jsx)(n.h3,{id:"send-request-with-verification-record-id",children:"Anfrage mit Verifizierungsdatensatz-ID senden"}),"\n",(0,t.jsxs)(n.p,{children:["Wenn du eine Anfrage zum Aktualisieren des Benutzeridentifikators sendest, musst du die Verifizierungsdatensatz-ID im Request-Header mit dem Feld ",(0,t.jsx)(n.code,{children:"logto-verification-id"})," angeben."]}),"\n",(0,t.jsx)(n.h3,{id:"update-users-password",children:"Passwort des Benutzers aktualisieren"}),"\n",(0,t.jsxs)(n.p,{children:["Um das Passwort des Benutzers zu aktualisieren, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"POST /api/my-account/password"})," verwenden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/password \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"password\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"update-or-link-new-email",children:"Neue E-Mail aktualisieren oder verkn\xfcpfen"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du den ",(0,t.jsx)(n.a,{href:"/connectors/email-connectors/",children:"E-Mail-Connector konfigurieren"})," und sicherstellen, dass die ",(0,t.jsx)(n.code,{children:"BindNewIdentifier"}),"-Vorlage eingerichtet ist."]})}),"\n",(0,t.jsx)(n.p,{children:"Um eine neue E-Mail zu aktualisieren oder zu verkn\xfcpfen, musst du zun\xe4chst den Besitz der E-Mail nachweisen."}),"\n",(0,t.jsxs)(n.p,{children:["Rufe den Endpunkt ",(0,t.jsx)(n.code,{children:"POST /api/verifications/verification-code"})," auf, um einen Verifizierungscode anzufordern."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Du findest eine ",(0,t.jsx)(n.code,{children:"verificationId"})," in der Antwort und erh\xe4ltst einen Verifizierungscode per E-Mail. Verwende diesen, um die E-Mail zu verifizieren."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Nach der Verifizierung des Codes kannst du nun die E-Mail des Benutzers aktualisieren. Setze die ",(0,t.jsx)(n.code,{children:"verificationId"})," im Request-Body als ",(0,t.jsx)(n.code,{children:"newIdentifierVerificationRecordId"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"email\":\"...\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remove-the-users-email",children:"E-Mail des Benutzers entfernen"}),"\n",(0,t.jsxs)(n.p,{children:["Um die E-Mail des Benutzers zu entfernen, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/primary-email"})," verwenden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"manage-phone",children:"Telefon verwalten"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du den ",(0,t.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"SMS-Connector konfigurieren"})," und sicherstellen, dass die ",(0,t.jsx)(n.code,{children:"BindNewIdentifier"}),"-Vorlage eingerichtet ist."]})}),"\n",(0,t.jsxs)(n.p,{children:["\xc4hnlich wie beim Aktualisieren der E-Mail kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account/primary-phone"})," verwenden, um ein neues Telefon zu aktualisieren oder zu verkn\xfcpfen. Und den Endpunkt ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/primary-phone"}),", um das Telefon des Benutzers zu entfernen."]}),"\n",(0,t.jsx)(n.h3,{id:"link-a-new-social-connection",children:"Neue soziale Verbindung verkn\xfcpfen"}),"\n",(0,t.jsx)(n.p,{children:"Um eine neue soziale Verbindung zu verkn\xfcpfen, solltest du zun\xe4chst eine Autorisierungs-URL anfordern:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorId":"...","redirectUri":"...","state":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"connectorId"}),": Die ID des ",(0,t.jsx)(n.a,{href:"/connectors/social-connectors/",children:"Social Connectors"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"redirectUri"}),": Die Redirect-URI nach der Autorisierung der Anwendung durch den Benutzer. Du solltest eine Webseite unter dieser URL hosten und den Callback abfangen."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"state"}),": Der State, der nach der Autorisierung der Anwendung durch den Benutzer zur\xfcckgegeben wird. Es handelt sich um einen zuf\xe4lligen String, der zur Verhinderung von CSRF-Angriffen verwendet wird."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["In der Antwort findest du eine ",(0,t.jsx)(n.code,{children:"verificationRecordId"}),", bewahre sie f\xfcr die sp\xe4tere Verwendung auf."]}),"\n",(0,t.jsxs)(n.p,{children:["Nachdem der Benutzer die Anwendung autorisiert hat, erh\xe4ltst du einen Callback an der ",(0,t.jsx)(n.code,{children:"redirectUri"})," mit dem Parameter ",(0,t.jsx)(n.code,{children:"state"}),". Dann kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"POST /api/verifications/social/verify"})," verwenden, um die soziale Verbindung zu verifizieren."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorData":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Das ",(0,t.jsx)(n.code,{children:"connectorData"})," sind die Daten, die vom Social Connector nach der Autorisierung der Anwendung durch den Benutzer zur\xfcckgegeben werden. Du musst die Query-Parameter aus der ",(0,t.jsx)(n.code,{children:"redirectUri"})," auf deiner Callback-Seite extrahieren und sie als JSON im Feld ",(0,t.jsx)(n.code,{children:"connectorData"})," \xfcbergeben."]}),"\n",(0,t.jsxs)(n.p,{children:["Abschlie\xdfend kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"POST /api/my-account/identities"})," verwenden, um die soziale Verbindung zu verkn\xfcpfen."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/identities \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remove-a-social-connection",children:"Soziale Verbindung entfernen"}),"\n",(0,t.jsxs)(n.p,{children:["Um eine soziale Verbindung zu entfernen, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/identities"})," verwenden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/identities/[connector_target_id] \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"link-a-new-webauthn-passkey",children:"Neuen WebAuthn-Passkey verkn\xfcpfen"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Denke daran, zuerst ",(0,t.jsx)(n.a,{href:"/end-user-flows/mfa",children:"MFA und WebAuthn zu aktivieren"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du das Feld ",(0,t.jsx)(n.code,{children:"mfa"})," in den Account Center-Einstellungen aktivieren."]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 0: F\xfcge den Origin deiner Frontend-App zu den zugeh\xf6rigen Origins hinzu."})}),"\n",(0,t.jsx)(n.p,{children:"Ein Passkey im Browser ist an einen bestimmten Hostnamen (RP ID) gebunden, und nur der Origin der RP ID kann verwendet werden, um einen Passkey zu registrieren oder zu verifizieren. Da deine Frontend-App, die die Anfrage an die Account API sendet, nicht dieselbe ist wie die Logto-Anmeldeseite, musst du den Origin deiner Frontend-App zur Liste der zugeh\xf6rigen Origins hinzuf\xfcgen. Dadurch kann deine Frontend-App einen Passkey unter anderen RP IDs registrieren und verifizieren."}),"\n",(0,t.jsxs)(n.p,{children:["Standardm\xe4\xdfig setzt Logto die RP ID auf die Tenant-Domain, z. B. wenn deine Tenant-Domain ",(0,t.jsx)(n.code,{children:"https://example.logto.app"})," ist, ist die RP ID ",(0,t.jsx)(n.code,{children:"example.logto.app"}),". Wenn du eine eigene Domain verwendest, ist die RP ID die eigene Domain, z. B. bei ",(0,t.jsx)(n.code,{children:"https://auth.example.com"})," ist die RP ID ",(0,t.jsx)(n.code,{children:"auth.example.com"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["F\xfcge nun den Origin deiner Frontend-App zu den zugeh\xf6rigen Origins hinzu, z. B. wenn der Origin deiner Frontend-App ",(0,t.jsx)(n.code,{children:"https://account.example.com"})," ist:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/webauthn-connectors \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"webauthnRelatedOrigins\":[\"https://account.example.com\"]}'\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Weitere Informationen zu den zugeh\xf6rigen Origins findest du in der ",(0,t.jsx)(n.a,{href:"https://passkeys.dev/docs/advanced/related-origins/",children:"Related Origin Requests"})," Dokumentation."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 1: Neue Registrierungsoptionen anfordern."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Du erh\xe4ltst eine Antwort wie:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "registrationOptions": "...",\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 2: Passkey im lokalen Browser registrieren."})}),"\n",(0,t.jsxs)(n.p,{children:["Am Beispiel von ",(0,t.jsx)(n.a,{href:"https://simplewebauthn.dev/",children:(0,t.jsx)(n.code,{children:"@simplewebauthn/browser"})})," kannst du die Funktion ",(0,t.jsx)(n.code,{children:"startRegistration"})," verwenden, um den Passkey im lokalen Browser zu registrieren."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { startRegistration } from '@simplewebauthn/browser';\n\n// ...\nconst response = await startRegistration({\n  optionsJSON: registrationOptions, // Die vom Server in Schritt 1 zur\xfcckgegebenen Daten\n});\n// Speichere die Antwort f\xfcr die sp\xe4tere Verwendung\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 3: Passkey verifizieren."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"payload":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"payload"}),": Die Antwort aus dem lokalen Browser in Schritt 2."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verificationRecordId"}),": Die vom Server in Schritt 1 zur\xfcckgegebene Verifizierungsdatensatz-ID."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 4: Abschlie\xdfend kannst du den Passkey verkn\xfcpfen."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"type\":\"WebAuthn\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verification_record_id"}),": Eine g\xfcltige Verifizierungsdatensatz-ID, die durch die Verifizierung des bestehenden Faktors des Benutzers gew\xe4hrt wurde. Weitere Details findest du im Abschnitt ",(0,t.jsx)(n.a,{href:"#get-a-verification-record-id",children:"Eine Verifizierungsdatensatz-ID erhalten"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),": Der Typ des MFA-Faktors, aktuell wird nur ",(0,t.jsx)(n.code,{children:"WebAuthn"})," unterst\xfctzt."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"newIdentifierVerificationRecordId"}),": Die vom Server in Schritt 1 zur\xfcckgegebene Verifizierungsdatensatz-ID."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"manage-existing-webauthn-passkey",children:"Bestehenden WebAuthn-Passkey verwalten"}),"\n",(0,t.jsxs)(n.p,{children:["Um einen bestehenden WebAuthn-Passkey zu verwalten, kannst du den Endpunkt ",(0,t.jsx)(n.code,{children:"GET /api/my-account/mfa-verifications"})," verwenden, um aktuelle Passkeys und andere MFA-Verifizierungsfaktoren abzurufen."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "id": "...",\n    "type": "WebAuthn",\n    "name": "...",\n    "agent": "...",\n    "createdAt": "...",\n    "updatedAt": "..."\n  }\n]\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"}),": Die ID der Verifizierung."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),": Der Typ der Verifizierung, ",(0,t.jsx)(n.code,{children:"WebAuthn"})," f\xfcr WebAuthn-Passkey."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),": Der Name des Passkeys, optionales Feld."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"agent"}),": Der User Agent des Passkeys."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Passkey-Namen aktualisieren:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId}/name \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"name\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Passkey l\xf6schen:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId} \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"link-a-new-totp",children:"Neues TOTP verkn\xfcpfen"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Denke daran, zuerst ",(0,t.jsx)(n.a,{href:"/end-user-flows/mfa",children:"MFA und TOTP zu aktivieren"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du das Feld ",(0,t.jsx)(n.code,{children:"mfa"})," in den Account Center-Einstellungen aktivieren."]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 1: TOTP-Secret generieren."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications/totp-secret/generate \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "secret": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 2: TOTP-Secret dem Benutzer anzeigen."})}),"\n",(0,t.jsx)(n.p,{children:"Verwende das Secret, um einen QR-Code zu generieren oder zeige es dem Benutzer direkt an. Der Benutzer sollte es zu seiner Authenticator-App (wie Google Authenticator, Microsoft Authenticator oder Authy) hinzuf\xfcgen."}),"\n",(0,t.jsx)(n.p,{children:"Das URI-Format f\xfcr den QR-Code sollte sein:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"otpauth://totp/[Issuer]:[Account]?secret=[Secret]&issuer=[Issuer]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Beispiel:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"otpauth://totp/YourApp:user@example.com?secret=JBSWY3DPEHPK3PXP&issuer=YourApp\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 3: TOTP-Faktor binden."})}),"\n",(0,t.jsx)(n.p,{children:"Nachdem der Benutzer das Secret zu seiner Authenticator-App hinzugef\xfcgt hat, muss er es verifizieren und an sein Konto binden:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"type\":\"Totp\",\"secret\":\"...\"}'\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verification_record_id"}),": Eine g\xfcltige Verifizierungsdatensatz-ID, die durch die Verifizierung des bestehenden Faktors des Benutzers gew\xe4hrt wurde. Weitere Details findest du im Abschnitt ",(0,t.jsx)(n.a,{href:"#get-a-verification-record-id",children:"Eine Verifizierungsdatensatz-ID erhalten"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),": Muss ",(0,t.jsx)(n.code,{children:"Totp"})," sein."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"secret"}),": Das in Schritt 1 generierte TOTP-Secret."]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Ein Benutzer kann nur einen TOTP-Faktor gleichzeitig haben. Wenn der Benutzer bereits einen TOTP-Faktor hat, f\xfchrt der Versuch, einen weiteren hinzuzuf\xfcgen, zu einem 422-Fehler."})}),"\n",(0,t.jsx)(n.h3,{id:"manage-backup-codes",children:"Backup-Codes verwalten"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Denke daran, zuerst ",(0,t.jsx)(n.a,{href:"/end-user-flows/mfa",children:"MFA und Backup-Codes zu aktivieren"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Um diese Methode zu verwenden, musst du das Feld ",(0,t.jsx)(n.code,{children:"mfa"})," in den Account Center-Einstellungen aktivieren."]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 1: Neue Backup-Codes generieren:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications/backup-codes/generate \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "codes": ["...", "...", "..."]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 2: Backup-Codes dem Benutzer anzeigen:"})}),"\n",(0,t.jsxs)(n.admonition,{type:"important",children:[(0,t.jsx)(n.p,{children:"Bevor du die Backup-Codes an das Benutzerkonto bindest, musst du sie dem Benutzer anzeigen und ihn anweisen:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Lade diese Codes sofort herunter oder schreibe sie auf"}),"\n",(0,t.jsx)(n.li,{children:"Bewahre sie an einem sicheren Ort auf"}),"\n",(0,t.jsx)(n.li,{children:"Verstehe, dass jeder Code nur einmal verwendet werden kann"}),"\n",(0,t.jsx)(n.li,{children:"Wisse, dass diese Codes die letzte Rettung sind, falls der Zugriff auf die prim\xe4ren MFA-Methoden verloren geht"}),"\n"]}),(0,t.jsx)(n.p,{children:"Du solltest die Codes in einem klaren, einfach zu kopierenden Format anzeigen und eine Download-Option (z. B. als Textdatei oder PDF) anbieten."})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schritt 3: Backup-Codes an das Benutzerkonto binden:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'logto-verification-id: <verification_record_id>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"type":"BackupCode","codes":["...","...","..."]}\'\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verification_record_id"}),": Eine g\xfcltige Verifizierungsdatensatz-ID, die durch die Verifizierung des bestehenden Faktors des Benutzers gew\xe4hrt wurde. Weitere Details findest du im Abschnitt ",(0,t.jsx)(n.a,{href:"#get-a-verification-record-id",children:"Eine Verifizierungsdatensatz-ID erhalten"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),": Muss ",(0,t.jsx)(n.code,{children:"BackupCode"})," sein."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"codes"}),": Das Array der in Schritt 1 generierten Backup-Codes."]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ein Benutzer kann nur einen Satz Backup-Codes gleichzeitig haben. Wenn alle Codes verwendet wurden, muss der Benutzer neue Codes generieren und binden."}),"\n",(0,t.jsx)(n.li,{children:"Backup-Codes k\xf6nnen nicht der einzige MFA-Faktor sein. Der Benutzer muss mindestens einen weiteren MFA-Faktor (wie WebAuthn oder TOTP) aktiviert haben."}),"\n",(0,t.jsx)(n.li,{children:"Jeder Backup-Code kann nur einmal verwendet werden."}),"\n"]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Vorhandene Backup-Codes anzeigen:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account/mfa-verifications/backup-codes \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort sieht beispielsweise so aus:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "codes": [\n    {\n      "code": "...",\n      "usedAt": null\n    },\n    {\n      "code": "...",\n      "usedAt": "2024-01-15T10:30:00.000Z"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"code"}),": Der Backup-Code."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"usedAt"}),": Der Zeitstempel, wann der Code verwendet wurde, ",(0,t.jsx)(n.code,{children:"null"}),", wenn noch nicht verwendet."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},79621:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var r=i(58101);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);