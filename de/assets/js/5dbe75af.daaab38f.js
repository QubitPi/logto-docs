"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[5046],{50060:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>p,contentTitle:()=>g,default:()=>j,frontMatter:()=>h,metadata:()=>r,resource:()=>m,toc:()=>f});const r=JSON.parse('{"id":"authorization/global-api-resources","title":"Globale API-Ressourcen sch\xfctzen","description":"Sch\xfctze produktweite APIs mit rollenbasierter Zugangskontrolle (RBAC) in Logto. Weise globale Rollen und Berechtigungen zu, um den Zugriff f\xfcr alle Benutzer und Clients in deiner Anwendung zu steuern.","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","sourceDirName":"authorization","slug":"/authorization/global-api-resources","permalink":"/de/authorization/global-api-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/de/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Organisationstemplate","permalink":"/de/authorization/organization-template"},"next":{"title":"Organisation (Nicht-API) Berechtigungen sch\xfctzen","permalink":"/de/authorization/organization-permissions"}}');var t=i(25105),s=i(79621),o=i(46643),l=i(39088),a=i(78506),d=i(42372),c=i(38552),u=i(22002);const h={sidebar_position:3},g="Globale API-Ressourcen sch\xfctzen",p={},m="https://api.your-app.com",f=[{value:"Was sind globale API-Ressourcen?",id:"what-are-global-api-resources",level:2},{value:"So funktioniert es in Logto",id:"how-it-works-in-logto",level:2},{value:"\xdcberblick \xfcber die Implementierung",id:"implementation-overview",level:3},{value:"Ressourcenindikatoren verstehen",id:"understanding-resource-indicators",level:3},{value:"Autorisierungsfluss: Authentifizierung und Absicherung deiner API",id:"authorization-flow-authenticating-and-securing-your-api",level:3},{value:"Umsetzungsschritte",id:"implementation-steps",level:2},{value:"Registriere deine API-Ressourcen",id:"register-your-api-resources",level:3},{value:"Richte globale Rollen ein",id:"set-up-global-roles",level:3},{value:"Zugangstokens f\xfcr globale API-Ressourcen erhalten",id:"obtain-access-tokens-for-global-api-resources",level:3},{value:"Authorization Code oder Auffrischungstoken-Flow",id:"authorization-code-or-refresh-token-flow",level:4},{value:"Client-Credentials-Flow",id:"client-credentials-flow",level:4},{value:"JWT-Zugangstokens in deiner API validieren",id:"validating-jwt-access-tokens-in-your-api",level:3},{value:"Optional: Benutzerberechtigungs\xe4nderung behandeln",id:"optional-handle-user-permission-change",level:3},{value:"Best Practices und Sicherheitstipps",id:"best-practices-and-security-tips",level:2},{value:"FAQs",id:"faqs",level:2},{value:"Was, wenn mein Client den resource-Parameter nicht unterst\xfctzt?",id:"what-if-my-client-doesn-t-support-the-resource-parameter",level:3},{value:"Warum erhalte ich 401 Nicht autorisiert von meiner API?",id:"why-do-i-get-401-unauthorized-from-my-api",level:3},{value:"Wie kann ich ohne vollst\xe4ndigen Client testen?",id:"how-do-i-test-without-a-full-client",level:3},{value:"Weiterf\xfchrende Literatur",id:"further-reading",level:2}];function x(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{CloudLink:i,Details:r,Url:h}=n;return i||b("CloudLink",!0),r||b("Details",!0),h||b("Url",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"globale-api-ressourcen-sch\xfctzen",children:"Globale API-Ressourcen sch\xfctzen"})}),"\n","\n",(0,t.jsx)(n.p,{children:"Sch\xfctze produktweite APIs mit rollenbasierter Zugangskontrolle (RBAC) in Logto. Weise globale Rollen und Berechtigungen zu, um den Zugriff f\xfcr alle Benutzer und Clients in deiner Anwendung zu steuern."}),"\n",(0,t.jsx)(n.h2,{id:"what-are-global-api-resources",children:"Was sind globale API-Ressourcen?"}),"\n",(0,t.jsx)(n.p,{children:"Globale API-Ressourcen sind Endpunkte oder Dienste in deiner Anwendung, die f\xfcr alle Benutzer zug\xe4nglich sind, unabh\xe4ngig von Organisation oder Mandant. Dies sind typischerweise \xf6ffentlich zug\xe4ngliche APIs, zentrale Produktdienste oder jeder Endpunkt, der nicht auf eine bestimmte Organisation beschr\xe4nkt ist."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Anwendungsf\xe4lle umfassen"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\xd6ffentliche APIs oder Endpunkte, die von deiner gesamten Benutzerbasis geteilt werden."}),"\n",(0,t.jsx)(n.li,{children:"Microservices, die nicht an Multi-Tenancy gebunden sind."}),"\n",(0,t.jsxs)(n.li,{children:["Zentrale Anwendungs-APIs (z. B. ",(0,t.jsx)(n.code,{children:"/api/users"}),", ",(0,t.jsx)(n.code,{children:"/api/products"}),"), die von allen Kunden genutzt werden."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Logto erm\xf6glicht es dir, diese APIs mit OAuth 2.1 in Kombination mit flexibler, rollenbasierter Zugangskontrolle abzusichern."}),"\n",(0,t.jsx)(n.h2,{id:"how-it-works-in-logto",children:"So funktioniert es in Logto"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"API-Ressourcen und Berechtigungen werden global registriert:"})," Jede API, die du sch\xfctzen m\xf6chtest, wird mit einem eindeutigen Ressourcenindikator (URI) und einem Satz von Berechtigungen (Scopes) definiert, die den Zugriff steuern."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Der Zugriff wird durch globale Rollen gesteuert:"})," Du kannst Berechtigungen Rollen zuweisen, die dann Benutzern oder Clients zugewiesen werden."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Getrennt von organisationsbezogenen Berechtigungen:"})," Globale API-Ressourcen haben keinen Organisationskontext. Sie k\xf6nnen jedoch in Verbindung mit Organisationsrollen verwendet werden, um bei Bedarf eine zus\xe4tzliche Kontextebene bereitzustellen. Um organisationsbezogene APIs zu sch\xfctzen, siehe ",(0,t.jsx)(n.a,{href:"/authorization/organization-level-api-resources",children:"Organisationsbezogene API-Ressourcen sch\xfctzen"}),"."]}),"\n"]}),"\n",(0,t.jsx)("img",{src:o.A,alt:"Globale API-Ressourcen RBAC",style:{maxWidth:"100%"}}),"\n",(0,t.jsx)(n.h3,{id:"implementation-overview",children:"\xdcberblick \xfcber die Implementierung"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Registriere deine API-Ressource"})," und definiere deren Berechtigungen in Logto."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Definiere Rollen"})," mit den notwendigen Berechtigungen f\xfcr den Zugriff auf die API."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Weise Rollen"})," Benutzern oder Clients zu."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nutze OAuth 2.0 Autorisierungsfl\xfcsse"}),", um Zugangstokens f\xfcr die API zu erhalten (der resource-Parameter muss mit dem registrierten API-Identifier \xfcbereinstimmen)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validiere Zugangstokens"})," in deiner API, um Berechtigungen durchzusetzen."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"understanding-resource-indicators",children:"Ressourcenindikatoren verstehen"}),"\n",(0,t.jsxs)(n.p,{children:["Logto modelliert API-Ressourcen gem\xe4\xdf ",(0,t.jsx)(n.a,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Resource Indicators for OAuth 2.0"}),". Ein ",(0,t.jsx)(n.strong,{children:"Ressourcenindikator"})," ist eine URI, die die angeforderte Ziel-API oder den Dienst eindeutig identifiziert."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Wichtige Punkte"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Ressourcenindikatoren m\xfcssen absolute URIs sein (z. B. ",(0,t.jsx)(n.code,{children:"https://api.example.com"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Kein Fragmentbestandteil; vermeide nach M\xf6glichkeit die Verwendung von Query-Strings."}),"\n",(0,t.jsx)(n.li,{children:"Ressourcenindikatoren erm\xf6glichen zielgruppenbeschr\xe4nkte Tokens und unterst\xfctzen Multi-API-Architekturen."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Beispiel"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Management API: ",(0,t.jsx)(n.code,{children:"https://my-tenant.logto.app/api"})]}),"\n",(0,t.jsxs)(n.li,{children:["Benutzerdefinierte globale API: ",(0,t.jsx)(n.code,{children:"https://api.yourapp.com"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"authorization-flow-authenticating-and-securing-your-api",children:"Autorisierungsfluss: Authentifizierung und Absicherung deiner API"}),"\n",(0,t.jsx)(n.p,{children:"Der folgende Ablauf gilt sowohl f\xfcr interaktive Benutzer-Authentifizierung (Browser / App) als auch f\xfcr Backend-Maschine-zu-Maschine (M2M)-Szenarien."}),"\n",(0,t.jsx)(n.p,{children:"Bitte beachte, dass der Ablauf keine vollst\xe4ndigen Details zu den erforderlichen Parametern oder Headern enth\xe4lt, sondern sich auf die wichtigsten Schritte konzentriert. Lies weiter, um zu sehen, wie der Ablauf in der Praxis funktioniert."}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Logto\n    participant API as API-Ressource\n\n    alt Benutzer-Authentifizierung\n        Client->>Logto: GET /oidc/auth\n        Logto->>Logto: Leitet Benutzer zur Anmeldeseite weiter\n        Logto->>Client: Leitet zur\xfcck mit `authorization_code`\n        alt Verwende authorization_code grant\n            Client->>Logto: POST /oidc/token mit `grant_type=authorization_code`<br/>und `resource`-Parameter\n        else Verwende refresh_token grant\n            Client->>Logto: POST /oidc/token mit `grant_type=authorization_code`\n            Logto->>Client: Gibt Auffrischungstoken zur\xfcck\n            Client->>Logto: POST /oidc/token mit `grant_type=refresh_token`<br/>und `resource`-Parameter\n        end\n    else Maschine-zu-Maschine (M2M) Client-Authentifizierung\n        Client->>Logto: POST /oidc/token mit `grant_type=client_credentials`<br/>und `resource`-Parameter\n    end\n\n    Logto->>Client: Gibt Zugangstoken (JSON Web Token) zur\xfcck\n    Client->>API: Anfrage mit Bearer-Token\n    API->>API: Validiert Zugangstoken\n\n    alt Token ist g\xfcltig\n      API->>Client: Gibt gesch\xfctzte Ressourcendaten zur\xfcck\n    else Token ist ung\xfcltig\n      API->>Client: 401 Nicht autorisiert\n    end"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Benutzer-Authentifizierung = Browser / App. M2M = Backend-Dienst oder Skript mit Client-Credentials."})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Der ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter muss exakt mit dem API-Identifier (Ressourcenindikator) \xfcbereinstimmen, den du in Logto registriert hast."]})}),"\n",(0,t.jsx)(n.h2,{id:"implementation-steps",children:"Umsetzungsschritte"}),"\n",(0,t.jsx)(n.h3,{id:"register-your-api-resources",children:"Registriere deine API-Ressourcen"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Gehe zu ",(0,t.jsx)(i,{to:"/api-resources",children:"Konsole \u2192 API-Ressourcen"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Erstelle eine neue API-Ressource (z. B. ",(0,t.jsx)(n.code,{children:"https://api.yourapp.com/org"}),") und definiere deren Berechtigungen (Scopes)."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["F\xfcr vollst\xe4ndige Konfigurationsschritte siehe ",(0,t.jsx)(n.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"API-Ressourcen mit Berechtigungen definieren"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"set-up-global-roles",children:"Richte globale Rollen ein"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Gehe zu ",(0,t.jsx)(i,{to:"/roles",children:"Konsole \u2192 Rollen"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Erstelle Rollen, die deinen API-Berechtigungen entsprechen (z. B. ",(0,t.jsx)(n.code,{children:"read:products"}),", ",(0,t.jsx)(n.code,{children:"write:products"}),")."]}),"\n",(0,t.jsx)(n.li,{children:"Weise diese Rollen Benutzern oder Clients zu, die Zugriff auf die API ben\xf6tigen."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["F\xfcr vollst\xe4ndige Konfigurationsschritte siehe ",(0,t.jsx)(n.a,{href:"/authorization/role-based-access-control#configure-global-roles",children:"Globale Rollen verwenden"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"obtain-access-tokens-for-global-api-resources",children:"Zugangstokens f\xfcr globale API-Ressourcen erhalten"}),"\n",(0,t.jsxs)(n.p,{children:["Bevor du auf eine globale API-Ressource zugreifst, muss dein Client ein Zugangstoken erhalten. Logto stellt ",(0,t.jsx)(n.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWTs)"})," als Zugangstokens f\xfcr globale API-Ressourcen aus. Dies geschieht typischerweise \xfcber den ",(0,t.jsx)(n.a,{href:"https://auth.wiki/authorization-code-flow",children:"OAuth 2.0 Authorization Code Flow"}),", ",(0,t.jsx)(n.a,{href:"https://auth.wiki/refresh-token",children:"Auffrischungstoken-Flow"})," oder den ",(0,t.jsx)(n.a,{href:"https://auth.wiki/client-credentials-flow",children:"Client-Credentials-Flow"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"authorization-code-or-refresh-token-flow",children:"Authorization Code oder Auffrischungstoken-Flow"}),"\n",(0,t.jsx)(n.p,{children:"Alle offiziellen Logto SDKs unterst\xfctzen das Abrufen von Zugangstokens f\xfcr globale API-Ressourcen mit dem Auffrischungstoken-Flow direkt. Eine Standard-OAuth 2.0 / OIDC-Clientbibliothek kann ebenfalls verwendet werden, um diesen Flow zu implementieren."}),"\n",(0,t.jsxs)(u.A,{groupId:"user-client",children:[(0,t.jsxs)(c.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,t.jsxs)(n.p,{children:["Beim Initialisieren des Logto-Clients f\xfcge den Ressourcenindikator zum ",(0,t.jsx)(n.code,{children:"resources"}),"-Parameter (Array) hinzu und die gew\xfcnschten Berechtigungen (Scopes) zum ",(0,t.jsx)(n.code,{children:"scopes"}),"-Parameter."]}),(0,t.jsxs)(n.p,{children:["Sobald der Benutzer authentifiziert ist, \xfcbergib den Ressourcenindikator im ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter oder einem \xe4hnlich benannten Parameter, wenn du das Zugangstoken anforderst (z. B. beim Aufruf von ",(0,t.jsx)(n.code,{children:"getAccessToken()"}),")."]}),(0,t.jsxs)(n.p,{children:["Details zu jedem SDK findest du in den ",(0,t.jsx)(n.a,{href:"/quick-starts",children:"Quick Starts"}),"."]})]}),(0,t.jsxs)(c.A,{value:"oauth-client",label:"OAuth 2.0 / OIDC client library",children:[(0,t.jsxs)(n.p,{children:["Beim Konfigurieren deines OAuth 2.0-Clients oder beim Initialisieren des Authorization Code Flows stelle sicher, dass du den ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter und die gew\xfcnschten Scopes in der Autorisierungsanfrage einschlie\xdft."]}),(0,t.jsxs)(n.p,{children:["Einige Bibliotheken unterst\xfctzen den ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter nicht nativ, erlauben aber in der Regel das Hinzuf\xfcgen zus\xe4tzlicher Parameter in der Autorisierungsanfrage. Pr\xfcfe die Dokumentation deiner Bibliothek f\xfcr Details."]}),(0,t.jsxs)(n.p,{children:["Hier ist ein nicht-normatives Beispiel f\xfcr die Autorisierungsanfrage mit den Parametern ",(0,t.jsx)(n.code,{children:"resource"})," und ",(0,t.jsx)(n.code,{children:"scope"}),":"]}),(0,t.jsx)(l.A,{resource:m,scope:"read:products write:products"}),(0,t.jsxs)(n.p,{children:["Sobald der Benutzer authentifiziert ist, erh\xe4ltst du einen Authorization Code. Tausche diesen Code gegen ein Zugangstoken aus, indem du eine POST-Anfrage an Logtos ",(0,t.jsx)(n.code,{children:"/oidc/token"}),"-Endpunkt stellst und den ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter im Anfragek\xf6rper einschlie\xdft."]}),(0,t.jsx)(n.p,{children:"Hier ist ein nicht-normatives Beispiel f\xfcr die Token-Anfrage mit dem Authorization Code Grant Type:"}),(0,t.jsx)(d.A,{grantType:"authorization_code",resource:m}),(0,t.jsxs)(n.p,{children:["Du kannst auch den Grant Type ",(0,t.jsx)(n.code,{children:"refresh_token"})," verwenden, um ein neues Zugangstoken ohne Benutzerinteraktion zu erhalten, solange der ",(0,t.jsx)(n.code,{children:"resource"}),"-Parameter in der Anfrage enthalten ist."]}),(0,t.jsx)(n.p,{children:"Hier ist ein nicht-normatives Beispiel f\xfcr die Token-Anfrage mit dem Refresh Token Grant Type:"}),(0,t.jsx)(d.A,{grantType:"refresh_token",resource:m})]})]}),"\n",(0,t.jsx)(n.h4,{id:"client-credentials-flow",children:"Client-Credentials-Flow"}),"\n",(0,t.jsxs)(n.p,{children:["F\xfcr Maschine-zu-Maschine (M2M)-Szenarien kannst du den Client-Credentials-Flow verwenden, um ein Zugangstoken f\xfcr deine globale API-Ressource zu erhalten. Durch eine POST-Anfrage an Logtos ",(0,t.jsx)(n.code,{children:"/oidc/token"}),"-Endpunkt kannst du ein Zugangstoken mit deiner Client-ID und deinem Secret anfordern."]}),"\n",(0,t.jsx)(n.p,{children:"Es gibt zwei wichtige Parameter, die in der Anfrage enthalten sein m\xfcssen:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resource"}),": Die Ressourcenindikator-URI der API, auf die du zugreifen m\xf6chtest (z. B. ",(0,t.jsx)(n.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scope"}),": Die Berechtigungen, die du f\xfcr die API anfordern m\xf6chtest (z. B. ",(0,t.jsx)(n.code,{children:"read:products write:products"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Hier ist ein nicht-normatives Beispiel f\xfcr die Token-Anfrage mit dem Client Credentials Grant Type:"}),"\n",(0,t.jsx)(a.A,{resource:"https://api.yourapp.com",scope:"read:products write:products"}),"\n",(0,t.jsx)(n.h3,{id:"validating-jwt-access-tokens-in-your-api",children:"JWT-Zugangstokens in deiner API validieren"}),"\n",(0,t.jsx)(n.p,{children:"Von Logto ausgestellte JWTs enthalten Anspr\xfcche, die deine API zur Durchsetzung der Autorisierung verwenden kann."}),"\n",(0,t.jsx)(n.p,{children:"Wenn deine API eine Anfrage mit einem von Logto ausgestellten Zugangstoken erh\xe4lt, solltest du:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Die Token-Signatur \xfcberpr\xfcfen (mit Logtos JWKs)."}),"\n",(0,t.jsxs)(n.li,{children:["Best\xe4tigen, dass das Token nicht abgelaufen ist (",(0,t.jsx)(n.code,{children:"exp"}),"-Anspruch)."]}),"\n",(0,t.jsxs)(n.li,{children:["Pr\xfcfen, dass der ",(0,t.jsx)(n.code,{children:"iss"})," (Aussteller) mit deinem Logto-Endpunkt \xfcbereinstimmt."]}),"\n",(0,t.jsxs)(n.li,{children:["Sicherstellen, dass der ",(0,t.jsx)(n.code,{children:"aud"})," (Zielgruppe) mit dem registrierten API-Ressourcenindikator \xfcbereinstimmt (z. B. ",(0,t.jsx)(n.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["Den ",(0,t.jsx)(n.code,{children:"scope"}),"-Anspruch (durch Leerzeichen getrennt) aufteilen und auf erforderliche Berechtigungen pr\xfcfen."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["F\xfcr Schritt-f\xfcr-Schritt- und sprachspezifische Anleitungen siehe ",(0,t.jsx)(n.a,{href:"/authorization/validate-access-tokens",children:"Wie man Zugangstokens validiert"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"optional-handle-user-permission-change",children:"Optional: Benutzerberechtigungs\xe4nderung behandeln"}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"\ud83d\udc77 In Arbeit. \ud83d\udea7"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices-and-security-tips",children:"Best Practices und Sicherheitstipps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Halte Berechtigungen gesch\xe4ftsorientiert:"})," Verwende klare Namen, die echten Aktionen entsprechen."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Halte die Token-G\xfcltigkeit kurz:"})," Reduziert das Risiko bei einem Token-Leak."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Beschr\xe4nke gew\xe4hrte Scopes:"})," Gib Tokens nur die Berechtigungen, die sie tats\xe4chlich ben\xf6tigen."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Verwende Zielgruppenbeschr\xe4nkung:"})," \xdcberpr\xfcfe immer den ",(0,t.jsx)(n.code,{children:"aud"}),"-Anspruch, um Missbrauch zu verhindern."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"faqs",children:"FAQs"}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.h3,{id:"what-if-my-client-doesn-t-support-the-resource-parameter",children:"Was, wenn mein Client den resource-Parameter nicht unterst\xfctzt?"})}),(0,t.jsx)(n.p,{children:"Setze eine Standard-API-Ressource in der Logto-Konsole. Tokens verwenden diese Zielgruppe, wenn im Token-Request kein resource-Parameter angegeben ist."})]}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.h3,{id:"why-do-i-get-401-unauthorized-from-my-api",children:"Warum erhalte ich 401 Nicht autorisiert von meiner API?"})}),(0,t.jsx)(n.p,{children:"\xdcberpr\xfcfe die folgenden h\xe4ufigen Probleme:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Token-Signatur"}),": Stelle sicher, dass dein Backend die richtigen JWKs von Logto abruft"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Token-G\xfcltigkeit"}),": Stelle sicher, dass das Token nicht abgelaufen ist (",(0,t.jsx)(n.code,{children:"exp"}),"-Anspruch)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Zielgruppe"}),": Pr\xfcfe, dass der ",(0,t.jsx)(n.code,{children:"aud"}),"-Anspruch mit deinem registrierten API-Ressourcenindikator \xfcbereinstimmt"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Erforderliche Scopes"}),": Stelle sicher, dass das Token die notwendigen Berechtigungen im ",(0,t.jsx)(n.code,{children:"scope"}),"-Anspruch enth\xe4lt"]}),"\n"]})]}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.h3,{id:"how-do-i-test-without-a-full-client",children:"Wie kann ich ohne vollst\xe4ndigen Client testen?"})}),(0,t.jsxs)(n.p,{children:["Verwende ein ",(0,t.jsx)(n.a,{href:"/user-management/personal-access-token",children:"Personal Access Token"}),", um authentifizierte Aufrufe zu simulieren. So kannst du deine API-Endpunkte testen, ohne einen vollst\xe4ndigen OAuth-Flow in deiner Client-Anwendung zu implementieren."]})]}),"\n",(0,t.jsx)(n.h2,{id:"further-reading",children:"Weiterf\xfchrende Literatur"}),"\n",(0,t.jsx)(h,{href:"/authorization/validate-access-tokens",children:"Wie man Zugangstokens validiert"}),"\n",(0,t.jsx)(h,{href:"/use-cases/authorization/rbac-in-practice",children:(0,t.jsx)(n.p,{children:"RBAC in der Praxis: Sichere Autorisierung f\xfcr deine Anwendung implementieren"})}),"\n",(0,t.jsx)(h,{href:"/developers/custom-token-claims",children:"Token-Anspr\xfcche anpassen"}),"\n",(0,t.jsx)(h,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707: Ressourcenindikatoren"})]})}function j(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(x,{...e})}):x(e)}function b(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,n,i)=>{i.d(n,{A:()=>s});var r=i(80173),t=i(25105);const s=e=>{let{resource:n,scope:i}=e;return(0,t.jsx)(r.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${i}\n&resource=${n}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,n,i)=>{i.d(n,{A:()=>s});var r=i(80173),t=i(25105);const s=e=>{let{resource:n,organizationId:i,scope:s}=e;return(0,t.jsxs)(r.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",n&&`&resource=${n}\n`,i&&`&organization_id=${i}\n`,`&scope=${s}\n`]})}},42372:(e,n,i)=>{i.d(n,{A:()=>s});var r=i(80173),t=i(25105);const s=e=>{let{grantType:n,resource:i,organizationId:s}=e;const o=[`grant_type=${n}`,"authorization_code"===n&&"code=authorization-code-received","authorization_code"===n&&"redirect_uri=https://your-app.com/callback","refresh_token"===n&&"refresh_token=your-refresh-token",i&&`resource=${i}`,s&&`organization_id=${s}`].filter(Boolean);return(0,t.jsx)(r.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${o.join("\n&")}`})}},38552:(e,n,i)=>{i.d(n,{A:()=>o});i(58101);var r=i(13526);const t={tabItem:"tabItem_dgSZ"};var s=i(25105);function o(e){let{children:n,hidden:i,className:o}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,o),hidden:i,children:n})}},22002:(e,n,i)=>{i.d(n,{A:()=>z});var r=i(58101),t=i(13526),s=i(60755),o=i(55234),l=i(6635),a=i(4100),d=i(35661),c=i(42752);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:i}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:i,attributes:r,default:t}}=e;return{value:n,label:i,attributes:r,default:t}}))}(i);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function g(e){let{value:n,tabValues:i}=e;return i.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:i}=e;const t=(0,o.W6)(),s=function(e){let{queryString:n=!1,groupId:i}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return i??null}({queryString:n,groupId:i});return[(0,a.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function m(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,s=h(e),[o,a]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:i}=e;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:i}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${i.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=i.find((e=>e.default))??i[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[d,u]=p({queryString:i,groupId:t}),[m,f]=function(e){let{groupId:n}=e;const i=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,s]=(0,c.Dv)(i);return[t,(0,r.useCallback)((e=>{i&&s.set(e)}),[i,s])]}({groupId:t}),x=(()=>{const e=d??m;return g({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{x&&a(x)}),[x]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!g({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var f=i(21929);const x={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var j=i(25105);function b(e){let{className:n,block:i,selectedValue:r,selectValue:o,tabValues:l}=e;const a=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.a_)(),c=e=>{const n=e.currentTarget,i=a.indexOf(n),t=l[i].value;t!==r&&(d(n),o(t))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const i=a.indexOf(e.currentTarget)+1;n=a[i]??a[0];break}case"ArrowLeft":{const i=a.indexOf(e.currentTarget)-1;n=a[i]??a[a.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":i},n),children:l.map((e=>{let{value:n,label:i,attributes:s}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{a.push(e)},onKeyDown:u,onClick:c,...s,className:(0,t.A)("tabs__item",x.tabItem,s?.className,{"tabs__item--active":r===n}),children:i??n},n)}))})}function k(e){let{lazy:n,children:i,selectedValue:s}=e;const o=(Array.isArray(i)?i:[i]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function A(e){const n=m(e);return(0,j.jsxs)("div",{className:(0,t.A)("tabs-container",x.tabList),children:[(0,j.jsx)(b,{...n,...e}),(0,j.jsx)(k,{...n,...e})]})}function z(e){const n=(0,f.A)();return(0,j.jsx)(A,{...e,children:u(e.children)},String(n))}},55138:(e,n,i)=>{i.d(n,{A:()=>m});var r=i(28259),t=i(6097),s=i(58574),o=i(9484),l=i(76566),a=i(26346),d=i(17867),c=i(17510),u=i(13526),h=i(72355);const g={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var p=i(25105);function m(e){let{children:n,className:i="",metastring:m,title:f,showLineNumbers:x,language:j}=e;const{prism:{defaultLanguage:b,magicComments:k}}=(0,r.p)(),A=function(e){return e?.toLowerCase()}(j??(0,s.Op)(i)??b),z=(0,t.A)(),v=(0,o.f)(),w=(0,s.wt)(m)||f,{lineClassNames:P,code:I}=(0,s.Li)(n,{metastring:m,language:A,magicComments:k}),B=x??(0,s._u)(m);return(0,p.jsxs)(l.A,{as:"div",className:(0,u.A)(i,A&&!i.includes(`language-${A}`)&&`language-${A}`),children:[w&&(0,p.jsx)("div",{className:g.codeBlockTitle,children:w}),(0,p.jsxs)("div",{className:g.codeBlockContent,children:[(0,p.jsx)(h.f4,{theme:z,code:I,language:A??"text",children:e=>{let{className:n,tokens:i,getLineProps:r,getTokenProps:t}=e;return(0,p.jsx)("pre",{ref:v.codeBlockRef,tabIndex:0,className:(0,u.A)(n,g.codeBlock,"thin-scrollbar"),children:(0,p.jsx)("code",{className:(0,u.A)(g.codeBlockLines,B&&g.codeBlockLinesWithNumbering),children:i.map(((e,n)=>(0,p.jsx)(d.A,{line:e,getLineProps:r,getTokenProps:t,classNames:P[n],showLineNumbers:B},n)))})})}}),(0,p.jsxs)("div",{className:g.buttonGroup,children:[(v.isEnabled||v.isCodeScrollable)&&(0,p.jsx)(c.A,{className:g.codeButton,isEnabled:v.isEnabled,onClick:()=>{v.toggle()}}),(0,p.jsx)(a.A,{className:g.codeButton,code:I})]})]})]})}},46643:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/rbac-global-api-resources-33fafc263308d3f769c62cbcdb8d7829.png"}}]);