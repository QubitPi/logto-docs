"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[2318],{94882:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"end-user-flows/one-time-token","title":"Magic Link (Einmal-Token)","description":"\xc4hnlich wie das Einmalpasswort (OTP) ist ein Einmal-Token eine weitere passwortlose Authentifizierungsmethode, mit der die Identit\xe4t eines Benutzers verifiziert werden kann.","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","sourceDirName":"end-user-flows","slug":"/end-user-flows/one-time-token","permalink":"/de/end-user-flows/one-time-token","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/de/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Direkte Anmeldung","permalink":"/de/end-user-flows/authentication-parameters/direct-sign-in"},"next":{"title":"Zustimmungsbildschirm (Consent screen)","permalink":"/de/end-user-flows/consent-screen"}}');var r=i(25105),a=i(79621),s=i(88969);const d={sidebar_position:5},l="Magic Link (Einmal-Token)",o={},u=[{value:"Einmal-Token-Ablauf",id:"one-time-token-flow",level:2},{value:"Implementierungsanleitung",id:"implementation-guide",level:2},{value:"Schritt 1: Einmal-Token anfordern",id:"step-1-request-one-time-token",level:3},{value:"Schritt 2: Magic Link erstellen",id:"step-2-compose-your-magic-link",level:3},{value:"Schritt 3: Authentifizierungsablauf \xfcber Logto SDK ausl\xf6sen",id:"step-3-trigger-the-authentication-flow-via-logto-sdk",level:3},{value:"Schritt 4: (Optional) Zwischengespeicherte Tokens auf der sign-in Callback-Seite l\xf6schen",id:"step-4-clear-cached-tokens-in-sign-in-callback-page",level:3},{value:"FAQs",id:"faqs",level:2},{value:"Kann ich den Magic Link verwenden, um neue Benutzer zu meinen Organisationen einzuladen?",id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",level:3},{value:"L\xe4uft das Einmal-Token ab?",id:"does-the-one-time-token-expire",level:3},{value:"Kann ich weiterhin Magic Links zum Einladen von Benutzern verwenden, wenn ich die Benutzerregistrierung in der &quot;Anmeldeerfahrung&quot; deaktiviere?",id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",level:3},{value:"Was passiert, wenn ein Benutzer bereits angemeldet ist und dann auf einen weiteren Magic Link klickt?",id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"magic-link-einmal-token",children:"Magic Link (Einmal-Token)"})}),"\n","\n",(0,r.jsx)(s.A,{cloud:!0,oss:{major:1,minor:27}}),"\n",(0,r.jsx)(n.p,{children:"\xc4hnlich wie das Einmalpasswort (OTP) ist ein Einmal-Token eine weitere passwortlose Authentifizierungsmethode, mit der die Identit\xe4t eines Benutzers verifiziert werden kann.\nDas Token ist f\xfcr einen begrenzten Zeitraum g\xfcltig und mit einer E-Mail-Adresse des Endbenutzers verkn\xfcpft."}),"\n",(0,r.jsx)(n.p,{children:'Manchmal m\xf6chtest du neue Benutzer zu deiner Anwendung / Organisation einladen, ohne dass sie zuerst ein Konto erstellen m\xfcssen.\nOder du hast dein Passwort vergessen und m\xf6chtest dich anmelden / dein Passwort zur\xfccksetzen, indem du deine Identit\xe4t schnell per E-Mail verifizierst.\nIn solchen F\xe4llen kann die Anwendung einen "Magic Link" an deine E-Mail senden. Und du wirst sofort authentifiziert, wenn du auf den Link klickst.'}),"\n",(0,r.jsx)(n.p,{children:"Anwendungsentwickler k\xf6nnen das Einmal-Token verwenden, um einen Magic Link zu erstellen und ihn an die E-Mail-Adresse des Endbenutzers zu senden."}),"\n",(0,r.jsx)(n.h2,{id:"one-time-token-flow",children:"Einmal-Token-Ablauf"}),"\n",(0,r.jsx)(n.p,{children:"Hier ist das Sequenzdiagramm des Authentifizierungsablaufs mit Einmal-Token:"}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant U as Endbenutzer\n  participant C as Deine Anwendung\n  participant L as Logto\n\n  U ->> C: (Optional) Benutzer fordert einen Magic Link von deiner Anwendung an\n  C ->> L: Einmal-Token anfordern\n  L --\x3e> C: Einmal-Token zur\xfcckgeben\n  C --\x3e> U: Magic Link, der das Einmal-Token enth\xe4lt, erstellen und an die E-Mail des Endbenutzers senden\n  U ->> C: Benutzer klickt auf den Magic Link und wird auf eine Landingpage deiner Anwendung weitergeleitet\n  C ->> L: Das Einmal-Token aus dem Magic Link extrahieren und den Authentifizierungsablauf ausl\xf6sen\n  L --\x3e> C: Logto \xfcberpr\xfcft das Einmal-Token und gibt das Ergebnis zur\xfcck\n  C --\x3e> U: Benutzer ist authentifiziert und Benutzerinfo wird zur\xfcckgegeben"}),"\n",(0,r.jsx)(n.h2,{id:"implementation-guide",children:"Implementierungsanleitung"}),"\n",(0,r.jsx)(n.p,{children:"Logto bietet eine Reihe von Management APIs und Experience APIs, um die Implementierung deines Magic Links zu erleichtern."}),"\n",(0,r.jsxs)(n.p,{children:["Bevor du beginnst, stelle sicher, dass du eine Logto-Instanz bereit hast und die Maschine-zu-Maschine-Verbindung zwischen deinem Anwendungsserver\nund dem Logto-Endpunkt hergestellt ist (erforderlich f\xfcr die Management APIs). Erfahre mehr \xfcber ",(0,r.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Logto Management API"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"step-1-request-one-time-token",children:"Schritt 1: Einmal-Token anfordern"}),"\n",(0,r.jsx)(n.p,{children:"Verwende die Logto Management API, um ein Einmal-Token zu erstellen."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"POST /api/one-time-tokens\n"})}),"\n",(0,r.jsx)(n.p,{children:"Beispiel f\xfcr den Anfrage-Body:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "email": "user@example.com",\n  // Optional. Standardwert ist 600 (10 Minuten).\n  "expiresIn": 3600,\n  // Optional. Der Benutzer wird nach erfolgreicher Verifizierung den angegebenen Organisationen zugeordnet.\n  "context": {\n    "jitOrganizationIds": ["abcdefgh1234"]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-compose-your-magic-link",children:"Schritt 2: Magic Link erstellen"}),"\n",(0,r.jsxs)(n.p,{children:["Nachdem du das Einmal-Token erhalten hast, kannst du einen Magic Link erstellen und ihn an die E-Mail-Adresse des Endbenutzers senden.\nDer Magic Link sollte mindestens das Token und die Benutzer-E-Mail als Parameter enthalten und auf eine Landingpage in deiner eigenen Anwendung f\xfchren.\nZ. B. ",(0,r.jsx)(n.code,{children:"https://yourapp.com/landing-page"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Hier ist ein einfaches Beispiel, wie der Magic Link aussehen k\xf6nnte:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://yourapp.com/landing-page?token=YHwbXSXxQfL02IoxFqr1hGvkB13uTqcd&email=user@example.com\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"Die Parameternamen im Magic Link k\xf6nnen vollst\xe4ndig angepasst werden.\nDu kannst dem Magic Link zus\xe4tzliche Informationen hinzuf\xfcgen, je nach den Anforderungen deiner Anwendung,\nsowie alle URL-Parameter kodieren."})}),"\n",(0,r.jsx)(n.h3,{id:"step-3-trigger-the-authentication-flow-via-logto-sdk",children:"Schritt 3: Authentifizierungsablauf \xfcber Logto SDK ausl\xf6sen"}),"\n",(0,r.jsxs)(n.p,{children:["Nachdem der Endbenutzer auf den Magic Link geklickt und deine Anwendung aufgerufen hat, kannst du die Parameter ",(0,r.jsx)(n.code,{children:"token"})," und ",(0,r.jsx)(n.code,{children:"email"})," aus der URL extrahieren und dann die Funktion ",(0,r.jsx)(n.code,{children:"signIn()"})," aus dem Logto SDK aufrufen, um den Authentifizierungsablauf zu starten."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'title="TokenLandingPage.tsx"',children:"// React-Beispiel\nimport { useLogto } from '@logto/react';\nimport { useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\n\nconst TokenLandingPage = () => {\n  const { signIn } = useLogto();\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    // Token und E-Mail aus dem Magic Link extrahieren\n    const oneTimeToken = searchParams.get('token');\n    const email = searchParams.get('email');\n\n    // Dies ist deine sign-in redirect URI\n    const redirectUri = 'https://yourapp.com/callback';\n\n    if (oneTimeToken && email) {\n      signIn({\n        redirectUri,\n        clearTokens: false, // Optional. Siehe Warnhinweis unten\n        extraParams: {\n          'one_time_token': oneTimeToken,\n          'login_hint': email,\n        },\n      });\n    }\n  }, [searchParams, signIn]);\n\n  return <>Bitte warten...</>;\n};\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsxs)(n.p,{children:["Wenn ein Benutzer bereits angemeldet ist, l\xf6scht der Aufruf der Funktion ",(0,r.jsx)(n.code,{children:"signIn()"})," aus dem SDK automatisch alle zwischengespeicherten Tokens (ID-Token, Zugangstoken und Auffrischungstoken) aus dem Client-Speicher,\nwas dazu f\xfchrt, dass der aktuelle Authentifizierungsstatus verloren geht."]}),(0,r.jsxs)(n.p,{children:["Daher solltest du einen zus\xe4tzlichen sign-in Parameter ",(0,r.jsx)(n.code,{children:"clearTokens: false"})," angeben, um das L\xf6schen der bestehenden Tokens zu vermeiden.\nWenn dies angegeben ist, musst du die Tokens auf der sign-in Callback-Seite manuell l\xf6schen."]}),(0,r.jsx)(n.p,{children:"Ignoriere dies, wenn deine Magic Links nicht f\xfcr authentifizierte Benutzer gedacht sind."})]}),"\n",(0,r.jsx)(n.h3,{id:"step-4-clear-cached-tokens-in-sign-in-callback-page",children:"Schritt 4: (Optional) Zwischengespeicherte Tokens auf der sign-in Callback-Seite l\xf6schen"}),"\n",(0,r.jsxs)(n.p,{children:["Wenn du ",(0,r.jsx)(n.code,{children:"clearTokens: false"})," in der sign-in Funktion angibst, musst du die Tokens auf der sign-in Callback-Seite manuell l\xf6schen."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'title="Callback.tsx"',children:"// React-Beispiel\nimport { useHandleSignInCallback, useLogto } from '@logto/react';\nimport { useEffect } from 'react';\n\nconst Callback = () => {\n  const { clearAllTokens } = useLogto();\n\n  useEffect(() => {\n    void clearAllTokens();\n  }, [clearAllTokens]);\n\n  useHandleSignInCallback(() => {\n    // Navigiere zu deiner Startseite\n  });\n\n  return <>Bitte warten...</>;\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"faqs",children:"FAQs"}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.h3,{id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",children:"Kann ich den Magic Link verwenden, um neue Benutzer zu meinen Organisationen einzuladen?"})}),(0,r.jsxs)(n.p,{children:["Ja, du kannst den Magic Link verwenden, um neue Benutzer zu deiner Anwendung sowie zu Organisationen einzuladen.\nWenn du neue Benutzer zu deiner Organisation einladen m\xf6chtest, gib einfach die ",(0,r.jsx)(n.code,{children:"jitOrganizationIds"})," im Anfrage-Body an."]}),(0,r.jsx)(n.p,{children:'Der Benutzer tritt nach erfolgreicher Verifizierung automatisch den Organisationen bei, und Standardrollen werden zugewiesen.\nSieh dir den Abschnitt "Just-in-time-Bereitstellung" auf der Detailseite deiner Organisation an und konfiguriere die Standardrollen f\xfcr deine Organisationen.'})]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.h3,{id:"does-the-one-time-token-expire",children:"L\xe4uft das Einmal-Token ab?"})}),(0,r.jsxs)(n.p,{children:["Ja, das Einmal-Token l\xe4uft nach der angegebenen ",(0,r.jsx)(n.code,{children:"expiresIn"}),"-Zeit (in Sekunden) ab. Die Standardablaufzeit betr\xe4gt 10 Minuten."]})]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.h3,{id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",children:'Kann ich weiterhin Magic Links zum Einladen von Benutzern verwenden, wenn ich die Benutzerregistrierung in der "Anmeldeerfahrung" deaktiviere?'})}),(0,r.jsx)(n.p,{children:'Ja, du kannst weiterhin Magic Links zum Einladen von Benutzern verwenden, auch wenn du die Benutzerregistrierung in der "Anmeldeerfahrung" deaktivierst.'})]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.h3,{id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",children:"Was passiert, wenn ein Benutzer bereits angemeldet ist und dann auf einen weiteren Magic Link klickt?"})}),(0,r.jsx)(n.p,{children:"Es gibt mehrere m\xf6gliche Szenarien:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Der Benutzer ist bereits angemeldet und klickt dann auf einen Magic Link, der mit dem aktuellen Benutzerkonto verkn\xfcpft ist. In diesem Fall \xfcberpr\xfcft Logto dennoch das Einmal-Token und weist den Benutzer ggf. den angegebenen Organisationen zu."}),"\n",(0,r.jsxs)(n.li,{children:["Der Benutzer ist bereits angemeldet und klickt dann auf einen Magic Link, der mit einem anderen Konto verkn\xfcpft ist. In diesem Fall fordert Logto den Benutzer auf, entweder als neues Konto fortzufahren oder mit dem aktuellen Konto zur Anwendung zur\xfcckzukehren.","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Wenn der Benutzer sich entscheidet, als neues Konto fortzufahren, wechselt Logto nach erfolgreicher Token-Verifizierung zum neuen Konto."}),"\n",(0,r.jsx)(n.li,{children:"Wenn der Benutzer beim aktuellen Konto bleiben m\xf6chte, wird das Token nicht \xfcberpr\xfcft und zur Anwendung mit dem aktuellen Konto zur\xfcckgekehrt."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:'Wenn deine sign-in Aufforderung auf "login" gesetzt ist oder "login" enth\xe4lt, meldet Logto das mit dem Einmal-Token verkn\xfcpfte Konto automatisch an, ohne einen Wechsel abzufragen.'}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},88969:(e,n,i)=>{i.d(n,{A:()=>s});const t="availability_kRMk";var r=i(25105);const a=e=>"comingSoon"===e?"coming soon-blue":"boolean"==typeof e?e?"\u2713 available-4EA254":"not applicable-78767F":`since v${e.major}.${e.minor}-4EA254`,s=e=>{let{cloud:n,oss:i}=e;return(0,r.jsxs)("div",{className:t,children:[(0,r.jsx)("img",{alt:"Cloud availability",src:`https://img.shields.io/badge/Cloud-${a(n)}`}),(0,r.jsx)("img",{alt:"OSS availability",src:`https://img.shields.io/badge/OSS-${a(i)}`})]})}},79621:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var t=i(58101);const r={},a=t.createContext(r);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);