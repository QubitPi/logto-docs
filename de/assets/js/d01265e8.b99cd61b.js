"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[79150],{37922:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"authorization/api-resources/protect-your-api","title":"Sch\xfctze deine API","description":"Wenn du keine flexiblen, feingranularen Zugangskontrollrichtlinien ben\xf6tigst, kannst du einfach deine API direkt sch\xfctzen. Wir f\xfchren dich durch ein Sequenzdiagramm und die notwendigen Schritte, um die Zugangskontrolle in deine App zu integrieren.","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/authorization/api-resources/protect-your-api.mdx","sourceDirName":"authorization/api-resources","slug":"/authorization/api-resources/protect-your-api","permalink":"/de/authorization/api-resources/protect-your-api","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/de/docusaurus-plugin-content-docs/current/authorization/api-resources/protect-your-api.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"API-Ressourcen","permalink":"/de/authorization/api-resources/"},"next":{"title":"Leitfaden: Python","permalink":"/de/authorization/api-resources/python"}}');var t=r(25105),s=r(79621);const o={sidebar_position:1},d="Sch\xfctze deine API",a={},c=[{value:"Authentifizierungsanfrage",id:"authentication-request",level:2},{value:"Token-Anfrage",id:"token-request",level:2},{value:"Anfrage an die API-Ressource",id:"request-to-the-api-resource",level:2},{value:"Autorisierungstoken f\xfcr API-Anfragen validieren",id:"validate-authorization-tokens-for-api-requests",level:2},{value:"Verst\xe4ndnis des JWS-Tokens",id:"understanding-jws-token",level:4},{value:"Das Autorisierungstoken validieren",id:"validate-the-authorization-token",level:4},{value:"Referenz",id:"reference",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"sch\xfctze-deine-api",children:"Sch\xfctze deine API"})}),"\n",(0,t.jsx)(n.p,{children:"Wenn du keine flexiblen, feingranularen Zugangskontrollrichtlinien ben\xf6tigst, kannst du einfach deine API direkt sch\xfctzen. Wir f\xfchren dich durch ein Sequenzdiagramm und die notwendigen Schritte, um die Zugangskontrolle in deine App zu integrieren."}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Logto\n    participant API\n\n    Note over Client,API: 1. Authentifizierungsanfrage\n    Client->>Logto: GET /oidc/auth\n    Note right of Client: mit resource=https://resource-server.com/api<br/>und optional scope=read write\n    Logto--\x3e>Client: Gibt authorization_code zur\xfcck\n\n    Note over Client,API: 2. Token-Anfrage\n    Client->>Logto: POST /oidc/token\n    Note right of Client: mit authorization_code<br/>resource=https://resource-server.com/api<br/>und optional scope=read write\n    Logto--\x3e>Client: Gibt JWT Zugangstoken zur\xfcck\n    Note left of Logto: Token enth\xe4lt:<br/>- Zielgruppe eingeschr\xe4nkt auf Ressource<br/>- Gew\xe4hrte Berechtigungen (falls vorhanden)\n\n    Note over Client,API: 3. API-Anfrage\n    Client->>API: Anfrage mit Bearer-Token\n    Note over API: JWT-Token validieren:\n    Note over API: - Signatur \xfcberpr\xfcfen<br/>- Aussteller verifizieren<br/>- Zielgruppe \xfcberpr\xfcfen<br/>- Ablaufdatum verifizieren<br/>- Berechtigungen \xfcberpr\xfcfen (wenn RBAC aktiviert)\n    alt Token g\xfcltig\n        API--\x3e>Client: Gesch\xfctzte Ressource\n    else Token ung\xfcltig\n        API--\x3e>Client: 401 Nicht autorisiert\n    end"}),"\n",(0,t.jsx)(n.p,{children:"In diesem Tutorial"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Logto-Endpunkt: ",(0,t.jsx)(n.code,{children:"https://tenant-id.logto.app"})]}),"\n",(0,t.jsxs)(n.li,{children:["Client-Anwendung: ",(0,t.jsx)(n.code,{children:"https://client.example.org"})]}),"\n",(0,t.jsxs)(n.li,{children:["API-Ressourcenserver: ",(0,t.jsx)(n.code,{children:"https://resource-server.com/api"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Du solltest diese durch deine tats\xe4chlichen Endpunkte ersetzen, wenn du implementierst."}),"\n",(0,t.jsx)(n.h2,{id:"authentication-request",children:"Authentifizierungsanfrage"}),"\n",(0,t.jsxs)(n.p,{children:["Stelle eine Liste von Ressourcenindikator-Parametern in einer ",(0,t.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest",children:"Authentifizierungsanfrage"})," bereit. Dies wird alle gesch\xfctzten Ressourcen anzeigen, die der Benutzer m\xf6glicherweise anfordert."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"GET https://tenant-id.logto.app/oidc/auth?response_type=code\n    &client_id=s6BhdRkqt3\n    &state=tNwzQ87pC6llebpmac_IDeeq-mCR2wLDYljHUZUAWuI\n    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb\n    &resource=https%3A%2F%2Fresource-server.com%2Fapi\n    &scope=read%20write\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Logto wird diese Ressourcenindikatoren validieren und speichern. Ein ",(0,t.jsx)(n.code,{children:"authorization_code"})," wird gew\xe4hrt und mit Berechtigungen zur\xfcckgegeben, die auf diese angegebenen Ressourcen beschr\xe4nkt sind."]}),"\n",(0,t.jsx)(n.p,{children:"Beispielkonfiguration des Logto SDK:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const config: LogtoConfig = {\n  // ...andere Konfigurationen\n  resources: ['https://resource-server.com/api'],\n  scopes: ['read', 'write'],\n};\n"})}),"\n",(0,t.jsx)(n.h2,{id:"token-request",children:"Token-Anfrage"}),"\n",(0,t.jsxs)(n.p,{children:["Wenn der Ressourcenparameter bei einer ",(0,t.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#TokenRequest",children:"Token-Anfrage"})," zusammen mit dem oben gew\xe4hrten ",(0,t.jsx)(n.code,{children:"authorization_code"})," vorhanden ist, wird die Ziel-API-Ressourcenzielgruppe des Zugangstokens spezifiziert."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"POST https://tenant-id.logto.app/oidc/token HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb&code=10esc29BWC2qZB0acc9v8zAv9ltc2pko105tQauZ&resource=https%3A%2F%2Fresource-server.com%2Fapi\n"})}),"\n",(0,t.jsx)(n.p,{children:"Ein verschl\xfcsseltes Zugangstoken mit der Zielgruppe, die auf diese angeforderte Ressource beschr\xe4nkt ist, wird von Logto gew\xe4hrt. Das Token enth\xe4lt alle Daten, die du ben\xf6tigst, um den Autorisierungsstatus der Anfrage darzustellen, z. B. die Identit\xe4t und Rolle des anfragenden Benutzers, die Zielgruppe und die Ablaufzeit des Tokens."}),"\n",(0,t.jsx)(n.p,{children:"Beispielcode des Logto SDK:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const accessToken = await logtoClient.getAccessToken('https://resource-server.com/api');\n"})}),"\n",(0,t.jsx)(n.p,{children:"Der Payload des accessToken wird enthalten:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"{\n  iss: '<your-logto-endpoint>/oidc',\n  aud: 'https://resource-server.com/api',\n  scope: 'read write'\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"request-to-the-api-resource",children:"Anfrage an die API-Ressource"}),"\n",(0,t.jsxs)(n.p,{children:["Der Client-Benutzer sendet eine Anfrage an die API-Ressource, indem er das gegebene ",(0,t.jsx)(n.code,{children:"access_token"})," im Authorization-Header pr\xe4sentiert."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"GET https://resource-server.com/api/users\nAuthorization: Bearer eyJhbGciOiJIUz...\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Logto folgt dem standardm\xe4\xdfigen tokenbasierten Autorisierungsprotokoll, um deine API-Ressourcen zu sch\xfctzen. Um mehr \xfcber OAuth 2.0 zu erfahren, siehe bitte das ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6749#section-1.3.1",children:"offizielle Dokument"})," von OAuth 2.0."]}),"\n",(0,t.jsx)(n.h2,{id:"validate-authorization-tokens-for-api-requests",children:"Autorisierungstoken f\xfcr API-Anfragen validieren"}),"\n",(0,t.jsxs)(n.p,{children:["Logto stellt ein standardm\xe4\xdfiges ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519",children:"JWT"}),"-Format Autorisierungstoken f\xfcr jede autorisierte API-Anfrage aus. Das Token ist verschl\xfcsselt und als ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7515",children:"JWS"}),"-Token signiert."]}),"\n",(0,t.jsx)(n.h4,{id:"understanding-jws-token",children:"Verst\xe4ndnis des JWS-Tokens"}),"\n",(0,t.jsxs)(n.p,{children:["Ein kodiertes ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7515",children:"JWS"}),"-Token wird aus drei Teilen konstruiert:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"JOSE Header: Deklariert den Code-Typ und den Kodierungsalgorithmus"}),"\n",(0,t.jsx)(n.li,{children:"JWS Payload: Beinhaltet alle Anspr\xfcche des Tokens"}),"\n",(0,t.jsxs)(n.li,{children:["JWS Signature: Signatur, signiert mit ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7517",children:"JWK"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Ein Standardschema des von Logto ausgestellten JWS-Payloads: (Anspr\xfcche k\xf6nnen je nach deiner benutzerdefinierten OIDC-Konfiguration variieren)"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Schl\xfcssel"}),(0,t.jsx)(n.th,{children:"Beschreibung"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"jti"}),(0,t.jsx)(n.td,{children:"eindeutige JWT-ID"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"sub"}),(0,t.jsx)(n.td,{children:"Subjekt, normalerweise Benutzer-ID"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"iat"}),(0,t.jsx)(n.td,{children:"Zeitstempel, wann das Token ausgestellt wurde"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"exp"}),(0,t.jsx)(n.td,{children:"Zeitstempel, wann das Token abl\xe4uft"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"client_id"}),(0,t.jsx)(n.td,{children:"Anwendungs-ID"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"iss"}),(0,t.jsx)(n.td,{children:"Identit\xe4t des Token-Ausstellers"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"aud"}),(0,t.jsx)(n.td,{children:"Zielgruppe des Tokens"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"scope"}),(0,t.jsx)(n.td,{children:"Berechtigungen des Tokens"})]})]})]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["F\xfcr die Entwicklung, um ein JWT-Token visuell zu inspizieren, k\xf6nntest du ein ",(0,t.jsx)(n.a,{href:"https://www.jstoolset.com/jwt",children:"JWT Decoder Tool"})," besuchen, um die empfangenen Tokens zu dekodieren und zu \xfcberpr\xfcfen. Sei vorsichtig oder verwende niemals Tokens aus einer Produktionsumgebung. Da dies ein von Dritten bereitgestellter \xf6ffentlicher Online-Dienst ist, k\xf6nnte dein Token exponiert werden."]})}),"\n",(0,t.jsx)(n.h4,{id:"validate-the-authorization-token",children:"Das Autorisierungstoken validieren"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519#section-7.2",children:"Ein JWT validieren"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7515#section-5.2",children:"Die JWS-Signatur validieren"})}),"\n",(0,t.jsxs)(n.li,{children:["Der Aussteller des Tokens ist ",(0,t.jsx)(n.code,{children:"https://<your-logto-domain>/oidc"})," (ausgestellt von deinem Logto-Auth-Server)"]}),"\n",(0,t.jsx)(n.li,{children:"Die Zielgruppe des Tokens entspricht dem aktuellen Ressourcenindikator des Empf\xe4ngers, der in der Logto Admin Console registriert ist"}),"\n",(0,t.jsx)(n.li,{children:"Das Token befindet sich innerhalb seiner Ablaufzeit"}),"\n",(0,t.jsxs)(n.li,{children:["(Nur ",(0,t.jsx)(n.a,{href:"/authorization/role-based-access-control/protect-api-resources-with-rbac",children:"RBAC"}),") Das Token hat die gew\xfcnschte ",(0,t.jsx)(n.code,{children:"scope"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Es gibt verschiedene Open-Source-Bibliotheken und -Pakete, die dir helfen k\xf6nnen, ein JWT-Token einfach zu validieren und zu dekodieren. Du kannst eine ausw\xe4hlen und in deine Backend-Anwendung integrieren, basierend auf der Sprache und dem Framework, das du verwendest. Bitte \xfcberpr\xfcfe einige der Beispiele, die wir haben:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/authorization/api-resources/node-express",children:"Node (Express)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/authorization/api-resources/spring-boot",children:"Spring Boot"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/authorization/api-resources/python",children:"Python"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"reference",children:"Referenz"}),"\n",(0,t.jsxs)(n.p,{children:["Logto verwendet das codebasierte OAuth 2.0 Autorisierungsprotokoll, um deine API-Anfrage sicher zu machen. Wenn du an der dahinterstehenden Strategie interessiert bist, sieh dir die ",(0,t.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6749#section-1.3.1",children:"Spezifikation"})," von OAuth 2.0 f\xfcr weitere Details an."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},79621:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var i=r(58101);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);