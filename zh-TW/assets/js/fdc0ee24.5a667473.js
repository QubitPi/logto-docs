"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[3156],{41827:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>x,default:()=>w,frontMatter:()=>g,metadata:()=>r,toc:()=>j});const r=JSON.parse('{"id":"quick-starts/framework/flutterflow/README","title":"\u4f7f\u7528 Logto SDK \u81ea\u8a02 FlutterFlow CustomAuthManager","description":"FlutterFlow \u5167\u5efa\u7684 \u81ea\u8a02\u9a57\u8b49 (custom authentication) \u529f\u80fd\u5141\u8a31\u4f60\u4f7f\u7528\u81ea\u5df1\u7684\u5f8c\u7aef\u4f86\u9a57\u8b49\u4f7f\u7528\u8005\u3002\u7136\u800c\uff0c\u5167\u5efa\u7684\u81ea\u8a02\u9a57\u8b49\u6d41\u7a0b\u8a2d\u8a08\u70ba\u50c5\u9700\u55ae\u4e00\u9a57\u8b49 API \u547c\u53eb\u5373\u53ef\u904b\u4f5c\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7b2c\u4e09\u65b9\u8eab\u5206\u63d0\u4f9b\u8005 (IdP)\uff0c\u9a57\u8b49\u8acb\u6c42\u53ea\u80fd\u4f7f\u7528 Resource Owner Password Credentials \u6388\u6b0a\u985e\u578b\uff0c\u9019\u4e0d\u5efa\u8b70\u7528\u65bc\u751f\u7522\u74b0\u5883\u3002\u8a73\u60c5\u8acb\u53c3\u95b1 Deprecated ropc grant type\u3002","source":"@site/i18n/zh-TW/docusaurus-plugin-content-docs/current/quick-starts/framework/flutterflow/README.mdx","sourceDirName":"quick-starts/framework/flutterflow","slug":"/quick-starts/flutter-flow","permalink":"/zh-TW/quick-starts/flutter-flow","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/zh-TW/docusaurus-plugin-content-docs/current/quick-starts/framework/flutterflow/README.mdx","tags":[],"version":"current","frontMatter":{"slug":"/quick-starts/flutter-flow","sidebar_label":"FlutterFlow","sidebar_custom_props":{"description":"FlutterFlow \u662f\u4e00\u500b\u7528\u65bc\u69cb\u5efa\u6df7\u5408 Flutter \u61c9\u7528\u7a0b\u5f0f\u7684\u4f4e\u4ee3\u78bc\u6846\u67b6\u3002"}},"sidebar":"quickStartSidebar","previous":{"title":"Flutter","permalink":"/zh-TW/quick-starts/flutter"},"next":{"title":"Go","permalink":"/zh-TW/quick-starts/go"}}');var o=n(25105),i=n(79621);function l(e){const t={code:"code",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/auth/custom_auth/custom_auth_manager.dart\n\nimport 'dart:async';\n\nimport 'package:flutter/foundation.dart';\nimport 'package:http/http.dart' as http;\nimport 'package:logto_dart_sdk/logto_client.dart';\nimport 'package:logto_dart_sdk/src/modules/id_token.dart';\n\nimport 'custom_auth_user_provider.dart';\n\nexport 'custom_auth_manager.dart';\n\n\nclass CustomAuthManager {\n  late LogtoClient logtoClient;\n\n  final logtoConfig = const LogtoConfig(\n      appId: '<YOUR-APP-ID>',\n      endpoint: '<YOUR-LOGTO-ENDPOINT>');\n\n\n  // ...\n\n  FlutterFlowAuthAuthUser? _updateCurrentUser(\n      {bool loggedIn = false, String? uid, OpenIdClaims? idToken}) {\n    // \u66f4\u65b0\u7576\u524d\u4f7f\u7528\u8005\u6d41\u3002\n    final updatedUser = FlutterFlowAuthAuthUser(\n      loggedIn: loggedIn,\n      uid: uid,\n      idToken: idToken,\n    );\n\n    flutterFlowAuthAuthUserSubject.add(updatedUser);\n\n    return updatedUser;\n  }\n\n  Future initialize() async {\n    logtoClient = LogtoClient(config: logtoConfig, httpClient: http.Client());\n\n    late OpenIdClaims? idToken;\n\n    try {\n      idToken = await logtoClient.idTokenClaims;\n    } catch (e) {\n      if (kDebugMode) {\n        print('\u521d\u59cb\u5316\u9a57\u8b49\u6642\u51fa\u932f: $e');\n      }\n    }\n\n    _updateCurrentUser(\n        loggedIn: idToken != null, uid: idToken?.subject, idToken: idToken);\n  }\n}\n\nFlutterFlowAuthAuthUser? currentUser;\nbool get loggedIn => currentUser?.loggedIn ?? false;\n\n"})})}function s(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}function a(e){const t={code:"code",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/auth/custom_auth/custom_auth_user_provider.dart\n\nimport 'package:logto_dart_sdk/src/modules/id_token.dart';\nimport 'package:rxdart/rxdart.dart';\n\nimport 'custom_auth_manager.dart';\n\nclass FlutterFlowAuthAuthUser {\n  FlutterFlowAuthAuthUser({required this.loggedIn, this.uid, this.idToken});\n\n  bool loggedIn;\n  String? uid;\n  OpenIdClaims? idToken;\n}\n\n/// \u751f\u6210\u5df2\u9a57\u8b49\u4f7f\u7528\u8005\u7684\u8cc7\u6599\u6d41\u3002\nBehaviorSubject<FlutterFlowAuthAuthUser> flutterFlowAuthAuthUserSubject =\n    BehaviorSubject.seeded(FlutterFlowAuthAuthUser(loggedIn: false));\nStream<FlutterFlowAuthAuthUser> flutterFlowAuthAuthUserStream() =>\n    flutterFlowAuthAuthUserSubject\n        .asBroadcastStream()\n        .map((user) => currentUser = user);\n\n"})})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}function u(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(n,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(t.h3,{id:"flutter_secure_storage",children:"flutter_secure_storage"})}),(0,o.jsxs)(t.p,{children:["\u6211\u5011\u4f7f\u7528 ",(0,o.jsx)(t.a,{href:"https://pub.dev/packages/flutter_secure_storage",children:"flutter_secure_storage"})," \u4f86\u5be6\u73fe\u8de8\u5e73\u53f0\u7684\u6301\u4e45\u5b89\u5168\u6b0a\u6756\u5b58\u5132\u3002\u5728\u5e95\u5c64\uff1a"]}),(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"iOS \u4f7f\u7528 Keychain"}),"\n",(0,o.jsx)(t.li,{children:"Android \u4f7f\u7528 AES \u52a0\u5bc6\u3002"}),"\n"]}),(0,o.jsx)(t.h3,{id:"config-android-version",children:"\u914d\u7f6e Android \u7248\u672c\uff1a"}),(0,o.jsx)(t.p,{children:"\u5728 [project]/android/app/build.gradle \u4e2d\u5c07 minSdkVersion \u8a2d\u7f6e\u70ba >= 18\u3002"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-kotlin",children:"  android {\n      ...\n\n      defaultConfig {\n          ...\n          minSdkVersion 18\n          ...\n      }\n  }\n"})}),(0,o.jsx)(t.h3,{id:"disable-autobackup",children:"\u7981\u7528\u81ea\u52d5\u5099\u4efd\uff1a"}),(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsxs)(t.p,{children:["\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0cAndroid \u6703\u5728 Google Drive \u4e0a\u5099\u4efd\u6578\u64da\u3002\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u4f8b\u5916 java.security.InvalidKeyException",":Failed"," to unwrap key\u3002"]})}),(0,o.jsx)(t.p,{children:"\u70ba\u907f\u514d\u6b64\u60c5\u6cc1\uff0c\u4f60\u53ef\u4ee5\u7981\u7528\u61c9\u7528\u7a0b\u5f0f\u7684\u81ea\u52d5\u5099\u4efd\u6216\u5f9e FlutterSecureStorage \u4e2d\u6392\u9664 sharedprefs\u3002"}),(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["\u8981\u7981\u7528\u81ea\u52d5\u5099\u4efd\uff0c\u8acb\u524d\u5f80\u61c9\u7528\u7a0b\u5f0f\u7684 manifest \u6587\u4ef6\u4e26\u8a2d\u7f6e\u5e03\u6797\u503c android",":allowBackup","\uff1a"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-xml",children:'<manifest ... >\n    ...\n    <application\n      android:allowBackup="false"\n      android:fullBackupContent="false"\n      ...\n    >\n        ...\n    </application>\n</manifest>\n\n'})}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"\u5f9e FlutterSecureStorage \u4e2d\u6392\u9664 sharedprefs\u3002"}),"\n",(0,o.jsxs)(t.p,{children:["\u5982\u679c\u4f60\u9700\u8981\u70ba\u61c9\u7528\u7a0b\u5f0f\u555f\u7528 android",":fullBackupContent","\uff0c\u8acb\u8a2d\u7f6e\u5099\u4efd\u898f\u5247\u4ee5 ",(0,o.jsx)(t.a,{href:"https://developer.android.com/guide/topics/data/autobackup#IncludingFiles",children:"\u6392\u9664"})," \u63d2\u4ef6\u4f7f\u7528\u7684 prefs\uff1a"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-xml",children:'<application ...\n  android:fullBackupContent="@xml/backup_rules">\n</application>\n'})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-xml",children:'<?xml version="1.0" encoding="utf-8"?>\n<full-backup-content>\n  <exclude domain="sharedpref" path="FlutterSecureStorage"/>\n</full-backup-content>\n'})}),"\n",(0,o.jsxs)(t.p,{children:["\u8acb\u67e5\u770b ",(0,o.jsx)(t.a,{href:"https://pub.dev/packages/flutter_secure_storage#configure-android-version",children:"flutter_secure_storage"})," \u4ee5\u7372\u53d6\u66f4\u591a\u8a73\u7d30\u8cc7\u8a0a\u3002"]}),"\n"]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}function h(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(n,{children:[(0,o.jsx)("summary",{children:(0,o.jsx)(t.h3,{id:"flutter_web_auth",children:"flutter_web_auth"})}),(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.a,{href:"https://pub.dev/packages/flutter_web_auth",children:"flutter_web_auth"})," \u5728 Logto \u7684 flutter SDK \u4e2d\u88ab\u4f7f\u7528\u3002\u6211\u5011\u4f9d\u8cf4\u5176\u57fa\u65bc webview \u7684\u4e92\u52d5\u4ecb\u9762\u4f86\u958b\u555f Logto \u7684\u6388\u6b0a\u9801\u9762\u3002"]}),(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"\u6b64\u63d2\u4ef6\u5728 iOS 12+ \u548c macOS 10.15+ \u4e0a\u4f7f\u7528 ASWebAuthenticationSession\uff0c\u5728 iOS 11 \u4e0a\u4f7f\u7528 SFAuthenticationSession\uff0c\u5728 Android \u4e0a\u4f7f\u7528 Chrome Custom Tabs\uff0c\u4e26\u5728 Web \u4e0a\u958b\u555f\u65b0\u8996\u7a97\u3002\n\u4f60\u53ef\u4ee5\u5728 iOS 8+ \u4e0a\u69cb\u5efa\u5b83\uff0c\u4f46\u76ee\u524d\u50c5\u652f\u63f4 iOS 11 \u6216\u66f4\u9ad8\u7248\u672c\u3002"})}),(0,o.jsx)(t.h3,{id:"register-the-callback-url-on-android",children:"\u5728 Android \u4e0a\u8a3b\u518a\u56de\u547c URL"}),(0,o.jsx)(t.p,{children:"\u70ba\u4e86\u5f9e Logto \u7684\u767b\u5165\u7db2\u9801\u6355\u7372\u56de\u547c URL\uff0c\u4f60\u9700\u8981\u5c07\u4f60\u7684\u767b\u5165 redirectUri \u8a3b\u518a\u5230 AndroidManifest.xml \u4e2d\u3002"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-xml",children:'<activity android:name="com.linusu.flutter_web_auth.CallbackActivity" android:exported="true">\n    <intent-filter android:label="flutter_web_auth">\n        <action android:name="android.intent.action.VIEW"/>\n        <category android:name="android.intent.category.DEFAULT"/>\n        <category android:name="android.intent.category.BROWSABLE"/>\n        <data android:scheme="io.logto"/>\n    </intent-filter>\n</activity>\n'})})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}const g={slug:"/quick-starts/flutter-flow",sidebar_label:"FlutterFlow",sidebar_custom_props:{description:"FlutterFlow \u662f\u4e00\u500b\u7528\u65bc\u69cb\u5efa\u6df7\u5408 Flutter \u61c9\u7528\u7a0b\u5f0f\u7684\u4f4e\u4ee3\u78bc\u6846\u67b6\u3002"}},x="\u4f7f\u7528 Logto SDK \u81ea\u8a02 FlutterFlow CustomAuthManager",m={},j=[{value:"\u5148\u6c7a\u689d\u4ef6",id:"prerequisites",level:2},{value:"\u555f\u7528 FlutterFlow \u81ea\u8a02\u4ee3\u78bc",id:"enable-flutterflow-custom-code",level:2},{value:"\u5728 FlutterFlow \u4e2d\u5275\u5efa\u4f60\u7684 UI",id:"create-your-ui-in-flutterflow",level:2},{value:"\u81ea\u8a02 CustomAuthManager",id:"customize-the-customauthmanager",level:2},{value:"\u5b89\u88dd Logto SDK \u4f9d\u8cf4",id:"install-logto-sdk-dependency",level:3},{value:"\u66f4\u65b0 UserProvider",id:"update-the-userprovider",level:3},{value:"\u5728 CustomAuthManager \u4e2d\u521d\u59cb\u5316 logto \u5ba2\u6236\u7aef",id:"init-the-logto-client-in-customauthmanager",level:3},{value:"\u5be6\u73fe\u767b\u5165\u65b9\u6cd5",id:"implement-the-sign-in-method",level:3},{value:"\u5be6\u73fe\u767b\u51fa\u65b9\u6cd5",id:"implement-the-sign-out-method",level:3},{value:"\u66f4\u65b0\u9a57\u8b49\u5de5\u5177\u65b9\u6cd5",id:"update-the-auth-util-methods",level:3},{value:"\u5728\u4f60\u7684 UI \u4e2d\u6574\u5408\u81ea\u8a02\u9a57\u8b49",id:"integrate-the-custom-authentication-in-your-ui",level:2},{value:"\u4e3b\u9801",id:"home-page",level:3},{value:"\u7528\u6236\u8cc7\u6599\u9801\u9762",id:"user-profile-page",level:3},{value:"\u9032\u4e00\u6b65\u95b1\u8b80",id:"further-readings",level:2},{value:"\u4f9d\u8cf4\u554f\u984c\u6392\u67e5",id:"dependency-troubleshooting",level:2},{value:"flutter_secure_storage",id:"flutter_secure_storage",level:3},{value:"\u914d\u7f6e Android \u7248\u672c\uff1a",id:"config-android-version",level:3},{value:"\u7981\u7528\u81ea\u52d5\u5099\u4efd\uff1a",id:"disable-autobackup",level:3},{value:"flutter_web_auth",id:"flutter_web_auth",level:3},{value:"\u5728 Android \u4e0a\u8a3b\u518a\u56de\u547c URL",id:"register-the-callback-url-on-android",level:3}];function f(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"\u4f7f\u7528-logto-sdk-\u81ea\u8a02-flutterflow-customauthmanager",children:"\u4f7f\u7528 Logto SDK \u81ea\u8a02 FlutterFlow CustomAuthManager"})}),"\n",(0,o.jsxs)(t.p,{children:["FlutterFlow \u5167\u5efa\u7684 ",(0,o.jsx)(t.a,{href:"https://docs.flutterflow.io/data-and-backend/custom-authentication",children:"\u81ea\u8a02\u9a57\u8b49 (custom authentication)"})," \u529f\u80fd\u5141\u8a31\u4f60\u4f7f\u7528\u81ea\u5df1\u7684\u5f8c\u7aef\u4f86\u9a57\u8b49\u4f7f\u7528\u8005\u3002\u7136\u800c\uff0c\u5167\u5efa\u7684\u81ea\u8a02\u9a57\u8b49\u6d41\u7a0b\u8a2d\u8a08\u70ba\u50c5\u9700\u55ae\u4e00\u9a57\u8b49 API \u547c\u53eb\u5373\u53ef\u904b\u4f5c\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7b2c\u4e09\u65b9\u8eab\u5206\u63d0\u4f9b\u8005 (IdP)\uff0c\u9a57\u8b49\u8acb\u6c42\u53ea\u80fd\u4f7f\u7528 ",(0,o.jsx)(t.code,{children:"Resource Owner Password Credentials"})," \u6388\u6b0a\u985e\u578b\uff0c\u9019\u4e0d\u5efa\u8b70\u7528\u65bc\u751f\u7522\u74b0\u5883\u3002\u8a73\u60c5\u8acb\u53c3\u95b1 ",(0,o.jsx)(t.a,{href:"https://blog.logto.io/deprecated-ropc-grant-type/",children:"Deprecated ropc grant type"}),"\u3002"]}),"\n",(0,o.jsxs)(t.p,{children:["\u6a19\u6e96\u7684 OpenID Connect (OIDC) \u9a57\u8b49\u6d41\u7a0b\u6d89\u53ca\u591a\u500b\u6b65\u9a5f\uff0c\u4f8b\u5982\u6388\u6b0a\u3001\u6b0a\u6756\u4ea4\u63db\u548c\u4f7f\u7528\u8005\u8cc7\u8a0a\u6aa2\u7d22\u3002\u8981\u5728 FlutterFlow \u4e2d\u4f7f\u7528\u50cf Logto \u9019\u6a23\u7684 IdP \u5be6\u73fe\u6a19\u6e96 OIDC \u9a57\u8b49\u6d41\u7a0b\uff0c\u4f60\u9700\u8981\u81ea\u8a02 FlutterFlow \u4e2d\u7684 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u3002"]}),"\n",(0,o.jsxs)(t.p,{children:["\u672c\u6559\u7a0b\u5c07\u5411\u4f60\u5c55\u793a\u5982\u4f55\u4f7f\u7528 Logto ",(0,o.jsx)(t.a,{href:"/zh-TW/quick-starts/flutter",children:"Flutter SDK"})," \u81ea\u8a02 FlutterFlow \u4e2d\u7684 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u3002\u4f60\u53ef\u4ee5\u5229\u7528 Logto SDK \u9032\u884c\u6a19\u6e96 OIDC \u9a57\u8b49\u6d41\u7a0b\uff0c\u540c\u6642\u4fdd\u7559 FlutterFlow UI \u69cb\u5efa\u5668\u7684\u512a\u52e2\u3002"]}),"\n",(0,o.jsx)(t.admonition,{type:"tip",children:(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Logto SDK \u5957\u4ef6\u53ef\u5728 ",(0,o.jsx)(t.a,{href:"https://pub.dev/packages/logto_dart_sdk",children:"pub.dev"})," \u548c Logto ",(0,o.jsx)(t.a,{href:"https://github.com/logto-io/dart",children:"GitHub \u5132\u5b58\u5eab"})," \u4e0a\u7372\u5f97\u3002"]}),"\n",(0,o.jsx)(t.li,{children:"\u8a72 SDK \u76ee\u524d\u50c5\u9069\u7528\u65bc Android \u548c iOS \u5e73\u53f0\u3002"}),"\n"]})}),"\n",(0,o.jsx)(t.h2,{id:"prerequisites",children:"\u5148\u6c7a\u689d\u4ef6"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\u4e00\u500b ",(0,o.jsx)(t.a,{href:"https://cloud.logto.io",children:"Logto Cloud"})," \u5e33\u6236\u6216 ",(0,o.jsx)(t.a,{href:"/introduction/set-up-logto-oss",children:"\u81ea\u8a17\u7ba1 Logto"}),"\u3002"]}),"\n",(0,o.jsx)(t.li,{children:"\u5275\u5efa\u4e00\u500b Logto Flutter \u61c9\u7528\u7a0b\u5f0f\u3002"}),"\n",(0,o.jsx)(t.li,{children:"\u4e00\u500b FlutterFlow \u5c08\u6848\u3002"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"enable-flutterflow-custom-code",children:"\u555f\u7528 FlutterFlow \u81ea\u8a02\u4ee3\u78bc"}),"\n",(0,o.jsxs)(t.p,{children:["\u70ba\u4e86\u81ea\u8a02 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\uff0c\u4f60\u9700\u8981\u5728 FlutterFlow \u4e2d\u555f\u7528\u81ea\u8a02\u4ee3\u78bc\u529f\u80fd\u3002\u6309\u7167 ",(0,o.jsx)(t.a,{href:"https://docs.flutterflow.io/customizing-your-app/manage-custom-code-in-github",children:"Manage Custom Code In GitHub"})," \u6307\u5357\u5c07\u4f60\u7684 FlutterFlow \u5c08\u6848\u8207 GitHub \u540c\u6b65\u3002"]}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"\u5728 GitHub \u4e2d\u7ba1\u7406\u81ea\u8a02\u4ee3\u78bc\u662f FlutterFlow \u7684\u9ad8\u7d1a\u529f\u80fd\u3002\u4f60\u9700\u8981\u5347\u7d1a\u4f60\u7684 FlutterFlow \u5230\u5c08\u696d\u8a08\u5283\u4ee5\u555f\u7528\u6b64\u529f\u80fd\u3002"})}),"\n",(0,o.jsx)(t.p,{children:"\u5b8c\u6210\u5f8c\uff0c\u4f60\u7684 GitHub FlutterFlow \u5132\u5b58\u5eab\u4e2d\u5c07\u6709\u4e09\u500b\u4e0d\u540c\u7684\u5206\u652f\uff1a"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"main"}),"\uff1aFlutter \u5c08\u6848\u7684\u4e3b\u5206\u652f\u3002\u4f60\u9700\u8981\u6b64\u5206\u652f\u4f86\u90e8\u7f72\u4f60\u7684\u5c08\u6848\u3002"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"flutterflow"}),"\uff1a",(0,o.jsx)(t.code,{children:"FlutterFlow"})," \u5c07\u5f9e FlutterFlow \u7de8\u8f2f\u5668\u540c\u6b65\u66f4\u6539\u7684\u5206\u652f\u3002"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"develop"}),"\uff1a\u4f60\u53ef\u4ee5\u5728\u6b64\u5206\u652f\u4e2d\u4fee\u6539\u81ea\u8a02\u4ee3\u78bc\u3002"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"create-your-ui-in-flutterflow",children:"\u5728 FlutterFlow \u4e2d\u5275\u5efa\u4f60\u7684 UI"}),"\n",(0,o.jsxs)(t.p,{children:["\u9996\u5148\uff0c\u5728 FlutterFlow \u4e2d\u5275\u5efa\u4f60\u7684 UI\u3002\u4f60\u53ef\u4ee5\u6309\u7167 ",(0,o.jsx)(t.a,{href:"https://docs.flutterflow.io/",children:"FlutterFlow \u6587\u6a94"})," \u6839\u64da\u4f60\u7684\u9700\u6c42\u5275\u5efa UI\u3002\u5c0d\u65bc\u672c\u6559\u7a0b\uff0c\u6700\u4f4e\u8981\u6c42\u662f\u5275\u5efa\u5169\u500b\u9801\u9762\uff1a"]}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"\u4e00\u500b\u5e36\u6709\u767b\u5165\u6309\u9215\u7684\u7c21\u55ae\u4e3b\u9801\u3002"}),"\n",(0,o.jsx)(t.li,{children:"\u4e00\u500b\u7528\u6236\u8cc7\u6599\u9801\u9762\uff0c\u7528\u65bc\u986f\u793a\u7528\u6236\u8cc7\u8a0a\u548c\u767b\u51fa\u6309\u9215\u3002"}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["\u9032\u5165 ",(0,o.jsx)(t.code,{children:"App Settings"})," -> ",(0,o.jsx)(t.code,{children:"Authentication"})," \u9801\u9762\u4e26\u555f\u7528\u81ea\u8a02\u9a57\u8b49\u3002\u9019\u5c07\u5728\u4f60\u7684 FlutterFlow \u5c08\u6848\u4e2d\u5275\u5efa\u4e00\u500b ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u3002"]}),"\n",(0,o.jsx)("center",{children:(0,o.jsx)("img",{src:"/img/assets/flutter-flow-custom-authentication.png",alt:"FlutterFlow \u81ea\u8a02\u9a57\u8b49"})}),"\n",(0,o.jsxs)(t.p,{children:["UI \u6e96\u5099\u597d\u5f8c\uff0c\u5c0e\u822a\u5230 ",(0,o.jsx)(t.code,{children:"integrations"})," -> ",(0,o.jsx)(t.code,{children:"GitHub"})," \u9801\u9762\uff0c\u7136\u5f8c\u9ede\u64ca ",(0,o.jsx)(t.code,{children:"Push to Repository"})," \u6309\u9215\u5c07\u66f4\u6539\u63a8\u9001\u5230 ",(0,o.jsx)(t.code,{children:"flutterflow"})," \u5206\u652f\u3002"]}),"\n",(0,o.jsx)("center",{children:(0,o.jsx)("img",{src:"/img/assets/flutter-flow-github-push.png",alt:"FlutterFlow GitHub \u63a8\u9001"})}),"\n",(0,o.jsx)(t.h2,{id:"customize-the-customauthmanager",children:"\u81ea\u8a02 CustomAuthManager"}),"\n",(0,o.jsxs)(t.p,{children:["\u5207\u63db\u5230 GitHub \u5132\u5b58\u5eab\u4e2d\u7684 ",(0,o.jsx)(t.code,{children:"develop"})," \u5206\u652f\uff0c\u4e26\u5408\u4f75\u4f86\u81ea ",(0,o.jsx)(t.code,{children:"flutterflow"})," \u5206\u652f\u7684\u6700\u65b0\u66f4\u6539\u3002\u5305\u62ec\u4f60\u7684 UI \u9801\u9762\u548c\u9810\u5efa\u7684 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u3002"]}),"\n",(0,o.jsx)(t.h3,{id:"install-logto-sdk-dependency",children:"\u5b89\u88dd Logto SDK \u4f9d\u8cf4"}),"\n",(0,o.jsx)(t.p,{children:"\u5c07 Logto SDK \u4f9d\u8cf4\u6dfb\u52a0\u5230\u4f60\u7684\u5c08\u6848\u4e2d\u3002"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"  flutter pub add logto_dart_sdk\n"})}),"\n",(0,o.jsxs)(t.admonition,{type:"note",children:[(0,o.jsx)(t.p,{children:"\u53ef\u9078\u7684 Http \u5957\u4ef6\uff1a"}),(0,o.jsxs)(t.p,{children:["Logto \u5ba2\u6236\u7aef\u9700\u8981\u4e00\u500b http \u5ba2\u6236\u7aef\u4f86\u9032\u884c API \u547c\u53eb\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,o.jsx)(t.code,{children:"http"})," \u5957\u4ef6\u6216\u4efb\u4f55\u5176\u4ed6\u4f60\u9078\u64c7\u7684 http \u5ba2\u6236\u7aef\u5957\u4ef6\u3002"]}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"  flutter pub add http\n"})})]}),"\n",(0,o.jsx)(t.h3,{id:"update-the-userprovider",children:"\u66f4\u65b0 UserProvider"}),"\n",(0,o.jsxs)(t.p,{children:["\u5c07 ",(0,o.jsx)(t.code,{children:"OpenIdClaims"})," \u985e\u5225\u6dfb\u52a0\u5230 ",(0,o.jsx)(t.code,{children:"CustomAuthUserProvider"})," \u985e\u5225\u4e2d\u4ee5\u5b58\u5132\u7528\u6236\u8cc7\u8a0a\u3002"]}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"OpenIdClaims"})," \u985e\u5225\u662f Logto SDK \u7684\u4e00\u90e8\u5206\uff0c\u5c07\u63d0\u4f9b\u5df2\u9a57\u8b49\u7528\u6236\u7684 ",(0,o.jsx)(t.code,{children:"id_token"})," \u5ba3\u544a\u3002"]}),"\n"]}),"\n",(0,o.jsx)(d,{}),"\n",(0,o.jsx)(t.h3,{id:"init-the-logto-client-in-customauthmanager",children:"\u5728 CustomAuthManager \u4e2d\u521d\u59cb\u5316 logto \u5ba2\u6236\u7aef"}),"\n",(0,o.jsxs)(t.p,{children:["\u5728 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u4e2d\u521d\u59cb\u5316 Logto \u5ba2\u6236\u7aef\u3002"]}),"\n",(0,o.jsx)(s,{}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"initialize"})," \u65b9\u6cd5\u5c07\u521d\u59cb\u5316 Logto \u5ba2\u6236\u7aef\u4e26\u4f7f\u7528\u672c\u5730\u5b58\u5132\u4e2d\u6301\u4e45\u5316\u7684\u7528\u6236\u9a57\u8b49\u72c0\u614b\u66f4\u65b0\u7576\u524d\u7528\u6236\u6d41\u3002"]}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:["Logto SDK \u4f7f\u7528 ",(0,o.jsx)(t.a,{href:"https://pub.dev/packages/flutter_secure_storage",children:"flutter_secure_storage"})," \u5957\u4ef6\u5b89\u5168\u5730\u5b58\u5132\u7528\u6236\u9a57\u8b49\u8cc7\u8a0a\u3002"]}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"implement-the-sign-in-method",children:"\u5be6\u73fe\u767b\u5165\u65b9\u6cd5"}),"\n",(0,o.jsxs)(t.p,{children:["\u8abf\u7528 ",(0,o.jsx)(t.code,{children:"LogtoClient.signIn"})," \u65b9\u6cd5\u5c07\u555f\u52d5\u6a19\u6e96 OIDC \u9a57\u8b49\u6d41\u7a0b\u3002Logto \u767b\u5165\u9801\u9762\u5c07\u4f7f\u7528 ",(0,o.jsx)(t.a,{href:"https://pub.dev/packages/flutter_web_auth",children:"flutter_web_auth"})," \u5728 webview \u4e2d\u6253\u958b\u3002"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/auth/custom_auth/custom_auth_manager.dart\n\nFuture<FlutterFlowAuthAuthUser?> signIn(\n    String redirectUri,\n  ) async {\n    await logtoClient.signIn(redirectUri);\n\n    var idTokenClaims = await logtoClient.idTokenClaims;\n\n    return _updateCurrentUser(\n      loggedIn: idTokenClaims != null,\n      uid: idTokenClaims?.subject,\n      idToken: idTokenClaims,\n    );\n  }\n\n"})}),"\n",(0,o.jsxs)(t.p,{children:["LogtoClient \u5c07\u8655\u7406\u6388\u6b0a\u3001\u6b0a\u6756\u4ea4\u63db\u548c\u7528\u6236\u8cc7\u8a0a\u6aa2\u7d22\u6b65\u9a5f\u3002\u4e00\u65e6\u7528\u6236\u9a57\u8b49\u6210\u529f\uff0c",(0,o.jsx)(t.code,{children:"idTokenClaims"})," \u5c07\u5b58\u5132\u5728\u672c\u5730\u5b58\u5132\u4e2d\u3002\n\u5f9e LogtoClient \u6aa2\u7d22 ",(0,o.jsx)(t.code,{children:"idTokenClaims"})," \u4e26\u66f4\u65b0\u7576\u524d\u7528\u6236\u6d41\u3002"]}),"\n",(0,o.jsx)(t.h3,{id:"implement-the-sign-out-method",children:"\u5be6\u73fe\u767b\u51fa\u65b9\u6cd5"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/auth/custom_auth/custom_auth_manager.dart\n\nFuture signOut() async {\n    await logtoClient.signOut();\n\n    flutterFlowAuthAuthUserSubject.add(\n      FlutterFlowAuthAuthUser(loggedIn: false),\n    );\n  }\n"})}),"\n",(0,o.jsx)(t.h3,{id:"update-the-auth-util-methods",children:"\u66f4\u65b0\u9a57\u8b49\u5de5\u5177\u65b9\u6cd5"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\u6dfb\u52a0 ",(0,o.jsx)(t.code,{children:"authManager"})," getter \u4ee5\u8a2a\u554f ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u5be6\u4f8b\u3002"]}),"\n",(0,o.jsxs)(t.li,{children:["\u6dfb\u52a0 ",(0,o.jsx)(t.code,{children:"currentUserUid"})," getter \u4ee5\u7372\u53d6\u7576\u524d\u7528\u6236 uid\u3002"]}),"\n",(0,o.jsxs)(t.li,{children:["\u6dfb\u52a0 ",(0,o.jsx)(t.code,{children:"currentUserData"})," getter \u4ee5\u7372\u53d6\u7576\u524d\u7528\u6236\u8cc7\u6599\u3002"]}),"\n",(0,o.jsxs)(t.li,{children:["\u6dfb\u52a0 ",(0,o.jsx)(t.code,{children:"logtoClient"})," getter \u4ee5\u8a2a\u554f Logto \u5ba2\u6236\u7aef\u5be6\u4f8b\u3002"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/auth/custom_auth/auth_util.dart\n\nimport 'package:logto_dart_sdk/logto_client.dart';\nimport 'package:logto_dart_sdk/src/modules/id_token.dart';\n\nimport 'custom_auth_manager.dart';\n\nexport 'custom_auth_manager.dart';\n\nfinal _authManager = CustomAuthManager();\nCustomAuthManager get authManager => _authManager;\nString get currentUserUid => currentUser?.uid ?? '';\nOpenIdClaims? get currentUserData => currentUser?.idToken;\nLogtoClient get logtoClient => _authManager.logtoClient;\n"})}),"\n",(0,o.jsx)(t.h2,{id:"integrate-the-custom-authentication-in-your-ui",children:"\u5728\u4f60\u7684 UI \u4e2d\u6574\u5408\u81ea\u8a02\u9a57\u8b49"}),"\n",(0,o.jsx)(t.h3,{id:"home-page",children:"\u4e3b\u9801"}),"\n",(0,o.jsxs)(t.p,{children:["\u7576\u7528\u6236\u9ede\u64ca\u767b\u5165\u6309\u9215\u6642\uff0c\u8abf\u7528 ",(0,o.jsx)(t.code,{children:"authManager.signIn"})," \u65b9\u6cd5\u4ee5\u555f\u52d5\u9a57\u8b49\u6d41\u7a0b\u3002"]}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"redirectUri"})," \u662f\u7528\u65bc\u5f9e Logto \u767b\u5165\u9801\u9762\u6355\u7372\u6388\u6b0a\u56de\u8abf\u7684\u56de\u8abf URL\u3002\n\u6709\u95dc redirectUri \u7684\u66f4\u591a\u8a73\u7d30\u8cc7\u8a0a\uff0c\u8acb\u53c3\u95b1 ",(0,o.jsx)(t.a,{href:"/zh-TW/quick-starts/flutter#implement-sign-in",children:"Flutter SDK"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/pages/home_page/home_page_widget.dart\n\nfinal redirectUri = 'io.logto://callback';\n\n// ...\n\nFFButtonWidget(\n  onPressed: () async {\n    GoRouter.of(context).prepareAuthEvent();\n\n    await authManager.signIn(redirectUri);\n\n    context.replaceNamed('user');\n  },\n  text: 'Sign In',\n  // ...\n)\n"})}),"\n",(0,o.jsx)(t.h3,{id:"user-profile-page",children:"\u7528\u6236\u8cc7\u6599\u9801\u9762"}),"\n",(0,o.jsx)(t.p,{children:"\u4f7f\u7528\u9a57\u8b49\u5de5\u5177 getter \u8a2a\u554f\u7576\u524d\u7528\u6236\u8cc7\u6599\u548c Logto \u5ba2\u6236\u7aef\u5be6\u4f8b\u3002"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/pages/user/user_widget.dart\n\nimport '/auth/custom_auth/auth_util.dart';\n\n// ...\n\nchildren: [\n  Text(\n    'User ID: $currentUserUid',\n  ),\n  Text(\n    'Display Name: ${currentUserData?.name}',\n  ),\n  Text(\n    'Username: ${currentUserData?.username}',\n  ),\n  Text(\n    'Email: ${currentUserData?.emailVerified ?? currentUserData?.email}',\n  ),\n]\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"\u7576\u7528\u6236\u9ede\u64ca\u767b\u51fa\u6309\u9215\u6642\uff0c\u5be6\u73fe\u767b\u51fa\u65b9\u6cd5\u3002"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-dart",children:"// lib/pages/user/user_widget.dart\n\nFFButtonWidget(\n  onPressed: () async {\n    await authManager.signOut();\n\n    context.replaceNamed('HomePage');\n  },\n  text: 'Sign Out',\n  // ...\n)\n"})}),"\n",(0,o.jsx)(t.h2,{id:"further-readings",children:"\u9032\u4e00\u6b65\u95b1\u8b80"}),"\n",(0,o.jsxs)(t.p,{children:["Logto SDK \u63d0\u4f9b\u66f4\u591a\u65b9\u6cd5\u8207 Logto API \u4e92\u52d5\u3002\u4f60\u53ef\u4ee5\u9032\u4e00\u6b65\u81ea\u8a02 ",(0,o.jsx)(t.code,{children:"CustomAuthManager"})," \u985e\u5225\u4ee5\u5be6\u73fe\u66f4\u591a\u529f\u80fd\u3002"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"/zh-TW/quick-starts/flutter#get-user-information",children:"\u7528\u6236\u8cc7\u6599"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"/zh-TW/quick-starts/flutter#api-resources-and-organizations",children:"API \u8cc7\u6e90\u548c\u7d44\u7e54"})}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"dependency-troubleshooting",children:"\u4f9d\u8cf4\u554f\u984c\u6392\u67e5"}),"\n",(0,o.jsx)(c,{}),"\n",(0,o.jsx)(p,{})]})}function w(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(f,{...e})}):f(e)}},79621:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>s});var r=n(58101);const o={},i=r.createContext(o);function l(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);