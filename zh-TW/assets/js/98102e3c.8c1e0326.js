"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[1634],{50863:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"user-management/user-migration","title":"\u4f7f\u7528\u8005\u9077\u79fb (User migration)","description":"Logto \u652f\u63f4\u624b\u52d5\u5c07\u73fe\u6709\u4f7f\u7528\u8005\u5f9e\u5176\u4ed6\u5e73\u53f0\u9077\u79fb\uff0c\u672c\u6307\u5357\u5c07\u8aaa\u660e\u5982\u4f55\u900f\u904e Management API \u532f\u5165\u73fe\u6709\u4f7f\u7528\u8005\uff0c\u4e26\u4ecb\u7d39\u9077\u79fb\u524d\u4f60\u61c9\u8003\u616e\u7684\u4e8b\u9805\u3002","source":"@site/i18n/zh-TW/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","sourceDirName":"user-management","slug":"/user-management/user-migration","permalink":"/zh-TW/user-management/user-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/zh-TW/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"\u500b\u4eba\u5b58\u53d6\u6b0a\u6756 (Personal access token)","permalink":"/zh-TW/user-management/personal-access-token"},"next":{"title":"\u4f7f\u7528\u8005\u7ba1\u7406","permalink":"/zh-TW/user-management/"}}');var t=s(25105),o=s(79621);const a={sidebar_position:5},i="\u4f7f\u7528\u8005\u9077\u79fb (User migration)",c={},d=[{value:"\u4f7f\u7528\u8005\u7d50\u69cb (User schema)",id:"user-schema",level:2},{value:"\u5bc6\u78bc\u96dc\u6e4a (Password hashing)",id:"password-hashing",level:2},{value:"\u9077\u79fb\u6b65\u9a5f (Steps to migrate)",id:"steps-to-migrate",level:2},{value:"\u76f8\u95dc\u8cc7\u6e90 (Related resources)",id:"related-resources",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components},{Url:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\u4f7f\u7528\u8005\u9077\u79fb-user-migration",children:"\u4f7f\u7528\u8005\u9077\u79fb (User migration)"})}),"\n",(0,t.jsx)(n.p,{children:"Logto \u652f\u63f4\u624b\u52d5\u5c07\u73fe\u6709\u4f7f\u7528\u8005\u5f9e\u5176\u4ed6\u5e73\u53f0\u9077\u79fb\uff0c\u672c\u6307\u5357\u5c07\u8aaa\u660e\u5982\u4f55\u900f\u904e Management API \u532f\u5165\u73fe\u6709\u4f7f\u7528\u8005\uff0c\u4e26\u4ecb\u7d39\u9077\u79fb\u524d\u4f60\u61c9\u8003\u616e\u7684\u4e8b\u9805\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"user-schema",children:"\u4f7f\u7528\u8005\u7d50\u69cb (User schema)"}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u958b\u59cb\u4e4b\u524d\uff0c\u8b93\u6211\u5011\u5148\u770b\u770b Logto \u7684 ",(0,t.jsx)(n.a,{href:"/user-management/user-data/#user-profile",children:"\u4f7f\u7528\u8005\u7d50\u69cb"}),"\u3002\u4f60\u9700\u8981\u6ce8\u610f\u4f7f\u7528\u8005\u7d50\u69cb\u7684\u4e09\u500b\u90e8\u5206\uff1a"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u57fa\u672c\u8cc7\u6599 (Basic data)"}),"\uff1a\u4f86\u81ea\u4f7f\u7528\u8005\u6a94\u6848\u7684\u57fa\u672c\u8cc7\u8a0a\uff0c\u4f60\u53ef\u4ee5\u5c07\u73fe\u6709\u4f7f\u7528\u8005\u6a94\u6848\u7684\u8cc7\u6599\u5c0d\u61c9\u5230\u9019\u88e1\u3002"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u81ea\u8a02\u8cc7\u6599 (Custom data)"}),"\uff1a\u5132\u5b58\u984d\u5916\u7684\u4f7f\u7528\u8005\u8cc7\u8a0a\uff0c\u9069\u5408\u5b58\u653e\u7121\u6cd5\u5c0d\u61c9\u5230\u57fa\u672c\u8cc7\u6599\u7684\u6b04\u4f4d\u3002"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u793e\u4ea4\u8eab\u5206 (Social identities)"}),"\uff1a\u5132\u5b58\u5f9e\u793e\u4ea4\u767b\u5165\u53d6\u5f97\u7684\u4f7f\u7528\u8005\u8cc7\u8a0a\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u5c0d\u61c9\u8868\uff0c\u5c07\u73fe\u6709\u4f7f\u7528\u8005\u6a94\u6848\u7684\u8cc7\u8a0a\u5c0d\u61c9\u5230 ",(0,t.jsx)(n.strong,{children:"\u57fa\u672c\u8cc7\u6599 (basic data)"})," \u8207 ",(0,t.jsx)(n.strong,{children:"\u81ea\u8a02\u8cc7\u6599 (custom data)"}),"\u3002\u82e5\u6709\u793e\u4ea4\u767b\u5165\uff0c\u9700\u984d\u5916\u6b65\u9a5f\u532f\u5165\u793e\u4ea4\u8eab\u5206\uff0c\u8acb\u53c3\u8003 ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/operation/operation-createuseridentity",children:"\u9023\u7d50\u793e\u4ea4\u8eab\u5206\u81f3\u4f7f\u7528\u8005 (Link social identity to user)"})," \u7684 API\u3002"]}),"\n",(0,t.jsx)(n.h2,{id:"password-hashing",children:"\u5bc6\u78bc\u96dc\u6e4a (Password hashing)"}),"\n",(0,t.jsxs)(n.p,{children:["Logto \u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Argon2",children:"Argon2"})," \u9032\u884c\u4f7f\u7528\u8005\u5bc6\u78bc\u96dc\u6e4a\uff0c\u4e26\u70ba\u9077\u79fb\u65b9\u4fbf\uff0c\u4e5f\u652f\u63f4 ",(0,t.jsx)(n.code,{children:"MD5"}),"\u3001",(0,t.jsx)(n.code,{children:"SHA1"}),"\u3001",(0,t.jsx)(n.code,{children:"SHA256"})," \u548c ",(0,t.jsx)(n.code,{children:"Bcrypt"})," \u7b49\u5176\u4ed6\u6f14\u7b97\u6cd5\u3002\u9019\u4e9b\u6f14\u7b97\u6cd5\u88ab\u8a8d\u70ba\u4e0d\u5b89\u5168\uff0c\u5c0d\u61c9\u7684\u5bc6\u78bc\u96dc\u6e4a\u503c\u6703\u5728\u4f7f\u7528\u8005\u9996\u6b21\u6210\u529f\u767b\u5165\u6642\u81ea\u52d5\u9077\u79fb\u70ba Argon2\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u4f7f\u7528\u5176\u4ed6\u96dc\u6e4a\u6f14\u7b97\u6cd5\u6216\u52a0\u9e7d\uff0c\u53ef\u4ee5\u5c07 ",(0,t.jsx)(n.code,{children:"passwordAlgorithm"})," \u8a2d\u70ba ",(0,t.jsx)(n.code,{children:"Legacy"}),"\uff0c\u9019\u6a23\u53ef\u4f7f\u7528 Node.js \u652f\u63f4\u7684\u4efb\u4f55\u96dc\u6e4a\u6f14\u7b97\u6cd5\u3002\u652f\u63f4\u7684\u6f14\u7b97\u6cd5\u5217\u8868\u53ef\u53c3\u8003 ",(0,t.jsx)(n.a,{href:"https://nodejs.org/api/crypto.html#cryptogethashes",children:"Node.js crypto \u6587\u4ef6"}),"\u3002\u6b64\u60c5\u6cc1\u4e0b\uff0c",(0,t.jsx)(n.code,{children:"passwordDigest"})," \u9700\u70ba\u5305\u542b\u96dc\u6e4a\u6f14\u7b97\u6cd5\u53ca\u5176\u4ed6\u53c3\u6578\u7684 JSON \u5b57\u4e32\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"JSON \u5b57\u4e32\u683c\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'["hash_algorithm", ["argument1", "argument2", ...], "expected_hashed_value"]\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u7528 ",(0,t.jsx)(n.code,{children:"@"})," \u4f5c\u70ba\u53c3\u6578\u4e2d\u7684\u5be6\u969b\u5bc6\u78bc\u503c\u4f54\u4f4d\u7b26\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u82e5\u4f60\u4f7f\u7528 SHA256 \u4e26\u52a0\u9e7d\uff0c\u53ef\u5c07\u5bc6\u78bc\u5132\u5b58\u70ba\u4e0b\u5217\u683c\u5f0f\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'["sha256", ["salt123", "@"], "c465f66c6ac481a7a17e9ed5b4e2e7e7288d892f12bf1c95c140901e9a70436e"]\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u9019\u7b49\u540c\u65bc\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const hash = crypto.createHash('sha256');\nhash.update('salt123' + 'password123');\nconst expectedHashedValue = hash.digest('hex');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"steps-to-migrate",children:"\u9077\u79fb\u6b65\u9a5f (Steps to migrate)"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u6e96\u5099\u4f7f\u7528\u8005\u8cc7\u6599 (Prepare the user data)"}),"\n\u4f60\u61c9\u5148\u5f9e\u73fe\u6709\u5e73\u53f0\u532f\u51fa\u4f7f\u7528\u8005\u8cc7\u6599\uff0c\u4e26\u5c07\u4f7f\u7528\u8005\u8cc7\u8a0a\u5c0d\u61c9\u5230 Logto \u7684\u4f7f\u7528\u8005\u7d50\u69cb\u3002\u6211\u5011\u5efa\u8b70\u4f60\u5c07\u5c0d\u61c9\u5f8c\u7684\u8cc7\u6599\u6574\u7406\u70ba JSON \u683c\u5f0f\u3002\u4ee5\u4e0b\u70ba\u4f7f\u7528\u8005\u8cc7\u6599\u7bc4\u4f8b\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "username": "user1",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  },\n  {\n    "username": "user2",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  }\n]\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u5efa\u7acb Logto \u79df\u6236 (Create a Logto tenant)"}),"\n\u4f60\u9700\u8981\u5728 Logto \u5efa\u7acb\u4e00\u500b\u79df\u6236\u3002\u53ef\u9078\u64c7 Logto Cloud \u6216 Logto OSS\u3002\u82e5\u5c1a\u672a\u5efa\u7acb\uff0c\u8acb\u53c3\u8003 ",(0,t.jsx)(n.a,{href:"/introduction/set-up-logto-cloud/#create-logto-tenant",children:"\u8a2d\u5b9a Logto Cloud"})," \u6307\u5357\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u8a2d\u5b9a Management API \u9023\u7dda (Setup the connection of Management API)"}),"\n\u6211\u5011\u5c07\u4f7f\u7528 Management API \u532f\u5165\u4f7f\u7528\u8005\u8cc7\u6599\uff0c\u8acb\u53c3\u8003 ",(0,t.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," \u4e86\u89e3\u5982\u4f55\u5728\u958b\u767c\u74b0\u5883\u4e2d\u8a2d\u5b9a\u9023\u7dda\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u532f\u5165\u4f7f\u7528\u8005\u8cc7\u6599 (Import the user data)"}),"\n\u5efa\u8b70\u4f60\u64b0\u5beb\u8173\u672c\u9010\u4e00\u532f\u5165\u4f7f\u7528\u8005\u8cc7\u6599\uff0c\u5c07\u547c\u53eb ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/operation/operation-createuser",children:"\u5efa\u7acb\u4f7f\u7528\u8005 (create user)"})," API \u4f86\u532f\u5165\u3002\u4ee5\u4e0b\u70ba\u8173\u672c\u7bc4\u4f8b\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"const users = require('./users.json');\n\nconst importUsers = async () => {\n  for (const user of users) {\n    try {\n      await fetch('https://[tenant_id].logto.app/api/users', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer [your-access-token]',\n        },\n        body: JSON.stringify(user),\n      });\n      // Sleep for a while to avoid rate limit\n      await new Promise((resolve) => setTimeout(resolve, 200));\n    } catch (error) {\n      console.error(`Failed to import user ${user.username}: ${error.message}`);\n    }\n  }\n};\n\nimportUsers();\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u8acb\u6ce8\u610f API \u7aef\u9ede\u6709\u901f\u7387\u9650\u5236\uff0c\u4f60\u61c9\u5728\u6bcf\u6b21\u8acb\u6c42\u9593\u52a0\u5165\u5ef6\u9072\u4ee5\u907f\u514d\u89f8\u767c\u9650\u5236\u3002\u8a73\u60c5\u8acb\u53c3\u95b1 ",(0,t.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api/#rate-limit",children:"\u901f\u7387\u9650\u5236 (rate limits)"})," \u9801\u9762\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u82e5\u4f60\u6709\u5927\u91cf\u4f7f\u7528\u8005\u8cc7\u6599\uff0810 \u842c\u4ee5\u4e0a\uff09\uff0c\u53ef",(0,t.jsx)(n.a,{href:"https://logto.io/contact",children:"\u806f\u7d61\u6211\u5011"}),"\u4ee5\u63d0\u5347\u901f\u7387\u9650\u5236\u3002"]}),"\n",(0,t.jsx)(n.h2,{id:"related-resources",children:"\u76f8\u95dc\u8cc7\u6e90 (Related resources)"}),"\n",(0,t.jsx)(s,{href:"https://blog.logto.io/general-migration-guide",children:(0,t.jsx)(n.p,{children:"\u5c07\u73fe\u6709\u4f7f\u7528\u8005\u8cc7\u6599\u5eab\u9077\u79fb\u81f3 Logto \u7684\u4e00\u822c\u6307\u5f15"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},79621:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var r=s(58101);const t={},o=r.createContext(t);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);