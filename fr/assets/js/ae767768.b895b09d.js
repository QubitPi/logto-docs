"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[8678],{52760:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>m,contentTitle:()=>h,default:()=>f,frontMatter:()=>p,metadata:()=>r,resource:()=>x,toc:()=>g});const r=JSON.parse('{"id":"authorization/global-api-resources","title":"Prot\xe9ger les ressources API globales","description":"Prot\xe9gez les API \xe0 l\u2019\xe9chelle du produit en utilisant le contr\xf4le d\u2019acc\xe8s bas\xe9 sur les r\xf4les (RBAC) dans Logto. Attribuez des r\xf4les et des permissions globales pour contr\xf4ler l\u2019acc\xe8s de tous les utilisateurs et clients \xe0 travers votre application.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","sourceDirName":"authorization","slug":"/authorization/global-api-resources","permalink":"/fr/authorization/global-api-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/authorization/global-api-resources.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Mod\xe8le d\u2019organisation","permalink":"/fr/authorization/organization-template"},"next":{"title":"Prot\xe9ger les permissions d\u2019organisation (hors API)","permalink":"/fr/authorization/organization-permissions"}}');var t=n(25105),i=n(79621),o=n(46643),a=n(39088),l=n(78506),c=n(42372),u=n(38552),d=n(22002);const p={sidebar_position:3},h="Prot\xe9ger les ressources API globales",m={},x="https://api.your-app.com",g=[{value:"Qu\u2019est-ce qu\u2019une ressource API globale ?",id:"what-are-global-api-resources",level:2},{value:"Fonctionnement dans Logto",id:"how-it-works-in-logto",level:2},{value:"Vue d\u2019ensemble de l\u2019impl\xe9mentation",id:"implementation-overview",level:3},{value:"Comprendre les indicateurs de ressource",id:"understanding-resource-indicators",level:3},{value:"Flux d\u2019autorisation : authentifier et s\xe9curiser votre API",id:"authorization-flow-authenticating-and-securing-your-api",level:3},{value:"\xc9tapes d\u2019impl\xe9mentation",id:"implementation-steps",level:2},{value:"Enregistrez vos ressources API",id:"register-your-api-resources",level:3},{value:"Configurez les r\xf4les globaux",id:"set-up-global-roles",level:3},{value:"Obtenez des jetons d\u2019acc\xe8s pour les ressources API globales",id:"obtain-access-tokens-for-global-api-resources",level:3},{value:"Flux authorization code ou refresh token",id:"authorization-code-or-refresh-token-flow",level:4},{value:"Flux client credentials",id:"client-credentials-flow",level:4},{value:"Validation des jetons d\u2019acc\xe8s JWT dans votre API",id:"validating-jwt-access-tokens-in-your-api",level:3},{value:"Optionnel : G\xe9rer le changement de permission utilisateur",id:"optional-handle-user-permission-change",level:3},{value:"Bonnes pratiques et conseils de s\xe9curit\xe9",id:"best-practices-and-security-tips",level:2},{value:"FAQ",id:"faqs",level:2},{value:"Que faire si mon client ne prend pas en charge le param\xe8tre resource ?",id:"what-if-my-client-doesn-t-support-the-resource-parameter",level:3},{value:"Pourquoi mon API retourne-t-elle 401 Non autoris\xe9 ?",id:"why-do-i-get-401-unauthorized-from-my-api",level:3},{value:"Comment tester sans client complet ?",id:"how-do-i-test-without-a-full-client",level:3},{value:"Pour aller plus loin",id:"further-reading",level:2}];function j(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{CloudLink:n,Details:r,Url:p}=s;return n||v("CloudLink",!0),r||v("Details",!0),p||v("Url",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"prot\xe9ger-les-ressources-api-globales",children:"Prot\xe9ger les ressources API globales"})}),"\n","\n",(0,t.jsx)(s.p,{children:"Prot\xe9gez les API \xe0 l\u2019\xe9chelle du produit en utilisant le contr\xf4le d\u2019acc\xe8s bas\xe9 sur les r\xf4les (RBAC) dans Logto. Attribuez des r\xf4les et des permissions globales pour contr\xf4ler l\u2019acc\xe8s de tous les utilisateurs et clients \xe0 travers votre application."}),"\n",(0,t.jsx)(s.h2,{id:"what-are-global-api-resources",children:"Qu\u2019est-ce qu\u2019une ressource API globale ?"}),"\n",(0,t.jsx)(s.p,{children:"Les ressources API globales sont des points de terminaison ou des services dans votre application accessibles \xe0 tous les utilisateurs, quel que soit l\u2019organisation ou le locataire. Il s\u2019agit g\xe9n\xe9ralement d\u2019API publiques, de services c\u0153ur du produit ou de tout point de terminaison qui n\u2019est pas limit\xe9 \xe0 une organisation sp\xe9cifique."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Cas d\u2019utilisation courants"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"API publiques ou points de terminaison partag\xe9s entre tous vos utilisateurs."}),"\n",(0,t.jsx)(s.li,{children:"Microservices non li\xe9s \xe0 la multi-location."}),"\n",(0,t.jsxs)(s.li,{children:["API principales de l\u2019application (par exemple, ",(0,t.jsx)(s.code,{children:"/api/users"}),", ",(0,t.jsx)(s.code,{children:"/api/products"}),") utilis\xe9es par tous les clients."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Logto vous permet de s\xe9curiser ces API en utilisant OAuth 2.1, combin\xe9 \xe0 un contr\xf4le d\u2019acc\xe8s flexible bas\xe9 sur les r\xf4les."}),"\n",(0,t.jsx)(s.h2,{id:"how-it-works-in-logto",children:"Fonctionnement dans Logto"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Les ressources API et les permissions sont enregistr\xe9es globalement :"})," Chaque API que vous souhaitez prot\xe9ger est d\xe9finie avec un indicateur de ressource unique (URI) et un ensemble de permissions (port\xe9es) qui contr\xf4lent l\u2019acc\xe8s."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"L\u2019acc\xe8s est contr\xf4l\xe9 par des r\xf4les globaux :"})," Vous pouvez attribuer des permissions \xe0 des r\xf4les, qui sont ensuite attribu\xe9s \xe0 des utilisateurs ou des clients."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"S\xe9par\xe9 des permissions au niveau de l\u2019organisation :"})," Les ressources API globales n\u2019ont pas de contexte d\u2019organisation. Cependant, elles peuvent \xeatre utilis\xe9es en combinaison avec des r\xf4les d\u2019organisation pour fournir une couche de contexte suppl\xe9mentaire si n\xe9cessaire. Pour prot\xe9ger les API au niveau de l\u2019organisation, voir ",(0,t.jsx)(s.a,{href:"/authorization/organization-level-api-resources",children:"Prot\xe9ger les ressources API au niveau de l\u2019organisation"}),"."]}),"\n"]}),"\n",(0,t.jsx)("img",{src:o.A,alt:"Ressources API globales RBAC",style:{maxWidth:"100%"}}),"\n",(0,t.jsx)(s.h3,{id:"implementation-overview",children:"Vue d\u2019ensemble de l\u2019impl\xe9mentation"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Enregistrez votre ressource API"})," et d\xe9finissez ses permissions dans Logto."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"D\xe9finissez des r\xf4les"})," avec les permissions n\xe9cessaires pour acc\xe9der \xe0 l\u2019API."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Attribuez les r\xf4les"})," aux utilisateurs ou clients."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Utilisez les flux d\u2019autorisation OAuth 2.0"})," pour obtenir des jetons d\u2019acc\xe8s pour l\u2019API (le param\xe8tre resource doit correspondre \xe0 l\u2019identifiant API enregistr\xe9)."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Validez les jetons d\u2019acc\xe8s"})," dans votre API pour appliquer les permissions."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"understanding-resource-indicators",children:"Comprendre les indicateurs de ressource"}),"\n",(0,t.jsxs)(s.p,{children:["Logto mod\xe9lise les ressources API selon ",(0,t.jsx)(s.a,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707 : Indicateurs de ressource pour OAuth 2.0"}),". Un ",(0,t.jsx)(s.strong,{children:"indicateur de ressource"})," est un URI qui identifie de fa\xe7on unique l\u2019API ou le service cible demand\xe9."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Points cl\xe9s"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Les indicateurs de ressource doivent \xeatre des URI absolus (par exemple, ",(0,t.jsx)(s.code,{children:"https://api.example.com"}),")"]}),"\n",(0,t.jsx)(s.li,{children:"Pas de composant fragment ; \xe9vitez d\u2019utiliser des cha\xeenes de requ\xeate si possible."}),"\n",(0,t.jsx)(s.li,{children:"Les indicateurs de ressource permettent des jetons restreints \xe0 une audience et la prise en charge d\u2019architectures multi-API."}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Exemple"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Management API : ",(0,t.jsx)(s.code,{children:"https://my-tenant.logto.app/api"})]}),"\n",(0,t.jsxs)(s.li,{children:["API globale personnalis\xe9e : ",(0,t.jsx)(s.code,{children:"https://api.yourapp.com"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"authorization-flow-authenticating-and-securing-your-api",children:"Flux d\u2019autorisation : authentifier et s\xe9curiser votre API"}),"\n",(0,t.jsx)(s.p,{children:"Le flux ci-dessous s\u2019applique \xe0 la fois \xe0 l\u2019authentification interactive des utilisateurs (navigateur / application) et aux sc\xe9narios backend machine \xe0 machine (M2M)."}),"\n",(0,t.jsx)(s.p,{children:"Veuillez noter que ce flux ne d\xe9taille pas tous les param\xe8tres ou en-t\xeates requis, mais se concentre sur les \xe9tapes cl\xe9s. Continuez \xe0 lire pour voir comment ce flux fonctionne en pratique."}),"\n",(0,t.jsx)(s.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Logto\n    participant API as Ressource API\n\n    alt Authentification utilisateur\n        Client->>Logto: GET /oidc/auth\n        Logto->>Logto: Redirige l\u2019utilisateur vers la page de connexion\n        Logto->>Client: Redirige avec `authorization_code`\n        alt Utiliser le grant authorization_code\n            Client->>Logto: POST /oidc/token avec `grant_type=authorization_code`<br/>et param\xe8tre `resource`\n        else Utiliser le grant refresh_token\n            Client->>Logto: POST /oidc/token avec `grant_type=authorization_code`\n            Logto->>Client: Retourne un jeton de rafra\xeechissement\n            Client->>Logto: POST /oidc/token avec `grant_type=refresh_token`<br/>et param\xe8tre `resource`\n        end\n    else Authentification client machine \xe0 machine (M2M)\n        Client->>Logto: POST /oidc/token avec `grant_type=client_credentials`<br/>et param\xe8tre `resource`\n    end\n\n    Logto->>Client: Retourne un jeton d\u2019acc\xe8s (JSON Web Token)\n    Client->>API: Requ\xeate avec jeton Bearer\n    API->>API: Valide le jeton d\u2019acc\xe8s\n\n    alt Jeton valide\n      API->>Client: Retourne les donn\xe9es de la ressource prot\xe9g\xe9e\n    else Jeton invalide\n      API->>Client: 401 Non autoris\xe9\n    end"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:"Authentification utilisateur = navigateur / application. M2M = service backend ou script utilisant les identifiants client."})}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["Le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"})," doit correspondre exactement \xe0 l\u2019identifiant API (indicateur de ressource) que vous avez enregistr\xe9 dans Logto."]})}),"\n",(0,t.jsx)(s.h2,{id:"implementation-steps",children:"\xc9tapes d\u2019impl\xe9mentation"}),"\n",(0,t.jsx)(s.h3,{id:"register-your-api-resources",children:"Enregistrez vos ressources API"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Allez dans ",(0,t.jsx)(n,{to:"/api-resources",children:"Console \u2192 Ressources API"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Cr\xe9ez une nouvelle ressource API (par exemple, ",(0,t.jsx)(s.code,{children:"https://api.yourapp.com/org"}),") et d\xe9finissez ses permissions (port\xe9es)."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Pour toutes les \xe9tapes de configuration, voir ",(0,t.jsx)(s.a,{href:"/authorization/role-based-access-control#define-api-resources-with-permissions",children:"D\xe9finir des ressources API avec des permissions"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"set-up-global-roles",children:"Configurez les r\xf4les globaux"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Allez dans ",(0,t.jsx)(n,{to:"/roles",children:"Console \u2192 R\xf4les"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Cr\xe9ez des r\xf4les correspondant \xe0 vos permissions API (par exemple, ",(0,t.jsx)(s.code,{children:"read:products"}),", ",(0,t.jsx)(s.code,{children:"write:products"}),")."]}),"\n",(0,t.jsx)(s.li,{children:"Attribuez ces r\xf4les aux utilisateurs ou clients qui ont besoin d\u2019acc\xe9der \xe0 l\u2019API."}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Pour toutes les \xe9tapes de configuration, voir ",(0,t.jsx)(s.a,{href:"/authorization/role-based-access-control#configure-global-roles",children:"Utiliser les r\xf4les globaux"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"obtain-access-tokens-for-global-api-resources",children:"Obtenez des jetons d\u2019acc\xe8s pour les ressources API globales"}),"\n",(0,t.jsxs)(s.p,{children:["Avant d\u2019acc\xe9der \xe0 une ressource API globale, votre client doit obtenir un jeton d\u2019acc\xe8s. Logto \xe9met des ",(0,t.jsx)(s.a,{href:"https://auth.wiki/jwt",children:"JSON Web Tokens (JWT)"})," comme jetons d\u2019acc\xe8s pour les ressources API globales. Cela se fait g\xe9n\xe9ralement via le ",(0,t.jsx)(s.a,{href:"https://auth.wiki/authorization-code-flow",children:"flux d\u2019autorisation OAuth 2.0 code"}),", le ",(0,t.jsx)(s.a,{href:"https://auth.wiki/refresh-token",children:"flux de jeton de rafra\xeechissement"}),", ou le ",(0,t.jsx)(s.a,{href:"https://auth.wiki/client-credentials-flow",children:"flux client credentials"}),"."]}),"\n",(0,t.jsx)(s.h4,{id:"authorization-code-or-refresh-token-flow",children:"Flux authorization code ou refresh token"}),"\n",(0,t.jsx)(s.p,{children:"Tous les SDK officiels Logto prennent en charge l\u2019obtention de jetons d\u2019acc\xe8s pour les ressources API globales via le flux de jeton de rafra\xeechissement par d\xe9faut. Une biblioth\xe8que cliente OAuth 2.0 / OIDC standard peut \xe9galement \xeatre utilis\xe9e pour impl\xe9menter ce flux."}),"\n",(0,t.jsxs)(d.A,{groupId:"user-client",children:[(0,t.jsxs)(u.A,{value:"logto-sdk",label:"Logto SDK",children:[(0,t.jsxs)(s.p,{children:["Lors de l\u2019initialisation du client Logto, ajoutez l\u2019indicateur de ressource au param\xe8tre ",(0,t.jsx)(s.code,{children:"resources"})," (tableau), puis ajoutez les permissions souhait\xe9es (port\xe9es) au param\xe8tre ",(0,t.jsx)(s.code,{children:"scopes"}),"."]}),(0,t.jsxs)(s.p,{children:["Une fois l\u2019utilisateur authentifi\xe9, transmettez l\u2019indicateur de ressource dans le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"})," ou un param\xe8tre similaire lors de la demande du jeton d\u2019acc\xe8s (par exemple, en appelant ",(0,t.jsx)(s.code,{children:"getAccessToken()"}),")."]}),(0,t.jsxs)(s.p,{children:["Pour plus de d\xe9tails sur chaque SDK, voir les ",(0,t.jsx)(s.a,{href:"/quick-starts",children:"D\xe9marrages rapides"}),"."]})]}),(0,t.jsxs)(u.A,{value:"oauth-client",label:"Biblioth\xe8que cliente OAuth 2.0 / OIDC",children:[(0,t.jsxs)(s.p,{children:["Lors de la configuration de votre client OAuth 2.0 ou de l\u2019initialisation du flux authorization code, assurez-vous d\u2019inclure le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"})," et les port\xe9es souhait\xe9es dans la requ\xeate d\u2019autorisation."]}),(0,t.jsxs)(s.p,{children:["Certaines biblioth\xe8ques ne prennent pas en charge nativement le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"}),", mais permettent g\xe9n\xe9ralement de passer des param\xe8tres suppl\xe9mentaires dans la requ\xeate d\u2019autorisation. Consultez la documentation de votre biblioth\xe8que pour plus de d\xe9tails."]}),(0,t.jsxs)(s.p,{children:["Voici un exemple non normatif de requ\xeate d\u2019autorisation avec les param\xe8tres ",(0,t.jsx)(s.code,{children:"resource"})," et ",(0,t.jsx)(s.code,{children:"scope"})," :"]}),(0,t.jsx)(a.A,{resource:x,scope:"read:products write:products"}),(0,t.jsxs)(s.p,{children:["Une fois l\u2019utilisateur authentifi\xe9, vous recevrez un code d\u2019autorisation. \xc9changez ce code contre un jeton d\u2019acc\xe8s en effectuant une requ\xeate POST vers le point de terminaison ",(0,t.jsx)(s.code,{children:"/oidc/token"})," de Logto, en incluant le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"})," dans le corps de la requ\xeate."]}),(0,t.jsx)(s.p,{children:"Voici un exemple non normatif de requ\xeate de jeton utilisant le type de grant authorization_code :"}),(0,t.jsx)(c.A,{grantType:"authorization_code",resource:x}),(0,t.jsxs)(s.p,{children:["Vous pouvez \xe9galement utiliser le type de grant ",(0,t.jsx)(s.code,{children:"refresh_token"})," pour obtenir un nouveau jeton d\u2019acc\xe8s sans interaction utilisateur, tant que le param\xe8tre ",(0,t.jsx)(s.code,{children:"resource"})," est inclus dans la requ\xeate."]}),(0,t.jsx)(s.p,{children:"Voici un exemple non normatif de requ\xeate de jeton utilisant le type de grant refresh_token :"}),(0,t.jsx)(c.A,{grantType:"refresh_token",resource:x})]})]}),"\n",(0,t.jsx)(s.h4,{id:"client-credentials-flow",children:"Flux client credentials"}),"\n",(0,t.jsxs)(s.p,{children:["Pour les sc\xe9narios machine \xe0 machine (M2M), vous pouvez utiliser le flux client credentials pour obtenir un jeton d\u2019acc\xe8s pour votre ressource API globale. En effectuant une requ\xeate POST vers le point de terminaison ",(0,t.jsx)(s.code,{children:"/oidc/token"})," de Logto, vous pouvez demander un jeton d\u2019acc\xe8s en utilisant votre client ID et secret."]}),"\n",(0,t.jsx)(s.p,{children:"Deux param\xe8tres cl\xe9s doivent \xeatre inclus dans la requ\xeate :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"resource"})," : L\u2019URI indicateur de ressource de l\u2019API \xe0 laquelle vous souhaitez acc\xe9der (par exemple, ",(0,t.jsx)(s.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"scope"})," : Les permissions que vous souhaitez demander pour l\u2019API (par exemple, ",(0,t.jsx)(s.code,{children:"read:products write:products"}),")."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Voici un exemple non normatif de requ\xeate de jeton utilisant le type de grant client credentials :"}),"\n",(0,t.jsx)(l.A,{resource:"https://api.yourapp.com",scope:"read:products write:products"}),"\n",(0,t.jsx)(s.h3,{id:"validating-jwt-access-tokens-in-your-api",children:"Validation des jetons d\u2019acc\xe8s JWT dans votre API"}),"\n",(0,t.jsx)(s.p,{children:"Les JWT \xe9mis par Logto contiennent des revendications que votre API peut utiliser pour appliquer l\u2019autorisation."}),"\n",(0,t.jsx)(s.p,{children:"Lorsque votre API re\xe7oit une requ\xeate avec un jeton d\u2019acc\xe8s \xe9mis par Logto, vous devez :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"V\xe9rifier la signature du jeton (en utilisant les JWKs de Logto)."}),"\n",(0,t.jsxs)(s.li,{children:["Confirmer que le jeton n\u2019est pas expir\xe9 (revendication ",(0,t.jsx)(s.code,{children:"exp"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["V\xe9rifier que le ",(0,t.jsx)(s.code,{children:"iss"})," (\xe9metteur) correspond \xe0 votre point de terminaison Logto."]}),"\n",(0,t.jsxs)(s.li,{children:["S\u2019assurer que le ",(0,t.jsx)(s.code,{children:"aud"})," (audience) correspond \xe0 l\u2019identifiant de la ressource API que vous avez enregistr\xe9e (par exemple, ",(0,t.jsx)(s.code,{children:"https://api.yourapp.com"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["S\xe9parer la revendication ",(0,t.jsx)(s.code,{children:"scope"})," (s\xe9par\xe9e par des espaces) et v\xe9rifier les permissions requises."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Pour des guides \xe9tape par \xe9tape et sp\xe9cifiques \xe0 chaque langage, voir ",(0,t.jsx)(s.a,{href:"/authorization/validate-access-tokens",children:"Comment valider les jetons d\u2019acc\xe8s"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"optional-handle-user-permission-change",children:"Optionnel : G\xe9rer le changement de permission utilisateur"}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsx)(s.p,{children:"\ud83d\udc77 Travail en cours. \ud83d\udea7"})}),"\n",(0,t.jsx)(s.h2,{id:"best-practices-and-security-tips",children:"Bonnes pratiques et conseils de s\xe9curit\xe9"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Gardez les permissions orient\xe9es m\xe9tier :"})," Utilisez des noms clairs correspondant \xe0 des actions r\xe9elles."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Gardez une expiration de jeton courte :"})," R\xe9duit le risque en cas de fuite d\u2019un jeton."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Limitez les port\xe9es accord\xe9es :"})," Donnez uniquement aux jetons les permissions r\xe9ellement n\xe9cessaires."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Utilisez la restriction d\u2019audience :"})," V\xe9rifiez toujours la revendication ",(0,t.jsx)(s.code,{children:"aud"})," pour \xe9viter les abus."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"faqs",children:"FAQ"}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(s.h3,{id:"what-if-my-client-doesn-t-support-the-resource-parameter",children:"Que faire si mon client ne prend pas en charge le param\xe8tre resource ?"})}),(0,t.jsx)(s.p,{children:"D\xe9finissez une ressource API par d\xe9faut dans la Console Logto. Les jetons utiliseront cette audience par d\xe9faut si aucun param\xe8tre resource n\u2019est sp\xe9cifi\xe9 dans la requ\xeate de jeton."})]}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(s.h3,{id:"why-do-i-get-401-unauthorized-from-my-api",children:"Pourquoi mon API retourne-t-elle 401 Non autoris\xe9 ?"})}),(0,t.jsx)(s.p,{children:"V\xe9rifiez les probl\xe8mes courants suivants :"}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Signature du jeton"})," : V\xe9rifiez que votre backend r\xe9cup\xe8re les bons JWKs depuis Logto"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Expiration du jeton"})," : Assurez-vous que le jeton n\u2019a pas expir\xe9 (revendication ",(0,t.jsx)(s.code,{children:"exp"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Audience"})," : V\xe9rifiez que la revendication ",(0,t.jsx)(s.code,{children:"aud"})," correspond \xe0 l\u2019indicateur de ressource API enregistr\xe9"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Port\xe9es requises"})," : V\xe9rifiez que le jeton contient les permissions n\xe9cessaires dans la revendication ",(0,t.jsx)(s.code,{children:"scope"})]}),"\n"]})]}),"\n",(0,t.jsxs)(r,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(s.h3,{id:"how-do-i-test-without-a-full-client",children:"Comment tester sans client complet ?"})}),(0,t.jsxs)(s.p,{children:["Utilisez un ",(0,t.jsx)(s.a,{href:"/user-management/personal-access-token",children:"jeton d\u2019acc\xe8s personnel"})," pour simuler des appels authentifi\xe9s. Cela vous permet de tester vos points de terminaison API sans impl\xe9menter un flux OAuth complet dans votre application cliente."]})]}),"\n",(0,t.jsx)(s.h2,{id:"further-reading",children:"Pour aller plus loin"}),"\n",(0,t.jsx)(p,{href:"/authorization/validate-access-tokens",children:"Comment valider les jetons d\u2019acc\xe8s"}),"\n",(0,t.jsx)(p,{href:"/use-cases/authorization/rbac-in-practice",children:(0,t.jsx)(s.p,{children:"RBAC en pratique : Impl\xe9menter une autorisation s\xe9curis\xe9e pour votre application"})}),"\n",(0,t.jsx)(p,{href:"/developers/custom-token-claims",children:"Personnalisation des revendications de jeton"}),"\n",(0,t.jsx)(p,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:"RFC 8707 : Indicateurs de ressource"})]})}function f(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(j,{...e})}):j(e)}function v(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},39088:(e,s,n)=>{n.d(s,{A:()=>i});var r=n(80173),t=n(25105);const i=e=>{let{resource:s,scope:n}=e;return(0,t.jsx)(r.A,{language:"http",children:`GET /oidc/auth?response_type=code\n&client_id=your-client-id\n&redirect_uri=https://your-app.com/callback\n&scope=openid profile offline_access ${n}\n&resource=${s}\n&code_challenge=abc123\n&code_challenge_method=S256\n&state=xyz\nHTTP/1.1\nHost: your.logto.endpoint\n`})}},78506:(e,s,n)=>{n.d(s,{A:()=>i});var r=n(80173),t=n(25105);const i=e=>{let{resource:s,organizationId:n,scope:i}=e;return(0,t.jsxs)(r.A,{language:"http",children:["POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\ngrant_type=client_credentials\n",s&&`&resource=${s}\n`,n&&`&organization_id=${n}\n`,`&scope=${i}\n`]})}},42372:(e,s,n)=>{n.d(s,{A:()=>i});var r=n(80173),t=n(25105);const i=e=>{let{grantType:s,resource:n,organizationId:i}=e;const o=[`grant_type=${s}`,"authorization_code"===s&&"code=authorization-code-received","authorization_code"===s&&"redirect_uri=https://your-app.com/callback","refresh_token"===s&&"refresh_token=your-refresh-token",n&&`resource=${n}`,i&&`organization_id=${i}`].filter(Boolean);return(0,t.jsx)(r.A,{language:"http",children:`POST /oidc/token HTTP/1.1\nHost: your.logto.endpoint\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic base64(client_id:client_secret)\n\n${o.join("\n&")}`})}},38552:(e,s,n)=>{n.d(s,{A:()=>o});n(58101);var r=n(13526);const t={tabItem:"tabItem_dgSZ"};var i=n(25105);function o(e){let{children:s,hidden:n,className:o}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,o),hidden:n,children:s})}},22002:(e,s,n)=>{n.d(s,{A:()=>P});var r=n(58101),t=n(13526),i=n(60755),o=n(55234),a=n(6635),l=n(4100),c=n(35661),u=n(42752);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:s}=e;return!!s&&"object"==typeof s&&"value"in s}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:s,children:n}=e;return(0,r.useMemo)((()=>{const e=s??function(e){return d(e).map((e=>{let{props:{value:s,label:n,attributes:r,default:t}}=e;return{value:s,label:n,attributes:r,default:t}}))}(n);return function(e){const s=(0,c.XI)(e,((e,s)=>e.value===s.value));if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[s,n])}function h(e){let{value:s,tabValues:n}=e;return n.some((e=>e.value===s))}function m(e){let{queryString:s=!1,groupId:n}=e;const t=(0,o.W6)(),i=function(e){let{queryString:s=!1,groupId:n}=e;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:s,groupId:n});return[(0,l.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const s=new URLSearchParams(t.location.search);s.set(i,e),t.replace({...t.location,search:s.toString()})}),[i,t])]}function x(e){const{defaultValue:s,queryString:n=!1,groupId:t}=e,i=p(e),[o,l]=(0,r.useState)((()=>function(e){let{defaultValue:s,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!h({value:s,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:s,tabValues:i}))),[c,d]=m({queryString:n,groupId:t}),[x,g]=function(e){let{groupId:s}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(s),[t,i]=(0,u.Dv)(n);return[t,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:t}),j=(()=>{const e=c??x;return h({value:e,tabValues:i})?e:null})();(0,a.A)((()=>{j&&l(j)}),[j]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),g(e)}),[d,g,i]),tabValues:i}}var g=n(21929);const j={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var f=n(25105);function v(e){let{className:s,block:n,selectedValue:r,selectValue:o,tabValues:a}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),u=e=>{const s=e.currentTarget,n=l.indexOf(s),t=a[n].value;t!==r&&(c(s),o(t))},d=e=>{let s=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;s=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;s=l[n]??l[l.length-1];break}}s?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},s),children:a.map((e=>{let{value:s,label:n,attributes:i}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===s?0:-1,"aria-selected":r===s,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...i,className:(0,t.A)("tabs__item",j.tabItem,i?.className,{"tabs__item--active":r===s}),children:n??s},s)}))})}function b(e){let{lazy:s,children:n,selectedValue:i}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(s){const e=o.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,s)=>(0,r.cloneElement)(e,{key:s,hidden:e.props.value!==i})))})}function A(e){const s=x(e);return(0,f.jsxs)("div",{className:(0,t.A)("tabs-container",j.tabList),children:[(0,f.jsx)(v,{...s,...e}),(0,f.jsx)(b,{...s,...e})]})}function P(e){const s=(0,g.A)();return(0,f.jsx)(A,{...e,children:d(e.children)},String(s))}},55138:(e,s,n)=>{n.d(s,{A:()=>x});var r=n(28259),t=n(6097),i=n(58574),o=n(9484),a=n(76566),l=n(26346),c=n(17867),u=n(17510),d=n(13526),p=n(72355);const h={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};var m=n(25105);function x(e){let{children:s,className:n="",metastring:x,title:g,showLineNumbers:j,language:f}=e;const{prism:{defaultLanguage:v,magicComments:b}}=(0,r.p)(),A=function(e){return e?.toLowerCase()}(f??(0,i.Op)(n)??v),P=(0,t.A)(),z=(0,o.f)(),I=(0,i.wt)(x)||g,{lineClassNames:k,code:q}=(0,i.Li)(s,{metastring:x,language:A,magicComments:b}),w=j??(0,i._u)(x);return(0,m.jsxs)(a.A,{as:"div",className:(0,d.A)(n,A&&!n.includes(`language-${A}`)&&`language-${A}`),children:[I&&(0,m.jsx)("div",{className:h.codeBlockTitle,children:I}),(0,m.jsxs)("div",{className:h.codeBlockContent,children:[(0,m.jsx)(p.f4,{theme:P,code:q,language:A??"text",children:e=>{let{className:s,tokens:n,getLineProps:r,getTokenProps:t}=e;return(0,m.jsx)("pre",{ref:z.codeBlockRef,tabIndex:0,className:(0,d.A)(s,h.codeBlock,"thin-scrollbar"),children:(0,m.jsx)("code",{className:(0,d.A)(h.codeBlockLines,w&&h.codeBlockLinesWithNumbering),children:n.map(((e,s)=>(0,m.jsx)(c.A,{line:e,getLineProps:r,getTokenProps:t,classNames:k[s],showLineNumbers:w},s)))})})}}),(0,m.jsxs)("div",{className:h.buttonGroup,children:[(z.isEnabled||z.isCodeScrollable)&&(0,m.jsx)(u.A,{className:h.codeButton,isEnabled:z.isEnabled,onClick:()=>{z.toggle()}}),(0,m.jsx)(l.A,{className:h.codeButton,code:q})]})]})]})}},46643:(e,s,n)=>{n.d(s,{A:()=>r});const r=n.p+"assets/images/rbac-global-api-resources-33fafc263308d3f769c62cbcdb8d7829.png"}}]);