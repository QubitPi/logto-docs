"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[5898],{12614:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"end-user-flows/account-settings/by-account-api","title":"Param\xe8tres du compte via l\u2019Account API","description":"D\xe9couvrez comment utiliser l\u2019Account API pour g\xe9rer l\u2019utilisateur","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","sourceDirName":"end-user-flows/account-settings","slug":"/end-user-flows/account-settings/by-account-api","permalink":"/fr/end-user-flows/account-settings/by-account-api","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/end-user-flows/account-settings/by-account-api.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"description":"D\xe9couvrez comment utiliser l\u2019Account API pour g\xe9rer l\u2019utilisateur","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Param\xe8tres de compte via Management API","permalink":"/fr/end-user-flows/account-settings/by-management-api"},"next":{"title":"V\xe9rification de s\xe9curit\xe9","permalink":"/fr/end-user-flows/security-verification/"}}');var t=i(25105),a=i(79621);const s={description:"D\xe9couvrez comment utiliser l\u2019Account API pour g\xe9rer l\u2019utilisateur",sidebar_position:2},o="Param\xe8tres du compte via l\u2019Account API",c={},l=[{value:"Qu\u2019est-ce que l\u2019Account API de Logto",id:"what-is-logto-account-api",level:2},{value:"Comment activer l\u2019Account API",id:"how-to-enable-account-api",level:2},{value:"Comment acc\xe9der \xe0 l\u2019Account API",id:"how-to-access-account-api",level:2},{value:"R\xe9cup\xe9rer un jeton d\u2019acc\xe8s",id:"fetch-an-access-token",level:3},{value:"Acc\xe9der \xe0 l\u2019Account API avec le jeton d\u2019acc\xe8s",id:"access-account-api-using-access-token",level:3},{value:"G\xe9rer les informations de base du compte",id:"manage-basic-account-information",level:2},{value:"R\xe9cup\xe9rer les informations du compte utilisateur",id:"retrieve-user-account-information",level:3},{value:"Mettre \xe0 jour les informations de base du compte",id:"update-basic-account-information",level:3},{value:"G\xe9rer les identifiants et autres informations sensibles",id:"manage-identifiers-and-other-sensitive-information",level:2},{value:"Obtenir un identifiant d\u2019enregistrement de v\xe9rification",id:"get-a-verification-record-id",level:3},{value:"V\xe9rifier le mot de passe de l\u2019utilisateur",id:"verify-the-users-password",level:4},{value:"V\xe9rifier en envoyant un code de v\xe9rification \xe0 l\u2019e-mail ou au t\xe9l\xe9phone de l\u2019utilisateur",id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",level:4},{value:"Envoyer une requ\xeate avec l\u2019identifiant d\u2019enregistrement de v\xe9rification",id:"send-request-with-verification-record-id",level:3},{value:"Mettre \xe0 jour ou lier un nouvel e-mail",id:"update-or-link-new-email",level:3},{value:"Supprimer l\u2019e-mail de l\u2019utilisateur",id:"remove-the-users-email",level:3},{value:"G\xe9rer le t\xe9l\xe9phone",id:"manage-phone",level:3},{value:"Lier une nouvelle connexion sociale",id:"link-a-new-social-connection",level:3},{value:"Supprimer une connexion sociale",id:"remove-a-social-connection",level:3},{value:"Lier une nouvelle passkey WebAuthn",id:"link-a-new-webauthn-passkey",level:3},{value:"G\xe9rer une passkey WebAuthn existante",id:"manage-existing-webauthn-passkey",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"param\xe8tres-du-compte-via-laccount-api",children:"Param\xe8tres du compte via l\u2019Account API"})}),"\n",(0,t.jsx)(n.h2,{id:"what-is-logto-account-api",children:"Qu\u2019est-ce que l\u2019Account API de Logto"}),"\n",(0,t.jsx)(n.p,{children:"L\u2019Account API de Logto est un ensemble complet d\u2019API qui donne aux utilisateurs finaux un acc\xe8s direct \xe0 l\u2019API sans avoir besoin de passer par la Management API. Voici les points cl\xe9s :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Acc\xe8s direct : L\u2019Account API permet aux utilisateurs finaux d\u2019acc\xe9der et de g\xe9rer directement leur propre profil de compte sans n\xe9cessiter le relais de la Management API."}),"\n",(0,t.jsx)(n.li,{children:"Gestion du profil utilisateur et des identit\xe9s : Les utilisateurs peuvent g\xe9rer enti\xe8rement leur profil et leurs param\xe8tres de s\xe9curit\xe9, y compris la possibilit\xe9 de mettre \xe0 jour les informations d\u2019identit\xe9 telles que l\u2019e-mail, le t\xe9l\xe9phone et le mot de passe, ainsi que de g\xe9rer les connexions sociales. Le support de MFA et SSO arrive bient\xf4t."}),"\n",(0,t.jsx)(n.li,{children:"Contr\xf4le d\u2019acc\xe8s global : Les administrateurs disposent d\u2019un contr\xf4le global complet sur les param\xe8tres d\u2019acc\xe8s et peuvent personnaliser chaque champ."}),"\n",(0,t.jsxs)(n.li,{children:["Autorisation transparente : L\u2019autorisation (Authorization) est plus simple que jamais ! Utilisez simplement ",(0,t.jsx)(n.code,{children:"client.getAccessToken()"})," pour obtenir un jeton d\u2019acc\xe8s opaque (Jeton d\u2019acc\xe8s (Access token)) pour OP (Logto), et attachez-le \xe0 l\u2019en-t\xeate Authorization sous la forme ",(0,t.jsx)(n.code,{children:"Bearer <access_token>"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Pour garantir que le jeton d\u2019acc\xe8s (Jeton d\u2019acc\xe8s (Access token)) dispose des permissions appropri\xe9es, assurez-vous d\u2019avoir correctement configur\xe9 les port\xe9es (Port\xe9es (Scopes)) correspondantes dans votre configuration Logto."}),(0,t.jsxs)(n.p,{children:["Par exemple, pour l\u2019API ",(0,t.jsx)(n.code,{children:"POST /api/my-account/primary-email"}),", vous devez configurer la port\xe9e ",(0,t.jsx)(n.code,{children:"email"})," ; pour l\u2019API ",(0,t.jsx)(n.code,{children:"POST /api/my-account/primary-phone"}),", vous devez configurer la port\xe9e ",(0,t.jsx)(n.code,{children:"phone"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { type LogtoConfig, UserScope } from '@logto/js';\n\nconst config: LogtoConfig = {\n  // ...autres options\n  // Ajoutez les port\xe9es appropri\xe9es selon vos cas d\u2019usage.\n  scopes: [\n    UserScope.Email, // Pour les APIs `{POST,DELETE} /api/my-account/primary-email`\n    UserScope.Phone, // Pour les APIs `{POST,DELETE} /api/my-account/primary-phone`\n    UserScope.CustomData, // Pour g\xe9rer les donn\xe9es personnalis\xe9es\n    UserScope.Address, // Pour g\xe9rer l\u2019adresse\n    UserScope.Identities, // Pour les APIs li\xe9es \xe0 l\u2019identit\xe9 et MFA\n    UserScope.Profile, // Pour g\xe9rer le profil utilisateur\n  ],\n};\n"})})]}),"\n",(0,t.jsx)(n.p,{children:"Avec l\u2019Account API de Logto, vous pouvez construire un syst\xe8me de gestion de compte personnalis\xe9, comme une page de profil, enti\xe8rement int\xe9gr\xe9 \xe0 Logto."}),"\n",(0,t.jsx)(n.p,{children:"Voici quelques cas d\u2019usage fr\xe9quents :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"R\xe9cup\xe9rer le profil utilisateur"}),"\n",(0,t.jsx)(n.li,{children:"Mettre \xe0 jour le profil utilisateur"}),"\n",(0,t.jsx)(n.li,{children:"Mettre \xe0 jour le mot de passe utilisateur"}),"\n",(0,t.jsx)(n.li,{children:"Mettre \xe0 jour les identit\xe9s utilisateur, y compris l\u2019e-mail, le t\xe9l\xe9phone et les connexions sociales"}),"\n",(0,t.jsx)(n.li,{children:"G\xe9rer les facteurs MFA (v\xe9rifications)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Pour en savoir plus sur les APIs disponibles, veuillez consulter la ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-my-account",children:"r\xe9f\xe9rence Logto Account API"})," et la ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-verifications",children:"r\xe9f\xe9rence Logto Verification API"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Des APIs Account d\xe9di\xe9es pour les param\xe8tres suivants arrivent bient\xf4t : MFA, SSO, Donn\xe9es personnalis\xe9es (utilisateur) et suppression de compte. En attendant, vous pouvez impl\xe9menter ces fonctionnalit\xe9s via les Management APIs de Logto. Voir ",(0,t.jsx)(n.a,{href:"/end-user-flows/account-settings/by-management-api",children:"Param\xe8tres du compte via la Management API"})," pour plus de d\xe9tails."]})}),"\n",(0,t.jsx)(n.h2,{id:"how-to-enable-account-api",children:"Comment activer l\u2019Account API"}),"\n",(0,t.jsxs)(n.p,{children:["Par d\xe9faut, l\u2019Account API est d\xe9sactiv\xe9e. Pour l\u2019activer, vous devez utiliser la ",(0,t.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," pour mettre \xe0 jour les param\xe8tres globaux."]}),"\n",(0,t.jsxs)(n.p,{children:["Le point de terminaison ",(0,t.jsx)(n.code,{children:"/api/account-center"})," peut \xeatre utilis\xe9 pour r\xe9cup\xe9rer et mettre \xe0 jour les param\xe8tres du centre de compte. Vous pouvez l\u2019utiliser pour activer ou d\xe9sactiver l\u2019Account API et personnaliser les champs."]}),"\n",(0,t.jsx)(n.p,{children:"Exemple de requ\xeate :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/account-center \\\n  -H \'authorization: Bearer <access_token for Logto Management API>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"enabled":true,"fields":{"username":"Edit"}}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Le champ ",(0,t.jsx)(n.code,{children:"enabled"})," permet d\u2019activer ou de d\xe9sactiver l\u2019Account API, et le champ ",(0,t.jsx)(n.code,{children:"fields"})," permet de personnaliser les champs, la valeur pouvant \xeatre ",(0,t.jsx)(n.code,{children:"Off"}),", ",(0,t.jsx)(n.code,{children:"Edit"}),", ",(0,t.jsx)(n.code,{children:"ReadOnly"}),". La valeur par d\xe9faut est ",(0,t.jsx)(n.code,{children:"Off"}),". Liste des champs :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"})," : Le champ nom."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"avatar"})," : Le champ avatar."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"profile"})," : Le champ profil, y compris ses sous-champs."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"username"})," : Le champ nom d\u2019utilisateur."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"email"})," : Le champ e-mail."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"phone"})," : Le champ t\xe9l\xe9phone."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"password"})," : Le champ mot de passe, lors de la r\xe9cup\xe9ration, il retournera ",(0,t.jsx)(n.code,{children:"true"})," si l\u2019utilisateur a d\xe9fini un mot de passe, sinon ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"social"})," : Connexions sociales."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"mfa"})," : Facteurs MFA."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["En savoir plus sur les d\xe9tails de l\u2019API dans la ",(0,t.jsx)(n.a,{href:"https://openapi.logto.io/group/endpoint-account-center",children:"r\xe9f\xe9rence Logto Management API"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-access-account-api",children:"Comment acc\xe9der \xe0 l\u2019Account API"}),"\n",(0,t.jsx)(n.h3,{id:"fetch-an-access-token",children:"R\xe9cup\xe9rer un jeton d\u2019acc\xe8s"}),"\n",(0,t.jsxs)(n.p,{children:["Apr\xe8s avoir configur\xe9 le SDK dans votre application, vous pouvez utiliser la m\xe9thode ",(0,t.jsx)(n.code,{children:"client.getAccessToken()"})," pour r\xe9cup\xe9rer un jeton d\u2019acc\xe8s (Jeton d\u2019acc\xe8s (Access token)). Ce jeton est un jeton opaque (Jeton opaque (Opaque token)) qui peut \xeatre utilis\xe9 pour acc\xe9der \xe0 l\u2019Account API."]}),"\n",(0,t.jsxs)(n.p,{children:["Si vous n\u2019utilisez pas le SDK officiel, vous devez d\xe9finir la ressource (",(0,t.jsx)(n.code,{children:"resource"}),") \xe0 vide pour la requ\xeate de jeton d\u2019acc\xe8s vers ",(0,t.jsx)(n.code,{children:"/oidc/token"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"access-account-api-using-access-token",children:"Acc\xe9der \xe0 l\u2019Account API avec le jeton d\u2019acc\xe8s"}),"\n",(0,t.jsxs)(n.p,{children:["Vous devez inclure le jeton d\u2019acc\xe8s (Jeton d\u2019acc\xe8s (Access token)) dans le champ ",(0,t.jsx)(n.code,{children:"Authorization"})," des en-t\xeates HTTP au format Bearer (",(0,t.jsx)(n.code,{children:"Bearer YOUR_TOKEN"}),") lors de l\u2019interaction avec l\u2019Account API."]}),"\n",(0,t.jsx)(n.p,{children:"Voici un exemple pour obtenir les informations du compte utilisateur :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"manage-basic-account-information",children:"G\xe9rer les informations de base du compte"}),"\n",(0,t.jsx)(n.h3,{id:"retrieve-user-account-information",children:"R\xe9cup\xe9rer les informations du compte utilisateur"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Le corps de la r\xe9ponse sera similaire \xe0 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "...",\n  "username": "...",\n  "name": "...",\n  "avatar": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Les champs de la r\xe9ponse peuvent varier selon les param\xe8tres du centre de compte."}),"\n",(0,t.jsx)(n.h3,{id:"update-basic-account-information",children:"Mettre \xe0 jour les informations de base du compte"}),"\n",(0,t.jsx)(n.p,{children:"Les informations de base du compte incluent le nom d\u2019utilisateur, le nom, l\u2019avatar et le profil."}),"\n",(0,t.jsxs)(n.p,{children:["Pour mettre \xe0 jour le nom d\u2019utilisateur, le nom et l\u2019avatar, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"username":"...","name":"...","avatar":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Pour mettre \xe0 jour le profil, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account/profile"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH https://[tenant-id].logto.app/api/my-account/profile \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"familyName":"...","givenName":"..."}\'\n'})}),"\n",(0,t.jsx)(n.h2,{id:"manage-identifiers-and-other-sensitive-information",children:"G\xe9rer les identifiants et autres informations sensibles"}),"\n",(0,t.jsx)(n.p,{children:"Pour des raisons de s\xe9curit\xe9, l\u2019Account API requiert une couche suppl\xe9mentaire d\u2019autorisation (Autorisation (Authorization)) pour les op\xe9rations impliquant des identifiants et autres informations sensibles."}),"\n",(0,t.jsx)(n.h3,{id:"get-a-verification-record-id",children:"Obtenir un identifiant d\u2019enregistrement de v\xe9rification"}),"\n",(0,t.jsx)(n.p,{children:"Vous devez d\u2019abord obtenir un identifiant d\u2019enregistrement de v\xe9rification. Celui-ci peut \xeatre utilis\xe9 pour v\xe9rifier l\u2019identit\xe9 de l\u2019utilisateur lors de la mise \xe0 jour des identifiants."}),"\n",(0,t.jsx)(n.p,{children:"Pour obtenir un identifiant d\u2019enregistrement de v\xe9rification, vous pouvez v\xe9rifier le mot de passe de l\u2019utilisateur ou envoyer un code de v\xe9rification \xe0 l\u2019e-mail ou au t\xe9l\xe9phone de l\u2019utilisateur."}),"\n",(0,t.jsxs)(n.p,{children:["Pour en savoir plus sur les v\xe9rifications, veuillez consulter ",(0,t.jsx)(n.a,{href:"/end-user-flows/security-verification/by-account-api",children:"V\xe9rification de s\xe9curit\xe9 via l\u2019Account API"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"verify-the-users-password",children:"V\xe9rifier le mot de passe de l\u2019utilisateur"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/password \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"password\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Le corps de la r\xe9ponse sera similaire \xe0 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"verify-by-sending-a-verification-code-to-the-users-email-or-phone",children:"V\xe9rifier en envoyant un code de v\xe9rification \xe0 l\u2019e-mail ou au t\xe9l\xe9phone de l\u2019utilisateur"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Pour utiliser cette m\xe9thode, vous devez ",(0,t.jsx)(n.a,{href:"/connectors/email-connectors/",children:"configurer le connecteur e-mail"})," ou ",(0,t.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"le connecteur SMS"}),", et vous assurer que le template ",(0,t.jsx)(n.code,{children:"UserPermissionValidation"})," est configur\xe9."]})}),"\n",(0,t.jsx)(n.p,{children:"Prenons l\u2019e-mail comme exemple, demandez un nouveau code de v\xe9rification et obtenez l\u2019identifiant d\u2019enregistrement de v\xe9rification :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"Le corps de la r\xe9ponse sera similaire \xe0 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Apr\xe8s r\xe9ception du code de v\xe9rification, vous pouvez l\u2019utiliser pour mettre \xe0 jour le statut de v\xe9rification de l\u2019enregistrement."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"123456"}\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"Apr\xe8s v\xe9rification du code, vous pouvez maintenant utiliser l\u2019identifiant d\u2019enregistrement de v\xe9rification pour mettre \xe0 jour l\u2019identifiant de l\u2019utilisateur."}),"\n",(0,t.jsx)(n.h3,{id:"send-request-with-verification-record-id",children:"Envoyer une requ\xeate avec l\u2019identifiant d\u2019enregistrement de v\xe9rification"}),"\n",(0,t.jsxs)(n.p,{children:["Lors de l\u2019envoi d\u2019une requ\xeate pour mettre \xe0 jour l\u2019identifiant de l\u2019utilisateur, vous devez inclure l\u2019identifiant d\u2019enregistrement de v\xe9rification dans l\u2019en-t\xeate de la requ\xeate avec le champ ",(0,t.jsx)(n.code,{children:"logto-verification-id"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"update-or-link-new-email",children:"Mettre \xe0 jour ou lier un nouvel e-mail"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Pour utiliser cette m\xe9thode, vous devez ",(0,t.jsx)(n.a,{href:"/connectors/email-connectors/",children:"configurer le connecteur e-mail"})," et vous assurer que le template ",(0,t.jsx)(n.code,{children:"BindNewIdentifier"})," est configur\xe9."]})}),"\n",(0,t.jsx)(n.p,{children:"Pour mettre \xe0 jour ou lier un nouvel e-mail, vous devez d\u2019abord prouver la propri\xe9t\xe9 de l\u2019e-mail."}),"\n",(0,t.jsxs)(n.p,{children:["Appelez le point de terminaison ",(0,t.jsx)(n.code,{children:"POST /api/verifications/verification-code"})," pour demander un code de v\xe9rification."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."}}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Vous trouverez un ",(0,t.jsx)(n.code,{children:"verificationId"})," dans la r\xe9ponse, et recevrez un code de v\xe9rification par e-mail, utilisez-le pour v\xe9rifier l\u2019e-mail."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/verification-code/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"identifier":{"type":"email","value":"..."},"verificationId":"...","code":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Apr\xe8s v\xe9rification du code, vous pouvez maintenant mettre \xe0 jour l\u2019e-mail de l\u2019utilisateur, en d\xe9finissant le ",(0,t.jsx)(n.code,{children:"verificationId"})," dans le corps de la requ\xeate comme ",(0,t.jsx)(n.code,{children:"newIdentifierVerificationRecordId"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"email\":\"...\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remove-the-users-email",children:"Supprimer l\u2019e-mail de l\u2019utilisateur"}),"\n",(0,t.jsxs)(n.p,{children:["Pour supprimer l\u2019e-mail de l\u2019utilisateur, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/primary-email"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/primary-email \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"manage-phone",children:"G\xe9rer le t\xe9l\xe9phone"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Pour utiliser cette m\xe9thode, vous devez ",(0,t.jsx)(n.a,{href:"/connectors/sms-connectors/",children:"configurer le connecteur SMS"}),", et vous assurer que le template ",(0,t.jsx)(n.code,{children:"BindNewIdentifier"})," est configur\xe9."]})}),"\n",(0,t.jsxs)(n.p,{children:["De mani\xe8re similaire \xe0 la mise \xe0 jour de l\u2019e-mail, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"PATCH /api/my-account/primary-phone"})," pour mettre \xe0 jour ou lier un nouveau t\xe9l\xe9phone. Et utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/primary-phone"})," pour supprimer le t\xe9l\xe9phone de l\u2019utilisateur."]}),"\n",(0,t.jsx)(n.h3,{id:"link-a-new-social-connection",children:"Lier une nouvelle connexion sociale"}),"\n",(0,t.jsx)(n.p,{children:"Pour lier une nouvelle connexion sociale, vous devez d\u2019abord demander une URL d\u2019autorisation :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorId":"...","redirectUri":"...","state":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"connectorId"})," : L\u2019ID du ",(0,t.jsx)(n.a,{href:"/connectors/social-connectors/",children:"connecteur social"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"redirectUri"})," : L\u2019URI de redirection apr\xe8s que l\u2019utilisateur a autoris\xe9 l\u2019application, vous devez h\xe9berger une page web \xe0 cette URL et capturer le callback."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"state"})," : L\u2019\xe9tat \xe0 retourner apr\xe8s que l\u2019utilisateur a autoris\xe9 l\u2019application, il s\u2019agit d\u2019une cha\xeene al\xe9atoire utilis\xe9e pour pr\xe9venir les attaques CSRF."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Dans la r\xe9ponse, vous trouverez un ",(0,t.jsx)(n.code,{children:"verificationRecordId"}),", conservez-le pour une utilisation ult\xe9rieure."]}),"\n",(0,t.jsxs)(n.p,{children:["Apr\xe8s que l\u2019utilisateur a autoris\xe9 l\u2019application, vous recevrez un callback \xe0 l\u2019",(0,t.jsx)(n.code,{children:"redirectUri"})," avec le param\xe8tre ",(0,t.jsx)(n.code,{children:"state"}),". Vous pouvez alors utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"POST /api/verifications/social/verify"})," pour v\xe9rifier la connexion sociale."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/social/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"connectorData":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Le ",(0,t.jsx)(n.code,{children:"connectorData"})," est la donn\xe9e retourn\xe9e par le connecteur social apr\xe8s que l\u2019utilisateur a autoris\xe9 l\u2019application, vous devez analyser et r\xe9cup\xe9rer les param\xe8tres de requ\xeate depuis l\u2019",(0,t.jsx)(n.code,{children:"redirectUri"})," sur votre page de callback, et les encapsuler en JSON comme valeur du champ ",(0,t.jsx)(n.code,{children:"connectorData"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Enfin, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"POST /api/my-account/identities"})," pour lier la connexion sociale."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/identities \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remove-a-social-connection",children:"Supprimer une connexion sociale"}),"\n",(0,t.jsxs)(n.p,{children:["Pour supprimer une connexion sociale, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"DELETE /api/my-account/identities"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/identities/[connector_target_id] \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"link-a-new-webauthn-passkey",children:"Lier une nouvelle passkey WebAuthn"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["N\u2019oubliez pas ",(0,t.jsx)(n.a,{href:"/end-user-flows/mfa",children:"d\u2019activer MFA et WebAuthn"})," au pr\xe9alable."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Pour utiliser cette m\xe9thode, vous devez activer le champ ",(0,t.jsx)(n.code,{children:"mfa"})," dans les param\xe8tres du centre de compte."]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\xc9tape 0 : Ajoutez l\u2019origine de votre application front-end aux origines associ\xe9es."})}),"\n",(0,t.jsx)(n.p,{children:"Une passkey dans le navigateur est li\xe9e \xe0 un nom d\u2019h\xf4te sp\xe9cifique (RP ID), et seule l\u2019origine du RP ID peut \xeatre utilis\xe9e pour enregistrer ou v\xe9rifier une passkey. Cependant, votre application front-end qui envoie la requ\xeate \xe0 l\u2019Account API n\u2019est pas la m\xeame que la page de connexion Logto, vous devez donc ajouter l\u2019origine de votre application front-end \xe0 la liste des origines associ\xe9es. Cela permettra \xe0 votre application front-end d\u2019enregistrer et de v\xe9rifier une passkey sous d\u2019autres RP ID."}),"\n",(0,t.jsxs)(n.p,{children:["Par d\xe9faut, Logto d\xe9finit le RP ID sur le domaine du tenant, par exemple, si votre domaine de tenant est ",(0,t.jsx)(n.code,{children:"https://example.logto.app"}),", le RP ID sera ",(0,t.jsx)(n.code,{children:"example.logto.app"}),". Si vous utilisez un domaine personnalis\xe9, le RP ID sera le domaine personnalis\xe9, par exemple, si votre domaine personnalis\xe9 est ",(0,t.jsx)(n.code,{children:"https://auth.example.com"}),", le RP ID sera ",(0,t.jsx)(n.code,{children:"auth.example.com"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Ajoutons maintenant l\u2019origine de votre application front-end aux origines associ\xe9es, par exemple, si l\u2019origine de votre application front-end est ",(0,t.jsx)(n.code,{children:"https://account.example.com"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/webauthn-connectors \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"webauthnRelatedOrigins\":[\"https://account.example.com\"]}'\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Pour en savoir plus sur les origines associ\xe9es, veuillez consulter la documentation ",(0,t.jsx)(n.a,{href:"https://passkeys.dev/docs/advanced/related-origins/",children:"Related Origin Requests"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\xc9tape 1 : demander de nouvelles options d\u2019enregistrement."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'content-type: application/json'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Vous obtiendrez une r\xe9ponse comme :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "registrationOptions": "...",\n  "verificationRecordId": "...",\n  "expiresAt": "..."\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\xc9tape 2 : enregistrer la passkey dans le navigateur local."})}),"\n",(0,t.jsxs)(n.p,{children:["Prenons ",(0,t.jsx)(n.a,{href:"https://simplewebauthn.dev/",children:(0,t.jsx)(n.code,{children:"@simplewebauthn/browser"})})," comme exemple, vous pouvez utiliser la fonction ",(0,t.jsx)(n.code,{children:"startRegistration"})," pour enregistrer la passkey dans le navigateur local."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { startRegistration } from '@simplewebauthn/browser';\n\n// ...\nconst response = await startRegistration({\n  optionsJSON: registrationOptions, // Les donn\xe9es retourn\xe9es par le serveur \xe0 l\u2019\xe9tape 1\n});\n// Sauvegardez la r\xe9ponse pour une utilisation ult\xe9rieure\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\xc9tape 3 : v\xe9rifier la passkey."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[tenant-id].logto.app/api/verifications/web-authn/registration/verify \\\n  -H \'authorization: Bearer <access_token>\' \\\n  -H \'content-type: application/json\' \\\n  --data-raw \'{"payload":"...","verificationRecordId":"..."}\'\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"payload"})," : La r\xe9ponse du navigateur local \xe0 l\u2019\xe9tape 2."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verificationRecordId"})," : L\u2019identifiant d\u2019enregistrement de v\xe9rification retourn\xe9 par le serveur \xe0 l\u2019\xe9tape 1."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\xc9tape 4 : enfin, vous pouvez lier la passkey."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"type\":\"WebAuthn\",\"newIdentifierVerificationRecordId\":\"...\"}'\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"verification_record_id"})," : un identifiant d\u2019enregistrement de v\xe9rification valide, obtenu en v\xe9rifiant le facteur existant de l\u2019utilisateur, voir la section ",(0,t.jsx)(n.a,{href:"#get-a-verification-record-id",children:"Obtenir un identifiant d\u2019enregistrement de v\xe9rification"})," pour plus de d\xe9tails."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"})," : le type du facteur MFA, actuellement seul ",(0,t.jsx)(n.code,{children:"WebAuthn"})," est support\xe9."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"newIdentifierVerificationRecordId"})," : l\u2019identifiant d\u2019enregistrement de v\xe9rification retourn\xe9 par le serveur \xe0 l\u2019\xe9tape 1."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"manage-existing-webauthn-passkey",children:"G\xe9rer une passkey WebAuthn existante"}),"\n",(0,t.jsxs)(n.p,{children:["Pour g\xe9rer une passkey WebAuthn existante, vous pouvez utiliser le point de terminaison ",(0,t.jsx)(n.code,{children:"GET /api/my-account/mfa-verifications"})," pour obtenir les passkeys actuelles et autres facteurs de v\xe9rification MFA."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl https://[tenant-id].logto.app/api/my-account/mfa-verifications \\\n  -H 'authorization: Bearer <access_token>'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Le corps de la r\xe9ponse sera similaire \xe0 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "id": "...",\n    "type": "WebAuthn",\n    "name": "...",\n    "agent": "...",\n    "createdAt": "...",\n    "updatedAt": "..."\n  }\n]\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"})," : l\u2019ID de la v\xe9rification."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"})," : le type de la v\xe9rification, ",(0,t.jsx)(n.code,{children:"WebAuthn"})," pour une passkey WebAuthn."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"})," : le nom de la passkey, champ optionnel."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"agent"})," : l\u2019agent utilisateur de la passkey."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Mettre \xe0 jour le nom de la passkey :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X PATCH https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId}/name \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>' \\\n  -H 'content-type: application/json' \\\n  --data-raw '{\"name\":\"...\"}'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Supprimer la passkey :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://[tenant-id].logto.app/api/my-account/mfa-verifications/{verificationId} \\\n  -H 'authorization: Bearer <access_token>' \\\n  -H 'logto-verification-id: <verification_record_id>'\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},79621:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var r=i(58101);const t={},a=r.createContext(t);function s(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);