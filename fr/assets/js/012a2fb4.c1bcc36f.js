"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[403],{73819:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"end-user-flows/one-time-token","title":"Lien magique (Jeton \xe0 usage unique)","description":"Similaire au mot de passe \xe0 usage unique (OTP), un jeton \xe0 usage unique est une autre m\xe9thode d\u2019authentification sans mot de passe qui peut \xeatre utilis\xe9e pour v\xe9rifier l\u2019identit\xe9 d\u2019un utilisateur.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","sourceDirName":"end-user-flows","slug":"/end-user-flows/one-time-token","permalink":"/fr/end-user-flows/one-time-token","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/end-user-flows/one-time-token.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Connexion directe","permalink":"/fr/end-user-flows/authentication-parameters/direct-sign-in"},"next":{"title":"\xc9cran de consentement","permalink":"/fr/end-user-flows/consent-screen"}}');var s=i(25105),a=i(79621),o=i(88969);const r={sidebar_position:5},l="Lien magique (Jeton \xe0 usage unique)",u={},c=[{value:"Flux du jeton \xe0 usage unique",id:"one-time-token-flow",level:2},{value:"Guide de mise en \u0153uvre",id:"implementation-guide",level:2},{value:"\xc9tape 1 : Demander un jeton \xe0 usage unique",id:"step-1-request-one-time-token",level:3},{value:"\xc9tape 2 : Composer votre lien magique",id:"step-2-compose-your-magic-link",level:3},{value:"\xc9tape 3 : D\xe9clencher le flux d\u2019authentification via Logto SDK",id:"step-3-trigger-the-authentication-flow-via-logto-sdk",level:3},{value:"\xc9tape 4 : (Optionnel) Effacer les jetons mis en cache dans la page de callback de connexion",id:"step-4-clear-cached-tokens-in-sign-in-callback-page",level:3},{value:"FAQ",id:"faqs",level:2},{value:"Puis-je utiliser le lien magique pour inviter de nouveaux utilisateurs dans mes organisations ?",id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",level:3},{value:"Le jeton \xe0 usage unique expire-t-il ?",id:"does-the-one-time-token-expire",level:3},{value:"Si je d\xe9sactive l\u2019inscription des utilisateurs dans &quot;Exp\xe9rience de connexion&quot;, puis-je toujours utiliser le lien magique pour inviter des utilisateurs ?",id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",level:3},{value:"Que se passe-t-il si un utilisateur est d\xe9j\xe0 connect\xe9, puis clique sur un autre lien magique ?",id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"lien-magique-jeton-\xe0-usage-unique",children:"Lien magique (Jeton \xe0 usage unique)"})}),"\n","\n",(0,s.jsx)(o.A,{cloud:!0,oss:{major:1,minor:27}}),"\n",(0,s.jsx)(n.p,{children:"Similaire au mot de passe \xe0 usage unique (OTP), un jeton \xe0 usage unique est une autre m\xe9thode d\u2019authentification sans mot de passe qui peut \xeatre utilis\xe9e pour v\xe9rifier l\u2019identit\xe9 d\u2019un utilisateur.\nLe jeton est valable pour une p\xe9riode limit\xe9e et est associ\xe9 \xe0 une adresse e-mail de l\u2019utilisateur final."}),"\n",(0,s.jsx)(n.p,{children:'Parfois, vous pouvez vouloir inviter de nouveaux utilisateurs \xe0 votre application / organisation sans leur demander de cr\xe9er un compte au pr\xe9alable.\nOu vous pouvez avoir oubli\xe9 votre mot de passe et vouloir vous connecter / r\xe9initialiser votre mot de passe en v\xe9rifiant rapidement votre identit\xe9 par e-mail.\nDans ces cas, l\u2019application peut envoyer un "lien magique" \xe0 votre adresse e-mail. Vous serez alors authentifi\xe9 imm\xe9diatement lorsque vous cliquerez sur le lien.'}),"\n",(0,s.jsx)(n.p,{children:"Les d\xe9veloppeurs d\u2019applications peuvent utiliser le jeton \xe0 usage unique pour composer un lien magique et l\u2019envoyer \xe0 l\u2019adresse e-mail de l\u2019utilisateur final."}),"\n",(0,s.jsx)(n.h2,{id:"one-time-token-flow",children:"Flux du jeton \xe0 usage unique"}),"\n",(0,s.jsx)(n.p,{children:"Voici le diagramme de s\xe9quence du flux d\u2019authentification utilisant un jeton \xe0 usage unique :"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant U as Utilisateur final\n  participant C as Votre application\n  participant L as Logto\n\n  U ->> C: (Optionnel) L\u2019utilisateur demande un lien magique depuis votre application\n  C ->> L: Demande un jeton \xe0 usage unique\n  L --\x3e> C: Retourne le jeton \xe0 usage unique\n  C --\x3e> U: Compose un lien magique contenant le jeton \xe0 usage unique et l\u2019envoie \xe0 l\u2019e-mail de l\u2019utilisateur final\n  U ->> C: L\u2019utilisateur clique sur le lien magique et est redirig\xe9 vers une page d\u2019atterrissage de votre application\n  C ->> L: Extrait le jeton \xe0 usage unique du lien magique et d\xe9clenche le flux d\u2019authentification\n  L --\x3e> C: Logto v\xe9rifie le jeton \xe0 usage unique et retourne le r\xe9sultat\n  C --\x3e> U: L\u2019utilisateur est authentifi\xe9 et retourne les informations utilisateur \xe0 l\u2019utilisateur"}),"\n",(0,s.jsx)(n.h2,{id:"implementation-guide",children:"Guide de mise en \u0153uvre"}),"\n",(0,s.jsx)(n.p,{children:"Logto propose un ensemble d\u2019APIs Management et d\u2019APIs Experience pour faciliter la mise en \u0153uvre de votre lien magique."}),"\n",(0,s.jsxs)(n.p,{children:["Avant de commencer, assurez-vous de disposer d\u2019une instance Logto pr\xeate \xe0 l\u2019emploi et d\u2019avoir \xe9tabli la connexion Machine \xe0 machine entre votre serveur d\u2019application\net l\u2019endpoint Logto (requis pour les APIs Management). En savoir plus sur ",(0,s.jsx)(n.a,{href:"/integrate-logto/interact-with-management-api",children:"Logto Management API"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"step-1-request-one-time-token",children:"\xc9tape 1 : Demander un jeton \xe0 usage unique"}),"\n",(0,s.jsx)(n.p,{children:"Utilisez Logto Management API pour cr\xe9er un jeton \xe0 usage unique."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"POST /api/one-time-tokens\n"})}),"\n",(0,s.jsx)(n.p,{children:"Exemple de payload du corps de la requ\xeate :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "email": "user@example.com",\n  // Optionnel. Par d\xe9faut \xe0 600 (10 min).\n  "expiresIn": 3600,\n  // Optionnel. L\u2019utilisateur sera provisionn\xe9 dans les organisations sp\xe9cifi\xe9es apr\xe8s v\xe9rification r\xe9ussie.\n  "context": {\n    "jitOrganizationIds": ["abcdefgh1234"]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-compose-your-magic-link",children:"\xc9tape 2 : Composer votre lien magique"}),"\n",(0,s.jsxs)(n.p,{children:["Apr\xe8s avoir obtenu le jeton \xe0 usage unique, vous pouvez composer un lien magique et l\u2019envoyer \xe0 l\u2019adresse e-mail de l\u2019utilisateur final.\nLe lien magique doit au moins contenir le jeton et l\u2019e-mail de l\u2019utilisateur comme param\xe8tres, et doit rediriger vers une page d\u2019atterrissage dans votre propre application.\nPar exemple : ",(0,s.jsx)(n.code,{children:"https://yourapp.com/landing-page"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Voici un exemple simple de ce \xe0 quoi peut ressembler le lien magique :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"https://yourapp.com/landing-page?token=YHwbXSXxQfL02IoxFqr1hGvkB13uTqcd&email=user@example.com\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Les noms des param\xe8tres dans le lien magique sont enti\xe8rement personnalisables.\nVous pouvez ajouter des informations suppl\xe9mentaires au lien magique selon les besoins de votre application,\nainsi qu\u2019encoder tous les param\xe8tres de l\u2019URL."})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-trigger-the-authentication-flow-via-logto-sdk",children:"\xc9tape 3 : D\xe9clencher le flux d\u2019authentification via Logto SDK"}),"\n",(0,s.jsxs)(n.p,{children:["Apr\xe8s que l\u2019utilisateur final a cliqu\xe9 sur le lien magique et a \xe9t\xe9 redirig\xe9 vers votre application, vous pouvez extraire les param\xe8tres ",(0,s.jsx)(n.code,{children:"token"})," et ",(0,s.jsx)(n.code,{children:"email"})," de l\u2019URL, puis appeler la fonction ",(0,s.jsx)(n.code,{children:"signIn()"})," du SDK Logto pour d\xe9clencher le flux d\u2019authentification."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:'title="TokenLandingPage.tsx"',children:"// Exemple React\nimport { useLogto } from '@logto/react';\nimport { useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\n\nconst TokenLandingPage = () => {\n  const { signIn } = useLogto();\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    // Extraire le jeton et l\u2019e-mail du lien magique\n    const oneTimeToken = searchParams.get('token');\n    const email = searchParams.get('email');\n\n    // Supposons que ceci est votre URI de redirection de connexion\n    const redirectUri = 'https://yourapp.com/callback';\n\n    if (oneTimeToken && email) {\n      signIn({\n        redirectUri,\n        clearTokens: false, // Optionnel. Voir le message d\u2019avertissement ci-dessous\n        extraParams: {\n          'one_time_token': oneTimeToken,\n          'login_hint': email,\n        },\n      });\n    }\n  }, [searchParams, signIn]);\n\n  return <>Veuillez patienter...</>;\n};\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsxs)(n.p,{children:["Si un utilisateur est d\xe9j\xe0 connect\xe9, appeler la fonction ",(0,s.jsx)(n.code,{children:"signIn()"})," du SDK effacera automatiquement tous les jetons mis en cache (jeton d\u2019identifiant (ID token), jeton d\u2019acc\xe8s (access token) et jeton de rafra\xeechissement (refresh token)) du stockage client,\nce qui entra\xeene la perte du statut d\u2019authentification de l\u2019utilisateur actuel."]}),(0,s.jsxs)(n.p,{children:["Par cons\xe9quent, vous devez sp\xe9cifier un param\xe8tre suppl\xe9mentaire ",(0,s.jsx)(n.code,{children:"clearTokens: false"})," lors de la connexion pour \xe9viter d\u2019effacer les jetons existants.\nSi cela est sp\xe9cifi\xe9, vous devrez \xe9galement effacer manuellement les jetons dans la page de callback de connexion."]}),(0,s.jsx)(n.p,{children:"Ignorez ceci si vos liens magiques ne sont pas con\xe7us pour des utilisateurs d\xe9j\xe0 authentifi\xe9s."})]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-clear-cached-tokens-in-sign-in-callback-page",children:"\xc9tape 4 : (Optionnel) Effacer les jetons mis en cache dans la page de callback de connexion"}),"\n",(0,s.jsxs)(n.p,{children:["Si vous sp\xe9cifiez ",(0,s.jsx)(n.code,{children:"clearTokens: false"})," dans la fonction de connexion, vous devez effacer manuellement les jetons dans la page de callback de connexion."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:'title="Callback.tsx"',children:"// Exemple React\nimport { useHandleSignInCallback, useLogto } from '@logto/react';\nimport { useEffect } from 'react';\n\nconst Callback = () => {\n  const { clearAllTokens } = useLogto();\n\n  useEffect(() => {\n    void clearAllTokens();\n  }, [clearAllTokens]);\n\n  useHandleSignInCallback(() => {\n    // Naviguer vers votre page d\u2019accueil\n  });\n\n  return <>Veuillez patienter...</>;\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"faqs",children:"FAQ"}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.h3,{id:"can-i-use-the-magic-link-to-invite-new-users-to-my-organizations",children:"Puis-je utiliser le lien magique pour inviter de nouveaux utilisateurs dans mes organisations ?"})}),(0,s.jsxs)(n.p,{children:["Oui, vous pouvez utiliser le lien magique pour inviter de nouveaux utilisateurs \xe0 votre application, ainsi qu\u2019\xe0 des organisations.\nSi vous souhaitez inviter de nouveaux utilisateurs dans votre organisation, il suffit de sp\xe9cifier les ",(0,s.jsx)(n.code,{children:"jitOrganizationIds"})," dans le corps de la requ\xeate."]}),(0,s.jsx)(n.p,{children:'L\u2019utilisateur rejoindra automatiquement les organisations apr\xe8s v\xe9rification r\xe9ussie, et les r\xf4les d\u2019organisation par d\xe9faut seront attribu\xe9s.\nConsultez la section "Approvisionnement Just-in-Time" dans la page de d\xe9tails de votre organisation et configurez les r\xf4les par d\xe9faut pour vos organisations.'})]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.h3,{id:"does-the-one-time-token-expire",children:"Le jeton \xe0 usage unique expire-t-il ?"})}),(0,s.jsxs)(n.p,{children:["Oui, le jeton \xe0 usage unique expirera apr\xe8s le temps ",(0,s.jsx)(n.code,{children:"expiresIn"})," sp\xe9cifi\xe9 (en secondes). Le temps d\u2019expiration par d\xe9faut est de 10 minutes."]})]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.h3,{id:"if-i-disable-user-registration-in-sign-in-experience-can-i-still-use-magic-link-to-invite-users",children:'Si je d\xe9sactive l\u2019inscription des utilisateurs dans "Exp\xe9rience de connexion", puis-je toujours utiliser le lien magique pour inviter des utilisateurs ?'})}),(0,s.jsx)(n.p,{children:'Oui, vous pouvez toujours utiliser le lien magique pour inviter des utilisateurs m\xeame si vous d\xe9sactivez l\u2019inscription des utilisateurs dans "Exp\xe9rience de connexion".'})]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.h3,{id:"what-will-happen-if-a-user-already-signed-in-and-then-click-another-magic-link",children:"Que se passe-t-il si un utilisateur est d\xe9j\xe0 connect\xe9, puis clique sur un autre lien magique ?"})}),(0,s.jsx)(n.p,{children:"Il existe plusieurs sc\xe9narios possibles :"}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"L\u2019utilisateur est d\xe9j\xe0 connect\xe9, puis clique sur un lien magique associ\xe9 au compte utilisateur actuel. Dans ce cas, Logto v\xe9rifiera tout de m\xeame le jeton \xe0 usage unique et provisionnera l\u2019utilisateur dans les organisations sp\xe9cifi\xe9es si n\xe9cessaire."}),"\n",(0,s.jsxs)(n.li,{children:["L\u2019utilisateur est d\xe9j\xe0 connect\xe9, puis clique sur un lien magique associ\xe9 \xe0 un autre compte. Dans ce cas, Logto invitera l\u2019utilisateur \xe0 continuer avec le nouveau compte ou \xe0 revenir \xe0 l\u2019application avec le compte actuel.","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Si l\u2019utilisateur choisit de continuer avec le nouveau compte, Logto basculera vers le nouveau compte apr\xe8s la v\xe9rification r\xe9ussie du jeton."}),"\n",(0,s.jsx)(n.li,{children:"Si l\u2019utilisateur choisit de rester sur le compte actuel, Logto ne v\xe9rifiera pas le jeton et retournera \xe0 l\u2019application avec le compte actuel."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:'Si votre invite de connexion est d\xe9finie sur "login" ou contient "login", Logto connectera automatiquement le compte associ\xe9 au jeton \xe0 usage unique sans demander de changement.'}),"\n"]})]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},88969:(e,n,i)=>{i.d(n,{A:()=>o});const t="availability_kRMk";var s=i(25105);const a=e=>"comingSoon"===e?"coming soon-blue":"boolean"==typeof e?e?"\u2713 available-4EA254":"not applicable-78767F":`since v${e.major}.${e.minor}-4EA254`,o=e=>{let{cloud:n,oss:i}=e;return(0,s.jsxs)("div",{className:t,children:[(0,s.jsx)("img",{alt:"Cloud availability",src:`https://img.shields.io/badge/Cloud-${a(n)}`}),(0,s.jsx)("img",{alt:"OSS availability",src:`https://img.shields.io/badge/OSS-${a(i)}`})]})}},79621:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(58101);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);