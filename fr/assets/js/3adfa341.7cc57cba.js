"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[2448],{99225:(e,n,i)=>{i.d(n,{Ay:()=>a,RM:()=>s});var r=i(25105),t=i(79621);const s=[];function o(e){const n={p:"p",...(0,t.R)(),...e.components};return(0,r.jsxs)(n.p,{children:["Il se peut que certaines informations utilisateur soient manquantes dans l'objet retourn\xe9 par ",(0,r.jsx)("code",{children:e.method}),". Cela est d\xfb au fait que OAuth 2.0 et OpenID Connect (OIDC) sont con\xe7us pour suivre le principe du moindre privil\xe8ge (PoLP), et Logto est construit sur ces normes."]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},62990:(e,n,i)=>{i.d(n,{Ay:()=>a,RM:()=>s});var r=i(25105),t=i(79621);const s=[];function o(e){const{Url:n}={...(0,t.R)(),...e.components};return n||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n,{href:"/end-user-flows",children:" Parcours utilisateur final : flux d\u2019authentification, flux de compte et flux d\u2019organisation "}),"\n",(0,r.jsx)(n,{href:"/connectors",children:" Configurer les connecteurs "}),"\n",(0,r.jsx)(n,{href:"/authorization",children:" Autorisation (Authorization) "})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},42142:(e,n,i)=>{i.d(n,{Ay:()=>a,RM:()=>s});var r=i(25105),t=i(79621);const s=[{value:"Concernant la connexion bas\xe9e sur la redirection",id:"regarding-redirect-based-sign-in",level:3}];function o(e){const n={a:"a",h3:"h3",li:"li",ol:"ol",p:"p",...(0,t.R)(),...e.components},{Details:i,MainSiteUrl:s}=n;return i||c("Details",!0),s||c("MainSiteUrl",!0),(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.h3,{id:"regarding-redirect-based-sign-in",children:"Concernant la connexion bas\xe9e sur la redirection"})}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ce processus d'authentification (Authentication) suit le protocole ",(0,r.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html",children:"OpenID Connect (OIDC)"}),", et Logto applique des mesures de s\xe9curit\xe9 strictes pour prot\xe9ger la connexion utilisateur."]}),"\n",(0,r.jsx)(n.li,{children:"Si vous avez plusieurs applications, vous pouvez utiliser le m\xeame fournisseur d\u2019identit\xe9 (Logto). Une fois que l'utilisateur se connecte \xe0 une application, Logto compl\xe9tera automatiquement le processus de connexion lorsque l'utilisateur acc\xe8de \xe0 une autre application."}),"\n"]}),(0,r.jsxs)(n.p,{children:["Pour en savoir plus sur la logique et les avantages de la connexion bas\xe9e sur la redirection, consultez ",(0,r.jsx)(s,{href:"/concepts/sign-in-experience",children:"Exp\xe9rience de connexion Logto expliqu\xe9e"}),"."]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}function c(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},28730:(e,n,i)=>{i.d(n,{Ay:()=>a,RM:()=>s});var r=i(25105),t=i(79621);const s=[];function o(e){const n={a:"a",admonition:"admonition",code:"code",hr:"hr",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Voici la liste des port\xe9es prises en charge et les revendications correspondantes :"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"openid"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"sub"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"L'identifiant unique de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"profile"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"name"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Le nom complet de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"username"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Le nom d'utilisateur de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"picture"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"URL de la photo de profil de l'utilisateur final. Cette URL DOIT faire r\xe9f\xe9rence \xe0 un fichier image (par exemple, un fichier PNG, JPEG ou GIF), plut\xf4t qu'\xe0 une page Web contenant une image. Notez que cette URL DOIT sp\xe9cifiquement r\xe9f\xe9rencer une photo de profil de l'utilisateur final adapt\xe9e \xe0 l'affichage lors de la description de l'utilisateur final, plut\xf4t qu'une photo arbitraire prise par l'utilisateur final."}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"created_at"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:"Heure \xe0 laquelle l'utilisateur final a \xe9t\xe9 cr\xe9\xe9. Le temps est repr\xe9sent\xe9 comme le nombre de millisecondes \xe9coul\xe9es depuis l'\xe9poque Unix (1970-01-01T00:00:00Z)."}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"updated_at"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"number"})}),(0,r.jsx)(n.td,{children:"Heure \xe0 laquelle les informations de l'utilisateur final ont \xe9t\xe9 mises \xe0 jour pour la derni\xe8re fois. Le temps est repr\xe9sent\xe9 comme le nombre de millisecondes \xe9coul\xe9es depuis l'\xe9poque Unix (1970-01-01T00:00:00Z)."}),(0,r.jsx)(n.td,{children:"Non"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["D'autres ",(0,r.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#StandardClaims",children:"revendications standard"})," incluent ",(0,r.jsx)(n.code,{children:"family_name"}),", ",(0,r.jsx)(n.code,{children:"given_name"}),", ",(0,r.jsx)(n.code,{children:"middle_name"}),", ",(0,r.jsx)(n.code,{children:"nickname"}),", ",(0,r.jsx)(n.code,{children:"preferred_username"}),", ",(0,r.jsx)(n.code,{children:"profile"}),", ",(0,r.jsx)(n.code,{children:"website"}),", ",(0,r.jsx)(n.code,{children:"gender"}),", ",(0,r.jsx)(n.code,{children:"birthdate"}),", ",(0,r.jsx)(n.code,{children:"zoneinfo"}),", et ",(0,r.jsx)(n.code,{children:"locale"})," seront \xe9galement incluses dans la port\xe9e ",(0,r.jsx)(n.code,{children:"profile"})," sans avoir besoin de demander le point de terminaison userinfo. Une diff\xe9rence par rapport aux revendications ci-dessus est que ces revendications ne seront renvoy\xe9es que lorsque leurs valeurs ne sont pas vides, tandis que les revendications ci-dessus renverront ",(0,r.jsx)(n.code,{children:"null"})," si les valeurs sont vides."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Contrairement aux revendications standard, les revendications ",(0,r.jsx)(n.code,{children:"created_at"})," et ",(0,r.jsx)(n.code,{children:"updated_at"})," utilisent des millisecondes au lieu de secondes."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"email"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"email"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"L'adresse e-mail de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"email_verified"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:"Si l'adresse e-mail a \xe9t\xe9 v\xe9rifi\xe9e"}),(0,r.jsx)(n.td,{children:"Non"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"phone"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"phone_number"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Le num\xe9ro de t\xe9l\xe9phone de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"phone_number_verified"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:"Si le num\xe9ro de t\xe9l\xe9phone a \xe9t\xe9 v\xe9rifi\xe9"}),(0,r.jsx)(n.td,{children:"Non"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"address"})})}),"\n",(0,r.jsxs)(n.p,{children:["Veuillez vous r\xe9f\xe9rer \xe0 ",(0,r.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#AddressClaim",children:"OpenID Connect Core 1.0"})," pour les d\xe9tails de la revendication d'adresse."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"custom_data"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"custom_data"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object"})}),(0,r.jsx)(n.td,{children:"Les donn\xe9es personnalis\xe9es de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Oui"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"identities"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"identities"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object"})}),(0,r.jsx)(n.td,{children:"Les identit\xe9s li\xe9es de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"sso_identities"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:"Les identit\xe9s SSO li\xe9es de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Oui"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"roles"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"roles"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string[]"})}),(0,r.jsx)(n.td,{children:"Les r\xf4les de l'utilisateur"}),(0,r.jsx)(n.td,{children:"Non"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"urn:logto:scope:organizations"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"organizations"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string[]"})}),(0,r.jsx)(n.td,{children:"Les identifiants d'organisation auxquels l'utilisateur appartient"}),(0,r.jsx)(n.td,{children:"Non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"organization_data"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object[]"})}),(0,r.jsx)(n.td,{children:"Les donn\xe9es d'organisation auxquelles l'utilisateur appartient"}),(0,r.jsx)(n.td,{children:"Oui"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"urn:logto:scope:organization_roles"})})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nom de la revendication"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Besoin de userinfo ?"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"organization_roles"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string[]"})}),(0,r.jsxs)(n.td,{children:["Les r\xf4les d'organisation auxquels l'utilisateur appartient avec le format ",(0,r.jsx)(n.code,{children:"<organization_id>:<role_name>"})]}),(0,r.jsx)(n.td,{children:"Non"})]})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:['En consid\xe9rant la performance et la taille des donn\xe9es, si "Besoin de userinfo ?" est "Oui", cela signifie que la revendication n\'appara\xeetra pas dans le jeton d\u2019identifiant, mais sera renvoy\xe9e dans la r\xe9ponse du ',(0,r.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#UserInfo",children:"point de terminaison userinfo"}),"."]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},75934:(e,n,i)=>{i.d(n,{Ay:()=>a,RM:()=>s});var r=i(25105),t=i(79621);const s=[];function o(e){const n={admonition:"admonition",code:"code",mermaid:"mermaid",p:"p",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Par d\xe9faut, des revendications limit\xe9es sont retourn\xe9es. Si vous avez besoin de plus d'informations, vous pouvez demander des port\xe9es suppl\xe9mentaires pour acc\xe9der \xe0 plus de revendications."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:'Une "revendication" est une affirmation faite \xe0 propos d\'un sujet ; une "port\xe9e" est un groupe de revendications. Dans le cas actuel, une revendication est une information sur l\'utilisateur.'})}),"\n",(0,r.jsx)(n.p,{children:"Voici un exemple non normatif de la relation port\xe9e - revendication :"}),"\n",(0,r.jsx)(n.mermaid,{value:"classDiagram\n  class openid {\n    +sub\n  }\n\n  class profile {\n    +name\n    +username\n    +picture\n    +...\n  }\n\n  class email {\n    +email\n    +email_verified\n  }\n\n  class phone {\n    +phone_number\n    +phone_number_verified\n  }"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"La revendication \"sub\" signifie \"sujet\", qui est l'identifiant unique de l'utilisateur (c'est-\xe0-dire l'ID utilisateur)."})}),"\n",(0,r.jsxs)(n.p,{children:["Le SDK Logto demandera toujours trois port\xe9es : ",(0,r.jsx)(n.code,{children:"openid"}),", ",(0,r.jsx)(n.code,{children:"profile"}),", et ",(0,r.jsx)(n.code,{children:"offline_access"}),"."]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},50102:(e,n,i)=>{i.d(n,{Ay:()=>l,Ip:()=>s,RM:()=>a,YF:()=>o});var r=i(25105),t=i(79621);const s="http://localhost:3000/",o=`${s}callback`,a=[{value:"Configurer les URIs de redirection",id:"configure-redirect-uris",level:4}];function c(e){const n={h4:"h4",p:"p",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:["\n","\n",(0,r.jsx)(n.h4,{id:"configure-redirect-uris",children:"Configurer les URIs de redirection"}),"\n",(0,r.jsxs)(n.p,{children:["Passez \xe0 la page des d\xe9tails de l'application de Logto Console. Ajoutez une URI de redirection ",(0,r.jsx)("code",{children:e.redirectUri??"http://localhost:3000/callback"}),"."]}),"\n",(0,r.jsx)("img",{alt:"URI de redirection dans Logto Console",src:"/img/assets/web-redirect-uri.png",width:"600px"}),"\n",(0,r.jsxs)(n.p,{children:["Tout comme pour la connexion, les utilisateurs doivent \xeatre redirig\xe9s vers Logto pour se d\xe9connecter de la session partag\xe9e. Une fois termin\xe9, il serait id\xe9al de rediriger l'utilisateur vers votre site web. Par exemple, ajoutez ",(0,r.jsx)("code",{children:s})," comme section d'URI de redirection apr\xe8s d\xe9connexion."]}),"\n",(0,r.jsx)(n.p,{children:'Ensuite, cliquez sur "Enregistrer" pour sauvegarder les modifications.'})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},60348:(e,n,i)=>{i.d(n,{Ay:()=>c,RM:()=>o});var r=i(25105),t=i(79621),s=i(42142);const o=[...s.RM];function a(e){const n={hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Avant de plonger dans les d\xe9tails, voici un aper\xe7u rapide de l'Exp\xe9rience utilisateur. Le processus de connexion peut \xeatre simplifi\xe9 comme suit :"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    A(Votre application) --\x3e|1. Lancer la connexion| B(Logto)\n    B --\x3e|2. Terminer la connexion| A"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Votre application lance la m\xe9thode de connexion."}),"\n",(0,r.jsx)(n.li,{children:"L'utilisateur est redirig\xe9 vers la page de connexion Logto. Pour les applications natives, le navigateur syst\xe8me est ouvert."}),"\n",(0,r.jsx)(n.li,{children:"L'utilisateur se connecte et est redirig\xe9 vers votre application (configur\xe9e comme l'URI de redirection)."}),"\n"]}),"\n",(0,r.jsx)(s.Ay,{}),"\n",(0,r.jsx)(n.hr,{})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},9825:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>m,contentTitle:()=>j,default:()=>b,frontMatter:()=>x,metadata:()=>r,toc:()=>v});const r=JSON.parse('{"id":"quick-starts/framework/java-spring-boot/README","title":"Ajoutez l\u2019authentification \xe0 votre application Java Spring Boot","description":"Ce guide vous montrera comment int\xe9grer Logto dans votre application Java Spring Boot.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/quick-starts/framework/java-spring-boot/README.mdx","sourceDirName":"quick-starts/framework/java-spring-boot","slug":"/quick-starts/java-spring-boot","permalink":"/fr/quick-starts/java-spring-boot","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/quick-starts/framework/java-spring-boot/README.mdx","tags":[],"version":"current","frontMatter":{"slug":"/quick-starts/java-spring-boot","sidebar_label":"Java Spring Boot","sidebar_custom_props":{"description":"Spring Boot est un framework web pour Java qui permet aux d\xe9veloppeurs de cr\xe9er des applications serveur s\xe9curis\xe9es, rapides et \xe9volutives avec le langage de programmation Java.","logoFilename":"spring-boot.svg"}},"sidebar":"quickStartSidebar","previous":{"title":"Go","permalink":"/fr/quick-starts/go"},"next":{"title":"Next.js (Pages Router)","permalink":"/fr/quick-starts/next"}}');var t=i(25105),s=i(79621),o=i(99225),a=i(62990),c=i(75934),l=i(50102),d=i(60348),u=i(28730);const p=[...u.RM];function h(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Logto utilise les conventions de ",(0,t.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#Claims",children:"port\xe9es et revendications"})," d' OIDC pour d\xe9finir les port\xe9es et revendications pour r\xe9cup\xe9rer les informations utilisateur \xe0 partir du jeton d\u2019identifiant et du point de terminaison OIDC ",(0,t.jsx)("a",{href:"https://openid.net/specs/openid-connect-core-1_0.html#UserInfo",children:"userinfo"}),'. Les termes "port\xe9e" et "revendication" proviennent des sp\xe9cifications OAuth 2.0 et OpenID Connect (OIDC).']}),"\n",(0,t.jsxs)(n.p,{children:["En bref, lorsque vous demandez une port\xe9e, vous obtiendrez les revendications correspondantes dans les informations utilisateur. Par exemple, si vous demandez la port\xe9e ",(0,t.jsx)(n.code,{children:"email"}),", vous obtiendrez les donn\xe9es ",(0,t.jsx)(n.code,{children:"email"})," et ",(0,t.jsx)(n.code,{children:"email_verified"})," de l'utilisateur."]}),"\n",(0,t.jsx)(u.Ay,{}),"\n",(0,t.jsxs)(n.p,{children:["Ajoutez des port\xe9es et revendications suppl\xe9mentaires dans le fichier ",(0,t.jsx)(n.code,{children:"application.properties"})," pour demander plus d'informations utilisateur. Par exemple, pour demander la port\xe9e ",(0,t.jsx)(n.code,{children:"urn:logto:scope:organizations"}),", ajoutez la ligne suivante au fichier ",(0,t.jsx)(n.code,{children:"application.properties"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"spring.security.oauth2.client.registration.logto.scope=openid,profile,offline_access,urn:logto:scope:organizations\n"})}),"\n",(0,t.jsx)(n.p,{children:"Les revendications d\u2019 organisation utilisateur seront incluses dans le jeton d\u2019autorisation."})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}const x={slug:"/quick-starts/java-spring-boot",sidebar_label:"Java Spring Boot",sidebar_custom_props:{description:"Spring Boot est un framework web pour Java qui permet aux d\xe9veloppeurs de cr\xe9er des applications serveur s\xe9curis\xe9es, rapides et \xe9volutives avec le langage de programmation Java.",logoFilename:"spring-boot.svg"}},j="Ajoutez l\u2019authentification \xe0 votre application Java Spring Boot",m={},v=[{value:"Pr\xe9requis",id:"prerequisites",level:2},{value:"Configurez votre application Java Spring Boot",id:"configure-your-java-spring-boot-application",level:2},{value:"Ajout de d\xe9pendances",id:"adding-dependencies",level:3},{value:"Configuration du client OAuth2",id:"oauth2-client-configuration",level:3},{value:"Impl\xe9mentation",id:"implementation",level:2},...d.RM,...l.RM,{value:"Impl\xe9mentez le WebSecurityConfig",id:"implement-the-websecurityconfig",level:3},{value:"Cr\xe9ez une nouvelle classe <code>WebSecurityConfig</code> dans votre projet",id:"create-a-new-class-websecurityconfig-in-your-project",level:4},{value:"Cr\xe9ez un bean <code>idTokenDecoderFactory</code>",id:"create-a-idtokendecoderfactory-bean",level:4},{value:"Cr\xe9ez une classe LoginSuccessHandler pour g\xe9rer l&#39;\xe9v\xe9nement de succ\xe8s de connexion",id:"create-a-loginsuccesshandler-class-to-handle-the-login-success-event",level:4},{value:"Cr\xe9ez une classe LogoutSuccessHandler pour g\xe9rer l&#39;\xe9v\xe9nement de succ\xe8s de d\xe9connexion",id:"create-a-logoutsuccesshandler-class-to-handle-the-logout-success-event",level:4},{value:"Mettez \xe0 jour la classe <code>WebSecurityConfig</code> avec un <code>securityFilterChain</code>",id:"update-the-websecurityconfig-class-with-a-securityfilterchain",level:4},{value:"Cr\xe9ez une page d&#39;accueil",id:"create-a-home-page",level:3},{value:"Cr\xe9ez une page utilisateur",id:"create-a-user-page",level:3},{value:"Demander des revendications suppl\xe9mentaires",id:"request-additional-claims",level:4},...o.RM,...c.RM,{value:"Ex\xe9cutez et testez l&#39;application",id:"run-and-test-the-application",level:3},{value:"Port\xe9es et Revendications",id:"scopes-and-claims",level:2},...p,{value:"Lectures compl\xe9mentaires",id:"further-readings",level:2},...a.RM];function f(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ajoutez-lauthentification-\xe0-votre-application-java-spring-boot",children:"Ajoutez l\u2019authentification \xe0 votre application Java Spring Boot"})}),"\n",(0,t.jsx)(n.p,{children:"Ce guide vous montrera comment int\xe9grer Logto dans votre application Java Spring Boot."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Vous pouvez trouver le code d'exemple pour ce guide dans notre d\xe9p\xf4t github ",(0,t.jsx)(n.a,{href:"https://github.com/logto-io/spring-boot-sample",children:"spring-boot-sample"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Aucun SDK officiel n'est requis pour int\xe9grer Logto \xe0 votre application Java Spring Boot. Nous utiliserons les biblioth\xe8ques ",(0,t.jsx)(n.a,{href:"https://spring.io/projects/spring-security",children:"Spring Security"})," et ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/tutorials/spring-boot-oauth2",children:"Spring Security OAuth2"})," pour g\xe9rer le flux d'authentification OIDC avec Logto."]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Pr\xe9requis"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Un compte ",(0,t.jsx)(n.a,{href:"https://cloud.logto.io",children:"Logto Cloud"})," ou un ",(0,t.jsx)(n.a,{href:"/introduction/set-up-logto-oss",children:"Logto auto-h\xe9berg\xe9"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Notre code d'exemple a \xe9t\xe9 cr\xe9\xe9 en utilisant le ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/gs/securing-web",children:"securing web starter"})," de Spring Boot. Suivez les instructions pour d\xe9marrer une nouvelle application web si vous n'en avez pas."]}),"\n",(0,t.jsxs)(n.li,{children:["Dans ce guide, nous utiliserons les biblioth\xe8ques ",(0,t.jsx)(n.a,{href:"https://spring.io/projects/spring-security",children:"Spring Security"})," et ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/tutorials/spring-boot-oauth2",children:"Spring Security OAuth2"})," pour g\xe9rer le flux d'authentification OIDC avec Logto. Veuillez vous assurer de parcourir la documentation officielle pour comprendre les concepts."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"configure-your-java-spring-boot-application",children:"Configurez votre application Java Spring Boot"}),"\n",(0,t.jsx)(n.h3,{id:"adding-dependencies",children:"Ajout de d\xe9pendances"}),"\n",(0,t.jsxs)(n.p,{children:["Pour les utilisateurs de ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/gs/gradle",children:"gradle"}),", ajoutez les d\xe9pendances suivantes \xe0 votre fichier ",(0,t.jsx)(n.code,{children:"build.gradle"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-groovy",metastring:'title="build.gradle"',children:"dependencies {\n  implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'\n\timplementation 'org.springframework.boot:spring-boot-starter-web'\n  implementation 'org.springframework.boot:spring-boot-starter-security'\n\timplementation 'org.springframework.boot:spring-boot-starter-oauth2-client'\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Pour les utilisateurs de ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/gs/maven",children:"maven"}),", ajoutez les d\xe9pendances suivantes \xe0 votre fichier ",(0,t.jsx)(n.code,{children:"pom.xml"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml"',children:"<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-thymeleaf</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-security</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-oauth2-client</artifactId>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"oauth2-client-configuration",children:"Configuration du client OAuth2"}),"\n",(0,t.jsxs)(n.p,{children:["Enregistrez une nouvelle application ",(0,t.jsx)(n.code,{children:"Java Spring Boot"})," dans la Console Logto et obtenez les informations d'identification du client et les configurations IdP pour votre application web."]}),"\n",(0,t.jsxs)(n.p,{children:["Ajoutez la configuration suivante \xe0 votre fichier ",(0,t.jsx)(n.code,{children:"application.properties"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"spring.security.oauth2.client.registration.logto.client-name=logto\nspring.security.oauth2.client.registration.logto.client-id={{YOUR_CLIENT_ID}}\nspring.security.oauth2.client.registration.logto.client-secret={{YOUR_CLIENT_ID}}\nspring.security.oauth2.client.registration.logto.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}\nspring.security.oauth2.client.registration.logto.authorization-grant-type=authorization_code\nspring.security.oauth2.client.registration.logto.scope=openid,profile,offline_access\nspring.security.oauth2.client.registration.logto.provider=logto\n\nspring.security.oauth2.client.provider.logto.issuer-uri={{LOGTO_ENDPOINT}}/oidc\nspring.security.oauth2.client.provider.logto.authorization-uri={{LOGTO_ENDPOINT}}/oidc/auth\nspring.security.oauth2.client.provider.logto.jwk-set-uri={{LOGTO_ENDPOINT}}/oidc/jwks\n"})}),"\n",(0,t.jsx)(n.h2,{id:"implementation",children:"Impl\xe9mentation"}),"\n",(0,t.jsx)(d.Ay,{}),"\n",(0,t.jsxs)(n.p,{children:["Pour rediriger les utilisateurs vers votre application apr\xe8s leur connexion, vous devez d\xe9finir l'URI de redirection en utilisant la propri\xe9t\xe9 ",(0,t.jsx)(n.code,{children:"client.registration.logto.redirect-uri"})," \xe0 l'\xe9tape pr\xe9c\xe9dente."]}),"\n",(0,t.jsx)(l.Ay,{}),"\n",(0,t.jsx)(n.h3,{id:"implement-the-websecurityconfig",children:"Impl\xe9mentez le WebSecurityConfig"}),"\n",(0,t.jsxs)(n.h4,{id:"create-a-new-class-websecurityconfig-in-your-project",children:["Cr\xe9ez une nouvelle classe ",(0,t.jsx)(n.code,{children:"WebSecurityConfig"})," dans votre projet"]}),"\n",(0,t.jsxs)(n.p,{children:["La classe ",(0,t.jsx)(n.code,{children:"WebSecurityConfig"})," sera utilis\xe9e pour configurer les param\xe8tres de s\xe9curit\xe9 de votre application. C'est la classe cl\xe9 qui g\xe9rera le flux d'authentification et d'autorisation. Veuillez consulter la ",(0,t.jsx)(n.a,{href:"https://spring.io/guides/topicals/spring-security-architecture",children:"documentation Spring Security"})," pour plus de d\xe9tails."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="WebSecurityConfig.java"',children:"package com.example.securingweb;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\n\n@Configuration\n@EnableWebSecurity\n\npublic class WebSecurityConfig {\n // ...\n}\n"})}),"\n",(0,t.jsxs)(n.h4,{id:"create-a-idtokendecoderfactory-bean",children:["Cr\xe9ez un bean ",(0,t.jsx)(n.code,{children:"idTokenDecoderFactory"})]}),"\n",(0,t.jsxs)(n.p,{children:["Ceci est n\xe9cessaire car Logto utilise ",(0,t.jsx)(n.code,{children:"ES384"})," comme algorithme par d\xe9faut, nous devons remplacer le ",(0,t.jsx)(n.code,{children:"OidcIdTokenDecoderFactory"})," par d\xe9faut pour utiliser le m\xeame algorithme."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="WebSecurityConfig.java"',children:"import org.springframework.context.annotation.Bean;\nimport org.springframework.security.oauth2.client.oidc.authentication.OidcIdTokenDecoderFactory;\nimport org.springframework.security.oauth2.client.registration.ClientRegistration;\nimport org.springframework.security.oauth2.jose.jws.SignatureAlgorithm;\nimport org.springframework.security.oauth2.jwt.JwtDecoderFactory;\n\npublic class WebSecurityConfig {\n  // ...\n\n  @Bean\n  public JwtDecoderFactory<ClientRegistration> idTokenDecoderFactory() {\n    OidcIdTokenDecoderFactory idTokenDecoderFactory = new OidcIdTokenDecoderFactory();\n    idTokenDecoderFactory.setJwsAlgorithmResolver(clientRegistration -> SignatureAlgorithm.ES384);\n    return idTokenDecoderFactory;\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"create-a-loginsuccesshandler-class-to-handle-the-login-success-event",children:"Cr\xe9ez une classe LoginSuccessHandler pour g\xe9rer l'\xe9v\xe9nement de succ\xe8s de connexion"}),"\n",(0,t.jsxs)(n.p,{children:["Nous redirigerons l'utilisateur vers la page ",(0,t.jsx)(n.code,{children:"/user"})," apr\xe8s une connexion r\xe9ussie."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="CustomSuccessHandler.java"',children:'package com.example.securingweb;\n\nimport java.io.IOException;\n\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.web.authentication.AuthenticationSuccessHandler;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\n\npublic class CustomSuccessHandler implements AuthenticationSuccessHandler {\n  @Override\n  public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,\n      Authentication authentication) throws IOException, ServletException {\n    response.sendRedirect("/user");\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"create-a-logoutsuccesshandler-class-to-handle-the-logout-success-event",children:"Cr\xe9ez une classe LogoutSuccessHandler pour g\xe9rer l'\xe9v\xe9nement de succ\xe8s de d\xe9connexion"}),"\n",(0,t.jsx)(n.p,{children:"Effacez la session et redirigez l'utilisateur vers la page d'accueil."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="CustomLogoutHandler.java"',children:'package com.example.securingweb;\n\nimport java.io.IOException;\n\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.web.authentication.logout.LogoutSuccessHandler;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport jakarta.servlet.http.HttpSession;\n\npublic class CustomLogoutHandler implements LogoutSuccessHandler {\n  @Override\n  public void onLogoutSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)\n      throws IOException, ServletException {\n    HttpSession session = request.getSession();\n\n    if (session != null) {\n      session.invalidate();\n    }\n\n    response.sendRedirect("/home");\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h4,{id:"update-the-websecurityconfig-class-with-a-securityfilterchain",children:["Mettez \xe0 jour la classe ",(0,t.jsx)(n.code,{children:"WebSecurityConfig"})," avec un ",(0,t.jsx)(n.code,{children:"securityFilterChain"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/DefaultSecurityFilterChain.html",children:"securityFilterChain"})," est une cha\xeene de filtres responsables du traitement des requ\xeates et r\xe9ponses entrantes."]}),"\n",(0,t.jsxs)(n.p,{children:["Nous allons configurer le ",(0,t.jsx)(n.code,{children:"securityFilterChain"})," pour permettre l'acc\xe8s \xe0 la page d'accueil et exiger une authentification pour toutes les autres requ\xeates. Utilisez le ",(0,t.jsx)(n.code,{children:"CustomSuccessHandler"})," et le ",(0,t.jsx)(n.code,{children:"CustomLogoutHandler"})," pour g\xe9rer les \xe9v\xe9nements de connexion et de d\xe9connexion."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="WebSecurityConfig.java"',children:'import org.springframework.context.annotation.Bean;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.web.DefaultSecurityFilterChain;\n\npublic class WebSecurityConfig {\n  // ...\n\n  @Bean\n  public DefaultSecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    http\n      .authorizeRequests(authorizeRequests ->\n        authorizeRequests\n          .antMatchers("/", "/home").permitAll() // Permettre l\'acc\xe8s \xe0 la page d\'accueil\n          .anyRequest().authenticated() // Toutes les autres requ\xeates n\xe9cessitent une authentification\n      )\n      .oauth2Login(oauth2Login ->\n        oauth2Login\n          .successHandler(new CustomSuccessHandler())\n      )\n      .logout(logout ->\n        logout\n          .logoutSuccessHandler(new CustomLogoutHandler())\n      );\n    return http.build();\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-home-page",children:"Cr\xe9ez une page d'accueil"}),"\n",(0,t.jsx)(n.p,{children:"(Vous pouvez passer cette \xe9tape si vous avez d\xe9j\xe0 une page d'accueil dans votre projet)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="HomeController.java"',children:'package com.example.securingweb;\n\nimport java.security.Principal;\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.GetMapping;\n\n@Controller\npublic class HomeController {\n  @GetMapping({ "/", "/home" })\n  public String home(Principal principal) {\n    return principal != null ? "redirect:/user" : "home";\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Ce contr\xf4leur redirigera l'utilisateur vers la page utilisateur si l'utilisateur est authentifi\xe9, sinon, il affichera la page d'accueil. Ajoutez un lien de connexion \xe0 la page d'accueil."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",metastring:'title="resources/templates/home.html"',children:'<body>\n  <h1>Bienvenue !</h1>\n\n  <p><a th:href="@{/oauth2/authorization/logto}">Connexion avec Logto</a></p>\n</body>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-user-page",children:"Cr\xe9ez une page utilisateur"}),"\n",(0,t.jsx)(n.p,{children:"Cr\xe9ez un nouveau contr\xf4leur pour g\xe9rer la page utilisateur :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="UserController.java"',children:'package com.example.securingweb;\n\nimport java.security.Principal;\nimport java.util.Map;\n\nimport org.springframework.security.oauth2.client.authentication.OAuth2AuthenticationToken;\nimport org.springframework.security.oauth2.core.user.OAuth2User;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n@Controller\n@RequestMapping("/user")\npublic class UserController {\n\n  @GetMapping\n  public String user(Model model, Principal principal) {\n    if (principal instanceof OAuth2AuthenticationToken) {\n      OAuth2AuthenticationToken token = (OAuth2AuthenticationToken) principal;\n      OAuth2User oauth2User = token.getPrincipal();\n      Map<String, Object> attributes = oauth2User.getAttributes();\n\n      model.addAttribute("username", attributes.get("username"));\n      model.addAttribute("email", attributes.get("email"));\n      model.addAttribute("sub", attributes.get("sub"));\n    }\n\n    return "user";\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Une fois l'utilisateur authentifi\xe9, nous r\xe9cup\xe9rerons les donn\xe9es ",(0,t.jsx)(n.code,{children:"OAuth2User"})," \xe0 partir de l'objet principal authentifi\xe9. Veuillez vous r\xe9f\xe9rer \xe0 ",(0,t.jsx)(n.a,{href:"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/oauth2/client/authentication/OAuth2AuthenticationToken.html",children:"OAuth2AuthenticationToken"})," et ",(0,t.jsx)(n.a,{href:"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/oauth2/core/user/OAuth2User.html",children:"OAuth2User"})," pour plus de d\xe9tails."]}),"\n",(0,t.jsxs)(n.p,{children:["Lisez les donn\xe9es utilisateur et passez-les au mod\xe8le ",(0,t.jsx)(n.code,{children:"user.html"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",metastring:'title="resources/templates/user.html"',children:'<body>\n  <h1>D\xe9tails de l\'utilisateur</h1>\n  <div>\n    <p>\n    <div><strong>nom :</strong> <span th:text="${username}"></span></div>\n    <div><strong>email :</strong> <span th:text="${email}"></span></div>\n    <div><strong>id :</strong> <span th:text="${sub}"></span></div>\n    </p>\n  </div>\n\n  <form th:action="@{/logout}" method="post">\n    <input type="submit" value="D\xe9connexion" />\n  </form>\n</body>\n'})}),"\n",(0,t.jsx)(n.h4,{id:"request-additional-claims",children:"Demander des revendications suppl\xe9mentaires"}),"\n",(0,t.jsx)(o.Ay,{method:"principal (OAuth2AuthenticationToken)"}),"\n",(0,t.jsx)(c.Ay,{}),"\n",(0,t.jsxs)(n.p,{children:["Pour r\xe9cup\xe9rer des informations utilisateur suppl\xe9mentaires, vous pouvez ajouter des port\xe9es suppl\xe9mentaires au fichier ",(0,t.jsx)(n.code,{children:"application.properties"}),". Par exemple, pour demander les port\xe9es ",(0,t.jsx)(n.code,{children:"email"}),", ",(0,t.jsx)(n.code,{children:"phone"}),", et ",(0,t.jsx)(n.code,{children:"urn:logto:scope:organizations"}),", ajoutez la ligne suivante au fichier ",(0,t.jsx)(n.code,{children:"application.properties"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"  spring.security.oauth2.client.registration.logto.scope=openid,profile,offline_access,email,phone,urn:logto:scope:organizations\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Ensuite, vous pouvez acc\xe9der aux revendications suppl\xe9mentaires dans l'objet ",(0,t.jsx)(n.code,{children:"OAuth2User"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"run-and-test-the-application",children:"Ex\xe9cutez et testez l'application"}),"\n",(0,t.jsxs)(n.p,{children:["Ex\xe9cutez l'application et acc\xe9dez \xe0 ",(0,t.jsx)(n.code,{children:"http://localhost:8080"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Vous verrez la page d'accueil avec un lien de connexion."}),"\n",(0,t.jsx)(n.li,{children:"Cliquez sur le lien pour vous connecter avec Logto."}),"\n",(0,t.jsx)(n.li,{children:"Apr\xe8s une authentification r\xe9ussie, vous serez redirig\xe9 vers la page utilisateur avec vos d\xe9tails utilisateur."}),"\n",(0,t.jsx)(n.li,{children:"Cliquez sur le bouton de d\xe9connexion pour vous d\xe9connecter. Vous serez redirig\xe9 vers la page d'accueil."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"scopes-and-claims",children:"Port\xe9es et Revendications"}),"\n",(0,t.jsx)(g,{}),"\n",(0,t.jsx)(n.h2,{id:"further-readings",children:"Lectures compl\xe9mentaires"}),"\n",(0,t.jsx)(a.Ay,{})]})}function b(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},79621:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var r=i(58101);const t={},s=r.createContext(t);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);