"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[46266],{32608:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"concepts/core-service/configuration","title":"Configuration","description":"Variables d\'environnement","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/concepts/core-service/configuration.md","sourceDirName":"concepts/core-service","slug":"/concepts/core-service/configuration","permalink":"/fr/concepts/core-service/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/concepts/core-service/configuration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Service principal Logto","permalink":"/fr/concepts/core-service/"},"next":{"title":"Jeton opaque","permalink":"/fr/concepts/opaque-token"}}');var d=s(25105),r=s(79621);const t={},c="Configuration",o={},l=[{value:"Variables d&#39;environnement",id:"environment-variables",level:2},{value:"Utilisation",id:"usage",level:3},{value:"Variables",id:"variables",level:3},{value:"Activation de HTTPS",id:"enabling-https",level:3},{value:"Utilisation de Node",id:"using-node",level:4},{value:"Utilisation d&#39;un proxy HTTPS",id:"using-a-https-proxy",level:4},{value:"Configurations de la base de donn\xe9es",id:"database-configs",level:2},{value:"Types de cl\xe9s priv\xe9es pris en charge",id:"supported-private-key-types",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,d.jsx)(n.h2,{id:"environment-variables",children:"Variables d'environnement"}),"\n",(0,d.jsx)(n.h3,{id:"usage",children:"Utilisation"}),"\n",(0,d.jsx)(n.p,{children:"Logto g\xe8re les variables d'environnement dans l'ordre suivant :"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Variables d'environnement syst\xe8me"}),"\n",(0,d.jsxs)(n.li,{children:["Le fichier ",(0,d.jsx)(n.code,{children:".env"})," \xe0 la racine du projet, qui est conforme au format ",(0,d.jsx)(n.a,{href:"https://github.com/motdotla/dotenv#readme",children:"dotenv"})]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Ainsi, les variables d'environnement syst\xe8me remplaceront les valeurs dans ",(0,d.jsx)(n.code,{children:".env"}),"."]}),"\n",(0,d.jsx)(n.h3,{id:"variables",children:"Variables"}),"\n",(0,d.jsx)(n.admonition,{type:"caution",children:(0,d.jsxs)(n.p,{children:["Si vous ex\xe9cutez Logto via ",(0,d.jsx)(n.code,{children:"npm start"})," \xe0 la racine du projet, ",(0,d.jsx)(n.code,{children:"NODE_ENV"})," sera toujours ",(0,d.jsx)(n.code,{children:"production"}),"."]})}),"\n",(0,d.jsxs)(n.p,{children:["Dans les valeurs par d\xe9faut, ",(0,d.jsx)(n.code,{children:"protocol"})," sera soit ",(0,d.jsx)(n.code,{children:"http"})," soit ",(0,d.jsx)(n.code,{children:"https"})," selon votre configuration HTTPS."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Key"}),(0,d.jsx)(n.th,{children:"Valeur par d\xe9faut"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"NODE_ENV"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"undefined"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"'production' | 'test' | undefined"})}),(0,d.jsx)(n.td,{children:"Quel type d'environnement dans lequel Logto fonctionne."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"PORT"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"3001"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Le port local auquel Logto \xe9coute."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ADMIN_PORT"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"3002"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"number"})}),(0,d.jsx)(n.td,{children:"Le port local auquel la console d'administration de Logto \xe9coute."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ADMIN_DISABLE_LOCALHOST"}),(0,d.jsx)(n.td,{children:"N/A"}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"string | boolean | number"})}),(0,d.jsxs)(n.td,{children:["D\xe9finissez-le sur ",(0,d.jsx)(n.code,{children:"1"})," ou ",(0,d.jsx)(n.code,{children:"true"})," pour d\xe9sactiver le port pour la console d'administration. Avec ",(0,d.jsx)(n.code,{children:"ADMIN_ENDPOINT"})," non d\xe9fini, cela d\xe9sactivera compl\xe8tement la console d'administration."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"DB_URL"}),(0,d.jsx)(n.td,{children:"N/A"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["Le ",(0,d.jsx)(n.a,{href:"https://www.postgresql.org/docs/14/libpq-connect.html#id-1.7.3.8.3.6",children:"Postgres DSN"})," pour la base de donn\xe9es Logto."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"HTTPS_CERT_PATH"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"undefined"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"string | undefined"})}),(0,d.jsxs)(n.td,{children:["Voir ",(0,d.jsx)(n.a,{href:"#enabling-https",children:"Activation de HTTPS"})," pour plus de d\xe9tails."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"HTTPS_KEY_PATH"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"undefined"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"string | undefined"})}),(0,d.jsx)(n.td,{children:"Idem."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"TRUST_PROXY_HEADER"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Idem."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ENDPOINT"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"'protocol://localhost:$PORT'"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Vous pouvez sp\xe9cifier une URL avec votre domaine personnalis\xe9 pour les tests en ligne ou la production. Cela affectera \xe9galement la valeur de l' identifiant de l' \xc9metteur (OIDC) ."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ADMIN_ENDPOINT"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"'protocol://localhost:$ADMIN_PORT'"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["Vous pouvez sp\xe9cifier une URL avec votre domaine personnalis\xe9 pour la production (par exemple ",(0,d.jsx)(n.code,{children:"ADMIN_ENDPOINT=https://admin.domain.com"}),"). Cela affectera \xe9galement la valeur des URI de redirection de la console d'administration."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"CASE_SENSITIVE_USERNAME"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsx)(n.td,{children:"Sp\xe9cifie si le nom d'utilisateur est sensible \xe0 la casse. Faites preuve de prudence lors de la modification de cette valeur ; les modifications n'ajusteront pas automatiquement les donn\xe9es existantes de la base de donn\xe9es, n\xe9cessitant une gestion manuelle."})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"enabling-https",children:"Activation de HTTPS"}),"\n",(0,d.jsx)(n.h4,{id:"using-node",children:"Utilisation de Node"}),"\n",(0,d.jsxs)(n.p,{children:["Node prend en charge nativement HTTPS. Fournissez ",(0,d.jsx)(n.strong,{children:"BOTH"})," ",(0,d.jsx)(n.code,{children:"HTTPS_CERT_PATH"})," et ",(0,d.jsx)(n.code,{children:"HTTPS_KEY_PATH"})," pour activer HTTPS via Node."]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"HTTPS_CERT_PATH"})," implique le chemin vers votre certificat HTTPS, tandis que ",(0,d.jsx)(n.code,{children:"HTTPS_KEY_PATH"})," implique le chemin vers votre cl\xe9 HTTPS."]}),"\n",(0,d.jsx)(n.h4,{id:"using-a-https-proxy",children:"Utilisation d'un proxy HTTPS"}),"\n",(0,d.jsx)(n.p,{children:"Une autre pratique courante consiste \xe0 avoir un proxy HTTPS devant Node (par exemple Nginx)."}),"\n",(0,d.jsxs)(n.p,{children:["Dans ce cas, vous voudrez probablement d\xe9finir ",(0,d.jsx)(n.code,{children:"TRUST_PROXY_HEADER"})," sur ",(0,d.jsx)(n.code,{children:"true"}),", ce qui indique si les champs d'en-t\xeate de proxy doivent \xeatre approuv\xe9s. Logto passera la valeur aux param\xe8tres de l'application ",(0,d.jsx)(n.a,{href:"https://github.com/koajs/koa/blob/master/docs/api/index.md#settings",children:"Koa"}),"."]}),"\n",(0,d.jsxs)(n.p,{children:["Voir ",(0,d.jsx)(n.a,{href:"https://github.com/panva/node-oidc-provider/blob/main/docs/README.md#trusting-tls-offloading-proxies",children:"Trusting TLS offloading proxies"})," pour savoir quand configurer ce champ."]}),"\n",(0,d.jsx)(n.h2,{id:"database-configs",children:"Configurations de la base de donn\xe9es"}),"\n",(0,d.jsxs)(n.p,{children:["G\xe9rer trop de variables d'environnement n'est pas efficace et flexible, donc la plupart de nos configurations g\xe9n\xe9rales sont stock\xe9es dans la table de base de donn\xe9es ",(0,d.jsx)(n.code,{children:"logto_configs"}),"."]}),"\n",(0,d.jsx)(n.p,{children:"La table est un simple stockage cl\xe9-valeur, et la cl\xe9 est \xe9num\xe9rable comme suit :"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Key"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"oidc.cookieKeys"}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"string[]"})}),(0,d.jsxs)(n.td,{children:["Le tableau de cha\xeenes des ",(0,d.jsx)(n.a,{href:"https://github.com/panva/node-oidc-provider/blob/main/docs/README.md#cookieskeys",children:"cl\xe9s de signature de cookie"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"oidc.privateKeys"}),(0,d.jsx)(n.td,{children:(0,d.jsx)("code",{children:"string[]"})}),(0,d.jsx)(n.td,{children:"Le tableau de cha\xeenes du contenu de la cl\xe9 priv\xe9e pour la signature de Jeton d\u2019identifiant (OIDC) ."})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"supported-private-key-types",children:"Types de cl\xe9s priv\xe9es pris en charge"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"EC (courbes P-256, secp256k1, P-384 et P-521)"}),"\n",(0,d.jsx)(n.li,{children:"RSA"}),"\n",(0,d.jsx)(n.li,{children:"OKP (sous-types Ed25519, Ed448, X25519, X448)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},79621:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(58101);const d={},r=i.createContext(d);function t(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);