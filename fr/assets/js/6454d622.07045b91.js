"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[1348],{45022:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"developers/custom-token-claims/README","title":"Revendications personnalis\xe9es de jeton","description":"Logto offre la flexibilit\xe9 d\u2019ajouter des revendications personnalis\xe9es dans les jetons d\u2019acc\xe8s (JWT / Jeton opaque). Gr\xe2ce \xe0 cette fonctionnalit\xe9, vous pouvez inclure des informations suppl\xe9mentaires pour votre logique m\xe9tier, toutes transmises de mani\xe8re s\xe9curis\xe9e dans les jetons et r\xe9cup\xe9rables via introspection dans le cas des jetons opaques.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","sourceDirName":"developers/custom-token-claims","slug":"/developers/custom-token-claims/","permalink":"/fr/developers/custom-token-claims/","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/developers/custom-token-claims/README.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"D\xe9veloppeur","permalink":"/fr/developers/"},"next":{"title":"Cas d\u2019utilisation courants","permalink":"/fr/developers/custom-token-claims/common-use-cases"}}');var o=n(25105),i=n(79621);const r={sidebar_position:2},a="Revendications personnalis\xe9es de jeton",c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Comment fonctionnent les revendications personnalis\xe9es de jeton ?",id:"how-do-custom-token-claims-work",level:2},{value:"Ressources associ\xe9es",id:"related-resources",level:2}];function u(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Url:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"revendications-personnalis\xe9es-de-jeton",children:"Revendications personnalis\xe9es de jeton"})}),"\n",(0,o.jsx)(s.p,{children:"Logto offre la flexibilit\xe9 d\u2019ajouter des revendications personnalis\xe9es dans les jetons d\u2019acc\xe8s (JWT / Jeton opaque). Gr\xe2ce \xe0 cette fonctionnalit\xe9, vous pouvez inclure des informations suppl\xe9mentaires pour votre logique m\xe9tier, toutes transmises de mani\xe8re s\xe9curis\xe9e dans les jetons et r\xe9cup\xe9rables via introspection dans le cas des jetons opaques."}),"\n",(0,o.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsxs)(s.p,{children:["Les ",(0,o.jsx)(s.a,{href:"https://auth.wiki/access-token",children:"Jetons d\u2019acc\xe8s (Access tokens)"})," jouent un r\xf4le essentiel dans le processus d\u2019authentification (Authentication) et d\u2019autorisation (Authorization), transportant les informations d\u2019identit\xe9 du sujet et les permissions, et sont transmis entre le ",(0,o.jsx)(s.a,{href:"/concepts/core-service",children:"serveur Logto"})," (servant de serveur d\u2019authentification ou fournisseur d\u2019identit\xe9, IdP), votre serveur de service web (fournisseur de ressources), et les applications clientes (clients)."]}),"\n",(0,o.jsxs)(s.p,{children:["Les ",(0,o.jsx)(s.a,{href:"https://auth.wiki/claim",children:"Revendications de jeton (Token claims)"})," sont les paires cl\xe9-valeur qui fournissent des informations sur une entit\xe9 ou sur le jeton lui-m\xeame. Les revendications peuvent inclure des informations utilisateur, la date d\u2019expiration du jeton, des permissions, et d\u2019autres m\xe9tadonn\xe9es pertinentes pour le processus d\u2019authentification (Authentication) et d\u2019autorisation (Authorization)."]}),"\n",(0,o.jsx)(s.p,{children:"Il existe deux types de jetons d\u2019acc\xe8s dans Logto :"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"JSON Web Token :"})," ",(0,o.jsx)(s.a,{href:"https://auth.wiki/jwt",children:"JSON Web Token (JWT)"})," est un format populaire qui encode les revendications de mani\xe8re s\xe9curis\xe9e et lisible par les clients. Les revendications courantes comme ",(0,o.jsx)(s.code,{children:"sub"}),", ",(0,o.jsx)(s.code,{children:"iss"}),", ",(0,o.jsx)(s.code,{children:"aud"})," etc. sont utilis\xe9es conform\xe9ment au protocole OAuth 2.0 (Voir ",(0,o.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519#section-4",children:"ce lien"})," pour plus de d\xe9tails). Les JWT permettent aux consommateurs d\u2019acc\xe9der directement aux revendications sans \xe9tapes de validation suppl\xe9mentaires. Dans Logto, les jetons d\u2019acc\xe8s sont \xe9mis au format JWT par d\xe9faut lorsqu\u2019un client initie des requ\xeates d\u2019autorisation de ressources ou d\u2019organisations sp\xe9cifiques."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Jeton opaque (Opaque token) :"})," Un ",(0,o.jsx)(s.a,{href:"http://localhost:3000/concepts/opaque-token",children:"jeton opaque"})," n\u2019est pas autonome et n\xe9cessite toujours une \xe9tape de validation suppl\xe9mentaire via le point de terminaison ",(0,o.jsx)(s.a,{href:"https://auth.wiki/token-introspection",children:"introspection de jeton"}),". Malgr\xe9 leur format non transparent, les jetons opaques permettent d\u2019obtenir des revendications et d\u2019\xeatre transmis de mani\xe8re s\xe9curis\xe9e entre les parties. Les revendications de jeton sont stock\xe9es en toute s\xe9curit\xe9 sur le serveur Logto et accessibles par les applications clientes via le point de terminaison d\u2019introspection de jeton. Les jetons d\u2019acc\xe8s sont \xe9mis au format opaque lorsqu\u2019aucune ressource ou organisation sp\xe9cifique n\u2019est incluse dans la requ\xeate d\u2019autorisation. Ces jetons sont principalement utilis\xe9s pour acc\xe9der au point de terminaison OIDC ",(0,o.jsx)(s.code,{children:"userinfo"})," et \xe0 d\u2019autres usages g\xe9n\xe9raux."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:"Dans de nombreux cas, les revendications standard ne suffisent pas \xe0 r\xe9pondre aux besoins sp\xe9cifiques de vos applications, que vous utilisiez des JWT ou des jetons opaques. Pour y rem\xe9dier, Logto offre la flexibilit\xe9 d\u2019ajouter des revendications personnalis\xe9es dans les jetons d\u2019acc\xe8s. Gr\xe2ce \xe0 cette fonctionnalit\xe9, vous pouvez inclure des informations suppl\xe9mentaires pour votre logique m\xe9tier, toutes transmises de mani\xe8re s\xe9curis\xe9e dans les jetons et r\xe9cup\xe9rables via introspection dans le cas des jetons opaques."}),"\n",(0,o.jsx)(s.h2,{id:"how-do-custom-token-claims-work",children:"Comment fonctionnent les revendications personnalis\xe9es de jeton ?"}),"\n",(0,o.jsxs)(s.p,{children:["Logto vous permet d\u2019ins\xe9rer des revendications personnalis\xe9es dans le ",(0,o.jsx)(s.code,{children:"jeton d\u2019acc\xe8s"})," via une fonction de rappel ",(0,o.jsx)(s.code,{children:"getCustomJwtClaims"}),". Vous pouvez fournir votre propre impl\xe9mentation de la fonction ",(0,o.jsx)(s.code,{children:"getCustomJwtClaims"})," pour retourner un objet de revendications personnalis\xe9es. La valeur de retour sera fusionn\xe9e avec la charge utile originale du jeton et sign\xe9e pour g\xe9n\xe9rer le jeton d\u2019acc\xe8s final."]}),"\n",(0,o.jsx)(s.mermaid,{value:"sequenceDiagram\n  participant U as Utilisateur ou agent utilisateur\n  participant IdP as Logto (fournisseur d\u2019identit\xe9)\n  participant SP as Fournisseur de service\n\n  autonumber\n  U ->> IdP: Requ\xeate d\u2019authentification (avec identifiants)\n  activate IdP\n  IdP--\x3e>IdP: Valider les identifiants &<br/>g\xe9n\xe9rer la charge utile brute du jeton d\u2019acc\xe8s\n  rect var(--mermaid-rect-fill)\n  note over IdP: Revendications personnalis\xe9es de jeton\n  IdP->>IdP: Ex\xe9cuter le script de revendications personnalis\xe9es (`getCustomJwtClaims`) &<br/>obtenir des revendications suppl\xe9mentaires\n  end\n  IdP--\x3e>IdP: Fusionner la charge utile brute et les revendications suppl\xe9mentaires\n  IdP--\x3e>IdP: Signer & chiffrer la charge utile pour obtenir le jeton d\u2019acc\xe8s\n  deactivate IdP\n  IdP--\x3e>U: \xc9mettre le jeton d\u2019acc\xe8s au format JWT\n  par Obtenir un service via l\u2019API\n  U->>SP: requ\xeate de service (avec jeton d\u2019acc\xe8s JWT)\n  SP--\x3e>U: r\xe9ponse du service\n  end"}),"\n",(0,o.jsx)(s.admonition,{type:"warning",children:(0,o.jsx)(s.p,{children:"Les revendications int\xe9gr\xe9es de Logto ne peuvent PAS \xeatre remplac\xe9es ou modifi\xe9es. Les revendications personnalis\xe9es seront ajout\xe9es au jeton en tant que revendications suppl\xe9mentaires. Si des revendications personnalis\xe9es entrent en conflit avec les revendications int\xe9gr\xe9es, ces revendications personnalis\xe9es seront ignor\xe9es."})}),"\n",(0,o.jsx)(s.h2,{id:"related-resources",children:"Ressources associ\xe9es"}),"\n",(0,o.jsx)(n,{href:"https://blog.logto.io/glance-on-custom-jwt-access-token-claims",children:(0,o.jsx)(s.p,{children:"Ajouter des revendications personnalis\xe9es pour les jetons d\u2019acc\xe8s JWT avec Logto pour renforcer\nvotre autorisation (Authorization)"})})]})}function l(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},79621:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>a});var t=n(58101);const o={},i=t.createContext(o);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);