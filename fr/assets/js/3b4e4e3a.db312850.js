"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[8272],{19707:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"user-management/user-migration","title":"Migration des utilisateurs","description":"Logto prend en charge la migration manuelle des utilisateurs existants depuis une autre plateforme. Ce guide vous montrera comment importer des utilisateurs existants via Management API et abordera les points \xe0 consid\xe9rer avant la migration.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","sourceDirName":"user-management","slug":"/user-management/user-migration","permalink":"/fr/user-management/user-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/fr/docusaurus-plugin-content-docs/current/user-management/user-migration.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Jeton d\u2019acc\xe8s personnel (Personal access token)","permalink":"/fr/user-management/personal-access-token"},"next":{"title":"Gestion des utilisateurs","permalink":"/fr/user-management/"}}');var t=r(25105),o=r(79621);const i={sidebar_position:5},a="Migration des utilisateurs",l={},u=[{value:"Sch\xe9ma utilisateur",id:"user-schema",level:2},{value:"Hachage des mots de passe",id:"password-hashing",level:2},{value:"\xc9tapes de migration",id:"steps-to-migrate",level:2},{value:"Ressources associ\xe9es",id:"related-resources",level:2}];function d(e){const s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components},{Url:r}=s;return r||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"migration-des-utilisateurs",children:"Migration des utilisateurs"})}),"\n",(0,t.jsx)(s.p,{children:"Logto prend en charge la migration manuelle des utilisateurs existants depuis une autre plateforme. Ce guide vous montrera comment importer des utilisateurs existants via Management API et abordera les points \xe0 consid\xe9rer avant la migration."}),"\n",(0,t.jsx)(s.h2,{id:"user-schema",children:"Sch\xe9ma utilisateur"}),"\n",(0,t.jsxs)(s.p,{children:["Avant de commencer, examinons le ",(0,t.jsx)(s.a,{href:"/user-management/user-data/#user-profile",children:"sch\xe9ma utilisateur"})," dans Logto. Il y a 3 parties du sch\xe9ma utilisateur dont vous devez \xeatre conscient :"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Donn\xe9es de base"})," : il s'agit des informations de base du profil utilisateur, vous pouvez faire correspondre les donn\xe9es de votre profil utilisateur existant."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Donn\xe9es personnalis\xe9es"})," : stocke des informations utilisateur suppl\xe9mentaires, vous pouvez l'utiliser pour stocker des fichiers qui ne correspondent pas aux donn\xe9es de base."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Identit\xe9s sociales"})," : stocke les informations utilisateur r\xe9cup\xe9r\xe9es lors de la connexion sociale."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Vous pouvez cr\xe9er une correspondance pour faire le lien entre les informations de votre profil utilisateur existant et les ",(0,t.jsx)(s.strong,{children:"donn\xe9es de base"})," et ",(0,t.jsx)(s.strong,{children:"donn\xe9es personnalis\xe9es"}),". Pour la connexion sociale, des \xe9tapes suppl\xe9mentaires sont n\xe9cessaires pour importer les identit\xe9s sociales ; veuillez vous r\xe9f\xe9rer \xe0 l\u2019API de ",(0,t.jsx)(s.a,{href:"https://openapi.logto.io/operation/operation-createuseridentity",children:"Lier une identit\xe9 sociale \xe0 un utilisateur"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"password-hashing",children:"Hachage des mots de passe"}),"\n",(0,t.jsxs)(s.p,{children:["Logto utilise ",(0,t.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Argon2",children:"Argon2"})," pour hacher le mot de passe de l'utilisateur, et prend \xe9galement en charge d'autres algorithmes comme ",(0,t.jsx)(s.code,{children:"MD5"}),", ",(0,t.jsx)(s.code,{children:"SHA1"}),", ",(0,t.jsx)(s.code,{children:"SHA256"})," et ",(0,t.jsx)(s.code,{children:"Bcrypt"})," pour faciliter la migration. Ces algorithmes sont consid\xe9r\xe9s comme non s\xe9curis\xe9s, les mots de passe correspondants seront migr\xe9s vers Argon2 lors de la premi\xe8re connexion r\xe9ussie de l'utilisateur."]}),"\n",(0,t.jsxs)(s.p,{children:["Si vous utilisez d'autres algorithmes de hachage ou du sel, vous pouvez d\xe9finir ",(0,t.jsx)(s.code,{children:"passwordAlgorithm"})," sur ",(0,t.jsx)(s.code,{children:"Legacy"}),", ce qui vous permet d'utiliser n'importe quel algorithme de hachage pris en charge par Node.js. Vous pouvez trouver la liste des algorithmes pris en charge dans la ",(0,t.jsx)(s.a,{href:"https://nodejs.org/api/crypto.html#cryptogethashes",children:"documentation Node.js crypto"}),". Dans ce cas, le ",(0,t.jsx)(s.code,{children:"passwordDigest"})," sera une cha\xeene JSON contenant l'algorithme de hachage et d'autres param\xe8tres sp\xe9cifiques \xe0 l'algorithme."]}),"\n",(0,t.jsx)(s.p,{children:"Le format de la cha\xeene JSON est le suivant :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'["hash_algorithm", ["argument1", "argument2", ...], "expected_hashed_value"]\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Et vous pouvez utiliser ",(0,t.jsx)(s.code,{children:"@"})," comme espace r\xe9serv\xe9 pour la valeur r\xe9elle du mot de passe dans les arguments."]}),"\n",(0,t.jsx)(s.p,{children:"Par exemple, si vous utilisez SHA256 avec un sel, vous pouvez stocker le mot de passe au format suivant :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'["sha256", ["salt123", "@"], "c465f66c6ac481a7a17e9ed5b4e2e7e7288d892f12bf1c95c140901e9a70436e"]\n'})}),"\n",(0,t.jsx)(s.p,{children:"Ce qui \xe9quivaut au code suivant :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ts",children:"const hash = crypto.createHash('sha256');\nhash.update('salt123' + 'password123');\nconst expectedHashedValue = hash.digest('hex');\n"})}),"\n",(0,t.jsx)(s.h2,{id:"steps-to-migrate",children:"\xc9tapes de migration"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Pr\xe9parer les donn\xe9es utilisateur"}),(0,t.jsx)(s.br,{}),"\n","Vous devez d'abord exporter les donn\xe9es utilisateur de votre plateforme existante, puis faire correspondre les informations utilisateur au sch\xe9ma utilisateur Logto. Nous vous recommandons de pr\xe9parer les donn\xe9es mapp\xe9es au format JSON. Voici un exemple de donn\xe9es utilisateur :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'[\n  {\n    "username": "user1",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  },\n  {\n    "username": "user2",\n    "passwordDigest": "password-encrypted",\n    "passwordAlgorithm": "SHA256"\n  }\n]\n'})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Cr\xe9er un tenant Logto"}),(0,t.jsx)(s.br,{}),"\n","Vous devrez configurer un tenant dans Logto. Vous pouvez utiliser Logto Cloud ou Logto OSS. Si ce n'est pas d\xe9j\xe0 fait, veuillez consulter le guide ",(0,t.jsx)(s.a,{href:"/introduction/set-up-logto-cloud/#create-logto-tenant",children:"Configurer Logto cloud"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Configurer la connexion \xe0 Management API"}),(0,t.jsx)(s.br,{}),"\n","Nous utiliserons Management API pour importer les donn\xe9es utilisateur. Vous pouvez consulter la page ",(0,t.jsx)(s.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," pour apprendre \xe0 configurer la connexion dans votre environnement de d\xe9veloppement."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Importer les donn\xe9es utilisateur"}),(0,t.jsx)(s.br,{}),"\n","Il est recommand\xe9 de pr\xe9parer un script pour importer les donn\xe9es utilisateur une par une. Nous appellerons l\u2019API ",(0,t.jsx)(s.a,{href:"https://openapi.logto.io/operation/operation-createuser",children:"create user"})," pour importer les donn\xe9es utilisateur. Voici un exemple de script :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-jsx",children:"const users = require('./users.json');\n\nconst importUsers = async () => {\n  for (const user of users) {\n    try {\n      await fetch('https://[tenant_id].logto.app/api/users', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer [your-access-token]',\n        },\n        body: JSON.stringify(user),\n      });\n      // Sleep for a while to avoid rate limit\n      await new Promise((resolve) => setTimeout(resolve, 200));\n    } catch (error) {\n      console.error(`Failed to import user ${user.username}: ${error.message}`);\n    }\n  }\n};\n\nimportUsers();\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Veuillez noter que le point d\u2019API est soumis \xe0 une limitation de d\xe9bit ; vous devez ajouter une pause entre chaque requ\xeate pour \xe9viter d\u2019atteindre la limite. Veuillez consulter notre page sur les ",(0,t.jsx)(s.a,{href:"/integrate-logto/interact-with-management-api/#rate-limit",children:"limitations de d\xe9bit"})," pour plus de d\xe9tails."]}),"\n",(0,t.jsxs)(s.p,{children:["Si vous avez un grand volume de donn\xe9es utilisateur (plus de 100 000 utilisateurs), vous pouvez ",(0,t.jsx)(s.a,{href:"https://logto.io/contact",children:"nous contacter"})," pour augmenter la limite de d\xe9bit."]}),"\n",(0,t.jsx)(s.h2,{id:"related-resources",children:"Ressources associ\xe9es"}),"\n",(0,t.jsx)(r,{href:"https://blog.logto.io/general-migration-guide",children:(0,t.jsx)(s.p,{children:"Guide g\xe9n\xe9ral pour migrer votre base de donn\xe9es utilisateur existante vers Logto"})})]})}function c(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},79621:(e,s,r)=>{r.d(s,{R:()=>i,x:()=>a});var n=r(58101);const t={},o=n.createContext(t);function i(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);