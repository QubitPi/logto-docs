"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[55692],{46955:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"logto-oss/develop-your-connector/step-by-step-guide","title":"Step-by-step guide to develop a social connector","description":"The fastest way to get yourself started is to copy the code from an existing official connector and modify it to fit your needs. Let\'s take the GitHub connector as an example.","source":"@site/docs/logto-oss/develop-your-connector/step-by-step-guide.mdx","sourceDirName":"logto-oss/develop-your-connector","slug":"/logto-oss/develop-your-connector/step-by-step-guide","permalink":"/logto-oss/develop-your-connector/step-by-step-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/docs/logto-oss/develop-your-connector/step-by-step-guide.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Implement connectors","permalink":"/logto-oss/develop-your-connector/implement-connectors"},"next":{"title":"Upgrading","permalink":"/logto-oss/upgrading-oss-version"}}');var i=t(25105),s=t(79621);const c={sidebar_position:3},r="Step-by-step guide to develop a social connector",l={},a=[{value:"Step 1: Clone an existing connector package",id:"step-1-clone-an-existing-connector-package",level:2},{value:"Step 2: Modify the main entry file (index.ts)",id:"step-2-modify-the-main-entry-file-indexts",level:2},{value:"Step 3: Test the connector",id:"step-3-test-the-connector",level:2},{value:"Unit test",id:"unit-test",level:3},{value:"Local test",id:"local-test",level:3}];function d(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components},{CloudLink:t}=o;return t||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CloudLink",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"step-by-step-guide-to-develop-a-social-connector",children:"Step-by-step guide to develop a social connector"})}),"\n",(0,i.jsx)(o.p,{children:"The fastest way to get yourself started is to copy the code from an existing official connector and modify it to fit your needs. Let's take the GitHub connector as an example."}),"\n",(0,i.jsx)(o.h2,{id:"step-1-clone-an-existing-connector-package",children:"Step 1: Clone an existing connector package"}),"\n",(0,i.jsx)(o.p,{children:"In a connector source folder, you will find the following files:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"index.ts"}),": The main entry file of the connector."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"constant.ts"}),": The constants used in the connector."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"types.ts"}),": The TypeScript types used in the connector."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"index.test.ts"}),": The test cases for the connector."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"mock.ts"}),": The mock data used in the connector test cases."]}),"\n"]}),"\n",(0,i.jsxs)(o.p,{children:["Besides these files, you will also need to provide a ",(0,i.jsx)(o.code,{children:"README.md"})," file to describe the connector, a ",(0,i.jsx)(o.code,{children:"logo.svg"})," (optionally a ",(0,i.jsx)(o.code,{children:"logo-dark.svg"})," for better dark mode user experience), and a ",(0,i.jsx)(o.code,{children:"package.json"})," file to define the npm package information."]}),"\n",(0,i.jsx)(o.h2,{id:"step-2-modify-the-main-entry-file-indexts",children:"Step 2: Modify the main entry file (index.ts)"}),"\n",(0,i.jsxs)(o.p,{children:["In the ",(0,i.jsx)(o.code,{children:"index.ts"})," file, you will find most of the connector logic. There are typically 4 functions you need to implement:"]}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"getAuthorizationUri"}),": Generate the authorization URI for the third-party social platform. For GitHub, it would be: ",(0,i.jsx)(o.code,{children:"https://github.com/login/oauth/authorize?client_id={clientId}&redirect_uri={redirectUri}&state={state}"}),". Refer to the developer documentation of your target social platform to get the correct URI."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"authorizationCallbackHandler"}),": Safeguard the returned parameter values in the authorization callback URI, extract the authorization ",(0,i.jsx)(o.code,{children:"code"})," and handle potential errors."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"getAccessToken"}),": Exchange the authorization ",(0,i.jsx)(o.code,{children:"code"})," for an access token."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.code,{children:"getUserInfo"}),": Fetch user information from the third-party social platform with the access token."]}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"Most of the other common logics have been taken care of in the Logto connector kit, which should make your work easier."}),"\n",(0,i.jsx)(o.p,{children:"Finally, in the end of the file, you will just need to export the connector object, following the same code structure as the GitHub connector."}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-tsx",children:"const createGithubConnector: CreateConnector<SocialConnector> = async ({ getConfig }) => {\n  return {\n    metadata: defaultMetadata,\n    type: ConnectorType.Social,\n    configGuard: githubConfigGuard,\n    getAuthorizationUri: getAuthorizationUri(getConfig),\n    getUserInfo: getUserInfo(getConfig),\n  };\n};\n"})}),"\n",(0,i.jsx)(o.h2,{id:"step-3-test-the-connector",children:"Step 3: Test the connector"}),"\n",(0,i.jsx)(o.h3,{id:"unit-test",children:"Unit test"}),"\n",(0,i.jsx)(o.p,{children:"First, write some unit test cases and make sure the basic functionalities work as expected."}),"\n",(0,i.jsx)(o.h3,{id:"local-test",children:"Local test"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:["Setup Logto in your local environment: Logto provides several ways to run locally, you can either use CLI, or docker, or even build from source code. Check out the documentations for ",(0,i.jsx)(o.a,{href:"/logto-oss/using-cli/install-logto/",children:"more details"}),"."]}),"\n",(0,i.jsxs)(o.li,{children:["Link your custom connector to your Logto instance: Use the CLI to create a symbolic link of your connector to the Logto instance. ",(0,i.jsx)(o.a,{href:"/logto-oss/using-cli/manage-connectors/#link-local-connectors",children:"More details"}),".","\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",children:"cd logto\nnpx @logto/cli connector link -p .\n"})}),"\n"]}),"\n",(0,i.jsxs)(o.li,{children:["After linking the connector, you should see it in the ",(0,i.jsx)(o.code,{children:"<logto-root-path>/packages/core/connectors"})," folder."]}),"\n",(0,i.jsx)(o.li,{children:"Restart your Logto instance, go to the Logto Admin Console, you should be able to see it in the social connectors list."}),"\n",(0,i.jsxs)(o.li,{children:["Configure your connector in ",(0,i.jsx)(t,{to:"/sign-in-experience/sign-up-and-sign-in",children:"Console > Sign-in experience > Sign-up and sign-in"}),' > Social sign-in. And try it in our demo app with the "Live preview" feature.']}),"\n"]})]})}function h(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},79621:(e,o,t)=>{t.d(o,{R:()=>c,x:()=>r});var n=t(58101);const i={},s=n.createContext(i);function c(e){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),n.createElement(s.Provider,{value:o},e.children)}}}]);