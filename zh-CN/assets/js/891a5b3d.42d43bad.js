"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[7832],{72798:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"use-cases/authorization/rbac-in-practice","title":"rbac-in-practice","description":"\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u5b9e\u8df5\u6307\u5357\uff1a\u5b66\u4e60\u5982\u4f55\u8bbe\u8ba1\u6743\u9650\u3001\u7ba1\u7406\u89d2\u8272\uff0c\u5e76\u5728\u4f60\u7684 CMS \u4e2d\u8bbe\u7f6e\u5b89\u5168\u7684\u6388\u6743 (Authorization)\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/use-cases/authorization/rbac-in-practice.mdx","sourceDirName":"use-cases/authorization","slug":"/use-cases/authorization/rbac-in-practice","permalink":"/zh-CN/use-cases/authorization/rbac-in-practice","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/zh-CN/docusaurus-plugin-content-docs/current/use-cases/authorization/rbac-in-practice.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"\u5b9e\u8df5\u4e2d\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC)","description":"\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u5b9e\u8df5\u6307\u5357\uff1a\u5b66\u4e60\u5982\u4f55\u8bbe\u8ba1\u6743\u9650\u3001\u7ba1\u7406\u89d2\u8272\uff0c\u5e76\u5728\u4f60\u7684 CMS \u4e2d\u8bbe\u7f6e\u5b89\u5168\u7684\u6388\u6743 (Authorization)\u3002"},"sidebar":"useCasesSidebar","previous":{"title":"\u6388\u6743 (Authorization)","permalink":"/zh-CN/use-cases/authorization/"},"next":{"title":"\u591a\u79df\u6237","permalink":"/zh-CN/use-cases/multi-tenancy/"}}');var r=n(25105),t=n(79621);const c={sidebar_position:1,sidebar_label:"\u5b9e\u8df5\u4e2d\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC)",description:"\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u5b9e\u8df5\u6307\u5357\uff1a\u5b66\u4e60\u5982\u4f55\u8bbe\u8ba1\u6743\u9650\u3001\u7ba1\u7406\u89d2\u8272\uff0c\u5e76\u5728\u4f60\u7684 CMS \u4e2d\u8bbe\u7f6e\u5b89\u5168\u7684\u6388\u6743 (Authorization)\u3002"},l="\u5b9e\u8df5\u4e2d\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC)\uff1a\u4e3a\u4f60\u7684\u5e94\u7528\u5b9e\u73b0\u5b89\u5168\u7684\u6388\u6743 (Authorization)",o={},d=[{value:"\u7406\u89e3 RBAC \u57fa\u7840",id:"understanding-rbac-fundamentals",level:2},{value:"\u7ec6\u7c92\u5ea6\u6743\u9650 (Permissions) \u8bbe\u8ba1",id:"fine-grained-permission-design",level:3},{value:"\u8d44\u6e90\u6240\u6709\u6743\u4e0e\u8bbf\u95ee\u63a7\u5236",id:"resource-ownership-and-access-control",level:3},{value:"\u8bbe\u8ba1\u5b89\u5168\u7684 API",id:"designing-a-secure-apis",level:2},{value:"\u4e3a API \u5b9e\u73b0\u8bbf\u95ee\u63a7\u5236",id:"implement-access-control-for-your-api",level:3},{value:"\u6784\u5efa\u53ef\u6269\u5c55\u7684\u6743\u9650 (Permissions) \u7cfb\u7edf",id:"creating-a-permission-system-that-scales",level:3},{value:"\u6784\u5efa\u6709\u6548\u7684\u89d2\u8272 (Roles)",id:"building-effective-roles",level:2},{value:"\u5728 Logto \u4e2d\u914d\u7f6e RBAC",id:"config-rbac-in-logto",level:2},{value:"\u8bbe\u7f6e\u4f60\u7684\u5e94\u7528",id:"setting-up-your-application",level:3},{value:"\u914d\u7f6e API \u8d44\u6e90\u548c\u6743\u9650 (Permissions)",id:"configuring-api-resources-and-permissions",level:3},{value:"\u521b\u5efa\u89d2\u8272 (Roles)",id:"creating-roles",level:3},{value:"\u5206\u914d\u89d2\u8272 (Roles) \u7ed9\u7528\u6237",id:"assigning-roles-to-users",level:3},{value:"\u524d\u7aef\u96c6\u6210 Logto RBAC",id:"integrate-your-frontend-with-logto-rbac",level:2},{value:"\u540e\u7aef\u96c6\u6210 Logto RBAC",id:"integrate-your-backend-with-logto-rbac",level:2},{value:"\u540e\u7aef\u6388\u6743 (Authorization) \u4e2d\u95f4\u4ef6",id:"backend-authorization-middleware",level:3},{value:"\u4fdd\u62a4 API \u7aef\u70b9",id:"protecting-api-endpoints",level:3},{value:"\u6d4b\u8bd5 CMS RBAC \u5b9e\u73b0",id:"test-the-cms-rbac-implementation",level:2},{value:"\u603b\u7ed3",id:"conclusion",level:2}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components},{Head:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n,{children:(0,r.jsx)("link",{rel:"canonical",href:"https://blog.logto.io/rbac-in-practice"})}),"\n",(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"\u5b9e\u8df5\u4e2d\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236-rbac\u4e3a\u4f60\u7684\u5e94\u7528\u5b9e\u73b0\u5b89\u5168\u7684\u6388\u6743-authorization",children:"\u5b9e\u8df5\u4e2d\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC)\uff1a\u4e3a\u4f60\u7684\u5e94\u7528\u5b9e\u73b0\u5b89\u5168\u7684\u6388\u6743 (Authorization)"})}),"\n",(0,r.jsx)(s.p,{children:"\u4f60\u662f\u5426\u5728\u4e3a\u4f60\u7684\u5e94\u7528\u5b9e\u73b0\u4e00\u4e2a\u5b89\u5168\u4e14\u53ef\u6269\u5c55\u7684\u6388\u6743 (Authorization) \u7cfb\u7edf\u800c\u82e6\u607c\uff1f\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u662f\u7ba1\u7406\u7528\u6237\u6743\u9650\u7684\u884c\u4e1a\u6807\u51c6\uff0c\u4f46\u6b63\u786e\u5b9e\u73b0\u5b83\u53ef\u80fd\u5177\u6709\u6311\u6218\u6027\u3002\u672c\u6559\u7a0b\u5c06\u901a\u8fc7\u4e00\u4e2a\u771f\u5b9e\u7684\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf (CMS) \u793a\u4f8b\uff0c\u6559\u4f60\u5982\u4f55\u6784\u5efa\u4e00\u4e2a\u5f3a\u5927\u7684 RBAC \u7cfb\u7edf\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u901a\u8fc7\u672c\u6307\u5357\uff0c\u4f60\u5c06\u5b66\u5230\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u2728 \u5982\u4f55\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u6743\u9650 (Permissions)\uff0c\u8ba9\u4f60\u62e5\u6709\u7cbe\u786e\u7684\u63a7\u5236"}),"\n",(0,r.jsx)(s.li,{children:"\ud83d\udd12 \u5982\u4f55\u5c06\u6743\u9650 (Permissions) \u7ec4\u7ec7\u5230\u6709\u610f\u4e49\u7684\u89d2\u8272 (Roles) \u4e2d\u7684\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsx)(s.li,{children:"\ud83d\udc64 \u6709\u6548\u5904\u7406\u8d44\u6e90\u6240\u6709\u6743\u7684\u6280\u5de7"}),"\n",(0,r.jsx)(s.li,{children:"\ud83d\ude80 \u8ba9\u4f60\u7684\u6388\u6743 (Authorization) \u7cfb\u7edf\u53ef\u6269\u5c55\u4e14\u6613\u4e8e\u7ef4\u62a4\u7684\u65b9\u6cd5"}),"\n",(0,r.jsx)(s.li,{children:"\ud83d\udca1 \u901a\u8fc7\u771f\u5b9e CMS \u793a\u4f8b\u7684\u5b9e\u8df5\u5b9e\u73b0"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u672c\u6559\u7a0b\u7684\u5b8c\u6574\u6e90\u7801\u53ef\u5728 ",(0,r.jsx)(s.a,{href:"https://github.com/logto-io/rbac-sample",children:"GitHub"})," \u83b7\u53d6\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"understanding-rbac-fundamentals",children:"\u7406\u89e3 RBAC \u57fa\u7840"}),"\n",(0,r.jsx)(s.p,{children:"\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u4e0d\u4ec5\u4ec5\u662f\u4e3a\u7528\u6237\u5206\u914d\u6743\u9650 (Permissions)\u3002\u5b83\u662f\u5173\u4e8e\u521b\u5efa\u4e00\u79cd\u7ed3\u6784\u5316\u7684\u6388\u6743 (Authorization) \u65b9\u6cd5\uff0c\u5728\u5b89\u5168\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002"}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u5728 Auth Wiki \u4e86\u89e3\u66f4\u591a ",(0,r.jsx)(s.a,{href:"https://auth-wiki.logto.io/rbac",children:"\u4ec0\u4e48\u662f RBAC"}),"\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u4ee5\u4e0b\u662f\u6211\u4eec\u5728\u5b9e\u73b0\u4e2d\u9075\u5faa\u7684\u5173\u952e\u539f\u5219\uff1a"}),"\n",(0,r.jsx)(s.h3,{id:"fine-grained-permission-design",children:"\u7ec6\u7c92\u5ea6\u6743\u9650 (Permissions) \u8bbe\u8ba1"}),"\n",(0,r.jsx)(s.p,{children:"\u7ec6\u7c92\u5ea6\u7684\u6743\u9650 (Permissions) \u8ba9\u4f60\u80fd\u591f\u7cbe\u786e\u63a7\u5236\u7528\u6237\u5728\u7cfb\u7edf\u4e2d\u7684\u64cd\u4f5c\u3002\u4e0e\u201c\u7ba1\u7406\u5458\u201d\u6216\u201c\u7528\u6237\u201d\u8fd9\u7c7b\u5bbd\u6cdb\u7684\u8bbf\u95ee\u7ea7\u522b\u4e0d\u540c\uff0c\u6211\u4eec\u5b9a\u4e49\u7528\u6237\u53ef\u4ee5\u5bf9\u8d44\u6e90\u6267\u884c\u7684\u5177\u4f53\u64cd\u4f5c\u3002\u4f8b\u5982\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"read:articles"})," - \u67e5\u770b\u7cfb\u7edf\u4e2d\u7684\u4efb\u610f\u6587\u7ae0"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create:articles"})," - \u521b\u5efa\u65b0\u6587\u7ae0"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"update:articles"})," - \u4fee\u6539\u5df2\u6709\u6587\u7ae0"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"publish:articles"})," - \u66f4\u6539\u6587\u7ae0\u7684\u53d1\u5e03\u72b6\u6001"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"resource-ownership-and-access-control",children:"\u8d44\u6e90\u6240\u6709\u6743\u4e0e\u8bbf\u95ee\u63a7\u5236"}),"\n",(0,r.jsx)(s.p,{children:"\u8d44\u6e90\u6240\u6709\u6743\u662f\u6211\u4eec CMS \u6388\u6743 (Authorization) \u8bbe\u8ba1\u4e2d\u7684\u4e00\u4e2a\u57fa\u672c\u6982\u5ff5\u3002\u867d\u7136 RBAC \u5b9a\u4e49\u4e86\u4e0d\u540c\u89d2\u8272 (Roles) \u53ef\u4ee5\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u4f46\u6240\u6709\u6743\u4e3a\u8bbf\u95ee\u63a7\u5236\u589e\u52a0\u4e86\u4e2a\u4eba\u7ef4\u5ea6\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u4f5c\u8005\u81ea\u52a8\u62e5\u6709\u4ed6\u4eec\u521b\u5efa\u7684\u6587\u7ae0\u7684\u8bbf\u95ee\u6743\u9650"}),"\n",(0,r.jsx)(s.li,{children:"\u8fd9\u79cd\u81ea\u7136\u7684\u6240\u6709\u6743\u6a21\u578b\u610f\u5473\u7740\u4f5c\u8005\u59cb\u7ec8\u53ef\u4ee5\u67e5\u770b\u548c\u7f16\u8f91\u81ea\u5df1\u7684\u5185\u5bb9"}),"\n",(0,r.jsx)(s.li,{children:"\u7cfb\u7edf\u5728\u5904\u7406\u6587\u7ae0\u64cd\u4f5c\u65f6\u4f1a\u540c\u65f6\u68c0\u67e5\u89d2\u8272 (Roles) \u6743\u9650 (Permissions) \u6216\u6240\u6709\u6743"}),"\n",(0,r.jsxs)(s.li,{children:["\u4f8b\u5982\uff0c\u5373\u4f7f\u6ca1\u6709 ",(0,r.jsx)(s.code,{children:"update:articles"})," \u6743\u9650 (Permission)\uff0c\u4f5c\u8005\u4ecd\u7136\u53ef\u4ee5\u7f16\u8f91\u81ea\u5df1\u7684\u6587\u7ae0"]}),"\n",(0,r.jsx)(s.li,{children:"\u8fd9\u79cd\u8bbe\u8ba1\u51cf\u5c11\u4e86\u989d\u5916\u89d2\u8272 (Roles) \u6743\u9650 (Permissions) \u7684\u9700\u6c42\uff0c\u540c\u65f6\u4fdd\u6301\u5b89\u5168\u6027"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\u8fd9\u79cd\u53cc\u5c42\u7ed3\u6784\uff08\u89d2\u8272 (Roles) + \u6240\u6709\u6743\uff09\u8ba9\u7cfb\u7edf\u66f4\u76f4\u89c2\u4e14\u66f4\u5b89\u5168\u3002\u53d1\u5e03\u8005\u548c\u7ba1\u7406\u5458\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u5176\u89d2\u8272 (Roles) \u6743\u9650 (Permissions) \u7ba1\u7406\u6240\u6709\u5185\u5bb9\uff0c\u800c\u4f5c\u8005\u5219\u5bf9\u81ea\u5df1\u7684\u4f5c\u54c1\u62e5\u6709\u63a7\u5236\u6743\u3002"}),"\n",(0,r.jsx)(s.h2,{id:"designing-a-secure-apis",children:"\u8bbe\u8ba1\u5b89\u5168\u7684 API"}),"\n",(0,r.jsx)(s.p,{children:"\u8ba9\u6211\u4eec\u4ece\u8bbe\u8ba1 CMS \u7684\u6838\u5fc3\u529f\u80fd API \u7aef\u70b9\u5f00\u59cb\uff1a"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"GET    /api/articles         # \u5217\u51fa\u6240\u6709\u6587\u7ae0\nGET    /api/articles/:id     # \u83b7\u53d6\u6307\u5b9a\u6587\u7ae0\nPOST   /api/articles        # \u521b\u5efa\u65b0\u6587\u7ae0\nPATCH  /api/articles/:id    # \u66f4\u65b0\u6587\u7ae0\nDELETE /api/articles/:id    # \u5220\u9664\u6587\u7ae0\nPATCH  /api/articles/:id/published  # \u66f4\u6539\u53d1\u5e03\u72b6\u6001\n"})}),"\n",(0,r.jsx)(s.h3,{id:"implement-access-control-for-your-api",children:"\u4e3a API \u5b9e\u73b0\u8bbf\u95ee\u63a7\u5236"}),"\n",(0,r.jsx)(s.p,{children:"\u5bf9\u4e8e\u6bcf\u4e2a\u7aef\u70b9\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u8bbf\u95ee\u63a7\u5236\u7684\u4e24\u4e2a\u65b9\u9762\uff1a"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"\u8d44\u6e90\u6240\u6709\u6743\u2014\u2014\u7528\u6237\u662f\u5426\u62e5\u6709\u8be5\u8d44\u6e90\uff1f"}),"\n",(0,r.jsx)(s.li,{children:"\u57fa\u4e8e\u89d2\u8272 (Roles) \u7684\u6743\u9650 (Permissions)\u2014\u2014\u7528\u6237\u7684\u89d2\u8272 (Role) \u662f\u5426\u5141\u8bb8\u6b64\u64cd\u4f5c\uff1f"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\u4ee5\u4e0b\u662f\u6211\u4eec\u5bf9\u6bcf\u4e2a\u7aef\u70b9\u7684\u8bbf\u95ee\u63a7\u5236\u5904\u7406\u65b9\u5f0f\uff1a"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"\u7aef\u70b9"}),(0,r.jsx)(s.th,{children:"\u8bbf\u95ee\u63a7\u5236\u903b\u8f91"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GET /api/articles"}),(0,r.jsxs)(s.td,{children:["- \u4efb\u4f55\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"list:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\uff0c\u6216\u4f5c\u8005\u53ef\u89c1\u81ea\u5df1\u7684\u6587\u7ae0"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["GET /api/articles/",":id"]}),(0,r.jsxs)(s.td,{children:["- \u4efb\u4f55\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"read:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\uff0c\u6216\u6587\u7ae0\u4f5c\u8005"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"POST /api/articles"}),(0,r.jsxs)(s.td,{children:["- \u4efb\u4f55\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"create:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["PATCH /api/articles/",":id"]}),(0,r.jsxs)(s.td,{children:["- \u4efb\u4f55\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"update:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\uff0c\u6216\u6587\u7ae0\u4f5c\u8005"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["DELETE /api/articles/",":id"]}),(0,r.jsxs)(s.td,{children:["- \u4efb\u4f55\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"delete:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\uff0c\u6216\u6587\u7ae0\u4f5c\u8005"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["PATCH /api/articles/",":id","/published"]}),(0,r.jsxs)(s.td,{children:["- \u4ec5\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"publish:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237"]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"creating-a-permission-system-that-scales",children:"\u6784\u5efa\u53ef\u6269\u5c55\u7684\u6743\u9650 (Permissions) \u7cfb\u7edf"}),"\n",(0,r.jsx)(s.p,{children:"\u6839\u636e\u6211\u4eec\u7684 API \u8bbf\u95ee\u9700\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u6743\u9650 (Permissions)\uff1a"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"\u6743\u9650 (Permission)"}),(0,r.jsx)(s.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["list",":articles"]}),(0,r.jsx)(s.td,{children:"\u67e5\u770b\u7cfb\u7edf\u4e2d\u6240\u6709\u6587\u7ae0\u7684\u5217\u8868"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["read",":articles"]}),(0,r.jsx)(s.td,{children:"\u9605\u8bfb\u4efb\u610f\u6587\u7ae0\u7684\u5b8c\u6574\u5185\u5bb9"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["create",":articles"]}),(0,r.jsx)(s.td,{children:"\u521b\u5efa\u65b0\u6587\u7ae0"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["update",":articles"]}),(0,r.jsx)(s.td,{children:"\u4fee\u6539\u4efb\u610f\u6587\u7ae0"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["delete",":articles"]}),(0,r.jsx)(s.td,{children:"\u5220\u9664\u4efb\u610f\u6587\u7ae0"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["publish",":articles"]}),(0,r.jsx)(s.td,{children:"\u66f4\u6539\u53d1\u5e03\u72b6\u6001"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"\u6ce8\u610f\uff0c\u8fd9\u4e9b\u6743\u9650 (Permissions) \u4ec5\u5728\u8bbf\u95ee\u4f60\u4e0d\u62e5\u6709\u7684\u8d44\u6e90\u65f6\u9700\u8981\u3002\u6587\u7ae0\u6240\u6709\u8005\u53ef\u4ee5\u81ea\u52a8\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u67e5\u770b\u81ea\u5df1\u7684\u6587\u7ae0\uff08\u65e0\u9700 ",(0,r.jsx)(s.code,{children:"read:articles"})," \u6743\u9650 (Permission)\uff09"]}),"\n",(0,r.jsxs)(s.li,{children:["\u7f16\u8f91\u81ea\u5df1\u7684\u6587\u7ae0\uff08\u65e0\u9700 ",(0,r.jsx)(s.code,{children:"update:articles"})," \u6743\u9650 (Permission)\uff09"]}),"\n",(0,r.jsxs)(s.li,{children:["\u5220\u9664\u81ea\u5df1\u7684\u6587\u7ae0\uff08\u65e0\u9700 ",(0,r.jsx)(s.code,{children:"delete:articles"})," \u6743\u9650 (Permission)\uff09"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"building-effective-roles",children:"\u6784\u5efa\u6709\u6548\u7684\u89d2\u8272 (Roles)"}),"\n",(0,r.jsx)(s.p,{children:"\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5b9a\u4e49\u4e86 API \u548c\u6743\u9650 (Permissions)\uff0c\u53ef\u4ee5\u521b\u5efa\u903b\u8f91\u5206\u7ec4\u8fd9\u4e9b\u6743\u9650 (Permissions) \u7684\u89d2\u8272 (Roles)\uff1a"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"\u6743\u9650 (Permission)/\u89d2\u8272 (Role)"}),(0,r.jsx)(s.th,{children:"\ud83d\udc51 \u7ba1\u7406\u5458 (Admin)"}),(0,r.jsx)(s.th,{children:"\ud83d\udcdd \u53d1\u5e03\u8005 (Publisher)"}),(0,r.jsx)(s.th,{children:"\u270d\ufe0f \u4f5c\u8005 (Author)"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u63cf\u8ff0"})}),(0,r.jsx)(s.td,{children:"\u62e5\u6709\u5b8c\u6574\u5185\u5bb9\u7ba1\u7406\u6743\u9650"}),(0,r.jsx)(s.td,{children:"\u53ef\u67e5\u770b\u6240\u6709\u6587\u7ae0\u5e76\u63a7\u5236\u53d1\u5e03\u72b6\u6001"}),(0,r.jsx)(s.td,{children:"\u53ef\u5728\u7cfb\u7edf\u4e2d\u521b\u5efa\u65b0\u6587\u7ae0"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["list",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["read",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["create",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"}),(0,r.jsx)(s.td,{children:"\u2705"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["update",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"}),(0,r.jsx)(s.td,{children:"\u274c"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["delete",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"}),(0,r.jsx)(s.td,{children:"\u274c"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["publish",":articles"]}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u2705"}),(0,r.jsx)(s.td,{children:"\u274c"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u6ce8\u610f"}),"\uff1a\u4f5c\u8005\u65e0\u8bba\u89d2\u8272 (Role) \u6743\u9650 (Permission) \u5982\u4f55\uff0c\u81ea\u52a8\u62e5\u6709\u5bf9\u81ea\u5df1\u6587\u7ae0\u7684\u8bfb\u53d6 / \u66f4\u65b0 / \u5220\u9664\u6743\u9650 (Permissions)\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u6bcf\u4e2a\u89d2\u8272 (Role) \u90fd\u6709\u660e\u786e\u7684\u804c\u8d23\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u7ba1\u7406\u5458 (Admin)"}),"\uff1a\u5bf9 CMS \u62e5\u6709\u5b8c\u5168\u63a7\u5236\u6743\uff0c\u5305\u62ec\u6240\u6709\u6587\u7ae0\u64cd\u4f5c"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u53d1\u5e03\u8005 (Publisher)"}),"\uff1a\u4e13\u6ce8\u4e8e\u5185\u5bb9\u5ba1\u6838\u548c\u53d1\u5e03\u7ba1\u7406"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\u4f5c\u8005 (Author)"}),"\uff1a\u4e13\u6ce8\u4e8e\u5185\u5bb9\u521b\u4f5c"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\u8fd9\u79cd\u89d2\u8272 (Role) \u7ed3\u6784\u5b9e\u73b0\u4e86\u5173\u6ce8\u70b9\u7684\u6e05\u6670\u5206\u79bb\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u4f5c\u8005\u4e13\u6ce8\u4e8e\u5185\u5bb9\u521b\u4f5c"}),"\n",(0,r.jsx)(s.li,{children:"\u53d1\u5e03\u8005\u7ba1\u7406\u5185\u5bb9\u8d28\u91cf\u548c\u53ef\u89c1\u6027"}),"\n",(0,r.jsx)(s.li,{children:"\u7ba1\u7406\u5458\u7ef4\u62a4\u6574\u4f53\u7cfb\u7edf\u63a7\u5236"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"config-rbac-in-logto",children:"\u5728 Logto \u4e2d\u914d\u7f6e RBAC"}),"\n",(0,r.jsxs)(s.p,{children:["\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u4f60\u9700\u8981\u5728 ",(0,r.jsx)(s.a,{href:"https://cloud.logto.io",children:"Logto Cloud"})," \u521b\u5efa\u4e00\u4e2a\u8d26\u53f7\uff0c\u6216\u8005\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(s.a,{href:"/logto-oss",children:"Logto OSS \u7248\u672c"})," \u4f7f\u7528\u81ea\u6258\u7ba1\u7684 Logto \u5b9e\u4f8b\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u4f46\u672c\u6559\u7a0b\u5c06\u4ee5 Logto Cloud \u4e3a\u4f8b\uff0c\u64cd\u4f5c\u66f4\u4e3a\u7b80\u4fbf\u3002"}),"\n",(0,r.jsx)(s.h3,{id:"setting-up-your-application",children:"\u8bbe\u7f6e\u4f60\u7684\u5e94\u7528"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\u5728 Logto \u63a7\u5236\u53f0\u7684\u201c\u5e94\u7528\u7a0b\u5e8f\u201d\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 React \u5e94\u7528","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u5e94\u7528\u540d\u79f0\uff1a\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf"}),"\n",(0,r.jsx)(s.li,{children:"\u5e94\u7528\u7c7b\u578b\uff1a\u4f20\u7edf Web \u5e94\u7528"}),"\n",(0,r.jsxs)(s.li,{children:["\u91cd\u5b9a\u5411 URI\uff1a",(0,r.jsx)(s.a,{href:"http://localhost:5173/callback",children:"http://localhost:5173/callback"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/cms_application_3ed42f2256.png",alt:"CMS React \u5e94\u7528"})}),"\n",(0,r.jsx)(s.h3,{id:"configuring-api-resources-and-permissions",children:"\u914d\u7f6e API \u8d44\u6e90\u548c\u6743\u9650 (Permissions)"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\u5728 Logto \u63a7\u5236\u53f0\u7684\u201cAPI \u8d44\u6e90\u201d\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 API \u8d44\u6e90","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"API \u540d\u79f0\uff1aCMS API"}),"\n",(0,r.jsxs)(s.li,{children:["API \u6807\u8bc6\u7b26\uff1a",(0,r.jsx)(s.a,{href:"https://api.cms.com",children:"https://api.cms.com"})]}),"\n",(0,r.jsxs)(s.li,{children:["\u4e3a API \u8d44\u6e90\u6dfb\u52a0\u6743\u9650 (Permissions)","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"list:articles"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"read:articles"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"create:articles"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"update:articles"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"publish:articles"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"delete:articles"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/cms_api_resource_b15ae2b91a.png",alt:"CMS API \u8d44\u6e90\u8be6\u60c5"})}),"\n",(0,r.jsx)(s.h3,{id:"creating-roles",children:"\u521b\u5efa\u89d2\u8272 (Roles)"}),"\n",(0,r.jsx)(s.p,{children:"\u5728 Logto \u63a7\u5236\u53f0\u7684\u201c\u89d2\u8272 (Roles)\u201d\u4e2d\u4e3a CMS \u521b\u5efa\u4ee5\u4e0b\u89d2\u8272 (Roles)\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u7ba1\u7406\u5458 (Admin)","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u62e5\u6709\u6240\u6709\u6743\u9650 (Permissions)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\u53d1\u5e03\u8005 (Publisher)","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"read:articles"}),"\u3001",(0,r.jsx)(s.code,{children:"list:articles"}),"\u3001",(0,r.jsx)(s.code,{children:"publish:articles"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\u4f5c\u8005 (Author)","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"create:articles"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/admin_role_53edb35ecf.png",alt:"\u7ba1\u7406\u5458\u89d2\u8272"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/publisher_role_2ac205cc32.png",alt:"\u53d1\u5e03\u8005\u89d2\u8272"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/author_role_f89cd99543.png",alt:"\u4f5c\u8005\u89d2\u8272"})}),"\n",(0,r.jsx)(s.h3,{id:"assigning-roles-to-users",children:"\u5206\u914d\u89d2\u8272 (Roles) \u7ed9\u7528\u6237"}),"\n",(0,r.jsx)(s.p,{children:"\u5728 Logto \u63a7\u5236\u53f0\u7684\u201c\u7528\u6237\u7ba1\u7406\u201d\u90e8\u5206\u521b\u5efa\u7528\u6237\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u5728\u7528\u6237\u8be6\u60c5\u7684\u201c\u89d2\u8272 (Roles)\u201d\u6807\u7b7e\u9875\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4e3a\u7528\u6237\u5206\u914d\u89d2\u8272 (Roles)\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86 3 \u4e2a\u7528\u6237\u53ca\u5176\u89d2\u8272 (Roles)\uff1a"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Alex\uff1a\u7ba1\u7406\u5458 (Admin)"}),"\n",(0,r.jsx)(s.li,{children:"Bob\uff1a\u53d1\u5e03\u8005 (Publisher)"}),"\n",(0,r.jsx)(s.li,{children:"Charlie\uff1a\u4f5c\u8005 (Author)"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/user_management_c0bc17119f.png",alt:"\u7528\u6237\u7ba1\u7406"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/user_details_alex_702f96ef9a.png",alt:"\u7528\u6237\u8be6\u60c5 - Alex"})}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["\u4e3a\u6f14\u793a\u65b9\u4fbf\uff0c\u6211\u4eec\u901a\u8fc7 Logto \u63a7\u5236\u53f0\u521b\u5efa\u8fd9\u4e9b\u8d44\u6e90\u548c\u914d\u7f6e\u3002\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 Logto \u63d0\u4f9b\u7684 ",(0,r.jsx)(s.a,{href:"/integrate-logto/interact-with-management-api",children:"Management API"})," \u4ee5\u7f16\u7a0b\u65b9\u5f0f\u521b\u5efa\u8fd9\u4e9b\u8d44\u6e90\u548c\u914d\u7f6e\u3002"]})}),"\n",(0,r.jsx)(s.h2,{id:"integrate-your-frontend-with-logto-rbac",children:"\u524d\u7aef\u96c6\u6210 Logto RBAC"}),"\n",(0,r.jsx)(s.p,{children:"\u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u5728 Logto \u4e2d\u914d\u7f6e\u597d\u4e86 RBAC\uff0c\u53ef\u4ee5\u5f00\u59cb\u5c06\u5176\u96c6\u6210\u5230\u524d\u7aef\u3002"}),"\n",(0,r.jsxs)(s.p,{children:["\u9996\u5148\uff0c\u6309\u7167 ",(0,r.jsx)(s.a,{href:"/quick-starts",children:"Logto \u5feb\u901f\u4e0a\u624b"})," \u5c06 Logto \u96c6\u6210\u5230\u4f60\u7684\u5e94\u7528\u4e2d\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4ee5 ",(0,r.jsx)(s.a,{href:"/quick-starts/react",children:"React"})," \u4e3a\u4f8b\u8fdb\u884c\u6f14\u793a\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u5728\u4f60\u7684\u5e94\u7528\u4e2d\u914d\u7f6e\u597d Logto \u540e\uff0c\u6211\u4eec\u9700\u8981\u4e3a Logto \u6dfb\u52a0 RBAC \u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-tsx",children:"// frontend/src/App.tsx\n\nconst logtoConfig: LogtoConfig = {\n  appId: LOGTO_APP_ID, // \u4f60\u5728 Logto \u63a7\u5236\u53f0\u521b\u5efa\u7684\u5e94\u7528 ID\n  endpoint: LOGTO_ENDPOINT, // \u4f60\u5728 Logto \u63a7\u5236\u53f0\u521b\u5efa\u7684 endpoint\n  resources: [API_RESOURCE], // \u4f60\u5728 Logto \u63a7\u5236\u53f0\u521b\u5efa\u7684 API \u8d44\u6e90\u6807\u8bc6\u7b26\uff0c\u4f8b\u5982 https://api.cms.com\n  // \u524d\u7aef\u53ef\u80fd\u9700\u8981\u4ece API \u8d44\u6e90\u8bf7\u6c42\u7684\u6240\u6709\u6743\u9650 (Scopes)\n  scopes: [\n    'list:articles',\n    'create:articles',\n    'read:articles',\n    'update:articles',\n    'delete:articles',\n    'publish:articles',\n  ],\n};\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u5982\u679c\u4f60\u5df2\u7ecf\u767b\u5f55\uff0c\u8bf7\u8bb0\u5f97\u5148\u9000\u51fa\u518d\u91cd\u65b0\u767b\u5f55\uff0c\u4f7f\u66f4\u6539\u751f\u6548\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u5f53\u7528\u6237\u901a\u8fc7 Logto \u767b\u5f55\u5e76\u8bf7\u6c42\u4e0a\u8ff0 API \u8d44\u6e90\u7684\u8bbf\u95ee\u4ee4\u724c (Access token) \u65f6\uff0cLogto \u4f1a\u5c06\u4e0e\u7528\u6237\u89d2\u8272 (Role) \u76f8\u5173\u7684\u6743\u9650 (Scopes) \u6dfb\u52a0\u5230\u8bbf\u95ee\u4ee4\u724c (Access token) \u4e2d\u3002"}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(s.code,{children:"useLogto"})," \u7684 ",(0,r.jsx)(s.code,{children:"getAccessTokenClaims"})," \u83b7\u53d6\u8bbf\u95ee\u4ee4\u724c (Access token) \u4e2d\u7684\u6743\u9650 (Scopes)\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-tsx",children:"// frontend/src/hooks/use-user-data.ts\n\nimport { useLogto } from '@logto/react';\nimport { API_RESOURCE } from '../config';\nimport { useState, useEffect } from 'react';\n\nexport const useUserData = () => {\n  const { getAccessTokenClaims } = useLogto();\n  const [userScopes, setUserScopes] = useState<string[]>([]);\n  const [userId, setUserId] = useState<string>();\n\n  useEffect(() => {\n    const fetchScopes = async () => {\n      const token = await getAccessTokenClaims(API_RESOURCE);\n      setUserScopes(token?.scope?.split(' ') ?? []);\n      setUserId(token?.sub);\n    };\n\n    fetchScopes();\n  }, [getAccessTokenClaims]);\n\n  return { userId, userScopes };\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"userScopes"})," \u5224\u65ad\u7528\u6237\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u8d44\u6e90\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-tsx",children:"// frontend/src/pages/Dashboard.tsx\n\nconst Dashboard = () => {\n  const { userId, userScopes } = useUserData();\n  // ...\n\n  return (\n    <div>\n      {/* ... */}\n      {(userScopes.includes('delete:articles') || article.ownerId === userId) && (\n        <button\n          onClick={() => handleDelete(article.id)}\n          className=\"text-red-600 hover:text-red-900\"\n        >\n          \u5220\u9664\n        </button>\n      )}\n    </div>\n  );\n};\n"})}),"\n",(0,r.jsx)(s.h2,{id:"integrate-your-backend-with-logto-rbac",children:"\u540e\u7aef\u96c6\u6210 Logto RBAC"}),"\n",(0,r.jsx)(s.p,{children:"\u73b0\u5728\uff0c\u662f\u65f6\u5019\u5c06 Logto RBAC \u96c6\u6210\u5230\u4f60\u7684\u540e\u7aef\u4e86\u3002"}),"\n",(0,r.jsx)(s.h3,{id:"backend-authorization-middleware",children:"\u540e\u7aef\u6388\u6743 (Authorization) \u4e2d\u95f4\u4ef6"}),"\n",(0,r.jsx)(s.p,{children:"\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5728\u540e\u7aef\u6dfb\u52a0\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u7528\u4e8e\u68c0\u67e5\u7528\u6237\u6743\u9650 (Permissions)\u3001\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u5df2\u767b\u5f55\uff0c\u5e76\u5224\u65ad\u5176\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u67d0\u4e9b API\u3002"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"// backend/src/middleware/auth.js\n\nconst { createRemoteJWKSet, jwtVerify } = require('jose');\n\nconst getTokenFromHeader = (headers) => {\n  const { authorization } = headers;\n  const bearerTokenIdentifier = 'Bearer';\n\n  if (!authorization) {\n    throw new Error('Authorization header missing');\n  }\n\n  if (!authorization.startsWith(bearerTokenIdentifier)) {\n    throw new Error('Authorization token type not supported');\n  }\n\n  return authorization.slice(bearerTokenIdentifier.length + 1);\n};\n\nconst hasScopes = (tokenScopes, requiredScopes) => {\n  if (!requiredScopes || requiredScopes.length === 0) {\n    return true;\n  }\n  const scopeSet = new Set(tokenScopes);\n  return requiredScopes.every((scope) => scopeSet.has(scope));\n};\n\nconst verifyJwt = async (token) => {\n  const JWKS = createRemoteJWKSet(new URL(process.env.LOGTO_JWKS_URL));\n\n  const { payload } = await jwtVerify(token, JWKS, {\n    issuer: process.env.LOGTO_ISSUER,\n    audience: process.env.LOGTO_API_RESOURCE,\n  });\n\n  return payload;\n};\n\nconst requireAuth = (requiredScopes = []) => {\n  return async (req, res, next) => {\n    try {\n      // \u63d0\u53d6\u4ee4\u724c\n      const token = getTokenFromHeader(req.headers);\n\n      // \u9a8c\u8bc1\u4ee4\u724c\n      const payload = await verifyJwt(token);\n\n      // \u5c06\u7528\u6237\u4fe1\u606f\u6dfb\u52a0\u5230\u8bf7\u6c42\u5bf9\u8c61\n      req.user = {\n        id: payload.sub,\n        scopes: payload.scope?.split(' ') || [],\n      };\n\n      // \u9a8c\u8bc1\u6240\u9700\u6743\u9650 (Scopes)\n      if (!hasScopes(req.user.scopes, requiredScopes)) {\n        throw new Error('Insufficient permissions');\n      }\n\n      next();\n    } catch (error) {\n      res.status(401).json({ error: 'Unauthorized' });\n    }\n  };\n};\n\nmodule.exports = {\n  requireAuth,\n  hasScopes,\n};\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u5982\u4f60\u6240\u89c1\uff0c\u5728\u8fd9\u4e2a\u4e2d\u95f4\u4ef6\u4e2d\uff0c\u6211\u4eec\u4f1a\u9a8c\u8bc1\u524d\u7aef\u8bf7\u6c42\u662f\u5426\u5305\u542b\u6709\u6548\u7684\u8bbf\u95ee\u4ee4\u724c (Access token)\uff0c\u5e76\u68c0\u67e5\u8bbf\u95ee\u4ee4\u724c (Access token) \u7684\u53d7\u4f17\u662f\u5426\u4e0e\u6211\u4eec\u5728 Logto \u63a7\u5236\u53f0\u521b\u5efa\u7684 API \u8d44\u6e90\u4e00\u81f4\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u9a8c\u8bc1 API \u8d44\u6e90\u7684\u539f\u56e0\u5728\u4e8e\uff0c\u6211\u4eec\u7684 API \u8d44\u6e90\u5b9e\u9645\u4e0a\u4ee3\u8868\u4e86 CMS \u540e\u7aef\u7684\u8d44\u6e90\uff0c\u6240\u6709 CMS \u6743\u9650 (Permissions) \u90fd\u4e0e\u8be5 API \u8d44\u6e90\u5173\u8054\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u7531\u4e8e\u8be5 API \u8d44\u6e90\u5728 Logto \u4e2d\u4ee3\u8868 CMS \u8d44\u6e90\uff0c\u5728\u524d\u7aef\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u5728\u5411\u540e\u7aef\u53d1\u8d77 API \u8bf7\u6c42\u65f6\u4f1a\u643a\u5e26\u76f8\u5e94\u7684\u8bbf\u95ee\u4ee4\u724c (Access token)\uff1a"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"// frontend/src/hooks/use-api.ts\nexport const useApi = () => {\n  const { getAccessToken } = useLogto();\n\n  return useMemo(\n    () =>\n      async (endpoint: string, options: RequestInit = {}) => {\n        try {\n          // \u83b7\u53d6 API \u8d44\u6e90\u7684\u8bbf\u95ee\u4ee4\u724c (Access token)\n          const token = await getAccessToken(API_RESOURCE);\n\n          if (!token) {\n            throw new ApiRequestError('Failed to get access token');\n          }\n\n          const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n            ...options,\n            headers: {\n              'Content-Type': 'application/json',\n              // \u5728\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0\u8bbf\u95ee\u4ee4\u724c (Access token)\n              Authorization: `Bearer ${token}`,\n              ...options.headers,\n            },\n          });\n\n          // ... \u5904\u7406\u54cd\u5e94\n\n          return await response.json();\n        } catch (error) {\n          // ... \u9519\u8bef\u5904\u7406\n        }\n      },\n    [getAccessToken]\n  );\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"requireAuth"})," \u4e2d\u95f4\u4ef6\u6765\u4fdd\u62a4\u6211\u4eec\u7684 API \u7aef\u70b9\u3002"]}),"\n",(0,r.jsx)(s.h3,{id:"protecting-api-endpoints",children:"\u4fdd\u62a4 API \u7aef\u70b9"}),"\n",(0,r.jsxs)(s.p,{children:["\u5bf9\u4e8e\u53ea\u5141\u8bb8\u7279\u5b9a\u6743\u9650 (Permissions) \u7528\u6237\u8bbf\u95ee\u7684 API\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u4e2d\u95f4\u4ef6\u4e2d\u6dfb\u52a0\u9650\u5236\u3002\u4f8b\u5982\uff0c\u6587\u7ae0\u521b\u5efa API \u53ea\u5141\u8bb8\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"create:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\u8bbf\u95ee\uff1a"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"// backend/src/routes/articles.js\n\nconst { requireAuth } = require('../middleware/auth');\n\nrouter.post('/articles', requireAuth(['create:articles']), async (req, res) => {\n  // ...\n});\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u5bf9\u4e8e\u9700\u8981\u540c\u65f6\u68c0\u67e5\u6743\u9650 (Permissions) \u548c\u8d44\u6e90\u6240\u6709\u6743\u7684 API\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"hasScopes"})," \u51fd\u6570\u3002\u4f8b\u5982\uff0c\u5728\u6587\u7ae0\u5217\u8868 API \u4e2d\uff0c\u62e5\u6709 ",(0,r.jsx)(s.code,{children:"list:articles"})," \u6743\u9650 (Permission) \u7684\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u6587\u7ae0\uff0c\u800c\u4f5c\u8005\u53ea\u80fd\u8bbf\u95ee\u81ea\u5df1\u521b\u5efa\u7684\u6587\u7ae0\uff1a"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"// backend/src/routes/articles.js\n\nconst { requireAuth, hasScopes } = require('../middleware/auth');\n\nrouter.get('/articles', requireAuth(), async (req, res) => {\n  try {\n    // \u5982\u679c\u7528\u6237\u6709 list:articles \u6743\u9650 (Scope)\uff0c\u8fd4\u56de\u6240\u6709\u6587\u7ae0\n    if (hasScopes(req.user.scopes, ['list:articles'])) {\n      const articles = await articleDB.list();\n      return res.json(articles);\n    }\n\n    // \u5426\u5219\uff0c\u4ec5\u8fd4\u56de\u7528\u6237\u81ea\u5df1\u7684\u6587\u7ae0\n    const articles = await articleDB.listByOwner(req.user.id);\n    res.json(articles);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch articles' });\n  }\n});\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86 RBAC \u7684\u5b9e\u73b0\u3002\u4f60\u53ef\u4ee5\u67e5\u770b ",(0,r.jsx)(s.a,{href:"https://github.com/logto-io/rbac-sample",children:"\u5b8c\u6574\u6e90\u7801"})," \u4e86\u89e3\u5168\u90e8\u5b9e\u73b0\u7ec6\u8282\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"test-the-cms-rbac-implementation",children:"\u6d4b\u8bd5 CMS RBAC \u5b9e\u73b0"}),"\n",(0,r.jsx)(s.p,{children:"\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u7528\u521a\u521a\u521b\u5efa\u7684\u4e09\u4e2a\u7528\u6237\u6d4b\u8bd5 CMS RBAC \u5b9e\u73b0\u3002"}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsx)(s.p,{children:"\u5982\u679c\u4f60\u53d1\u73b0\u65e0\u6cd5\u4f7f\u7528\u201c\u7528\u6237\u7ba1\u7406\u201d\u4e2d\u521b\u5efa\u7684\u7528\u6237\u51ed\u636e\u767b\u5f55\uff0c\u9700\u8981\u5148\u542f\u7528\u76f8\u5e94\u7684\u767b\u5f55\u65b9\u5f0f\u3002\u8bf7\u524d\u5f80 Logto \u63a7\u5236\u53f0\u7684\u201c\u767b\u5f55\u4f53\u9a8c\u201d\uff0c\u542f\u7528\u4f60\u559c\u6b22\u7684\u8ba4\u8bc1 (Authentication) \u65b9\u5f0f\uff08\u5982\u90ae\u7bb1 + \u5bc6\u7801\u6216\u7528\u6237\u540d + \u5bc6\u7801\uff09\u3002"})}),"\n",(0,r.jsx)(s.p,{children:"\u9996\u5148\uff0c\u5206\u522b\u4ee5 Alex \u548c Charles \u767b\u5f55\u5e76\u521b\u5efa\u4e00\u4e9b\u6587\u7ae0\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u7531\u4e8e Alex \u62e5\u6709\u7ba1\u7406\u5458 (Admin) \u89d2\u8272 (Role)\uff0c\u4ed6\u53ef\u4ee5\u521b\u5efa\u3001\u5220\u9664\u3001\u66f4\u65b0\u3001\u53d1\u5e03\u5e76\u67e5\u770b\u6240\u6709\u6587\u7ae0\u3002"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/cms_dashboard_alex_a11863a94b.png",alt:"CMS \u63a7\u5236\u53f0 - Alex"})}),"\n",(0,r.jsx)(s.p,{children:"Charles \u62e5\u6709\u4f5c\u8005 (Author) \u89d2\u8272 (Role)\uff0c\u53ea\u80fd\u521b\u5efa\u81ea\u5df1\u7684\u6587\u7ae0\uff0c\u5e76\u4e14\u53ea\u80fd\u67e5\u770b\u3001\u66f4\u65b0\u548c\u5220\u9664\u81ea\u5df1\u62e5\u6709\u7684\u6587\u7ae0\u3002"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/cms_dashboard_charles_05f610066a.png",alt:"CMS \u63a7\u5236\u53f0 - Charles - \u6587\u7ae0\u5217\u8868"})}),"\n",(0,r.jsx)(s.p,{children:"Bob \u62e5\u6709\u53d1\u5e03\u8005 (Publisher) \u89d2\u8272 (Role)\uff0c\u53ef\u4ee5\u67e5\u770b\u548c\u53d1\u5e03\u6240\u6709\u6587\u7ae0\uff0c\u4f46\u4e0d\u80fd\u521b\u5efa\u3001\u66f4\u65b0\u6216\u5220\u9664\u6587\u7ae0\u3002"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{src:"https://uploads.strapi.logto.io/cms_dashboard_bob_421a429b69.png",alt:"CMS \u63a7\u5236\u53f0 - Bob"})}),"\n",(0,r.jsx)(s.h2,{id:"conclusion",children:"\u603b\u7ed3"}),"\n",(0,r.jsx)(s.p,{children:"\u606d\u559c\u4f60\uff01\u4f60\u5df2\u7ecf\u5b66\u4f1a\u4e86\u5982\u4f55\u5728\u5e94\u7528\u4e2d\u5b9e\u73b0\u4e00\u4e2a\u5f3a\u5927\u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 (RBAC) \u7cfb\u7edf\u3002"}),"\n",(0,r.jsxs)(s.p,{children:["\u5bf9\u4e8e\u66f4\u590d\u6742\u7684\u573a\u666f\uff0c\u6bd4\u5982\u6784\u5efa\u591a\u79df\u6237\u5e94\u7528\uff0cLogto \u63d0\u4f9b\u4e86\u5b8c\u5584\u7684\u7ec4\u7ec7 (Organization) \u652f\u6301\u3002\u4f60\u53ef\u4ee5\u67e5\u9605\u6211\u4eec\u7684\u6307\u5357 ",(0,r.jsx)(s.a,{href:"/use-cases/multi-tenancy/build-multi-tenant-saas-application",children:"\u6784\u5efa\u591a\u79df\u6237 SaaS \u5e94\u7528\uff1a\u4ece\u8bbe\u8ba1\u5230\u5b9e\u73b0\u7684\u5b8c\u6574\u6307\u5357"}),"\uff0c\u4e86\u89e3\u5982\u4f55\u5b9e\u73b0\u7ec4\u7ec7 (Organization) \u7ea7\u522b\u7684\u8bbf\u95ee\u63a7\u5236\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u795d\u4f60\u7f16\u7801\u6109\u5feb\uff01\ud83d\ude80"})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},79621:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>l});var i=n(58101);const r={},t=i.createContext(r);function c(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);