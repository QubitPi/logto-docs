"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[6957],{69028:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>Ae,contentTitle:()=>fe,default:()=>ve,frontMatter:()=>je,metadata:()=>r,toc:()=>ye});const r=JSON.parse('{"id":"authorization/validate-access-tokens/README","title":"API \uc11c\ube44\uc2a4 \ub610\ub294 \ubc31\uc5d4\ub4dc\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\ud558\ub294 \ubc29\ubc95","description":"\uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\uc740 Logto\uc5d0\uc11c \uc5ed\ud560 \uae30\ubc18 \uc811\uadfc \uc81c\uc5b4 (RBAC)\ub97c \uc801\uc6a9\ud558\ub294 \ub370 \uc911\uc694\ud55c \ubd80\ubd84\uc785\ub2c8\ub2e4. \uc774 \uac00\uc774\ub4dc\uc5d0\uc11c\ub294 \ubc31\uc5d4\ub4dc / API\uc5d0\uc11c Logto\uac00 \ubc1c\uae09\ud55c JWT\ub97c \uac80\uc99d\ud558\ub294 \ubc29\ubc95, \uc11c\uba85, \ubc1c\uae09\uc790 (Issuer), \ub300\uc0c1 (Audience), \ub9cc\ub8cc, \uad8c\ud55c (\uc2a4\ucf54\ud504), \uc870\uc9c1 (Organization) \ucee8\ud14d\uc2a4\ud2b8\ub97c \ud655\uc778\ud558\ub294 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4.","source":"@site/i18n/ko/docusaurus-plugin-content-docs/current/authorization/validate-access-tokens/README.mdx","sourceDirName":"authorization/validate-access-tokens","slug":"/authorization/validate-access-tokens/","permalink":"/ko/authorization/validate-access-tokens/","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/ko/docusaurus-plugin-content-docs/current/authorization/validate-access-tokens/README.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"sidebar_label":"API\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\ud558\uae30"},"sidebar":"docsSidebar","previous":{"title":"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4 \ubcf4\ud638\ud558\uae30","permalink":"/ko/authorization/organization-level-api-resources"},"next":{"title":"\uc778\uac00 (Authorization)","permalink":"/ko/authorization/"}}');var o=t(25105),a=t(79621),i=t(38552),s=t(22002),c=t(37262),l=t(28433),u=t(35442),d=t(7620),p=t(16129),h=t(23147),g=t(49518),m=t(2740),x=t(31904),j=t(60431),f=t(53972),A=t(39132);const y=[...A.RM,...j.RM,...f.RM,...x.RM];function w(e){return(0,o.jsxs)(s.A,{groupId:"go-framework",children:[(0,o.jsx)(i.A,{value:"gin",label:"Gin",children:(0,o.jsx)(A.Ay,{})}),(0,o.jsx)(i.A,{value:"echo",label:"Echo",children:(0,o.jsx)(j.Ay,{})}),(0,o.jsx)(i.A,{value:"fiber",label:"Fiber",children:(0,o.jsx)(f.Ay,{})}),(0,o.jsx)(i.A,{value:"chi",label:"Chi",children:(0,o.jsx)(x.Ay,{})})]})}function v(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(w,{...e})}):w()}var _=t(24514),k=t(65830),b=t(6960),S=t(86126),I=t(62908),R=t(81546);const z=[...I.RM,...S.RM,...b.RM,...R.RM];function E(e){return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"spring-boot",label:"Spring Boot",children:(0,o.jsx)(I.Ay,{})}),(0,o.jsx)(i.A,{value:"quarkus",label:"Quarkus",children:(0,o.jsx)(S.Ay,{})}),(0,o.jsx)(i.A,{value:"micronaut",label:"Micronaut",children:(0,o.jsx)(b.Ay,{})}),(0,o.jsx)(i.A,{value:"vertx-web",label:"Vert.x Web",children:(0,o.jsx)(R.Ay,{})})]})}function T(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(E,{...e})}):E()}var J=t(95448),P=t(5540);function q(e){const n={code:"code",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"express",label:"Express.js",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="app.ts"',children:"import express from 'express';\nimport { verifyAccessToken } from './auth-middleware.js';\n\nconst app = express();\n\napp.get('/api/protected', verifyAccessToken, (req, res) => {\n  // req.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud558\uc138\uc694\n  res.json({ auth: req.auth });\n});\n\napp.get('/api/protected/detailed', verifyAccessToken, (req, res) => {\n  // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc138\uc694\n  res.json({\n    auth: req.auth,\n    message: '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4',\n  });\n});\n\napp.listen(3000);\n"})})}),(0,o.jsx)(i.A,{value:"koa",label:"Koa.js",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="app.ts"',children:"import Koa from 'koa';\nimport Router from '@koa/router';\nimport { koaVerifyAccessToken } from './auth-middleware.js';\n\nconst app = new Koa();\nconst router = new Router();\n\nrouter.get('/api/protected', koaVerifyAccessToken, (ctx) => {\n  // ctx.state.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud558\uc138\uc694\n  ctx.body = { auth: ctx.state.auth };\n});\n\nrouter.get('/api/protected/detailed', koaVerifyAccessToken, (ctx) => {\n  // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc138\uc694\n  ctx.body = {\n    auth: ctx.state.auth,\n    message: '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4',\n  };\n});\n\napp.use(router.routes());\napp.listen(3000);\n"})})}),(0,o.jsx)(i.A,{value:"fastify",label:"Fastify",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="app.ts"',children:"import Fastify from 'fastify';\nimport { fastifyVerifyAccessToken } from './auth-middleware.js';\n\nconst fastify = Fastify();\n\nserver.get('/api/protected', { preHandler: fastifyVerifyAccessToken }, (request, reply) => {\n  // request.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud558\uc138\uc694\n  reply.send({ auth: request.auth });\n});\n\nserver.get(\n  '/api/protected/detailed',\n  { preHandler: fastifyVerifyAccessToken },\n  (request, reply) => {\n    // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc138\uc694\n    reply.send({\n      auth: request.auth,\n      message: '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4',\n    });\n  }\n);\n\nfastify.listen({ port: 3000 });\n"})})}),(0,o.jsx)(i.A,{value:"hapi",label:"Hapi.js",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="app.ts"',children:"import Hapi from '@hapi/hapi';\nimport { hapiVerifyAccessToken } from './auth-middleware.js';\n\nconst server = Hapi.server({ port: 3000 });\n\nserver.route({\n  method: 'GET',\n  path: '/api/protected',\n  options: {\n    pre: [{ method: hapiVerifyAccessToken }],\n    handler: (request, h) => {\n      // request.app.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc811\uadfc\ud558\uc138\uc694\n      return { auth: request.app.auth };\n    },\n  },\n});\n\nserver.route({\n  method: 'GET',\n  path: '/api/protected/detailed',\n  options: {\n    pre: [{ method: hapiVerifyAccessToken }],\n    handler: (request, h) => {\n      // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc138\uc694\n      return {\n        auth: request.app.auth,\n        message: '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4',\n      };\n    },\n  },\n});\n\nawait server.start();\n"})})}),(0,o.jsx)(i.A,{value:"nestjs",label:"NestJS",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="protected.controller.ts"',children:"import { Controller, Get, UseGuards, Req } from '@nestjs/common';\nimport { AccessTokenGuard } from './access-token.guard.js';\n\n@Controller('api')\nexport class ProtectedController {\n  @Get('protected')\n  @UseGuards(AccessTokenGuard)\n  getProtected(@Req() req: any) {\n    // req.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc811\uadfc\ud558\uc138\uc694\n    return { auth: req.auth };\n  }\n\n  @Get('protected/detailed')\n  @UseGuards(AccessTokenGuard)\n  getDetailedProtected(@Req() req: any) {\n    // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc138\uc694\n    return {\n      auth: req.auth,\n      message: '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4',\n    };\n  }\n}\n"})})})]})}function C(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(q,{...e})}):q(e)}var N=t(15389),$=t(92106),M=t(33435),V=t(67611),O=t(55563),W=t(19115);const F=[...V.RM,...W.RM,...O.RM];function H(e){return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"laravel",label:(0,M.My)("laravel"),children:(0,o.jsx)(V.Ay,{})}),(0,o.jsx)(i.A,{value:"symfony",label:(0,M.My)("symfony"),children:(0,o.jsx)(W.Ay,{})}),(0,o.jsx)(i.A,{value:"slim",label:(0,M.My)("slim"),children:(0,o.jsx)(O.Ay,{})})]})}function D(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(H,{...e})}):H()}var L=t(29846),U=t(48406),B=t(14321),K=t(93726),G=t(16140),Y=t(60381);const Q=[...G.RM,...Y.RM,...B.RM,...K.RM];function X(e){return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"fastapi",label:(0,M.My)("fastapi"),children:(0,o.jsx)(G.Ay,{})}),(0,o.jsx)(i.A,{value:"flask",label:(0,M.My)("flask"),children:(0,o.jsx)(Y.Ay,{})}),(0,o.jsx)(i.A,{value:"django",label:(0,M.My)("django"),children:(0,o.jsx)(B.Ay,{})}),(0,o.jsx)(i.A,{value:"django-rest",label:(0,M.My)("django-rest"),children:(0,o.jsx)(K.Ay,{})})]})}function Z(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(X,{...e})}):X()}var ee=t(97134),ne=t(10270),te=t(62315),re=t(84341),oe=t(67314);const ae=[...re.RM,...oe.RM,...te.RM];function ie(e){return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"rails",label:(0,M.My)("rails"),children:(0,o.jsx)(re.Ay,{})}),(0,o.jsx)(i.A,{value:"sinatra",label:(0,M.My)("sinatra"),children:(0,o.jsx)(oe.Ay,{})}),(0,o.jsx)(i.A,{value:"grape",label:(0,M.My)("grape"),children:(0,o.jsx)(te.Ay,{})})]})}function se(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(ie,{...e})}):ie()}var ce=t(32272),le=t(61749),ue=t(33820),de=t(33321),pe=t(68730);const he=[...de.RM,...ue.RM,...pe.RM];function ge(e){return(0,o.jsxs)(s.A,{groupId:"api-framework",children:[(0,o.jsx)(i.A,{value:"axum",label:(0,M.My)("axum"),children:(0,o.jsx)(de.Ay,{})}),(0,o.jsx)(i.A,{value:"actix-web",label:(0,M.My)("actix-web"),children:(0,o.jsx)(ue.Ay,{})}),(0,o.jsx)(i.A,{value:"rocket",label:(0,M.My)("rocket"),children:(0,o.jsx)(pe.Ay,{})})]})}function me(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(ge,{...e})}):ge()}var xe=t(62910);const je={sidebar_position:6,sidebar_label:"API\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\ud558\uae30"},fe="API \uc11c\ube44\uc2a4 \ub610\ub294 \ubc31\uc5d4\ub4dc\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\ud558\ub294 \ubc29\ubc95",Ae={},ye=[{value:"\uc2dc\uc791\ud558\uae30 \uc804\uc5d0",id:"before-you-start",level:2},{value:"1\ub2e8\uacc4: \uc0c1\uc218 \ubc0f \uc720\ud2f8\ub9ac\ud2f0 \ucd08\uae30\ud654",id:"step-1-initialize-constants-and-utilities",level:2},...d.RM,...N.RM,...ee.RM,..._.RM,...J.RM,...u.RM,...L.RM,...ce.RM,...xe.RM,{value:"2\ub2e8\uacc4: Logto \ud14c\ub10c\ud2b8 \uc815\ubcf4 \uac00\uc838\uc624\uae30",id:"step-2-retrieve-info-about-your-logto-tenant",level:2},...p.RM,{value:"3\ub2e8\uacc4: \ud1a0\ud070 \ubc0f \uad8c\ud55c (Permission) \uac80\uc99d\ud558\uae30",id:"step-3-validate-the-token-and-permissions",level:2},...g.RM,{value:"\uac80\uc99d \ub85c\uc9c1 \ucd94\uac00\ud558\uae30",id:"add-the-validation-logic",level:3},...P.RM,...U.RM,...m.RM,...k.RM,...c.RM,...$.RM,...ne.RM,...le.RM,{value:"4\ub2e8\uacc4: API\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\ud558\uae30",id:"step-4-apply-middleware-to-your-api",level:2},...Q,...y,...z,...l.RM,...F,...ae,...he,{value:"5\ub2e8\uacc4: \uad6c\ud604 \ud14c\uc2a4\ud2b8\ud558\uae30",id:"step-5-test-your-implementation",level:2},...h.RM,{value:"\uad00\ub828 \ub9ac\uc18c\uc2a4",id:"related-resources",level:2}];function we(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components},{Url:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"api-\uc11c\ube44\uc2a4-\ub610\ub294-\ubc31\uc5d4\ub4dc\uc5d0\uc11c-\uc561\uc138\uc2a4-\ud1a0\ud070-access-token-\uac80\uc99d\ud558\ub294-\ubc29\ubc95",children:"API \uc11c\ube44\uc2a4 \ub610\ub294 \ubc31\uc5d4\ub4dc\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\ud558\ub294 \ubc29\ubc95"})}),"\n",(0,o.jsxs)(n.p,{children:["\uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\uc740 Logto\uc5d0\uc11c ",(0,o.jsx)(n.a,{href:"/authorization/role-based-access-control",children:"\uc5ed\ud560 \uae30\ubc18 \uc811\uadfc \uc81c\uc5b4 (RBAC)"}),"\ub97c \uc801\uc6a9\ud558\ub294 \ub370 \uc911\uc694\ud55c \ubd80\ubd84\uc785\ub2c8\ub2e4. \uc774 \uac00\uc774\ub4dc\uc5d0\uc11c\ub294 \ubc31\uc5d4\ub4dc / API\uc5d0\uc11c Logto\uac00 \ubc1c\uae09\ud55c JWT\ub97c \uac80\uc99d\ud558\ub294 \ubc29\ubc95, \uc11c\uba85, \ubc1c\uae09\uc790 (Issuer), \ub300\uc0c1 (Audience), \ub9cc\ub8cc, \uad8c\ud55c (\uc2a4\ucf54\ud504), \uc870\uc9c1 (Organization) \ucee8\ud14d\uc2a4\ud2b8\ub97c \ud655\uc778\ud558\ub294 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(n.h2,{id:"before-you-start",children:"\uc2dc\uc791\ud558\uae30 \uc804\uc5d0"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\uc774 \uac00\uc774\ub4dc\ub294 Logto\uc758 RBAC \uac1c\ub150\uc5d0 \uc775\uc219\ud558\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4."}),"\n",(0,o.jsxs)(n.li,{children:["API \ub9ac\uc18c\uc2a4\ub97c \ubcf4\ud638\ud558\ub294 \uacbd\uc6b0, ",(0,o.jsx)(n.a,{href:"/authorization/global-api-resources",children:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4 \ubcf4\ud638\ud558\uae30"})," \uac00\uc774\ub4dc\ub97c \uc774\ubbf8 \uc9c4\ud589\ud588\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(n.li,{children:["\uc571 \ub0b4 \uae30\ub2a5 \ub610\ub294 \uc6cc\ud06c\ud50c\ub85c\uc6b0(\ube44-API \uad8c\ud55c)\ub97c \ubcf4\ud638\ud558\ub294 \uacbd\uc6b0, ",(0,o.jsx)(n.a,{href:"/authorization/organization-permissions",children:"\uc870\uc9c1 (Organization) (\ube44-API) \uad8c\ud55c \ubcf4\ud638\ud558\uae30"})," \uac00\uc774\ub4dc\ub97c \uc774\ubbf8 \uc9c4\ud589\ud588\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(n.li,{children:["\uc870\uc9c1 \uc218\uc900\uc758 API \ub9ac\uc18c\uc2a4\ub97c \ubcf4\ud638\ud558\ub294 \uacbd\uc6b0, ",(0,o.jsx)(n.a,{href:"/authorization/organization-level-api-resources",children:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4 \ubcf4\ud638\ud558\uae30"})," \uac00\uc774\ub4dc\ub97c \uc774\ubbf8 \uc9c4\ud589\ud588\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"step-1-initialize-constants-and-utilities",children:"1\ub2e8\uacc4: \uc0c1\uc218 \ubc0f \uc720\ud2f8\ub9ac\ud2f0 \ucd08\uae30\ud654"}),"\n",(0,o.jsx)(d.Ay,{}),"\n",(0,o.jsxs)(s.A,{groupId:"api-language",children:[(0,o.jsx)(i.A,{value:"node",label:"Node.js",children:(0,o.jsx)(N.Ay,{})}),(0,o.jsx)(i.A,{value:"python",label:"Python",children:(0,o.jsx)(ee.Ay,{})}),(0,o.jsx)(i.A,{value:"go",label:"Go",children:(0,o.jsx)(_.Ay,{})}),(0,o.jsx)(i.A,{value:"java",label:"Java",children:(0,o.jsx)(J.Ay,{})}),(0,o.jsx)(i.A,{value:"dotnet",label:".NET",children:(0,o.jsx)(u.Ay,{})}),(0,o.jsx)(i.A,{value:"php",label:"PHP",children:(0,o.jsx)(L.Ay,{})}),(0,o.jsx)(i.A,{value:"ruby",label:"Ruby",children:(0,o.jsx)(ce.Ay,{})}),(0,o.jsx)(i.A,{value:"rust",label:"Rust",children:(0,o.jsx)(xe.Ay,{})})]}),"\n",(0,o.jsx)(n.h2,{id:"step-2-retrieve-info-about-your-logto-tenant",children:"2\ub2e8\uacc4: Logto \ud14c\ub10c\ud2b8 \uc815\ubcf4 \uac00\uc838\uc624\uae30"}),"\n",(0,o.jsx)(p.Ay,{}),"\n",(0,o.jsx)(n.h2,{id:"step-3-validate-the-token-and-permissions",children:"3\ub2e8\uacc4: \ud1a0\ud070 \ubc0f \uad8c\ud55c (Permission) \uac80\uc99d\ud558\uae30"}),"\n",(0,o.jsx)(g.Ay,{}),"\n",(0,o.jsx)(n.h3,{id:"add-the-validation-logic",children:"\uac80\uc99d \ub85c\uc9c1 \ucd94\uac00\ud558\uae30"}),"\n",(0,o.jsxs)(s.A,{groupId:"api-language",children:[(0,o.jsx)(i.A,{value:"node",label:"Node.js",children:(0,o.jsx)(P.Ay,{})}),(0,o.jsx)(i.A,{value:"python",label:"Python",children:(0,o.jsx)(U.Ay,{})}),(0,o.jsx)(i.A,{value:"go",label:"Go",children:(0,o.jsx)(m.Ay,{})}),(0,o.jsx)(i.A,{value:"java",label:"Java",children:(0,o.jsx)(k.Ay,{})}),(0,o.jsx)(i.A,{value:"dotnet",label:".NET",children:(0,o.jsx)(c.Ay,{})}),(0,o.jsx)(i.A,{value:"php",label:"PHP",children:(0,o.jsx)($.Ay,{})}),(0,o.jsx)(i.A,{value:"ruby",label:"Ruby",children:(0,o.jsx)(ne.Ay,{})}),(0,o.jsx)(i.A,{value:"rust",label:"Rust",children:(0,o.jsx)(le.Ay,{})})]}),"\n",(0,o.jsx)(n.h2,{id:"step-4-apply-middleware-to-your-api",children:"4\ub2e8\uacc4: API\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\ud558\uae30"}),"\n",(0,o.jsx)(n.p,{children:"\ubcf4\ud638\ud558\ub824\ub294 API \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uc801\uc6a9\ud558\uc138\uc694."}),"\n",(0,o.jsxs)(s.A,{groupId:"api-language",children:[(0,o.jsx)(i.A,{value:"node",label:"Node.js",children:(0,o.jsx)(C,{})}),(0,o.jsx)(i.A,{value:"python",label:"Python",children:(0,o.jsx)(Z,{})}),(0,o.jsx)(i.A,{value:"go",label:"Go",children:(0,o.jsx)(v,{})}),(0,o.jsx)(i.A,{value:"java",label:"Java",children:(0,o.jsx)(T,{})}),(0,o.jsx)(i.A,{value:"dotnet",label:".NET",children:(0,o.jsx)(l.Ay,{})}),(0,o.jsx)(i.A,{value:"php",label:"PHP",children:(0,o.jsx)(D,{})}),(0,o.jsx)(i.A,{value:"ruby",label:"Ruby",children:(0,o.jsx)(se,{})}),(0,o.jsx)(i.A,{value:"rust",label:"Rust",children:(0,o.jsx)(me,{})})]}),"\n",(0,o.jsx)(n.h2,{id:"step-5-test-your-implementation",children:"5\ub2e8\uacc4: \uad6c\ud604 \ud14c\uc2a4\ud2b8\ud558\uae30"}),"\n",(0,o.jsx)(h.Ay,{}),"\n",(0,o.jsx)(n.h2,{id:"related-resources",children:"\uad00\ub828 \ub9ac\uc18c\uc2a4"}),"\n",(0,o.jsx)(t,{href:"/developers/custom-token-claims",children:"\ud1a0\ud070 \ud074\ub808\uc784 (Claim) \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5"}),"\n",(0,o.jsx)(t,{href:"https://auth.wiki/jwt",children:"JSON Web Token (JWT)"}),"\n",(0,o.jsx)(t,{href:"https://openid.net/specs/openid-connect-discovery-1_0.html",children:(0,o.jsx)(n.p,{children:"OpenID Connect Discovery"})}),"\n",(0,o.jsx)(t,{href:"https://www.rfc-editor.org/rfc/rfc8707.html",children:(0,o.jsx)(n.p,{children:"RFC 8707: \ub9ac\uc18c\uc2a4 \uc9c0\ud45c (Resource Indicator)"})})]})}function ve(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(we,{...e})}):we(e)}},37262:(e,n,t)=>{t.d(n,{Ay:()=>l,RM:()=>s});var r=t(25105),o=t(79621),a=t(38552),i=t(22002);const s=[];function c(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"JWT \uc778\uc99d (Authentication)\uc744 \uc704\ud574 \ud544\uc694\ud55c NuGet \ud328\ud0a4\uc9c0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<PackageReference Include="Microsoft.AspNetCore.Authentication.JwtBearer" Version="8.0.0" />\n'})}),"\n",(0,r.jsx)(n.p,{children:"\ud1a0\ud070 \uac80\uc99d\uc744 \ucc98\ub9ac\ud560 \uac80\uc99d \uc11c\ube44\uc2a4\ub97c \uc0dd\uc131\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="JwtValidationService.cs"',children:'using System.Security.Claims;\nusing Microsoft.AspNetCore.Authentication.JwtBearer;\nusing YourApiNamespace.Exceptions;\n\nnamespace YourApiNamespace.Services\n{\n    public interface IJwtValidationService\n    {\n        Task ValidateTokenAsync(TokenValidatedContext context);\n    }\n\n    public class JwtValidationService : IJwtValidationService\n    {\n        public async Task ValidateTokenAsync(TokenValidatedContext context)\n        {\n            var principal = context.Principal!;\n\n            try\n            {\n                // \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \ucd94\uac00\ud558\uc138\uc694\n                ValidatePayload(principal);\n            }\n            catch (AuthorizationException)\n            {\n                throw; // \uc778\uac00 (Authorization) \uc608\uc678\ub294 \ub2e4\uc2dc throw\n            }\n            catch (Exception ex)\n            {\n                throw new AuthorizationException($"\ud1a0\ud070 \uac80\uc99d \uc2e4\ud328: {ex.Message}", 401);\n            }\n        }\n\n        private void ValidatePayload(ClaimsPrincipal principal)\n        {\n            // \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n            // \uc544\ub798 \uad8c\ud55c \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Program.cs"}),"\uc5d0\uc11c JWT \uc778\uc99d (Authentication)\uc744 \uad6c\uc131\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="Program.cs"',children:'using Microsoft.AspNetCore.Authentication.JwtBearer;\nusing Microsoft.IdentityModel.Tokens;\nusing YourApiNamespace.Services;\nusing YourApiNamespace.Exceptions;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// \uc11c\ube44\uc2a4 \ub4f1\ub85d\nbuilder.Services.AddControllers();\nbuilder.Services.AddScoped<IJwtValidationService, JwtValidationService>();\n\n// JWT \uc778\uc99d (Authentication) \uad6c\uc131\nbuilder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)\n    .AddJwtBearer(options =>\n    {\n        options.Authority = AuthConstants.Issuer;\n        options.MetadataAddress = $"{AuthConstants.Issuer}/.well-known/openid_configuration";\n        options.RequireHttpsMetadata = true;\n        options.TokenValidationParameters = new TokenValidationParameters\n        {\n            ValidateIssuer = true,\n            ValidIssuer = AuthConstants.Issuer,\n            ValidateAudience = false, // \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c audience\ub294 \uc9c1\uc811 \uac80\uc99d\n            ValidateLifetime = true,\n            ValidateIssuerSigningKey = true,\n            ClockSkew = TimeSpan.FromMinutes(5)\n        };\n\n        options.Events = new JwtBearerEvents\n        {\n            OnTokenValidated = async context =>\n            {\n                var validationService = context.HttpContext.RequestServices\n                    .GetRequiredService<IJwtValidationService>();\n\n                await validationService.ValidateTokenAsync(context);\n            },\n            OnAuthenticationFailed = context =>\n            {\n                // JWT \ub77c\uc774\ube0c\ub7ec\ub9ac \uc624\ub958\ub97c 401\ub85c \ucc98\ub9ac\n                context.Response.StatusCode = 401;\n                context.Response.ContentType = "application/json";\n                context.Response.WriteAsync($"{{\\"error\\": \\"Invalid token\\"}}");\n                context.HandleResponse();\n                return Task.CompletedTask;\n            }\n        };\n    });\n\nbuilder.Services.AddAuthorization();\n\nvar app = builder.Build();\n\n// \uc778\uc99d (Authentication)/\uc778\uac00 (Authorization) \uc2e4\ud328\uc5d0 \ub300\ud55c \uc804\uc5ed \uc5d0\ub7ec \ucc98\ub9ac\napp.Use(async (context, next) =>\n{\n    try\n    {\n        await next();\n    }\n    catch (AuthorizationException ex)\n    {\n        context.Response.StatusCode = ex.StatusCode;\n        context.Response.ContentType = "application/json";\n        await context.Response.WriteAsync($"{{\\"error\\": \\"{ex.Message}\\"}}");\n    }\n});\n\n// HTTP \uc694\uccad \ud30c\uc774\ud504\ub77c\uc778 \uad6c\uc131\napp.UseAuthentication();\napp.UseAuthorization();\n\napp.MapControllers();\n\napp.Run();\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c ",(0,r.jsx)(n.code,{children:"JwtValidationService"}),"\uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(i.A,{groupId:"permission-models",children:[(0,r.jsx)(a.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="JwtValidationService.cs"',children:'private void ValidatePayload(ClaimsPrincipal principal)\n{\n    // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    var audiences = principal.FindAll("aud").Select(c => c.Value).ToList();\n    if (!audiences.Contains("https://your-api-resource-indicator"))\n    {\n        throw new AuthorizationException("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (audience)");\n    }\n\n    // \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    var requiredScopes = new[] { "api:read", "api:write" }; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\n    var tokenScopes = principal.FindFirst("scope")?.Value?.Split(\' \') ?? Array.Empty<string>();\n\n    if (!requiredScopes.All(scope => tokenScopes.Contains(scope)))\n    {\n        throw new AuthorizationException("\uc2a4\ucf54\ud504 (scope)\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4");\n    }\n}\n'})})}),(0,r.jsx)(a.A,{value:"organization-permissions",label:"\uc870\uc9c1 (\ube44-API) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="JwtValidationService.cs"',children:'private void ValidatePayload(ClaimsPrincipal principal)\n{\n    // audience \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    var audiences = principal.FindAll("aud").Select(c => c.Value).ToList();\n    var hasOrgAudience = audiences.Any(aud => aud.StartsWith("urn:logto:organization:"));\n\n    if (!hasOrgAudience)\n    {\n        throw new AuthorizationException("\uc870\uc9c1 \uad8c\ud55c\uc5d0 \ub300\ud55c \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (audience)");\n    }\n\n    // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    var expectedOrgId = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    var expectedAud = $"urn:logto:organization:{expectedOrgId}";\n    if (!audiences.Contains(expectedAud))\n    {\n        throw new AuthorizationException("\uc870\uc9c1 ID \ubd88\uc77c\uce58");\n    }\n\n    // \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 \ud655\uc778\n    var requiredScopes = new[] { "invite:users", "manage:settings" }; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\n    var tokenScopes = principal.FindFirst("scope")?.Value?.Split(\' \') ?? Array.Empty<string>();\n\n    if (!requiredScopes.All(scope => tokenScopes.Contains(scope)))\n    {\n        throw new AuthorizationException("\uc870\uc9c1 \uc2a4\ucf54\ud504 (scope)\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4");\n    }\n}\n'})})}),(0,r.jsx)(a.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="JwtValidationService.cs"',children:'private void ValidatePayload(ClaimsPrincipal principal)\n{\n    // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    var audiences = principal.FindAll("aud").Select(c => c.Value).ToList();\n    if (!audiences.Contains("https://your-api-resource-indicator"))\n    {\n        throw new AuthorizationException("\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ub300\ud55c \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (audience)");\n    }\n\n    // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    var expectedOrgId = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    var orgId = principal.FindFirst("organization_id")?.Value;\n    if (!expectedOrgId.Equals(orgId))\n    {\n        throw new AuthorizationException("\uc870\uc9c1 ID \ubd88\uc77c\uce58");\n    }\n\n    // \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    var requiredScopes = new[] { "api:read", "api:write" }; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\n    var tokenScopes = principal.FindFirst("scope")?.Value?.Split(\' \') ?? Array.Empty<string>();\n\n    if (!requiredScopes.All(scope => tokenScopes.Contains(scope)))\n    {\n        throw new AuthorizationException("\uc870\uc9c1 \uc218\uc900 API \uc2a4\ucf54\ud504 (scope)\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4");\n    }\n}\n'})})})]})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28433:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\uc774\uc804 \uc139\uc158\uc5d0\uc11c \uc774\ubbf8 \uc778\uc99d (Authentication) \ubc0f \uc778\uac00 (Authorization) \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uc124\uc815\ud588\uc2b5\ub2c8\ub2e4. \uc774\uc81c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token)\uc744 \uac80\uc99d\ud558\uace0 \uc778\uc99d\ub41c \uc694\uccad\uc5d0\uc11c \ud074\ub808\uc784 (Claim)\uc744 \ucd94\ucd9c\ud558\ub294 \ubcf4\ud638\ub41c \ucee8\ud2b8\ub864\ub7ec\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="ProtectedController.cs"',children:'using Microsoft.AspNetCore.Authorization;\nusing Microsoft.AspNetCore.Mvc;\nusing System.Security.Claims;\n\nnamespace YourApiNamespace.Controllers\n{\n    [ApiController]\n    [Route("api/[controller]")]\n    [Authorize] // \uc774 \ucee8\ud2b8\ub864\ub7ec\uc758 \ubaa8\ub4e0 \uc561\uc158\uc5d0 \uc778\uc99d (Authentication) \ud544\uc694\n    public class ProtectedController : ControllerBase\n    {\n        [HttpGet]\n        public IActionResult GetProtectedData()\n        {\n            // User \ud074\ub808\uc784 (Claim)\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc815\ubcf4 \uc9c1\uc811 \uc811\uadfc\n            var sub = User.FindFirst(ClaimTypes.NameIdentifier)?.Value ?? User.FindFirst("sub")?.Value;\n            var clientId = User.FindFirst("client_id")?.Value;\n            var organizationId = User.FindFirst("organization_id")?.Value;\n            var scopes = User.FindFirst("scope")?.Value?.Split(\' \') ?? Array.Empty<string>();\n            var audience = User.FindAll("aud").Select(c => c.Value).ToArray();\n\n            return Ok(new {\n                sub,\n                client_id = clientId,\n                organization_id = organizationId,\n                scopes,\n                audience\n            });\n        }\n\n        [HttpGet("claims")]\n        public IActionResult GetAllClaims()\n        {\n            // \ub514\ubc84\uae45/\uc810\uac80\uc744 \uc704\ud574 \ubaa8\ub4e0 \ud074\ub808\uc784 (Claim) \ubc18\ud658\n            var claims = User.Claims.Select(c => new { c.Type, c.Value }).ToList();\n            return Ok(new { claims });\n        }\n    }\n}\n'})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},35442:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="AuthConstants.cs"',children:'namespace YourApiNamespace\n{\n    public static class AuthConstants\n    {\n        public const string Issuer = "https://your-tenant.logto.app/oidc";\n    }\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",metastring:'title="AuthenticationExceptions.cs"',children:"namespace YourApiNamespace.Exceptions\n{\n    public class AuthorizationException : Exception\n    {\n        public int StatusCode { get; }\n\n        public AuthorizationException(string message, int statusCode = 403) : base(message)\n        {\n            StatusCode = statusCode;\n        }\n    }\n}\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},7620:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",...(0,o.R)(),...e.components};return(0,r.jsxs)(n.p,{children:["\ucf54\ub4dc\uc5d0\uc11c \ud544\uc694\ud55c \uc0c1\uc218\uc640 \uc720\ud2f8\ub9ac\ud2f0\ub97c \uc815\uc758\ud558\uc5ec \ud1a0\ud070 \ucd94\ucd9c \ubc0f \uc720\ud6a8\uc131 \uac80\uc0ac\ub97c \ucc98\ub9ac\ud558\uc138\uc694. \uc720\ud6a8\ud55c \uc694\uccad\uc5d0\ub294 ",(0,r.jsx)(n.code,{children:"Authorization"})," \ud5e4\ub354\uac00 \ubc18\ub4dc\uc2dc ",(0,r.jsx)(n.code,{children:"Bearer <\uc561\uc138\uc2a4 \ud1a0\ud070 (Access token)>"})," \ud615\uc2dd\uc73c\ub85c \ud3ec\ud568\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},16129:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[{value:"OpenID Connect \ub514\uc2a4\ucee4\ubc84\ub9ac \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc5d0\uc11c \uac00\uc838\uc624\uae30",id:"fetch-from-openid-connect-discovery-endpoint",level:3},{value:"\ucf54\ub4dc\uc5d0 \ud558\ub4dc\ucf54\ub529\ud558\uae30 (\uad8c\uc7a5\ud558\uc9c0 \uc54a\uc74c)",id:"hardcode-in-your-code-not-recommended",level:3}];function i(e){const n={code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Logto\uc5d0\uc11c \ubc1c\uae09\ud55c \ud1a0\ud070\uc744 \uac80\uc99d\ud558\ub824\uba74 \ub2e4\uc74c \uac12\ub4e4\uc774 \ud544\uc694\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JSON Web Key Set (JWKS) URI: JWT \uc11c\uba85\uc744 \uac80\uc99d\ud558\ub294 \ub370 \uc0ac\uc6a9\ub418\ub294 Logto\uc758 \uacf5\uac1c \ud0a4 URL\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.li,{children:"\ubc1c\uae09\uc790 (Issuer): \uc608\uc0c1\ub418\ub294 \ubc1c\uae09\uc790 \uac12 (Logto\uc758 OIDC URL)."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, Logto \ud14c\ub10c\ud2b8\uc758 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub97c \ucc3e\uc544\uc57c \ud569\ub2c8\ub2e4. \ub2e4\uc74c \uc704\uce58\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Logto \ucf58\uc194\uc5d0\uc11c ",(0,r.jsx)(n.strong,{children:"\uc124\uc815"})," \u2192 ",(0,r.jsx)(n.strong,{children:"\ub3c4\uba54\uc778"}),"\uc5d0\uc11c \ud655\uc778\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:["Logto\uc5d0\uc11c \uad6c\uc131\ud55c \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc124\uc815\uc758 ",(0,r.jsx)(n.strong,{children:"\uc124\uc815"})," \u2192 ",(0,r.jsx)(n.strong,{children:"\uc5d4\ub4dc\ud3ec\uc778\ud2b8 & \uc790\uaca9 \uc99d\uba85"}),"\uc5d0\uc11c \ud655\uc778\ud558\uc138\uc694."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"fetch-from-openid-connect-discovery-endpoint",children:"OpenID Connect \ub514\uc2a4\ucee4\ubc84\ub9ac \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc5d0\uc11c \uac00\uc838\uc624\uae30"}),"\n",(0,r.jsx)(n.p,{children:"\uc774 \uac12\ub4e4\uc740 Logto\uc758 OpenID Connect \ub514\uc2a4\ucee4\ubc84\ub9ac \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc5d0\uc11c \uac00\uc838\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc/.well-known/openid-configuration\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uc608\uc2dc \uc751\ub2f5\uc785\ub2c8\ub2e4 (\ub2e4\ub978 \ud544\ub4dc\ub294 \uc0dd\ub7b5):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "jwks_uri": "https://your-tenant.logto.app/oidc/jwks",\n  "issuer": "https://your-tenant.logto.app/oidc"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"hardcode-in-your-code-not-recommended",children:"\ucf54\ub4dc\uc5d0 \ud558\ub4dc\ucf54\ub529\ud558\uae30 (\uad8c\uc7a5\ud558\uc9c0 \uc54a\uc74c)"}),"\n",(0,r.jsx)(n.p,{children:"Logto\ub294 JWKS URI \ub610\ub294 \ubc1c\uae09\uc790 (Issuer)\ub97c \ucee4\uc2a4\ud130\ub9c8\uc774\uc988\ud560 \uc218 \uc5c6\uc73c\ubbc0\ub85c, \uc774 \uac12\ub4e4\uc744 \ucf54\ub4dc\uc5d0 \ud558\ub4dc\ucf54\ub529\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud558\uc9c0\ub9cc, \ud5a5\ud6c4 \uc124\uc815\uc774 \ubcc0\uacbd\ub420 \uacbd\uc6b0 \uc720\uc9c0\ubcf4\uc218 \ubd80\ub2f4\uc774 \ucee4\uc9c8 \uc218 \uc788\uc73c\ubbc0\ub85c \ud504\ub85c\ub355\uc158 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0\uc11c\ub294 \uad8c\uc7a5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["JWKS URI: ",(0,r.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc/jwks"})]}),"\n",(0,r.jsxs)(n.li,{children:["\ubc1c\uae09\uc790 (Issuer): ",(0,r.jsx)(n.code,{children:"https://<your-logto-endpoint>/oidc"})]}),"\n"]})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},23147:(e,n,t)=>{t.d(n,{Ay:()=>l,RM:()=>s});var r=t(25105),o=t(79621),a=t(38552),i=t(22002);const s=[{value:"\uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \ubc1b\uae30",id:"get-access-tokens",level:3},{value:"\ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ud14c\uc2a4\ud2b8\ud558\uae30",id:"test-protected-endpoints",level:3},{value:"\uad8c\ud55c (Permission) \ubaa8\ub378\ubcc4 \ud14c\uc2a4\ud2b8",id:"permission-model-specific-testing",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"get-access-tokens",children:"\uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \ubc1b\uae30"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\ud074\ub77c\uc774\uc5b8\ud2b8 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0\uc11c:"}),"\n\ud074\ub77c\uc774\uc5b8\ud2b8 \ud1b5\ud569\uc744 \uc124\uc815\ud588\ub2e4\uba74, \uc571\uc774 \ud1a0\ud070\uc744 \uc790\ub3d9\uc73c\ub85c \ud68d\ub4dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token)\uc744 \ucd94\ucd9c\ud558\uc5ec API \uc694\uccad\uc5d0 \uc0ac\uc6a9\ud558\uc138\uc694."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"curl / Postman\uc73c\ub85c \ud14c\uc2a4\ud2b8\ud560 \ub54c:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\uc0ac\uc6a9\uc790 \ud1a0\ud070:"})," \ud074\ub77c\uc774\uc5b8\ud2b8 \uc571\uc758 \uac1c\ubc1c\uc790 \ub3c4\uad6c\uc5d0\uc11c localStorage \ub610\ub294 \ub124\ud2b8\uc6cc\ud06c \ud0ed\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token)\uc744 \ubcf5\uc0ac\ud558\uc138\uc694."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\uae30\uacc4 \uac04 (Machine-to-machine) \ud1a0\ud070:"})," \ud074\ub77c\uc774\uc5b8\ud2b8 \uc790\uaca9 \uc99d\uba85 \ud50c\ub85c\uc6b0\ub97c \uc0ac\uc6a9\ud558\uc138\uc694. \ub2e4\uc74c\uc740 curl\uc744 \uc0ac\uc6a9\ud55c \ube44\uacf5\uc2dd \uc608\uc2dc\uc785\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://your-tenant.logto.app/oidc/token \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "grant_type=client_credentials" \\\n  -d "client_id=your-m2m-client-id" \\\n  -d "client_secret=your-m2m-client-secret" \\\n  -d "resource=https://your-api-resource-indicator" \\\n  -d "scope=api:read api:write"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["API \ub9ac\uc18c\uc2a4 (API resource)\uc640 \uad8c\ud55c (Permission)\uc5d0 \ub530\ub77c ",(0,r.jsx)(n.code,{children:"resource"})," \ubc0f ",(0,r.jsx)(n.code,{children:"scope"})," \ud30c\ub77c\ubbf8\ud130\ub97c \uc870\uc815\ud574\uc57c \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. API\uac00 \uc870\uc9c1 \ubc94\uc704\ub77c\uba74 ",(0,r.jsx)(n.code,{children:"organization_id"})," \ud30c\ub77c\ubbf8\ud130\ub3c4 \ud544\uc694\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["\ud1a0\ud070 \ub0b4\uc6a9\uc744 \ud655\uc778\ud574\uc57c \ud558\ub098\uc694? \uc6b0\ub9ac\uc758 ",(0,r.jsx)(n.a,{href:"https://logto.io/jwt-decoder",children:"JWT \ub514\ucf54\ub354"}),"\ub97c \uc0ac\uc6a9\ud558\uc5ec JWT\ub97c \ub514\ucf54\ub4dc\ud558\uace0 \uac80\uc99d\ud558\uc138\uc694."]})}),"\n",(0,r.jsx)(n.h3,{id:"test-protected-endpoints",children:"\ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ud14c\uc2a4\ud2b8\ud558\uae30"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.strong,{children:"\uc720\ud6a8\ud55c \ud1a0\ud070 \uc694\uccad"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..." \\\n  http://localhost:3000/api/protected\n'})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc0c1 \uc751\ub2f5:"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "auth": {\n    "sub": "user123",\n    "clientId": "app456",\n    "organizationId": "org789",\n    "scopes": ["api:read", "api:write"],\n    "audience": ["https://your-api-resource-indicator"]\n  }\n}\n'})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.strong,{children:"\ud1a0\ud070 \uc5c6\uc74c"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:3000/api/protected\n"})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc0c1 \uc751\ub2f5 (401):"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Authorization header is missing"\n}\n'})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)(n.strong,{children:"\uc798\ubabb\ub41c \ud1a0\ud070"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer invalid-token" \\\n  http://localhost:3000/api/protected\n'})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc0c1 \uc751\ub2f5 (401):"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Invalid token"\n}\n'})})]}),"\n",(0,r.jsx)(n.h3,{id:"permission-model-specific-testing",children:"\uad8c\ud55c (Permission) \ubaa8\ub378\ubcc4 \ud14c\uc2a4\ud2b8"}),"\n",(0,r.jsxs)(i.A,{groupId:"permission-models",children:[(0,r.jsxs)(a.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:[(0,r.jsx)(n.p,{children:"\uae00\ub85c\ubc8c \uc2a4\ucf54\ud504\ub85c \ubcf4\ud638\ub41c API \ud14c\uc2a4\ud2b8 \uc2dc\ub098\ub9ac\uc624:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc720\ud6a8\ud55c \uc2a4\ucf54\ud504:"})," \ud544\uc694\ud55c API \uc2a4\ucf54\ud504(\uc608: ",(0,r.jsx)(n.code,{children:"api:read"}),", ",(0,r.jsx)(n.code,{children:"api:write"}),")\uac00 \ud3ec\ud568\ub41c \ud1a0\ud070\uc73c\ub85c \ud14c\uc2a4\ud2b8\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc2a4\ucf54\ud504 \ub204\ub77d:"})," \ud1a0\ud070\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504\uac00 \uc5c6\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc798\ubabb\ub41c \ub300\uc0c1 (Audience):"})," \ub300\uc0c1\uc774 API \ub9ac\uc18c\uc2a4\uc640 \uc77c\uce58\ud558\uc9c0 \uc54a\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \uc2a4\ucf54\ud504\uac00 \ub204\ub77d\ub41c \ud1a0\ud070 - 403 \uc608\uc0c1\ncurl -H "Authorization: Bearer token-without-required-scopes" \\\n  http://localhost:3000/api/protected\n'})})]}),(0,r.jsxs)(a.A,{value:"organization-permissions",label:"\uc870\uc9c1 (\ube44-API) \uad8c\ud55c",children:[(0,r.jsx)(n.p,{children:"\uc870\uc9c1\ubcc4 \uc811\uadfc \uc81c\uc5b4 \ud14c\uc2a4\ud2b8 \uc2dc\ub098\ub9ac\uc624:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc720\ud6a8\ud55c \uc870\uc9c1 \ud1a0\ud070:"})," \uc62c\ubc14\ub978 \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8(\uc870\uc9c1 ID \ubc0f \uc2a4\ucf54\ud504)\uac00 \ud3ec\ud568\ub41c \ud1a0\ud070\uc73c\ub85c \ud14c\uc2a4\ud2b8\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc2a4\ucf54\ud504 \ub204\ub77d:"})," \uc0ac\uc6a9\uc790\uac00 \uc694\uccad\ud55c \uc791\uc5c5\uc5d0 \ub300\ud55c \uad8c\ud55c\uc774 \uc5c6\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc798\ubabb\ub41c \uc870\uc9c1:"})," \ub300\uc0c1\uc774 \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8(",(0,r.jsx)(n.code,{children:"urn:logto:organization:<organization_id>"}),")\uc640 \uc77c\uce58\ud558\uc9c0 \uc54a\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \uc798\ubabb\ub41c \uc870\uc9c1\uc758 \ud1a0\ud070 - 403 \uc608\uc0c1\ncurl -H "Authorization: Bearer token-for-different-organization" \\\n  http://localhost:3000/api/protected\n'})})]}),(0,r.jsxs)(a.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:[(0,r.jsx)(n.p,{children:"API \ub9ac\uc18c\uc2a4 \uac80\uc99d\uacfc \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8\ub97c \uacb0\ud569\ud55c \ud14c\uc2a4\ud2b8 \uc2dc\ub098\ub9ac\uc624:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc720\ud6a8\ud55c \uc870\uc9c1 + API \uc2a4\ucf54\ud504:"})," \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8\uc640 \ud544\uc694\ud55c API \uc2a4\ucf54\ud504\uac00 \ubaa8\ub450 \ud3ec\ud568\ub41c \ud1a0\ud070\uc73c\ub85c \ud14c\uc2a4\ud2b8\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"API \uc2a4\ucf54\ud504 \ub204\ub77d:"})," \uc870\uc9c1 \ud1a0\ud070\uc5d0 \ud544\uc694\ud55c API \uad8c\ud55c\uc774 \uc5c6\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc798\ubabb\ub41c \uc870\uc9c1:"})," \ub2e4\ub978 \uc870\uc9c1\uc758 \ud1a0\ud070\uc73c\ub85c API\uc5d0 \uc811\uadfc\ud558\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc798\ubabb\ub41c \ub300\uc0c1 (Audience):"})," \ub300\uc0c1\uc774 \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc640 \uc77c\uce58\ud558\uc9c0 \uc54a\uc73c\uba74 ",(0,r.jsx)(n.strong,{children:"403 Forbidden"}),"\uc744 \uc608\uc0c1\ud558\uc138\uc694."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# API \uc2a4\ucf54\ud504\uac00 \uc5c6\ub294 \uc870\uc9c1 \ud1a0\ud070 - 403 \uc608\uc0c1\ncurl -H "Authorization: Bearer organization-token-without-api-scopes" \\\n  http://localhost:3000/api/protected\n'})})]})]})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},49518:(e,n,t)=>{t.d(n,{Ay:()=>l,RM:()=>s});var r=t(25105),o=t(79621),a=t(38552),i=t(22002);const s=[{value:"\uac01 \uad8c\ud55c \ubaa8\ub378\ubcc4\ub85c \ud655\uc778\ud574\uc57c \ud560 \uc0ac\ud56d",id:"what-to-check-for-each-permission-model",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\ud1a0\ud070\uc744 \ucd94\ucd9c\ud558\uace0 OIDC \uad6c\uc131\uc744 \uac00\uc838\uc628 \ud6c4, \ub2e4\uc74c\uc744 \uac80\uc99d\ud558\uc138\uc694:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc11c\uba85:"})," JWT\ub294 \uc720\ud6a8\ud574\uc57c \ud558\uba70 Logto(JWKS\ub97c \ud1b5\ud574)\uc5d0\uc11c \uc11c\uba85\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ubc1c\uae09\uc790 (Issuer):"})," Logto \ud14c\ub10c\ud2b8\uc758 \ubc1c\uae09\uc790\uc640 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ub300\uc0c1 (Audience):"})," Logto\uc5d0 \ub4f1\ub85d\ub41c API\uc758 \ub9ac\uc18c\uc2a4 \uc9c0\ud45c \ub610\ub294 \ud574\ub2f9\ub418\ub294 \uacbd\uc6b0 \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ub9cc\ub8cc:"})," \ud1a0\ud070\uc774 \ub9cc\ub8cc\ub418\uc9c0 \uc54a\uc544\uc57c \ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uad8c\ud55c (\uc2a4\ucf54\ud504, Permissions):"})," \ud1a0\ud070\uc5d0\ub294 API/\ub3d9\uc791\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504\uac00 \ud3ec\ud568\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4. \uc2a4\ucf54\ud504\ub294 ",(0,r.jsx)(n.code,{children:"scope"})," \ud074\ub808\uc784\uc5d0 \uacf5\ubc31\uc73c\ub85c \uad6c\ubd84\ub41c \ubb38\uc790\uc5f4\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8:"})," \uc870\uc9c1 \uc218\uc900\uc758 API \ub9ac\uc18c\uc2a4\ub97c \ubcf4\ud638\ud558\ub294 \uacbd\uc6b0, ",(0,r.jsx)(n.code,{children:"organization_id"})," \ud074\ub808\uc784\uc744 \uac80\uc99d\ud558\uc138\uc694."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["JWT \uad6c\uc870\uc640 \ud074\ub808\uc784\uc5d0 \ub300\ud574 \ub354 \uc54c\uc544\ubcf4\ub824\uba74 ",(0,r.jsx)(n.a,{href:"https://auth.wiki/jwt",children:"JSON Web Token"})," \uc744 \ucc38\uace0\ud558\uc138\uc694."]}),"\n",(0,r.jsx)(n.h3,{id:"what-to-check-for-each-permission-model",children:"\uac01 \uad8c\ud55c \ubaa8\ub378\ubcc4\ub85c \ud655\uc778\ud574\uc57c \ud560 \uc0ac\ud56d"}),"\n",(0,r.jsx)(n.p,{children:"\ud074\ub808\uc784\uacfc \uac80\uc99d \uaddc\uce59\uc740 \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \ub2e4\ub985\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(i.A,{groupId:"permission-models",children:[(0,r.jsx)(a.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Audience \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"aud"}),"):"]})," API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Organization \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"organization_id"}),"):"]})," ",(0,r.jsx)(n.em,{children:"\uc5c6\uc74c"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["\ud655\uc778\ud560 \uc2a4\ucf54\ud504(\uad8c\ud55c) (",(0,r.jsx)(n.code,{children:"scope"}),"):"]})," API \ub9ac\uc18c\uc2a4 \uad8c\ud55c"]}),"\n"]})}),(0,r.jsx)(a.A,{value:"organization-permissions",label:"\uc870\uc9c1(\ube44-API) \uad8c\ud55c",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Audience \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"aud"}),"):"]})," ",(0,r.jsx)(n.code,{children:"urn:logto:organization:<id>"})," (\uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8\uac00 ",(0,r.jsx)(n.code,{children:"aud"})," \ud074\ub808\uc784\uc5d0 \uc788\uc74c)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Organization \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"organization_id"}),"):"]})," ",(0,r.jsx)(n.em,{children:"\uc5c6\uc74c"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["\ud655\uc778\ud560 \uc2a4\ucf54\ud504(\uad8c\ud55c) (",(0,r.jsx)(n.code,{children:"scope"}),"):"]})," \uc870\uc9c1 \uad8c\ud55c"]}),"\n"]})}),(0,r.jsx)(a.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Audience \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"aud"}),"):"]})," API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Organization \ud074\ub808\uc784 (",(0,r.jsx)(n.code,{children:"organization_id"}),"):"]})," \uc870\uc9c1 ID(\uc694\uccad\uacfc \uc77c\uce58\ud574\uc57c \ud568)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["\ud655\uc778\ud560 \uc2a4\ucf54\ud504(\uad8c\ud55c) (",(0,r.jsx)(n.code,{children:"scope"}),"):"]})," API \ub9ac\uc18c\uc2a4 \uad8c\ud55c"]}),"\n"]})})]}),"\n",(0,r.jsx)("small",{children:(0,r.jsxs)(n.p,{children:["\ube44-API \uc870\uc9c1 \uad8c\ud55c\uc758 \uacbd\uc6b0, \uc870\uc9c1 \ucee8\ud14d\uc2a4\ud2b8\ub294 ",(0,r.jsx)(n.code,{children:"aud"})," \ud074\ub808\uc784(\uc608: ",(0,r.jsx)(n.code,{children:"urn:logto:organization:abc123"}),")\uc73c\ub85c\n\ud45c\ud604\ub429\ub2c8\ub2e4. ",(0,r.jsx)(n.code,{children:"organization_id"})," \ud074\ub808\uc784\uc740 \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4 \ud1a0\ud070\uc5d0\ub9cc \uc874\uc7ac\ud569\ub2c8\ub2e4."]})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"\uc548\uc804\ud55c \uba40\ud2f0 \ud14c\ub10c\ud2b8 API\ub97c \uc704\ud574 \ud56d\uc0c1 \uad8c\ud55c(\uc2a4\ucf54\ud504)\uacfc \ucee8\ud14d\uc2a4\ud2b8(\ub300\uc0c1, \uc870\uc9c1)\ub97c \ubaa8\ub450 \uac80\uc99d\ud558\uc138\uc694."})})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},2740:(e,n,t)=>{t.d(n,{Ay:()=>m,RM:()=>h});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'import (\n    "context"\n    "encoding/json"\n    "net/http"\n)\n\ntype contextKey string\n\nconst AuthContextKey contextKey = "auth"\n\nfunc VerifyAccessToken(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        tokenString, err := extractBearerTokenFromHeaders(r)\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            w.Header().Set("Content-Type", "application/json")\n            w.WriteHeader(authErr.Status)\n            json.NewEncoder(w).Encode(map[string]string{"error": authErr.Message})\n            return\n        }\n\n        token, err := validateJWT(tokenString)\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            w.Header().Set("Content-Type", "application/json")\n            w.WriteHeader(authErr.Status)\n            json.NewEncoder(w).Encode(map[string]string{"error": authErr.Message})\n            return\n        }\n\n        // \ud1a0\ud070\uc744 \ucee8\ud14d\uc2a4\ud2b8\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n        ctx := context.WithValue(r.Context(), AuthContextKey, token)\n        next.ServeHTTP(w, r.WithContext(ctx))\n    })\n}\n'})})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'import "github.com/labstack/echo/v4"\n\nfunc VerifyAccessToken(next echo.HandlerFunc) echo.HandlerFunc {\n    return func(c echo.Context) error {\n        tokenString, err := extractBearerTokenFromHeaders(c.Request())\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            return c.JSON(authErr.Status, echo.Map{"error": authErr.Message})\n        }\n\n        token, err := validateJWT(tokenString)\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            return c.JSON(authErr.Status, echo.Map{"error": authErr.Message})\n        }\n\n        // \ud1a0\ud070\uc744 \ucee8\ud14d\uc2a4\ud2b8\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n        c.Set("auth", token)\n        return next(c)\n    }\n}\n'})})}function u(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'import (\n    "net/http"\n    "github.com/gofiber/fiber/v2"\n)\n\nfunc VerifyAccessToken(c *fiber.Ctx) error {\n    // fiber \uc694\uccad\uc744 http.Request\ub85c \ubcc0\ud658\ud558\uc5ec \ud638\ud658\uc131 \ud655\ubcf4\n    req := &http.Request{\n        Header: make(http.Header),\n    }\n    req.Header.Set("Authorization", c.Get("Authorization"))\n\n    tokenString, err := extractBearerTokenFromHeaders(req)\n    if err != nil {\n        authErr := err.(*AuthorizationError)\n        return c.Status(authErr.Status).JSON(fiber.Map{"error": authErr.Message})\n    }\n\n    token, err := validateJWT(tokenString)\n    if err != nil {\n        authErr := err.(*AuthorizationError)\n        return c.Status(authErr.Status).JSON(fiber.Map{"error": authErr.Message})\n    }\n\n    // \ud1a0\ud070\uc744 locals\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n    c.Locals("auth", token)\n    return c.Next()\n}\n'})})}function d(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'import "github.com/gin-gonic/gin"\n\nfunc VerifyAccessToken() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        tokenString, err := extractBearerTokenFromHeaders(c.Request)\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            c.JSON(authErr.Status, gin.H{"error": authErr.Message})\n            c.Abort()\n            return\n        }\n\n        token, err := validateJWT(tokenString)\n        if err != nil {\n            authErr := err.(*AuthorizationError)\n            c.JSON(authErr.Status, gin.H{"error": authErr.Message})\n            c.Abort()\n            return\n        }\n\n        // \ud1a0\ud070\uc744 \ucee8\ud14d\uc2a4\ud2b8\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n        c.Set("auth", token)\n        c.Next()\n    }\n}\n'})})}const p=Object.freeze({gin:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}),{}),fiber:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),echo:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{}),chi:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{})}),h=[];function g(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc6b0\ub9ac\ub294 ",(0,r.jsx)(n.a,{href:"https://github.com/lestrrat-go/jwx",children:"github.com/lestrrat-go/jwx"})," \ub97c \uc0ac\uc6a9\ud558\uc5ec JWT \ub97c \uac80\uc99d\ud569\ub2c8\ub2e4. \uc544\uc9c1 \uc124\uce58\ud558\uc9c0 \uc54a\uc558\ub2e4\uba74 \uc124\uce58\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"go mod init your-project\ngo get github.com/lestrrat-go/jwx/v3\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\uba3c\uc800, \ub2e4\uc74c\uc758 \uacf5\ud1b5 \ucef4\ud3ec\ub10c\ud2b8\ub97c ",(0,r.jsx)(n.code,{children:"auth_middleware.go"})," \uc5d0 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'import (\n    "context"\n    "strings"\n    "time"\n\n    "github.com/lestrrat-go/jwx/v3/jwk"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nvar jwkSet jwk.Set\n\nfunc init() {\n    // JWKS \uce90\uc2dc \ucd08\uae30\ud654\n    ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n    defer cancel()\n\n    var err error\n    jwkSet, err = jwk.Fetch(ctx, JWKS_URI)\n    if err != nil {\n        panic("Failed to fetch JWKS: " + err.Error())\n    }\n}\n\n// validateJWT \ub294 JWT \ub97c \uac80\uc99d\ud558\uace0 \ud30c\uc2f1\ub41c \ud1a0\ud070\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4\nfunc validateJWT(tokenString string) (jwt.Token, error) {\n    token, err := jwt.Parse([]byte(tokenString), jwt.WithKeySet(jwkSet))\n    if err != nil {\n        return nil, NewAuthorizationError("Invalid token: "+err.Error(), http.StatusUnauthorized)\n    }\n\n    // \ubc1c\uae09\uc790(issuer) \uac80\uc99d\n    if token.Issuer() != ISSUER {\n        return nil, NewAuthorizationError("Invalid issuer", http.StatusUnauthorized)\n    }\n\n    if err := verifyPayload(token); err != nil {\n        return nil, err\n    }\n\n    return token, nil\n}\n\n// \ud1a0\ud070 \ub370\uc774\ud130 \ucd94\ucd9c\uc744 \uc704\ud55c \ud5ec\ud37c \ud568\uc218\nfunc getStringClaim(token jwt.Token, key string) string {\n    if val, ok := token.Get(key); ok {\n        if str, ok := val.(string); ok {\n            return str\n        }\n    }\n    return ""\n}\n\nfunc getScopesFromToken(token jwt.Token) []string {\n    if val, ok := token.Get("scope"); ok {\n        if scope, ok := val.(string); ok && scope != "" {\n            return strings.Split(scope, " ")\n        }\n    }\n    return []string{}\n}\n\nfunc getAudienceFromToken(token jwt.Token) []string {\n    return token.Audience()\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc744 \uac80\uc99d\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?p[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(p).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c (Permission) \ubaa8\ub378\uc5d0 \ub530\ub77c, \uc11c\ub85c \ub2e4\ub978 ",(0,r.jsx)(n.code,{children:"verifyPayload"})," \ub85c\uc9c1\uc744 \uc801\uc6a9\ud574\uc57c \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'func verifyPayload(token jwt.Token) error {\n    // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    if !hasAudience(token, "https://your-api-resource-indicator") {\n        return NewAuthorizationError("Invalid audience")\n    }\n\n    // \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    requiredScopes := []string{"api:read", "api:write"} // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    if !hasRequiredScopes(token, requiredScopes) {\n        return NewAuthorizationError("Insufficient scope")\n    }\n\n    return nil\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (Organization) (\ube44 API) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'func verifyPayload(token jwt.Token) error {\n    // audience \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud3ec\ub9f7\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    if !hasOrganizationAudience(token) {\n        return NewAuthorizationError("Invalid audience for organization permissions")\n    }\n\n    // \uc870\uc9c1 ID \uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    expectedOrgID := "your-organization-id" // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    if !hasMatchingOrganization(token, expectedOrgID) {\n        return NewAuthorizationError("Organization ID mismatch")\n    }\n\n    // \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 \ud655\uc778\n    requiredScopes := []string{"invite:users", "manage:settings"} // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    if !hasRequiredScopes(token, requiredScopes) {\n        return NewAuthorizationError("Insufficient organization scope")\n    }\n\n    return nil\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'func verifyPayload(token jwt.Token) error {\n    // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    if !hasAudience(token, "https://your-api-resource-indicator") {\n        return NewAuthorizationError("Invalid audience for organization-level API resources")\n    }\n\n    // \uc870\uc9c1 ID \uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    expectedOrgID := "your-organization-id" // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    if !hasMatchingOrganizationID(token, expectedOrgID) {\n        return NewAuthorizationError("Organization ID mismatch")\n    }\n\n    // \uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    requiredScopes := []string{"api:read", "api:write"} // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    if !hasRequiredScopes(token, requiredScopes) {\n        return NewAuthorizationError("Insufficient organization-level API scopes")\n    }\n\n    return nil\n}\n'})})})]}),"\n",(0,r.jsx)(n.p,{children:"\ud398\uc774\ub85c\ub4dc \uac80\uc99d\uc744 \uc704\ud55c \ub2e4\uc74c \ud5ec\ud37c \ud568\uc218\ub4e4\uc744 \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'// hasAudience \ub294 \ud1a0\ud070\uc774 \uc9c0\uc815\ub41c audience \ub97c \uac00\uc9c0\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4\nfunc hasAudience(token jwt.Token, expectedAud string) bool {\n    audiences := token.Audience()\n    for _, aud := range audiences {\n        if aud == expectedAud {\n            return true\n        }\n    }\n    return false\n}\n\n// hasOrganizationAudience \ub294 \ud1a0\ud070\uc774 \uc870\uc9c1 audience \ud3ec\ub9f7\uc744 \uac00\uc9c0\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4\nfunc hasOrganizationAudience(token jwt.Token) bool {\n    audiences := token.Audience()\n    for _, aud := range audiences {\n        if strings.HasPrefix(aud, "urn:logto:organization:") {\n            return true\n        }\n    }\n    return false\n}\n\n// hasRequiredScopes \ub294 \ud1a0\ud070\uc774 \ubaa8\ub4e0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub97c \uac00\uc9c0\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4\nfunc hasRequiredScopes(token jwt.Token, requiredScopes []string) bool {\n    scopes := getScopesFromToken(token)\n    for _, required := range requiredScopes {\n        found := false\n        for _, scope := range scopes {\n            if scope == required {\n                found = true\n                break\n            }\n        }\n        if !found {\n            return false\n        }\n    }\n    return true\n}\n\n// hasMatchingOrganization \ub294 \ud1a0\ud070 audience \uac00 \uae30\ub300\ud558\ub294 \uc870\uc9c1\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4\nfunc hasMatchingOrganization(token jwt.Token, expectedOrgID string) bool {\n    expectedAud := fmt.Sprintf("urn:logto:organization:%s", expectedOrgID)\n    return hasAudience(token, expectedAud)\n}\n\n// hasMatchingOrganizationID \ub294 \ud1a0\ud070\uc758 organization_id \uac00 \uae30\ub300\ud558\ub294 \uac12\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4\nfunc hasMatchingOrganizationID(token jwt.Token, expectedOrgID string) bool {\n    orgID := getStringClaim(token, "organization_id")\n    return orgID == expectedOrgID\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},24514:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="auth_middleware.go"',children:'package main\n\nimport (\n    "fmt"\n    "net/http"\n    "strings"\n)\n\nconst (\n    JWKS_URI = "https://your-tenant.logto.app/oidc/jwks"\n    ISSUER   = "https://your-tenant.logto.app/oidc"\n)\n\ntype AuthorizationError struct {\n    Message string\n    Status  int\n}\n\nfunc (e *AuthorizationError) Error() string {\n    return e.Message\n}\n\nfunc NewAuthorizationError(message string, status ...int) *AuthorizationError {\n    statusCode := http.StatusForbidden // \uae30\ubcf8\uac12\uc740 403 Forbidden\n    if len(status) > 0 {\n        statusCode = status[0]\n    }\n    return &AuthorizationError{\n        Message: message,\n        Status:  statusCode,\n    }\n}\n\nfunc extractBearerTokenFromHeaders(r *http.Request) (string, error) {\n    const bearerPrefix = "Bearer "\n\n    authorization := r.Header.Get("Authorization")\n    if authorization == "" {\n        return "", NewAuthorizationError("Authorization \ud5e4\ub354\uac00 \uc5c6\uc2b5\ub2c8\ub2e4", http.StatusUnauthorized)\n    }\n\n    if !strings.HasPrefix(authorization, bearerPrefix) {\n        return "", NewAuthorizationError(fmt.Sprintf("Authorization \ud5e4\ub354\ub294 \\"%s\\"\ub85c \uc2dc\uc791\ud574\uc57c \ud569\ub2c8\ub2e4", bearerPrefix), http.StatusUnauthorized)\n    }\n\n    return strings.TrimPrefix(authorization, bearerPrefix), nil\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},31904:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "encoding/json"\n    "net/http"\n\n    "github.com/go-chi/chi/v5"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    r := chi.NewRouter()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\n    r.With(VerifyAccessToken).Get("/api/protected", func(w http.ResponseWriter, r *http.Request) {\n        // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc815\ubcf4 \uc9c1\uc811 \uac00\uc838\uc624\uae30\n        tokenInterface := r.Context().Value(AuthContextKey)\n        if tokenInterface == nil {\n            w.Header().Set("Content-Type", "application/json")\n            w.WriteHeader(http.StatusInternalServerError)\n            json.NewEncoder(w).Encode(map[string]string{"error": "Token not found"})\n            return\n        }\n\n        token := tokenInterface.(jwt.Token)\n\n        w.Header().Set("Content-Type", "application/json")\n        json.NewEncoder(w).Encode(map[string]interface{}{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n        })\n    })\n\n    http.ListenAndServe(":8080", r)\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub610\ub294 \ub77c\uc6b0\ud2b8 \uadf8\ub8f9\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "encoding/json"\n    "net/http"\n\n    "github.com/go-chi/chi/v5"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    r := chi.NewRouter()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8 \uadf8\ub8f9 \uc0dd\uc131\n    r.Route("/api", func(r chi.Router) {\n        r.Use(VerifyAccessToken)\n        r.Get("/protected", func(w http.ResponseWriter, r *http.Request) {\n            // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc815\ubcf4 \uc9c1\uc811 \uac00\uc838\uc624\uae30\n            token := r.Context().Value(AuthContextKey).(jwt.Token)\n\n            w.Header().Set("Content-Type", "application/json")\n            json.NewEncoder(w).Encode(map[string]interface{}{\n                "sub":             token.Subject(),\n                "client_id":       getStringClaim(token, "client_id"),\n                "organization_id": getStringClaim(token, "organization_id"),\n                "scopes":          getScopesFromToken(token),\n                "audience":        getAudienceFromToken(token),\n                "message":         "\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4",\n            })\n        })\n    })\n\n    http.ListenAndServe(":8080", r)\n}\n'})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},60431:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "net/http"\n\n    "github.com/labstack/echo/v4"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    e := echo.New()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\n    e.GET("/api/protected", func(c echo.Context) error {\n        // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070(Access token) \uc815\ubcf4\uc5d0 \uc9c1\uc811 \uc811\uadfc\n        tokenInterface := c.Get("auth")\n        if tokenInterface == nil {\n            return c.JSON(http.StatusInternalServerError, echo.Map{"error": "Token not found"})\n        }\n\n        token := tokenInterface.(jwt.Token)\n\n        return c.JSON(http.StatusOK, echo.Map{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n        })\n    }, VerifyAccessToken)\n\n    e.Start(":8080")\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub610\ub294 \ub77c\uc6b0\ud2b8 \uadf8\ub8f9\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "github.com/labstack/echo/v4"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    e := echo.New()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8 \uadf8\ub8f9 \uc0dd\uc131\n    api := e.Group("/api", VerifyAccessToken)\n    api.GET("/protected", func(c echo.Context) error {\n        // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070(Access token) \uc815\ubcf4\uc5d0 \uc9c1\uc811 \uc811\uadfc\n        token := c.Get("auth").(jwt.Token)\n\n        return c.JSON(200, echo.Map{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n            "message":         "\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4",\n        })\n    })\n\n    e.Start(":8080")\n}\n'})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},53972:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v2"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    app := fiber.New()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\n    app.Get("/api/protected", VerifyAccessToken, func(c *fiber.Ctx) error {\n        // locals\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070(Access token) \uc815\ubcf4\ub97c \uc9c1\uc811 \uac00\uc838\uc635\ub2c8\ub2e4\n        tokenInterface := c.Locals("auth")\n        if tokenInterface == nil {\n            return c.Status(fiber.StatusInternalServerError).JSON(fiber.Map{"error": "Token not found"})\n        }\n\n        token := tokenInterface.(jwt.Token)\n\n        return c.JSON(fiber.Map{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n        })\n    })\n\n    app.Listen(":8080")\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub610\ub294 \ub77c\uc6b0\ud2b8 \uadf8\ub8f9\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v2"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    app := fiber.New()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8 \uadf8\ub8f9 \uc0dd\uc131\n    api := app.Group("/api", VerifyAccessToken)\n    api.Get("/protected", func(c *fiber.Ctx) error {\n        // locals\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070(Access token) \uc815\ubcf4\ub97c \uc9c1\uc811 \uac00\uc838\uc635\ub2c8\ub2e4\n        token := c.Locals("auth").(jwt.Token)\n\n        return c.JSON(fiber.Map{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n            "message":         "\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4",\n        })\n    })\n\n    app.Listen(":8080")\n}\n'})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},39132:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "net/http"\n\n    "github.com/gin-gonic/gin"\n    "github.com/lestrrat-go/jwx/v3/jwt"\n)\n\nfunc main() {\n    r := gin.Default()\n\n    // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\n    r.GET("/api/protected", VerifyAccessToken(), func(c *gin.Context) {\n        // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc815\ubcf4\ub97c \uc9c1\uc811 \uac00\uc838\uc624\uae30\n        tokenInterface, exists := c.Get("auth")\n        if !exists {\n            c.JSON(http.StatusInternalServerError, gin.H{"error": "\ud1a0\ud070\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4 (Token not found)"})\n            return\n        }\n\n        token := tokenInterface.(jwt.Token)\n\n        c.JSON(http.StatusOK, gin.H{\n            "sub":             token.Subject(),\n            "client_id":       getStringClaim(token, "client_id"),\n            "organization_id": getStringClaim(token, "organization_id"),\n            "scopes":          getScopesFromToken(token),\n            "audience":        getAudienceFromToken(token),\n        })\n    })\n\n    r.Run(":8080")\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},65830:(e,n,t)=>{t.d(n,{Ay:()=>m,RM:()=>h});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"pom.xml"}),"\uc5d0 \ub2e4\uc74c\uc744 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.micronaut.security</groupId>\n    <artifactId>micronaut-security-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.micronaut</groupId>\n    <artifactId>micronaut-http-server-netty</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="application.yml"',children:"micronaut:\n  security:\n    authentication: bearer\n    token:\n      jwt:\n        signatures:\n          jwks:\n            logto:\n              url: ${JWKS_URI:https://your-tenant.logto.app/oidc/jwks}\n        claims-validators:\n          issuer: ${JWT_ISSUER:https://your-tenant.logto.app/oidc}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="JwtClaimsValidator.java"',children:'import io.micronaut.security.token.Claims;\nimport io.micronaut.security.token.validator.TokenValidator;\nimport jakarta.inject.Singleton;\nimport org.reactivestreams.Publisher;\nimport reactor.core.publisher.Mono;\nimport java.util.Arrays;\nimport java.util.List;\n\n@Singleton\npublic class JwtClaimsValidator implements TokenValidator {\n\n    @Override\n    public Publisher<Boolean> validateToken(String token, Claims claims) {\n        try {\n            verifyPayload(claims);\n            return Mono.just(true);\n        } catch (AuthorizationException e) {\n            // Micronaut\uac00 \uc0c1\ud0dc \ucf54\ub4dc\ub97c \uc801\uc808\ud558\uac8c \ucc98\ub9ac\ud569\ub2c8\ub2e4\n            return Mono.just(false);\n        }\n    }\n\n    private void verifyPayload(Claims claims) {\n        // \ubc1c\uae09\uc790(issuer) \uac80\uc99d\uc740 Micronaut JWT \uc124\uc815\uc5d0 \uc758\ud574 \uc790\ub3d9\uc73c\ub85c \ucc98\ub9ac\ub429\ub2c8\ub2e4\n        // \uad8c\ud55c(permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \ucd94\uac00 \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n        // \uc544\ub798\uc758 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud074\ub808\uc784(claim) \ucd94\ucd9c\n\n        // \uc608\uc2dc: throw new AuthorizationException("Insufficient permissions");\n    }\n\n    // Micronaut JWT\ub97c \uc704\ud55c \ud5ec\ud37c \uba54\uc11c\ub4dc\n    @SuppressWarnings("unchecked")\n    private List<String> extractAudiences(Claims claims) {\n        Object aud = claims.get("aud");\n        if (aud instanceof List) {\n            return (List<String>) aud;\n        } else if (aud instanceof String) {\n            return Arrays.asList((String) aud);\n        }\n        return List.of();\n    }\n\n    private String extractScopes(Claims claims) {\n        return (String) claims.get("scope");\n    }\n\n    private String extractOrganizationId(Claims claims) {\n        return (String) claims.get("organization_id");\n    }\n}\n'})})]})}function l(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"pom.xml"}),"\uc5d0 \ub2e4\uc74c\uc744 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.quarkus</groupId>\n    <artifactId>quarkus-smallrye-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.quarkus</groupId>\n    <artifactId>quarkus-resteasy-reactive</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"# JWT \uad6c\uc131\nmp.jwt.verify.publickey.location=${JWKS_URI:https://your-tenant.logto.app/oidc/jwks}\nmp.jwt.verify.issuer=${JWT_ISSUER:https://your-tenant.logto.app/oidc}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="JwtVerificationFilter.java"',children:'import org.eclipse.microprofile.jwt.JsonWebToken;\nimport jakarta.enterprise.context.ApplicationScoped;\nimport jakarta.inject.Inject;\nimport jakarta.ws.rs.container.ContainerRequestContext;\nimport jakarta.ws.rs.container.ContainerRequestFilter;\nimport jakarta.ws.rs.core.Response;\nimport jakarta.ws.rs.ext.Provider;\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Provider\n@ApplicationScoped\npublic class JwtVerificationFilter implements ContainerRequestFilter {\n\n    @Inject\n    JsonWebToken jwt;\n\n    @Override\n    public void filter(ContainerRequestContext requestContext) {\n        if (requestContext.getUriInfo().getPath().startsWith("/api/protected")) {\n            try {\n                verifyPayload(jwt);\n                requestContext.setProperty("auth", jwt);\n            } catch (AuthorizationException e) {\n                requestContext.abortWith(\n                    Response.status(e.getStatusCode())\n                        .entity("{\\"error\\": \\"" + e.getMessage() + "\\"}")\n                        .build()\n                );\n            } catch (Exception e) {\n                requestContext.abortWith(\n                    Response.status(401)\n                        .entity("{\\"error\\": \\"Invalid token\\"}")\n                        .build()\n                );\n            }\n        }\n    }\n\n    private void verifyPayload(JsonWebToken jwt) {\n        // \ubc1c\uae09\uc790(issuer) \uac80\uc99d\uc740 Quarkus JWT \ud655\uc7a5 \uae30\ub2a5\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \ucc98\ub9ac\ub429\ub2c8\ub2e4\n        // \uad8c\ud55c(permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \ucd94\uac00 \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n        // \uc544\ub798\uc758 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud074\ub808\uc784(claim) \ucd94\ucd9c\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4\n    }\n\n    // Quarkus JWT\ub97c \uc704\ud55c \ud5ec\ud37c \uba54\uc11c\ub4dc\n    private List<String> extractAudiences(JsonWebToken jwt) {\n        return new ArrayList<>(jwt.getAudience());\n    }\n\n    private String extractScopes(JsonWebToken jwt) {\n        return jwt.getClaim("scope");\n    }\n\n    private String extractOrganizationId(JsonWebToken jwt) {\n        return jwt.getClaim("organization_id");\n    }\n}\n'})})]})}function u(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"pom.xml"}),"\uc5d0 \ub2e4\uc74c\uc744 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-security</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-oauth2-resource-server</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-oauth2-jose</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="JwtSecurityConfig.java"',children:'import org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\n@EnableWebSecurity\npublic class JwtSecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeHttpRequests(authz -> authz\n                .requestMatchers("/api/protected/**").authenticated()\n                .anyRequest().permitAll()\n            )\n            .oauth2ResourceServer(oauth2 -> oauth2\n                .jwt(jwt -> jwt.decoder(jwtDecoder()))\n            );\n        return http.build();\n    }\n\n    @Bean\n    public JwtDecoder jwtDecoder() {\n        // \ubc30\ud3ec \ud658\uacbd\uc5d0\uc11c \uc774 \ud658\uacbd \ubcc0\uc218\ub4e4\uc744 \ubc18\ub4dc\uc2dc \uc124\uc815\ud558\uc138\uc694\n        String jwksUri = System.getenv("JWKS_URI");\n        String issuer = System.getenv("JWT_ISSUER");\n\n        return NimbusJwtDecoder.withJwkSetUri(jwksUri)\n            .issuer(issuer)\n            .build();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="JwtValidator.java"',children:'import org.springframework.security.oauth2.jwt.Jwt;\nimport org.springframework.stereotype.Component;\nimport java.util.List;\n\n@Component\npublic class JwtValidator {\n\n    public void verifyPayload(Jwt jwt) {\n        // \ubc1c\uae09\uc790 (Issuer) \uac80\uc99d\uc740 Spring Security JWT \ub514\ucf54\ub354\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \ucc98\ub9ac\ub429\ub2c8\ub2e4\n        // \uad8c\ud55c (Permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \ucd94\uac00 \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n        // \uc544\ub798\uc758 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud074\ub808\uc784 (Claim)\uc744 \ucd94\ucd9c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n\n        // \uc608\uc2dc: throw new AuthorizationException("Insufficient permissions");\n        // \uc0c1\ud0dc \ucf54\ub4dc\ub294 Spring Security\uc758 \uc608\uc678 \ucc98\ub9ac\uc5d0\uc11c \ucc98\ub9ac\ub429\ub2c8\ub2e4\n    }\n\n    // Spring Boot JWT\ub97c \uc704\ud55c \ud5ec\ud37c \uba54\uc11c\ub4dc\n    private List<String> extractAudiences(Jwt jwt) {\n        return jwt.getAudience();\n    }\n\n    private String extractScopes(Jwt jwt) {\n        return jwt.getClaimAsString("scope");\n    }\n\n    private String extractOrganizationId(Jwt jwt) {\n        return jwt.getClaimAsString("organization_id");\n    }\n}\n'})})]})}function d(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"pom.xml"}),"\uc5d0 \ub2e4\uc74c\uc744 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-web</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-auth-jwt</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.vertx</groupId>\n    <artifactId>vertx-web-client</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="JwtAuthHandler.java"',children:'import io.vertx.core.Future;\nimport io.vertx.core.Handler;\nimport io.vertx.core.Vertx;\nimport io.vertx.core.json.JsonArray;\nimport io.vertx.core.json.JsonObject;\nimport io.vertx.ext.auth.jwt.JWTAuth;\nimport io.vertx.ext.auth.jwt.JWTAuthOptions;\nimport io.vertx.ext.web.RoutingContext;\nimport io.vertx.ext.web.client.WebClient;\nimport java.util.List;\nimport java.util.ArrayList;\n\npublic class JwtAuthHandler implements Handler<RoutingContext> {\n\n    private final JWTAuth jwtAuth;\n    private final WebClient webClient;\n    private final String expectedIssuer;\n    private final String jwksUri;\n\n    public JwtAuthHandler(Vertx vertx) {\n        this.webClient = WebClient.create(vertx);\n        this.jwtAuth = JWTAuth.create(vertx, new JWTAuthOptions());\n\n        // \ubc30\ud3ec \ud658\uacbd\uc5d0\uc11c \ubc18\ub4dc\uc2dc \uc774 \ud658\uacbd \ubcc0\uc218\ub4e4\uc744 \uc124\uc815\ud558\uc138\uc694\n        this.expectedIssuer = System.getenv("JWT_ISSUER");\n        this.jwksUri = System.getenv("JWKS_URI");\n\n        // JWKS\ub97c \uac00\uc838\uc640 JWT \uc778\uc99d\uc744 \uad6c\uc131\ud569\ub2c8\ub2e4\n        fetchJWKS().onSuccess(jwks -> {\n            // JWKS \uad6c\uc131 (\ub2e8\uc21c\ud654\ub428 - \uc2e4\uc81c\ub85c\ub294 \uc801\uc808\ud55c JWKS \ud30c\uc11c\uac00 \ud544\uc694\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4)\n        });\n    }\n\n    @Override\n    public void handle(RoutingContext context) {\n        String authHeader = context.request().getHeader("Authorization");\n        if (authHeader == null || !authHeader.startsWith("Bearer ")) {\n            context.response()\n                .setStatusCode(401)\n                .putHeader("Content-Type", "application/json")\n                .end("{\\"error\\": \\"Authorization header missing or invalid\\"}");\n            return;\n        }\n\n        String token = authHeader.substring(7);\n        jwtAuth.authenticate(new JsonObject().put("jwt", token))\n            .onSuccess(user -> {\n                try {\n                    JsonObject principal = user.principal();\n                    verifyPayload(principal);\n                    context.put("auth", principal);\n                    context.next();\n                } catch (AuthorizationException e) {\n                    context.response()\n                        .setStatusCode(e.getStatusCode())  // \uc608\uc678\uc758 \uc0c1\ud0dc \ucf54\ub4dc\ub97c \uc0ac\uc6a9\n                        .putHeader("Content-Type", "application/json")\n                        .end("{\\"error\\": \\"" + e.getMessage() + "\\"}");\n                } catch (Exception e) {\n                    context.response()\n                        .setStatusCode(401)\n                        .putHeader("Content-Type", "application/json")\n                        .end("{\\"error\\": \\"Invalid token\\"}");\n                }\n            })\n            .onFailure(err -> {\n                context.response()\n                    .setStatusCode(401)\n                    .putHeader("Content-Type", "application/json")\n                    .end("{\\"error\\": \\"Invalid token: " + err.getMessage() + "\\"}");\n            });\n    }\n\n    private Future<JsonObject> fetchJWKS() {\n        return webClient.getAbs(this.jwksUri)\n            .send()\n            .map(response -> response.bodyAsJsonObject());\n    }\n\n    private void verifyPayload(JsonObject principal) {\n        // Vert.x\uc5d0\uc11c \ubc1c\uae09\uc790(issuer)\ub97c \uc218\ub3d9\uc73c\ub85c \uac80\uc99d\n        String issuer = principal.getString("iss");\n        if (issuer == null || !expectedIssuer.equals(issuer)) {\n            throw new AuthorizationException("Invalid issuer: " + issuer);\n        }\n\n        // \uad8c\ud55c(permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \ucd94\uac00 \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n        // \uc544\ub798\uc758 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub85c \ud074\ub808\uc784 (Claim) \ucd94\ucd9c \uac00\ub2a5\n    }\n\n    // Vert.x JWT\ub97c \uc704\ud55c \ud5ec\ud37c \uba54\uc11c\ub4dc\n    private List<String> extractAudiences(JsonObject principal) {\n        JsonArray audiences = principal.getJsonArray("aud");\n        if (audiences != null) {\n            List<String> result = new ArrayList<>();\n            for (Object aud : audiences) {\n                result.add(aud.toString());\n            }\n            return result;\n        }\n        return List.of();\n    }\n\n    private String extractScopes(JsonObject principal) {\n        return principal.getString("scope");\n    }\n\n    private String extractOrganizationId(JsonObject principal) {\n        return principal.getString("organization_id");\n    }\n}\n'})})]})}const p=Object.freeze({"spring-boot":(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),quarkus:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{}),micronaut:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{}),"vertx-web":(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}),{})}),h=[];function g(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\ud504\ub808\uc784\uc6cc\ud06c\uc5d0 \ub530\ub77c \uc11c\ub85c \ub2e4\ub978 JWT \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \ud544\uc694\ud55c \uc885\uc18d\uc131\uc744 \uc124\uce58\ud558\uc138\uc694:"}),"\n",e.framework?p[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(p).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsx)(n.p,{children:"\uad8c\ud55c (Permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\nList<String> audiences = extractAudiences(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nif (!audiences.contains("https://your-api-resource-indicator")) {\n    throw new AuthorizationException("Invalid audience");\n}\n\n// \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\nList<String> requiredScopes = Arrays.asList("api:read", "api:write"); // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\nString scopes = extractScopes(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Insufficient scope");\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (Organization) (\ube44-API) \uad8c\ud55c (Permissions)",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// audience \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\nList<String> audiences = extractAudiences(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nboolean hasOrgAudience = audiences.stream()\n    .anyMatch(aud -> aud.startsWith("urn:logto:organization:"));\n\nif (!hasOrgAudience) {\n    throw new AuthorizationException("Invalid audience for organization permissions");\n}\n\n// \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\nString expectedOrgId = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\nString expectedAud = "urn:logto:organization:" + expectedOrgId;\nif (!audiences.contains(expectedAud)) {\n    throw new AuthorizationException("Organization ID mismatch");\n}\n\n// \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 \ud655\uc778\nList<String> requiredScopes = Arrays.asList("invite:users", "manage:settings"); // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\nString scopes = extractScopes(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Insufficient organization scope");\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\nList<String> audiences = extractAudiences(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nif (!audiences.contains("https://your-api-resource-indicator")) {\n    throw new AuthorizationException("Invalid audience for organization-level API resources");\n}\n\n// \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\nString expectedOrgId = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\nString orgId = extractOrganizationId(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nif (!expectedOrgId.equals(orgId)) {\n    throw new AuthorizationException("Organization ID mismatch");\n}\n\n// \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\nList<String> requiredScopes = Arrays.asList("api:read", "api:write"); // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\nString scopes = extractScopes(token); // \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \ucd94\ucd9c\nList<String> tokenScopes = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\nif (!tokenScopes.containsAll(requiredScopes)) {\n    throw new AuthorizationException("Insufficient organization-level API scopes");\n}\n'})})})]}),"\n",(0,r.jsx)(n.p,{children:"\ud074\ub808\uc784\uc744 \ucd94\ucd9c\ud558\ub294 \ud5ec\ud37c \uba54\uc11c\ub4dc\ub294 \ud504\ub808\uc784\uc6cc\ud06c\ubcc4\ub85c \ub2e4\ub985\ub2c8\ub2e4. \uc704\uc758 \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \uac80\uc99d \ud30c\uc77c\uc5d0\uc11c \uad6c\ud604 \uc138\ubd80 \uc815\ubcf4\ub97c \ud655\uc778\ud558\uc138\uc694."})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},95448:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="AuthorizationException.java"',children:"public class AuthorizationException extends RuntimeException {\n    private final int statusCode;\n\n    public AuthorizationException(String message) {\n        this(message, 403); // \uae30\ubcf8\uac12\uc740 403 \uae08\uc9c0(Forbidden)\n    }\n\n    public AuthorizationException(String message, int statusCode) {\n        super(message);\n        this.statusCode = statusCode;\n    }\n\n    public int getStatusCode() {\n        return statusCode;\n    }\n}\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},6960:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="ProtectedController.java"',children:'import io.micronaut.http.annotation.Controller;\nimport io.micronaut.http.annotation.Get;\nimport io.micronaut.security.annotation.Secured;\nimport io.micronaut.security.authentication.Authentication;\nimport io.micronaut.security.rules.SecurityRule;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\n\n@Controller("/api")\n@Secured(SecurityRule.IS_AUTHENTICATED)\npublic class ProtectedController {\n\n    @Get("/protected")\n    public Map<String, Object> protectedEndpoint(Authentication authentication) {\n        // \uc778\uc99d (Authentication)\uc5d0\uc11c \uc9c1\uc811 \uc561\uc138\uc2a4 \ud1a0\ud070 \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n        String scopes = (String) authentication.getAttributes().get("scope");\n        List<String> scopeList = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\n        return Map.of(\n            "sub", authentication.getName(),\n            "client_id", authentication.getAttributes().get("client_id"),\n            "organization_id", authentication.getAttributes().get("organization_id"),\n            "scopes", scopeList,\n            "audience", authentication.getAttributes().get("aud")\n        );\n    }\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},86126:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="ProtectedResource.java"',children:'import org.eclipse.microprofile.jwt.JsonWebToken;\nimport jakarta.inject.Inject;\nimport jakarta.ws.rs.GET;\nimport jakarta.ws.rs.Path;\nimport jakarta.ws.rs.Produces;\nimport jakarta.ws.rs.core.MediaType;\nimport jakarta.ws.rs.core.Context;\nimport jakarta.ws.rs.container.ContainerRequestContext;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\n\n@Path("/api")\npublic class ProtectedResource {\n\n    @Inject\n    JsonWebToken jwt;\n\n    @GET\n    @Path("/protected")\n    @Produces(MediaType.APPLICATION_JSON)\n    public Map<String, Object> protectedEndpoint(@Context ContainerRequestContext requestContext) {\n        // JWT\ub97c \uc778\uc81d\uc158 \ub610\ub294 \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \uc9c1\uc811 \uc811\uadfc\n        JsonWebToken token = (JsonWebToken) requestContext.getProperty("auth");\n        if (token == null) {\n            token = jwt; // \uc778\uc81d\uc158\ub41c JWT\ub85c \ub300\uccb4\n        }\n\n        String scopes = token.getClaim("scope");\n        List<String> scopeList = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\n        return Map.of(\n            "sub", token.getSubject(),\n            "client_id", token.<String>getClaim("client_id"),\n            "organization_id", token.<String>getClaim("organization_id"),\n            "scopes", scopeList,\n            "audience", token.getAudience()\n        );\n    }\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},62908:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="ProtectedController.java"',children:'import org.springframework.security.core.annotation.AuthenticationPrincipal;\nimport org.springframework.security.oauth2.jwt.Jwt;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\n\n@RestController\npublic class ProtectedController {\n\n    @GetMapping("/api/protected")\n    public Map<String, Object> protectedEndpoint(@AuthenticationPrincipal Jwt jwt) {\n        // JWT\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc815\ubcf4\ub97c \uc9c1\uc811 \uac00\uc838\uc635\ub2c8\ub2e4\n        String scopes = jwt.getClaimAsString("scope");\n        List<String> scopeList = scopes != null ? Arrays.asList(scopes.split(" ")) : List.of();\n\n        return Map.of(\n            "sub", jwt.getSubject(),\n            "client_id", jwt.getClaimAsString("client_id"),\n            "organization_id", jwt.getClaimAsString("organization_id"),\n            "scopes", scopeList,\n            "audience", jwt.getAudience()\n        );\n    }\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},81546:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="MainVerticle.java"',children:'import io.vertx.core.AbstractVerticle;\nimport io.vertx.core.Promise;\nimport io.vertx.core.json.JsonObject;\nimport io.vertx.ext.web.Router;\nimport io.vertx.ext.web.RoutingContext;\n\npublic class MainVerticle extends AbstractVerticle {\n\n    @Override\n    public void start(Promise<Void> startPromise) throws Exception {\n        Router router = Router.router(vertx);\n\n        // \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\n        router.route("/api/protected*").handler(new JwtAuthHandler(vertx));\n        router.get("/api/protected").handler(this::protectedEndpoint);\n\n        vertx.createHttpServer()\n            .requestHandler(router)\n            .listen(8080, result -> {\n                if (result.succeeded()) {\n                    startPromise.complete();\n                } else {\n                    startPromise.fail(result.cause());\n                }\n            });\n    }\n\n    private void protectedEndpoint(RoutingContext context) {\n        // \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c JWT principal\uc5d0 \uc9c1\uc811 \uc811\uadfc\n        JsonObject principal = context.get("auth");\n        if (principal == null) {\n            context.response()\n                .setStatusCode(500)\n                .putHeader("Content-Type", "application/json")\n                .end("{\\"error\\": \\"JWT principal not found\\"}");\n            return;\n        }\n\n        String scopes = principal.getString("scope");\n        JsonObject response = new JsonObject()\n            .put("sub", principal.getString("sub"))\n            .put("client_id", principal.getString("client_id"))\n            .put("organization_id", principal.getString("organization_id"))\n            .put("scopes", scopes != null ? scopes.split(" ") : new String[0])\n            .put("audience", principal.getJsonArray("aud"));\n\n        context.response()\n            .putHeader("Content-Type", "application/json")\n            .end(response.encode());\n    }\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},5540:(e,n,t)=>{t.d(n,{Ay:()=>x,RM:()=>g});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="auth-middleware.ts"',children:"import { Request, Response, NextFunction } from 'express';\nimport { validateJwt, createAuthInfo } from './jwt-validator.js';\n\n// Express Request \uc778\ud130\ud398\uc774\uc2a4\ub97c \ud655\uc7a5\ud558\uc5ec auth \ud3ec\ud568\ndeclare global {\n  namespace Express {\n    interface Request {\n      auth?: AuthInfo;\n    }\n  }\n}\n\nexport async function verifyAccessToken(req: Request, res: Response, next: NextFunction) {\n  try {\n    const token = extractBearerTokenFromHeaders(req.headers);\n    const payload = await validateJwt(token);\n\n    // \uc694\uccad\uc5d0 \uc778\uc99d \uc815\ubcf4 \uc800\uc7a5 (\ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9 \uac00\ub2a5)\n    req.auth = createAuthInfo(payload);\n\n    next();\n  } catch (err: any) {\n    return res.status(err.status ?? 401).json({ error: err.message });\n  }\n}\n"})})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="auth-middleware.ts"',children:"import { FastifyRequest, FastifyReply } from 'fastify';\nimport { validateJwt, createAuthInfo } from './jwt-validator.js';\n\n// Fastify Request \uc778\ud130\ud398\uc774\uc2a4\ub97c \ud655\uc7a5\ud558\uc5ec auth \ud3ec\ud568\ndeclare module 'fastify' {\n  interface FastifyRequest {\n    auth?: AuthInfo;\n  }\n}\n\nexport async function fastifyVerifyAccessToken(request: FastifyRequest, reply: FastifyReply) {\n  try {\n    const token = extractBearerTokenFromHeaders(request.headers);\n    const payload = await validateJwt(token);\n\n    // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c request\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n    request.auth = createAuthInfo(payload);\n  } catch (err: any) {\n    reply.code(err.status ?? 401).send({ error: err.message });\n  }\n}\n"})})}function u(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="auth-middleware.ts"',children:"import { Request, ResponseToolkit } from '@hapi/hapi';\nimport { validateJwt, createAuthInfo } from './jwt-validator.js';\n\nexport async function hapiVerifyAccessToken(request: Request, h: ResponseToolkit) {\n  try {\n    const token = extractBearerTokenFromHeaders(request.headers);\n    const payload = await validateJwt(token);\n\n    // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c request.app\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n    request.app.auth = createAuthInfo(payload);\n\n    return h.continue;\n  } catch (err: any) {\n    return h\n      .response({ error: err.message })\n      .code(err.status ?? 401)\n      .takeover();\n  }\n}\n"})})}function d(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="auth-middleware.ts"',children:"import { Context, Next } from 'koa';\nimport { validateJwt, createAuthInfo } from './jwt-validator.js';\n\n// \uc561\uc138\uc2a4 \ud1a0\ud070(Access token) \uac80\uc99d \ubbf8\ub4e4\uc6e8\uc5b4\nexport async function koaVerifyAccessToken(ctx: Context, next: Next) {\n  try {\n    const token = extractBearerTokenFromHeaders(ctx.request.headers);\n    const payload = await validateJwt(token);\n\n    // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c state\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n    ctx.state.auth = createAuthInfo(payload);\n\n    await next();\n  } catch (err: any) {\n    ctx.status = err.status ?? 401;\n    ctx.body = { error: err.message };\n  }\n}\n"})})}function p(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="access-token.guard.ts"',children:"import {\n  Injectable,\n  CanActivate,\n  ExecutionContext,\n  UnauthorizedException,\n  ForbiddenException,\n} from '@nestjs/common';\nimport { validateJwt, createAuthInfo } from './jwt-validator.js';\n\n@Injectable()\nexport class AccessTokenGuard implements CanActivate {\n  async canActivate(context: ExecutionContext): Promise<boolean> {\n    const req = context.switchToHttp().getRequest();\n\n    try {\n      const token = extractBearerTokenFromHeaders(req.headers);\n      const payload = await validateJwt(token);\n\n      // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c \uc694\uccad(request)\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n      req.auth = createAuthInfo(payload);\n\n      return true;\n    } catch (err: any) {\n      if (err.status === 401) throw new UnauthorizedException(err.message);\n      throw new ForbiddenException(err.message);\n    }\n  }\n}\n"})})}const h=Object.freeze({express:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{}),fastify:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{}),hapi:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),koa:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}),{}),nestjs:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}),{})}),g=[];function m(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc774 \uc608\uc81c\uc5d0\uc11c\ub294 JWT\ub97c \uac80\uc99d\ud558\uae30 \uc704\ud574 ",(0,r.jsx)(n.a,{href:"https://github.com/panva/jose",children:"jose"})," \ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \uc544\uc9c1 \uc124\uce58\ud558\uc9c0 \uc54a\uc558\ub2e4\uba74 \uc124\uce58\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install jose\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\ub610\ub294 \uc120\ud638\ud558\ub294 \ud328\ud0a4\uc9c0 \ub9e4\ub2c8\uc800(\uc608: ",(0,r.jsx)(n.code,{children:"pnpm"})," \ub610\ub294 ",(0,r.jsx)(n.code,{children:"yarn"}),")\ub97c \uc0ac\uc6a9\ud558\uc138\uc694."]}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, JWT \uac80\uc99d\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \uacf5\ud1b5 \uc720\ud2f8\ub9ac\ud2f0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="jwt-validator.ts"',children:"import { createRemoteJWKSet, jwtVerify, JWTPayload } from 'jose';\nimport { AuthInfo, AuthorizationError } from './auth-middleware.js';\n\nconst jwks = createRemoteJWKSet(new URL(JWKS_URI));\n\nexport async function validateJwt(token: string): Promise<JWTPayload> {\n  const { payload } = await jwtVerify(token, jwks, {\n    issuer: ISSUER,\n  });\n\n  verifyPayload(payload);\n  return payload;\n}\n\nexport function createAuthInfo(payload: JWTPayload): AuthInfo {\n  const scopes = (payload.scope as string)?.split(' ') ?? [];\n  const audience = Array.isArray(payload.aud) ? payload.aud : payload.aud ? [payload.aud] : [];\n\n  return new AuthInfo(\n    payload.sub!,\n    payload.client_id as string,\n    payload.organization_id as string,\n    scopes,\n    audience\n  );\n}\n\nfunction verifyPayload(payload: JWTPayload): void {\n  // \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n  // \uc544\ub798 \uad8c\ud55c \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uac80\uc99d\uc744 \uc704\ud55c \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?h[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(h).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c ",(0,r.jsx)(n.code,{children:"jwt-validator.ts"}),"\uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="jwt-validator.ts"',children:"function verifyPayload(payload: JWTPayload): void {\n  // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  const audiences = Array.isArray(payload.aud) ? payload.aud : payload.aud ? [payload.aud] : [];\n  if (!audiences.includes('https://your-api-resource-indicator')) {\n    throw new AuthorizationError('Invalid audience');\n  }\n\n  // \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n  const requiredScopes = ['api:read', 'api:write']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  const scopes = (payload.scope as string)?.split(' ') ?? [];\n  if (!requiredScopes.every((scope) => scopes.includes(scope))) {\n    throw new AuthorizationError('Insufficient scope');\n  }\n}\n"})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (Organization) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="jwt-validator.ts"',children:"function verifyPayload(payload: JWTPayload): void {\n  // audience \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  const audiences = Array.isArray(payload.aud) ? payload.aud : payload.aud ? [payload.aud] : [];\n  const hasOrgAudience = audiences.some((aud) => aud.startsWith('urn:logto:organization:'));\n\n  if (!hasOrgAudience) {\n    throw new AuthorizationError('Invalid audience for organization permissions');\n  }\n\n  // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n  const expectedOrgId = 'your-organization-id'; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n  const expectedAud = `urn:logto:organization:${expectedOrgId}`;\n  if (!audiences.includes(expectedAud)) {\n    throw new AuthorizationError('Organization ID mismatch');\n  }\n\n  // \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 \ud655\uc778\n  const requiredScopes = ['invite:users', 'manage:settings']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  const scopes = (payload.scope as string)?.split(' ') ?? [];\n  if (!requiredScopes.every((scope) => scopes.includes(scope))) {\n    throw new AuthorizationError('Insufficient organization scope');\n  }\n}\n"})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="jwt-validator.ts"',children:"function verifyPayload(payload: JWTPayload): void {\n  // audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  const audiences = Array.isArray(payload.aud) ? payload.aud : payload.aud ? [payload.aud] : [];\n  if (!audiences.includes('https://your-api-resource-indicator')) {\n    throw new AuthorizationError('Invalid audience for organization-level API resources');\n  }\n\n  // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n  const expectedOrgId = 'your-organization-id'; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n  const orgId = payload.organization_id as string;\n  if (expectedOrgId !== orgId) {\n    throw new AuthorizationError('Organization ID mismatch');\n  }\n\n  // \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n  const requiredScopes = ['api:read', 'api:write']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  const scopes = (payload.scope as string)?.split(' ') ?? [];\n  if (!requiredScopes.every((scope) => scopes.includes(scope))) {\n    throw new AuthorizationError('Insufficient organization-level API scopes');\n  }\n}\n"})})})]})]})}function x(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},15389:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="auth-middleware.ts"',children:"import { IncomingHttpHeaders } from 'http';\n\nconst JWKS_URI = 'https://your-tenant.logto.app/oidc/jwks';\nconst ISSUER = 'https://your-tenant.logto.app/oidc';\n\nexport class AuthInfo {\n  constructor(\n    public sub: string,\n    public clientId?: string,\n    public organizationId?: string,\n    public scopes: string[] = [],\n    public audience: string[] = []\n  ) {}\n}\n\nexport class AuthorizationError extends Error {\n  name = 'AuthorizationError';\n  constructor(\n    message: string,\n    public status = 403\n  ) {\n    super(message);\n  }\n}\n\nexport function extractBearerTokenFromHeaders({ authorization }: IncomingHttpHeaders): string {\n  const bearerPrefix = 'Bearer ';\n\n  if (!authorization) {\n    throw new AuthorizationError('Authorization \ud5e4\ub354\uac00 \uc5c6\uc2b5\ub2c8\ub2e4', 401);\n  }\n\n  if (!authorization.startsWith(bearerPrefix)) {\n    throw new AuthorizationError(`Authorization \ud5e4\ub354\ub294 \"${bearerPrefix}\"\ub85c \uc2dc\uc791\ud574\uc57c \ud569\ub2c8\ub2e4`, 401);\n  }\n\n  return authorization.slice(bearerPrefix.length);\n}\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},92106:(e,n,t)=>{t.d(n,{Ay:()=>g,RM:()=>p});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/Middleware/VerifyAccessToken.php"',children:"<?php\n\nnamespace App\\Http\\Middleware;\n\nuse Closure;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Http\\Response;\n\nclass VerifyAccessToken\n{\n    use AuthHelpers;\n\n    public function handle(Request $request, Closure $next): Response\n    {\n        try {\n            $token = $this->extractBearerToken($request->headers->all());\n            $payload = JwtValidator::validateJwt($token);\n\n            // \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc694\uccad \uc18d\uc131\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n            $request->attributes->set('auth', JwtValidator::createAuthInfo($payload));\n\n            return $next($request);\n\n        } catch (AuthorizationException $e) {\n            return response()->json(['error' => $e->getMessage()], $e->statusCode);\n        }\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\ubbf8\ub4e4\uc6e8\uc5b4\ub97c ",(0,r.jsx)(n.code,{children:"app/Http/Kernel.php"}),"\uc5d0 \ub4f1\ub85d\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/Kernel.php"',children:"protected $middlewareAliases = [\n    // ... \ub2e4\ub978 \ubbf8\ub4e4\uc6e8\uc5b4\n    'auth.token' => \\App\\Http\\Middleware\\VerifyAccessToken::class,\n];\n"})})]})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="src/Middleware/JwtMiddleware.php"',children:"<?php\n\nnamespace App\\Middleware;\n\nuse Psr\\Http\\Message\\ResponseInterface;\nuse Psr\\Http\\Message\\ServerRequestInterface;\nuse Psr\\Http\\Server\\MiddlewareInterface;\nuse Psr\\Http\\Server\\RequestHandlerInterface;\nuse Slim\\Psr7\\Response;\n\nclass JwtMiddleware implements MiddlewareInterface\n{\n    use AuthHelpers;\n\n    public function process(ServerRequestInterface $request, RequestHandlerInterface $handler): ResponseInterface\n    {\n        try {\n            $headers = $request->getHeaders();\n            $token = $this->extractBearerToken($headers);\n            $payload = JwtValidator::validateJwt($token);\n\n            // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c \uc694\uccad \uc18d\uc131\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n            $request = $request->withAttribute('auth', JwtValidator::createAuthInfo($payload));\n\n            return $handler->handle($request);\n\n        } catch (AuthorizationException $e) {\n            $response = new Response();\n            $response->getBody()->write(json_encode(['error' => $e->getMessage()]));\n            return $response\n                ->withHeader('Content-Type', 'application/json')\n                ->withStatus($e->statusCode);\n        }\n    }\n}\n"})})}function u(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="src/Security/JwtAuthenticator.php"',children:"<?php\n\nnamespace App\\Security;\n\nuse Symfony\\Component\\HttpFoundation\\JsonResponse;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AuthenticationException;\nuse Symfony\\Component\\Security\\Http\\Authenticator\\AbstractAuthenticator;\nuse Symfony\\Component\\Security\\Http\\Authenticator\\Passport\\Badge\\UserBadge;\nuse Symfony\\Component\\Security\\Http\\Authenticator\\Passport\\Passport;\nuse Symfony\\Component\\Security\\Http\\Authenticator\\Passport\\SelfValidatingPassport;\n\nclass JwtAuthenticator extends AbstractAuthenticator\n{\n    use AuthHelpers;\n\n    public function supports(Request $request): ?bool\n    {\n        return $request->headers->has('authorization');\n    }\n\n    public function authenticate(Request $request): Passport\n    {\n        try {\n            $token = $this->extractBearerToken($request->headers->all());\n            $payload = JwtValidator::validateJwt($token);\n            $authInfo = JwtValidator::createAuthInfo($payload);\n\n            // \uc778\uc99d \uc815\ubcf4\ub97c \uc694\uccad \uc18d\uc131\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n            $request->attributes->set('auth', $authInfo);\n\n            return new SelfValidatingPassport(new UserBadge($payload['sub']));\n\n        } catch (AuthorizationException $e) {\n            throw new AuthenticationException($e->getMessage());\n        }\n    }\n\n    public function onAuthenticationSuccess(Request $request, TokenInterface $token, string $firewallName): ?Response\n    {\n        return null; // \ucee8\ud2b8\ub864\ub7ec\ub85c \uacc4\uc18d \uc9c4\ud589\n    }\n\n    public function onAuthenticationFailure(Request $request, AuthenticationException $exception): ?Response\n    {\n        return new JsonResponse(['error' => $exception->getMessage()], Response::HTTP_UNAUTHORIZED);\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"config/packages/security.yaml"}),"\uc5d0\uc11c \uc2dc\ud050\ub9ac\ud2f0\ub97c \uc124\uc815\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="config/packages/security.yaml"',children:"security:\n  firewalls:\n    api:\n      pattern: ^/api/protected\n      stateless: true\n      custom_authenticators:\n        - App\\Security\\JwtAuthenticator\n"})})]})}const d=Object.freeze({laravel:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{}),symfony:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),slim:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{})}),p=[];function h(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc6b0\ub9ac\ub294 ",(0,r.jsx)(n.a,{href:"https://github.com/firebase/php-jwt",children:"firebase/php-jwt"})," \ub97c \uc0ac\uc6a9\ud558\uc5ec JWT \ub97c \uac80\uc99d\ud569\ub2c8\ub2e4. Composer \ub97c \uc0ac\uc6a9\ud558\uc5ec \uc124\uce58\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"composer require firebase/php-jwt\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, JWT \uac80\uc99d\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \ub2e4\uc74c\uacfc \uac19\uc740 \uacf5\uc6a9 \uc720\ud2f8\ub9ac\ud2f0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="JwtValidator.php"',children:"<?php\n\nuse Firebase\\JWT\\JWT;\nuse Firebase\\JWT\\JWK;\nuse Firebase\\JWT\\Key;\n\nclass JwtValidator\n{\n    use AuthHelpers;\n\n    private static ?array $jwks = null;\n\n    public static function fetchJwks(): array\n    {\n        if (self::$jwks === null) {\n            $jwksData = file_get_contents(AuthConstants::JWKS_URI);\n            if ($jwksData === false) {\n                throw new AuthorizationException('Failed to fetch JWKS', 401);\n            }\n\n            self::$jwks = json_decode($jwksData, true);\n        }\n\n        return self::$jwks;\n    }\n\n    public static function validateJwt(string $token): array\n    {\n        try {\n            $jwks = self::fetchJwks();\n            $keys = JWK::parseKeySet($jwks);\n\n            $decoded = JWT::decode($token, $keys);\n            $payload = (array) $decoded;\n\n            // \ubc1c\uae09\uc790 (Issuer) \uac80\uc99d\n            if (($payload['iss'] ?? '') !== AuthConstants::ISSUER) {\n                throw new AuthorizationException('Invalid issuer', 401);\n            }\n\n            self::verifyPayload($payload);\n            return $payload;\n\n        } catch (AuthorizationException $e) {\n            throw $e;\n        } catch (Exception $e) {\n            throw new AuthorizationException('Invalid token: ' . $e->getMessage(), 401);\n        }\n    }\n\n    public static function createAuthInfo(array $payload): AuthInfo\n    {\n        $scopes = !empty($payload['scope']) ? explode(' ', $payload['scope']) : [];\n        $audience = $payload['aud'] ?? [];\n\n        if (is_string($audience)) {\n            $audience = [$audience];\n        }\n\n        return new AuthInfo(\n            sub: $payload['sub'],\n            clientId: $payload['client_id'] ?? null,\n            organizationId: $payload['organization_id'] ?? null,\n            scopes: $scopes,\n            audience: $audience\n        );\n    }\n\n    private static function verifyPayload(array $payload): void\n    {\n        // \uad8c\ud55c (Permission) \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n        // \uc544\ub798\uc758 \uad8c\ud55c (Permission) \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n    }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc744 \uac80\uc99d\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?d[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(d).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c (Permission) \ubaa8\ub378\uc5d0 \ub530\ub77c, ",(0,r.jsx)(n.code,{children:"JwtValidator"})," \uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="JwtValidator.php"',children:"private static function verifyPayload(array $payload): void\n{\n    // \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    $audiences = $payload['aud'] ?? [];\n    if (is_string($audiences)) {\n        $audiences = [$audiences];\n    }\n\n    if (!in_array('https://your-api-resource-indicator', $audiences)) {\n        throw new AuthorizationException('Invalid audience');\n    }\n\n    // \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 (Scope) \ud655\uc778\n    $requiredScopes = ['api:read', 'api:write']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    $scopes = !empty($payload['scope']) ? explode(' ', $payload['scope']) : [];\n\n    foreach ($requiredScopes as $scope) {\n        if (!in_array($scope, $scopes)) {\n            throw new AuthorizationException('Insufficient scope');\n        }\n    }\n}\n"})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (Organization) \uad8c\ud55c (Permission)",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="JwtValidator.php"',children:"private static function verifyPayload(array $payload): void\n{\n    // \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 \uc870\uc9c1 (Organization) \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    $audiences = $payload['aud'] ?? [];\n    if (is_string($audiences)) {\n        $audiences = [$audiences];\n    }\n\n    $hasOrgAudience = false;\n    foreach ($audiences as $aud) {\n        if (str_starts_with($aud, 'urn:logto:organization:')) {\n            $hasOrgAudience = true;\n            break;\n        }\n    }\n\n    if (!$hasOrgAudience) {\n        throw new AuthorizationException('Invalid audience for organization permissions');\n    }\n\n    // \uc870\uc9c1 ID \uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n    $expectedOrgId = 'your-organization-id'; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    $expectedAud = \"urn:logto:organization:{$expectedOrgId}\";\n    if (!in_array($expectedAud, $audiences)) {\n        throw new AuthorizationException('Organization ID mismatch');\n    }\n\n    // \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 (Scope) \ud655\uc778\n    $requiredScopes = ['invite:users', 'manage:settings']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    $scopes = !empty($payload['scope']) ? explode(' ', $payload['scope']) : [];\n\n    foreach ($requiredScopes as $scope) {\n        if (!in_array($scope, $scopes)) {\n            throw new AuthorizationException('Insufficient organization scope');\n        }\n    }\n}\n"})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \ub2e8\uc704 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="JwtValidator.php"',children:"private static function verifyPayload(array $payload): void\n{\n    // \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    $audiences = $payload['aud'] ?? [];\n    if (is_string($audiences)) {\n        $audiences = [$audiences];\n    }\n\n    if (!in_array('https://your-api-resource-indicator', $audiences)) {\n        throw new AuthorizationException('Invalid audience for organization-level API resources');\n    }\n\n    // \uc870\uc9c1 ID \uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n    $expectedOrgId = 'your-organization-id'; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    $orgId = $payload['organization_id'] ?? null;\n    if ($expectedOrgId !== $orgId) {\n        throw new AuthorizationException('Organization ID mismatch');\n    }\n\n    // \uc870\uc9c1 \ub2e8\uc704 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 (Scope) \ud655\uc778\n    $requiredScopes = ['api:read', 'api:write']; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    $scopes = !empty($payload['scope']) ? explode(' ', $payload['scope']) : [];\n\n    foreach ($requiredScopes as $scope) {\n        if (!in_array($scope, $scopes)) {\n            throw new AuthorizationException('Insufficient organization-level API scopes');\n        }\n    }\n}\n"})})})]})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},29846:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="AuthConstants.php"',children:"<?php\n\nclass AuthConstants\n{\n    public const JWKS_URI = 'https://your-tenant.logto.app/oidc/jwks';\n    public const ISSUER = 'https://your-tenant.logto.app/oidc';\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="AuthInfo.php"',children:"<?php\n\nclass AuthInfo\n{\n    public function __construct(\n        public readonly string $sub,\n        public readonly ?string $clientId = null,\n        public readonly ?string $organizationId = null,\n        public readonly array $scopes = [],\n        public readonly array $audience = []\n    ) {}\n\n    public function toArray(): array\n    {\n        return [\n            'sub' => $this->sub,\n            'client_id' => $this->clientId,\n            'organization_id' => $this->organizationId,\n            'scopes' => $this->scopes,\n            'audience' => $this->audience,\n        ];\n    }\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="AuthorizationException.php"',children:"<?php\n\nclass AuthorizationException extends Exception\n{\n    public function __construct(\n        string $message,\n        public readonly int $statusCode = 403\n    ) {\n        parent::__construct($message);\n    }\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="AuthHelpers.php"',children:"<?php\n\ntrait AuthHelpers\n{\n    protected function extractBearerToken(array $headers): string\n    {\n        $authorization = $headers['authorization'][0] ?? $headers['Authorization'][0] ?? null;\n\n        if (!$authorization) {\n            throw new AuthorizationException('Authorization \ud5e4\ub354\uac00 \uc5c6\uc2b5\ub2c8\ub2e4', 401);\n        }\n\n        if (!str_starts_with($authorization, 'Bearer ')) {\n            throw new AuthorizationException('Authorization \ud5e4\ub354\ub294 \"Bearer \"\ub85c \uc2dc\uc791\ud574\uc57c \ud569\ub2c8\ub2e4', 401);\n        }\n\n        return substr($authorization, 7); // 'Bearer ' \uc811\ub450\uc0ac \uc81c\uac70\n    }\n}\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},67611:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="routes/api.php"',children:"<?php\n\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Route;\n\nRoute::middleware('auth.token')->group(function () {\n    Route::get('/api/protected', function (Request $request) {\n        // \uc694\uccad \uc18d\uc131\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\uc5d0 \uc811\uadfc\n        $auth = $request->attributes->get('auth');\n        return ['auth' => $auth->toArray()];\n    });\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub610\ub294 \ucee8\ud2b8\ub864\ub7ec\ub97c \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/Controllers/Api/ProtectedController.php"',children:"<?php\n\nnamespace App\\Http\\Controllers\\Api;\n\nuse App\\Http\\Controllers\\Controller;\nuse Illuminate\\Http\\Request;\n\nclass ProtectedController extends Controller\n{\n    public function __construct()\n    {\n        $this->middleware('auth.token');\n    }\n\n    public function index(Request $request)\n    {\n        // \uc694\uccad \uc18d\uc131\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\uc5d0 \uc811\uadfc\n        $auth = $request->attributes->get('auth');\n        return ['auth' => $auth->toArray()];\n    }\n\n    public function show(Request $request)\n    {\n        // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\n        $auth = $request->attributes->get('auth');\n        return [\n            'auth' => $auth->toArray(),\n            'message' => '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4'\n        ];\n    }\n}\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},55563:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="src/Controllers/ProtectedController.php"',children:"<?php\n\nnamespace App\\Controllers;\n\nuse Psr\\Http\\Message\\ResponseInterface as Response;\nuse Psr\\Http\\Message\\ServerRequestInterface as Request;\n\nclass ProtectedController\n{\n    public function index(Request $request, Response $response): Response\n    {\n        // \uc694\uccad \uc18d\uc131\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n        $auth = $request->getAttribute('auth');\n        $response->getBody()->write(json_encode(['auth' => $auth->toArray()]));\n        return $response->withHeader('Content-Type', 'application/json');\n    }\n\n    public function detailed(Request $request, Response $response): Response\n    {\n        // \ubcf4\ud638\ub41c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \ub85c\uc9c1\n        $auth = $request->getAttribute('auth');\n        $data = [\n            'auth' => $auth->toArray(),\n            'message' => '\ubcf4\ud638\ub41c \ub370\uc774\ud130\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \uc811\uadfc\ud588\uc2b5\ub2c8\ub2e4'\n        ];\n        $response->getBody()->write(json_encode($data));\n        return $response->withHeader('Content-Type', 'application/json');\n    }\n}\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},19115:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="src/Controller/Api/ProtectedController.php"',children:"<?php\n\nnamespace App\\Controller\\Api;\n\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\JsonResponse;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Component\\Security\\Http\\Attribute\\IsGranted;\n\n#[Route('/api/protected')]\n#[IsGranted('IS_AUTHENTICATED_FULLY')]\nclass ProtectedController extends AbstractController\n{\n    #[Route('', methods: ['GET'])]\n    public function index(Request $request): JsonResponse\n    {\n        // \uc694\uccad \uc18d\uc131\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n        $auth = $request->attributes->get('auth');\n        return $this->json(['auth' => $auth->toArray()]);\n    }\n}\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},48406:(e,n,t)=>{t.d(n,{Ay:()=>m,RM:()=>h});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="auth_middleware.py"',children:"from django.http import JsonResponse\nfrom jwt_validator import validate_jwt, create_auth_info\n\ndef require_access_token(view_func):\n    def wrapper(request, *args, **kwargs):\n        try:\n            headers = {key.replace('HTTP_', '').replace('_', '-').lower(): value\n                      for key, value in request.META.items() if key.startswith('HTTP_')}\n\n            token = extract_bearer_token_from_headers(headers)\n            payload = validate_jwt(token)\n\n            # \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c request\uc5d0 \ucca8\ubd80\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n            request.auth = create_auth_info(payload)\n\n            return view_func(request, *args, **kwargs)\n\n        except AuthorizationError as e:\n            return JsonResponse({'error': str(e)}, status=e.status)\n\n    return wrapper\n"})})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="auth_middleware.py"',children:"from rest_framework.authentication import TokenAuthentication\nfrom rest_framework import exceptions\nfrom jwt_validator import validate_jwt, create_auth_info\n\nclass \uc561\uc138\uc2a4 \ud1a0\ud070 (Access token) \uc778\uc99d (Authentication)(TokenAuthentication):\n    keyword = 'Bearer'  # 'Token' \ub300\uc2e0 'Bearer'\ub97c \uc0ac\uc6a9\ud558\uc138\uc694\n\n    def authenticate_credentials(self, key):\n        \"\"\"\n        \ud1a0\ud070\uc744 JWT\ub85c \uac80\uc99d\ud558\uc5ec \uc778\uc99d (Authentication)\ud569\ub2c8\ub2e4.\n        \"\"\"\n        try:\n            payload = validate_jwt(key)\n            auth_info = create_auth_info(payload)\n\n            # \uc77c\ubc18\uc801\uc73c\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \uc778\uc99d \uc815\ubcf4 (auth info)\ub97c \ub2f4\ub294 \uc0ac\uc6a9\uc790 \uc720\uc0ac \uac1d\uccb4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4\n            user = type('User', (), {\n                'auth': auth_info,\n                'is_authenticated': True,\n                'is_anonymous': False,\n                'is_active': True,\n            })()\n\n            return (user, key)\n\n        except AuthorizationError as e:\n            if e.status == 401:\n                raise exceptions.AuthenticationFailed(str(e))\n            else:  # 403\n                raise exceptions.PermissionDenied(str(e))\n"})})}function u(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="auth_middleware.py"',children:"from fastapi import HTTPException, Depends\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\nfrom jwt_validator import validate_jwt, create_auth_info\n\nsecurity = HTTPBearer()\n\nasync def verify_access_token(credentials: HTTPAuthorizationCredentials = Depends(security)) -> AuthInfo:\n    try:\n        token = credentials.credentials\n        payload = validate_jwt(token)\n        return create_auth_info(payload)\n\n    except AuthorizationError as e:\n        raise HTTPException(status_code=e.status, detail=str(e))\n"})})}function d(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="auth_middleware.py"',children:"from functools import wraps\nfrom flask import request, jsonify, g\nfrom jwt_validator import validate_jwt, create_auth_info\n\ndef verify_access_token(f):\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        try:\n            token = extract_bearer_token_from_headers(dict(request.headers))\n            payload = validate_jwt(token)\n\n            # \uc778\uc99d \uc815\ubcf4(auth info)\ub97c Flask\uc758 g \uac1d\uccb4\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n            g.auth = create_auth_info(payload)\n\n            return f(*args, **kwargs)\n\n        except AuthorizationError as e:\n            return jsonify({'error': str(e)}), e.status\n\n    return decorated_function\n"})})}const p=Object.freeze({fastapi:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),flask:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}),{}),django:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{}),"django-rest":(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{})}),h=[];function g(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc6b0\ub9ac\ub294 ",(0,r.jsx)(n.a,{href:"https://github.com/jpadilla/pyjwt",children:"PyJWT"}),"\ub97c \uc0ac\uc6a9\ud558\uc5ec JWT\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4. \uc544\uc9c1 \uc124\uce58\ud558\uc9c0 \uc54a\uc558\ub2e4\uba74 \uc124\uce58\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install pyjwt[crypto]\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, JWT \uac80\uc99d\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \ub2e4\uc74c\uacfc \uac19\uc740 \uacf5\ud1b5 \uc720\ud2f8\ub9ac\ud2f0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="jwt_validator.py"',children:"import jwt\nfrom jwt import PyJWKClient\nfrom typing import Dict, Any\nfrom auth_middleware import AuthInfo, AuthorizationError, JWKS_URI, ISSUER\n\njwks_client = PyJWKClient(JWKS_URI)\n\ndef validate_jwt(token: str) -> Dict[str, Any]:\n    \"\"\"JWT\ub97c \uac80\uc99d\ud558\uace0 \ud398\uc774\ub85c\ub4dc\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4\"\"\"\n    try:\n        signing_key = jwks_client.get_signing_key_from_jwt(token)\n\n        payload = jwt.decode(\n            token,\n            signing_key.key,\n            algorithms=['RS256'],\n            issuer=ISSUER,\n            options={'verify_aud': False}  # \ub300\uc0c1 (Audience)\ub294 \uc218\ub3d9\uc73c\ub85c \uac80\uc99d\ud569\ub2c8\ub2e4\n        )\n\n        verify_payload(payload)\n        return payload\n\n    except jwt.InvalidTokenError as e:\n        raise AuthorizationError(f'\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070: {str(e)}', 401)\n    except Exception as e:\n        raise AuthorizationError(f'\ud1a0\ud070 \uac80\uc99d \uc2e4\ud328: {str(e)}', 401)\n\ndef create_auth_info(payload: Dict[str, Any]) -> AuthInfo:\n    \"\"\"JWT \ud398\uc774\ub85c\ub4dc\ub85c\ubd80\ud130 AuthInfo\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4\"\"\"\n    scopes = payload.get('scope', '').split(' ') if payload.get('scope') else []\n    audience = payload.get('aud', [])\n    if isinstance(audience, str):\n        audience = [audience]\n\n    return AuthInfo(\n        sub=payload.get('sub'),\n        client_id=payload.get('client_id'),\n        organization_id=payload.get('organization_id'),\n        scopes=scopes,\n        audience=audience\n    )\n\ndef verify_payload(payload: Dict[str, Any]) -> None:\n    \"\"\"\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \ud398\uc774\ub85c\ub4dc\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4\"\"\"\n    # \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n    # \uc544\ub798 \uad8c\ud55c \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n    pass\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070\uc744 \uac80\uc99d\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?p[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(p).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c, ",(0,r.jsx)(n.code,{children:"jwt_validator.py"}),"\uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="jwt_validator.py"',children:"def verify_payload(payload: Dict[str, Any]) -> None:\n    \"\"\"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ub300\ud55c \ud398\uc774\ub85c\ub4dc\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4\"\"\"\n    # \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    audiences = payload.get('aud', [])\n    if isinstance(audiences, str):\n        audiences = [audiences]\n\n    if 'https://your-api-resource-indicator' not in audiences:\n        raise AuthorizationError('\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (Audience)')\n\n    # \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    required_scopes = ['api:read', 'api:write']  # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    scopes = payload.get('scope', '').split(' ') if payload.get('scope') else []\n    if not all(scope in scopes for scope in required_scopes):\n        raise AuthorizationError('\uc2a4\ucf54\ud504\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4')\n"})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (\ube44 API) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="jwt_validator.py"',children:"def verify_payload(payload: Dict[str, Any]) -> None:\n    \"\"\"\uc870\uc9c1 \uad8c\ud55c\uc5d0 \ub300\ud55c \ud398\uc774\ub85c\ub4dc\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4\"\"\"\n    # \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    audiences = payload.get('aud', [])\n    if isinstance(audiences, str):\n        audiences = [audiences]\n\n    has_org_audience = any(aud.startswith('urn:logto:organization:') for aud in audiences)\n    if not has_org_audience:\n        raise AuthorizationError('\uc870\uc9c1 \uad8c\ud55c\uc5d0 \ub300\ud55c \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (Audience)')\n\n    # \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n    expected_org_id = 'your-organization-id'  # \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    expected_aud = f'urn:logto:organization:{expected_org_id}'\n    if expected_aud not in audiences:\n        raise AuthorizationError('\uc870\uc9c1 ID \ubd88\uc77c\uce58')\n\n    # \ud544\uc694\ud55c \uc870\uc9c1 \uc2a4\ucf54\ud504 \ud655\uc778\n    required_scopes = ['invite:users', 'manage:settings']  # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    scopes = payload.get('scope', '').split(' ') if payload.get('scope') else []\n    if not all(scope in scopes for scope in required_scopes):\n        raise AuthorizationError('\uc870\uc9c1 \uc2a4\ucf54\ud504\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4')\n"})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="jwt_validator.py"',children:"def verify_payload(payload: Dict[str, Any]) -> None:\n    \"\"\"\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ub300\ud55c \ud398\uc774\ub85c\ub4dc\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4\"\"\"\n    # \ub300\uc0c1 (Audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    audiences = payload.get('aud', [])\n    if isinstance(audiences, str):\n        audiences = [audiences]\n\n    if 'https://your-api-resource-indicator' not in audiences:\n        raise AuthorizationError('\uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ub300\ud55c \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub300\uc0c1 (Audience)')\n\n    # \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n    expected_org_id = 'your-organization-id'  # \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    org_id = payload.get('organization_id')\n    if expected_org_id != org_id:\n        raise AuthorizationError('\uc870\uc9c1 ID \ubd88\uc77c\uce58')\n\n    # \uc870\uc9c1 \uc218\uc900 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    required_scopes = ['api:read', 'api:write']  # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n    scopes = payload.get('scope', '').split(' ') if payload.get('scope') else []\n    if not all(scope in scopes for scope in required_scopes):\n        raise AuthorizationError('\uc870\uc9c1 \uc218\uc900 API \uc2a4\ucf54\ud504\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4')\n"})})})]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},97134:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="auth_middleware.py"',children:"JWKS_URI = 'https://your-tenant.logto.app/oidc/jwks'\nISSUER = 'https://your-tenant.logto.app/oidc'\n\nclass AuthInfo:\n    def __init__(self, sub: str, client_id: str = None, organization_id: str = None,\n                 scopes: list = None, audience: list = None):\n        self.sub = sub\n        self.client_id = client_id\n        self.organization_id = organization_id\n        self.scopes = scopes or []\n        self.audience = audience or []\n\n    def to_dict(self):\n        return {\n            'sub': self.sub,\n            'client_id': self.client_id,\n            'organization_id': self.organization_id,\n            'scopes': self.scopes,\n            'audience': self.audience\n        }\n\nclass AuthorizationError(Exception):\n    def __init__(self, message: str, status: int = 403):\n        self.message = message\n        self.status = status\n        super().__init__(self.message)\n\ndef extract_bearer_token_from_headers(headers: dict) -> str:\n    \"\"\"\n    HTTP \ud5e4\ub354\uc5d0\uc11c bearer \ud1a0\ud070\uc744 \ucd94\ucd9c\ud569\ub2c8\ub2e4.\n\n    \ucc38\uace0: FastAPI \ubc0f Django REST Framework\uc5d0\ub294 \ub0b4\uc7a5 \ud1a0\ud070 \ucd94\ucd9c \uae30\ub2a5\uc774 \uc788\uc73c\ubbc0\ub85c,\n    \uc774 \ud568\uc218\ub294 \uc8fc\ub85c Flask \ubc0f \uae30\ud0c0 \ud504\ub808\uc784\uc6cc\ud06c\uc6a9\uc785\ub2c8\ub2e4.\n    \"\"\"\n    authorization = headers.get('authorization') or headers.get('Authorization')\n\n    if not authorization:\n        raise AuthorizationError('Authorization \ud5e4\ub354\uac00 \uc5c6\uc2b5\ub2c8\ub2e4', 401)\n\n    if not authorization.startswith('Bearer '):\n        raise AuthorizationError('Authorization \ud5e4\ub354\ub294 \"Bearer \"\ub85c \uc2dc\uc791\ud574\uc57c \ud569\ub2c8\ub2e4', 401)\n\n    return authorization[7:]  # 'Bearer ' \uc811\ub450\uc0ac \uc81c\uac70\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},93726:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="views.py"',children:"from rest_framework.decorators import api_view, authentication_classes\nfrom rest_framework.response import Response\nfrom auth_middleware import AccessTokenAuthentication\n\n@api_view(['GET'])\n@authentication_classes([AccessTokenAuthentication])\ndef protected_view(request):\n    # request.user.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n    return Response({\"auth\": request.user.auth.to_dict()})\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub610\ub294 \ud074\ub798\uc2a4 \uae30\ubc18 \ubdf0\ub97c \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="views.py"',children:'from rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom auth_middleware import AccessTokenAuthentication\n\nclass ProtectedView(APIView):\n    authentication_classes = [AccessTokenAuthentication]\n\n    def get(self, request):\n        # request.user.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n        return Response({"auth": request.user.auth.to_dict()})\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="urls.py"',children:"from django.urls import path\nfrom . import views\n\nurlpatterns = [\n    path('api/protected/', views.protected_view, name='protected'),\n    # \ub610\ub294 \ud074\ub798\uc2a4 \uae30\ubc18 \ubdf0\uc758 \uacbd\uc6b0:\n    # path('api/protected/', views.ProtectedView.as_view(), name='protected'),\n]\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},14321:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="views.py"',children:'from django.http import JsonResponse\nfrom auth_middleware import require_access_token\n\n@require_access_token\ndef protected_view(request):\n    # request.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n    return JsonResponse({"auth": request.auth.to_dict()})\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="urls.py"',children:"from django.urls import path\nfrom . import views\n\nurlpatterns = [\n    path('api/protected/', views.protected_view, name='protected'),\n]\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},16140:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="app.py"',children:'from fastapi import FastAPI, Depends\nfrom auth_middleware import verify_access_token, AuthInfo\n\napp = FastAPI()\n\n@app.get("/api/protected")\nasync def protected_endpoint(auth: AuthInfo = Depends(verify_access_token)):\n    # auth \ub9e4\uac1c\ubcc0\uc218\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud569\ub2c8\ub2e4\n    return {"auth": auth.to_dict()}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},60381:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",metastring:'title="app.py"',children:"from flask import Flask, g, jsonify\nfrom auth_middleware import verify_access_token\n\napp = Flask(__name__)\n\n@app.route('/api/protected', methods=['GET'])\n@verify_access_token\ndef protected_endpoint():\n    # g.auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n    return jsonify({\"auth\": g.auth.to_dict()})\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},10270:(e,n,t)=>{t.d(n,{Ay:()=>g,RM:()=>p});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="auth_helpers.rb"',children:"module GrapeAuthHelpers\n  include AuthHelpers\n\n  def authenticate_user!\n    begin\n      token = extract_bearer_token(request)\n      decoded_token = JwtValidator.validate_jwt(token)\n\n      # \uc778\uc99d \uc815\ubcf4\ub97c \ubc94\uc6a9\uc801\uc73c\ub85c \uc800\uc7a5\n      @auth = JwtValidator.create_auth_info(decoded_token)\n\n    rescue AuthorizationError => e\n      error!({ error: e.message }, e.status)\n    rescue JWT::DecodeError, JWT::VerificationError, JWT::ExpiredSignature => e\n      error!({ error: '\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070' }, 401)\n    end\n  end\n\n  def auth\n    @auth\n  end\nend\n"})})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="app/controllers/concerns/jwt_authentication.rb"',children:"module JwtAuthentication\n  extend ActiveSupport::Concern\n  include AuthHelpers\n\n  included do\n    before_action :verify_access_token, only: [:protected_action] # \ud2b9\uc815 \uc561\uc158\uc5d0\ub9cc \ucd94\uac00\n  end\n\n  private\n\n  def verify_access_token\n    begin\n      token = extract_bearer_token(request)\n      decoded_token = JwtValidator.validate_jwt(token)\n\n      # \uc778\uc99d \uc815\ubcf4(auth info)\ub97c \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \uc800\uc7a5\n      @auth = JwtValidator.create_auth_info(decoded_token)\n\n    rescue AuthorizationError => e\n      render json: { error: e.message }, status: e.status\n    rescue JWT::DecodeError, JWT::VerificationError, JWT::ExpiredSignature => e\n      render json: { error: '\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070' }, status: 401\n    end\n  end\nend\n"})})}function u(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="auth_middleware.rb"',children:"class AuthMiddleware\n  include AuthHelpers\n\n  def initialize(app)\n    @app = app\n  end\n\n  def call(env)\n    request = Rack::Request.new(env)\n\n    # \ud2b9\uc815 \ub77c\uc6b0\ud2b8\ub9cc \ubcf4\ud638\ud569\ub2c8\ub2e4\n    if request.path.start_with?('/api/protected')\n      begin\n        token = extract_bearer_token(request)\n        decoded_token = JwtValidator.validate_jwt(token)\n\n        # \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c env\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\ud569\ub2c8\ub2e4\n        env['auth'] = JwtValidator.create_auth_info(decoded_token)\n\n      rescue AuthorizationError => e\n        return [e.status, { 'Content-Type' => 'application/json' }, [{ error: e.message }.to_json]]\n      rescue JWT::DecodeError, JWT::VerificationError, JWT::ExpiredSignature => e\n        return [401, { 'Content-Type' => 'application/json' }, [{ error: '\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070' }.to_json]]\n      end\n    end\n\n    @app.call(env)\n  end\nend\n"})})}const d=Object.freeze({rails:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{}),sinatra:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{}),grape:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{})}),p=[];function h(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc6b0\ub9ac\ub294 ",(0,r.jsx)(n.a,{href:"https://github.com/jwt/ruby-jwt",children:"jwt"})," gem\uc744 \uc0ac\uc6a9\ud558\uc5ec JWT\ub97c \uac80\uc99d\ud569\ub2c8\ub2e4. Gemfile\uc5d0 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="Gemfile"',children:"gem 'jwt'\n# net-http\ub294 Ruby 2.7\ubd80\ud130 Ruby \ud45c\uc900 \ub77c\uc774\ube0c\ub7ec\ub9ac\uc758 \uc77c\ubd80\uc774\ubbc0\ub85c \uba85\uc2dc\uc801\uc73c\ub85c \ucd94\uac00\ud560 \ud544\uc694\uac00 \uc5c6\uc2b5\ub2c8\ub2e4\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8\ub7f0 \ub2e4\uc74c \ub2e4\uc74c\uc744 \uc2e4\ud589\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bundle install\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, JWKS \ubc0f \ud1a0\ud070 \uac80\uc99d\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \uacf5\ud1b5 \uc720\ud2f8\ub9ac\ud2f0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="jwt_validator.rb"',children:"require 'jwt'\nrequire 'net/http'\nrequire 'json'\n\nclass JwtValidator\n  include AuthHelpers\n\n  def self.fetch_jwks\n    @jwks ||= begin\n      uri = URI(AuthConstants::JWKS_URI)\n      response = Net::HTTP.get_response(uri)\n      raise AuthorizationError.new('Failed to fetch JWKS', 401) unless response.is_a?(Net::HTTPSuccess)\n\n      jwks_data = JSON.parse(response.body)\n      JWT::JWK::Set.new(jwks_data)\n    end\n  end\n\n  def self.validate_jwt(token)\n    jwks = fetch_jwks\n\n    # JWT \ub77c\uc774\ube0c\ub7ec\ub9ac\uac00 JWKS\uc5d0\uc11c \uc54c\uace0\ub9ac\uc998 \uac10\uc9c0\ub97c \ucc98\ub9ac\ud558\ub3c4\ub85d \ud569\ub2c8\ub2e4\n    decoded_token = JWT.decode(token, nil, true, {\n      iss: AuthConstants::ISSUER,\n      verify_iss: true,\n      verify_aud: false, # \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c audience\ub97c \uc218\ub3d9\uc73c\ub85c \uac80\uc99d\ud569\ub2c8\ub2e4\n      jwks: jwks\n    })[0]\n\n    verify_payload(decoded_token)\n    decoded_token\n  end\n\n  def self.create_auth_info(payload)\n    scopes = payload['scope']&.split(' ') || []\n    audience = payload['aud'] || []\n\n    AuthInfo.new(\n      payload['sub'],\n      payload['client_id'],\n      payload['organization_id'],\n      scopes,\n      audience\n    )\n  end\n\n  def self.verify_payload(payload)\n    # \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uc5ec\uae30\uc5d0 \uad6c\ud604\ud558\uc138\uc694\n    # \uc544\ub798 \uad8c\ud55c \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n  end\nend\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8\ub7f0 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070\uc744 \uac80\uc99d\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?d[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(d).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c ",(0,r.jsx)(n.code,{children:"JwtValidator"}),"\uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="jwt_validator.rb"',children:"def self.verify_payload(payload)\n  # audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  audiences = payload['aud'] || []\n  unless audiences.include?('https://your-api-resource-indicator')\n    raise AuthorizationError.new('Invalid audience')\n  end\n\n  # \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n  required_scopes = ['api:read', 'api:write'] # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  token_scopes = payload['scope']&.split(' ') || []\n\n  unless required_scopes.all? { |scope| token_scopes.include?(scope) }\n    raise AuthorizationError.new('Insufficient scope')\n  end\nend\n"})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (\ube44-API) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="jwt_validator.rb"',children:"def self.verify_payload(payload)\n  # audience \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  audiences = payload['aud'] || []\n  has_org_audience = audiences.any? { |aud| aud.start_with?('urn:logto:organization:') }\n\n  unless has_org_audience\n    raise AuthorizationError.new('Invalid audience for organization permissions')\n  end\n\n  # \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n  expected_org_id = 'your-organization-id' # \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n  expected_aud = \"urn:logto:organization:#{expected_org_id}\"\n  unless audiences.include?(expected_aud)\n    raise AuthorizationError.new('Organization ID mismatch')\n  end\n\n  # \uc870\uc9c1 \uad8c\ud55c\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n  required_scopes = ['invite:users', 'manage:settings'] # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  token_scopes = payload['scope']&.split(' ') || []\n\n  unless required_scopes.all? { |scope| token_scopes.include?(scope) }\n    raise AuthorizationError.new('Insufficient organization scope')\n  end\nend\n"})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="jwt_validator.rb"',children:"def self.verify_payload(payload)\n  # audience \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n  audiences = payload['aud'] || []\n  unless audiences.include?('https://your-api-resource-indicator')\n    raise AuthorizationError.new('Invalid audience for organization-level API resources')\n  end\n\n  # \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\ud574\uc57c \ud560 \uc218 \uc788\uc74c)\n  expected_org_id = 'your-organization-id' # \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n  org_id = payload['organization_id']\n  unless expected_org_id == org_id\n    raise AuthorizationError.new('Organization ID mismatch')\n  end\n\n  # \uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n  required_scopes = ['api:read', 'api:write'] # \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694\n  token_scopes = payload['scope']&.split(' ') || []\n\n  unless required_scopes.all? { |scope| token_scopes.include?(scope) }\n    raise AuthorizationError.new('Insufficient organization-level API scopes')\n  end\nend\n"})})})]})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},32272:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="auth_constants.rb"',children:"module AuthConstants\n  JWKS_URI = 'https://your-tenant.logto.app/oidc/jwks'\n  ISSUER = 'https://your-tenant.logto.app/oidc'\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="auth_info.rb"',children:"class AuthInfo\n  attr_accessor :sub, :client_id, :organization_id, :scopes, :audience\n\n  def initialize(sub, client_id = nil, organization_id = nil, scopes = [], audience = [])\n    @sub = sub\n    @client_id = client_id\n    @organization_id = organization_id\n    @scopes = scopes\n    @audience = audience\n  end\n\n  def to_h\n    {\n      sub: @sub,\n      client_id: @client_id,\n      organization_id: @organization_id,\n      scopes: @scopes,\n      audience: @audience\n    }\n  end\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="authorization_error.rb"',children:"class AuthorizationError < StandardError\n  attr_reader :status\n\n  def initialize(message, status = 403)\n    super(message)\n    @status = status\n  end\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="auth_helpers.rb"',children:"module AuthHelpers\n  def extract_bearer_token(request)\n    authorization = request.headers['Authorization']\n\n    raise AuthorizationError.new('Authorization header is missing', 401) unless authorization\n    raise AuthorizationError.new('Authorization header must start with \"Bearer \"', 401) unless authorization.start_with?('Bearer ')\n\n    authorization[7..-1] # 'Bearer ' \uc811\ub450\uc0ac\ub97c \uc81c\uac70\ud569\ub2c8\ub2e4\n  end\nend\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},62315:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="api.rb"',children:"require 'grape'\nrequire_relative 'auth_helpers'\nrequire_relative 'auth_constants'\nrequire_relative 'auth_info'\nrequire_relative 'authorization_error'\nrequire_relative 'jwt_validator'\n\nclass API < Grape::API\n  format :json\n\n  helpers GrapeAuthHelpers\n\n  namespace :api do\n    namespace :protected do\n      before do\n        authenticate_user!\n      end\n\n      get do\n        # \uc778\uc99d \ud5ec\ud37c\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\uc5d0 \uc811\uadfc\n        { auth: auth.to_h }\n      end\n    end\n  end\n\n  # \uacf5\uac1c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 (\ubcf4\ud638\ub418\uc9c0 \uc54a\uc74c)\n  get :public do\n    { message: \"\uacf5\uac1c \uc5d4\ub4dc\ud3ec\uc778\ud2b8\" }\n  end\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="config.ru"',children:"require_relative 'api'\n\nrun API\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},84341:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="app/controllers/application_controller.rb"',children:"class ApplicationController < ActionController::API # API \uc804\uc6a9 \uc571\uc758 \uacbd\uc6b0\n# class ApplicationController < ActionController::Base # \uc804\uccb4 Rails \uc571\uc758 \uacbd\uc6b0\n  include JwtAuthentication\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="app/controllers/api/protected_controller.rb"',children:"class Api::ProtectedController < ApplicationController\n  before_action :verify_access_token\n\n  def index\n    # @auth\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\n    render json: { auth: @auth.to_h }\n  end\nend\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="config/routes.rb"',children:"Rails.application.routes.draw do\n  namespace :api do\n    resources :protected, only: [:index]\n  end\nend\n"})})]})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},67314:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",metastring:'title="app.rb"',children:"require 'sinatra'\nrequire 'json'\nrequire_relative 'auth_middleware'\nrequire_relative 'auth_constants'\nrequire_relative 'auth_info'\nrequire_relative 'authorization_error'\nrequire_relative 'auth_helpers'\nrequire_relative 'jwt_validator'\n\n# \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\nuse AuthMiddleware\n\nget '/api/protected' do\n  content_type :json\n\n  # env\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\uc5d0 \uc811\uadfc\n  auth = env['auth']\n  { auth: auth.to_h }.to_json\nend\n\n# \uacf5\uac1c \uc5d4\ub4dc\ud3ec\uc778\ud2b8 (\ubbf8\ub4e4\uc6e8\uc5b4\ub85c \ubcf4\ud638\ub418\uc9c0 \uc54a\uc74c)\nget '/' do\n  content_type :json\n  { message: \"\uacf5\uac1c \uc5d4\ub4dc\ud3ec\uc778\ud2b8\" }.to_json\nend\n"})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},61749:(e,n,t)=>{t.d(n,{Ay:()=>g,RM:()=>p});var r=t(25105),o=t(79621),a=t(33435),i=t(38552),s=t(22002);function c(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="middleware.rs"',children:"use crate::{AuthInfo, AuthorizationError, extract_bearer_token};\nuse crate::jwt_validator::JwtValidator;\nuse actix_web::{\n    dev::{forward_ready, Service, ServiceRequest, ServiceResponse, Transform},\n    web, Error, HttpMessage, HttpResponse,\n};\nuse futures::future::{ok, Ready};\nuse std::sync::Arc;\n\n// JWT \ubbf8\ub4e4\uc6e8\uc5b4 \uad6c\uc870\uccb4 \uc815\uc758\npub struct JwtMiddleware {\n    validator: Arc<JwtValidator>,\n}\n\nimpl JwtMiddleware {\n    // \uc0c8\ub85c\uc6b4 \ubbf8\ub4e4\uc6e8\uc5b4 \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\n    pub fn new(validator: Arc<JwtValidator>) -> Self {\n        Self { validator }\n    }\n}\n\n// Transform \ud2b8\ub808\uc787 \uad6c\ud604: \uc11c\ube44\uc2a4\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9\nimpl<S, B> Transform<S, ServiceRequest> for JwtMiddleware\nwhere\n    S: Service<ServiceRequest, Response = ServiceResponse<B>, Error = Error>,\n    S::Future: 'static,\n    B: 'static,\n{\n    type Response = ServiceResponse<B>;\n    type Error = Error;\n    type InitError = ();\n    type Transform = JwtMiddlewareService<S>;\n    type Future = Ready<Result<Self::Transform, Self::InitError>>;\n\n    fn new_transform(&self, service: S) -> Self::Future {\n        ok(JwtMiddlewareService {\n            service,\n            validator: self.validator.clone(),\n        })\n    }\n}\n\n// \uc2e4\uc81c \uc694\uccad \ucc98\ub9ac\ub97c \ub2f4\ub2f9\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4 \uc11c\ube44\uc2a4 \uad6c\uc870\uccb4\npub struct JwtMiddlewareService<S> {\n    service: S,\n    validator: Arc<JwtValidator>,\n}\n\nimpl<S, B> Service<ServiceRequest> for JwtMiddlewareService<S>\nwhere\n    S: Service<ServiceRequest, Response = ServiceResponse<B>, Error = Error>,\n    S::Future: 'static,\n    B: 'static,\n{\n    type Response = ServiceResponse<B>;\n    type Error = Error;\n    type Future = futures::future::LocalBoxFuture<'static, Result<Self::Response, Self::Error>>;\n\n    forward_ready!(service);\n\n    // \uc694\uccad \ucc98\ub9ac \ud568\uc218\n    fn call(&self, req: ServiceRequest) -> Self::Future {\n        let validator = self.validator.clone();\n\n        Box::pin(async move {\n            // Authorization \ud5e4\ub354\uc5d0\uc11c \ud1a0\ud070 \ucd94\ucd9c\n            let authorization = req\n                .headers()\n                .get(\"authorization\")\n                .and_then(|h| h.to_str().ok());\n\n            match extract_bearer_token(authorization)\n                .and_then(|token| validator.validate_jwt(token))\n            {\n                Ok(auth_info) => {\n                    // \uc778\uc99d \uc815\ubcf4 (AuthInfo)\ub97c \uc694\uccad \ud655\uc7a5\uc5d0 \uc800\uc7a5\ud558\uc5ec \uc774\ud6c4\uc5d0 \ud65c\uc6a9 \uac00\ub2a5\n                    req.extensions_mut().insert(auth_info);\n                    let fut = self.service.call(req);\n                    fut.await\n                }\n                Err(e) => {\n                    // \uc778\uc99d \uc2e4\ud328 \uc2dc \uc5d0\ub7ec \uba54\uc2dc\uc9c0\uc640 \ud568\uaed8 403 \ub610\ub294 \uc9c0\uc815\ub41c \uc0c1\ud0dc \ucf54\ub4dc \ubc18\ud658\n                    let response = HttpResponse::build(\n                        actix_web::http::StatusCode::from_u16(e.status_code)\n                            .unwrap_or(actix_web::http::StatusCode::FORBIDDEN),\n                    )\n                    .json(serde_json::json!({ \"error\": e.message }));\n\n                    Ok(req.into_response(response))\n                }\n            }\n        })\n    }\n}\n"})})}function l(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="middleware.rs"',children:'use crate::{AuthInfo, AuthorizationError, extract_bearer_token};\nuse crate::jwt_validator::JwtValidator;\nuse axum::{\n    extract::Request,\n    http::{HeaderMap, StatusCode},\n    middleware::Next,\n    response::{IntoResponse, Response},\n    Extension, Json,\n};\nuse serde_json::json;\nuse std::sync::Arc;\n\n// JWT \ubbf8\ub4e4\uc6e8\uc5b4 \ud568\uc218\npub async fn jwt_middleware(\n    Extension(validator): Extension<Arc<JwtValidator>>,\n    headers: HeaderMap,\n    mut request: Request,\n    next: Next,\n) -> Result<Response, AuthorizationError> {\n    // Authorization \ud5e4\ub354\uc5d0\uc11c \ud1a0\ud070 \ucd94\ucd9c\n    let authorization = headers\n        .get("authorization")\n        .and_then(|h| h.to_str().ok());\n\n    let token = extract_bearer_token(authorization)?;\n    let auth_info = validator.validate_jwt(token)?;\n\n    // \uc778\uc99d \uc815\ubcf4(auth info)\ub97c request \ud655\uc7a5\uc5d0 \uc800\uc7a5\ud558\uc5ec \ubc94\uc6a9\uc801\uc73c\ub85c \uc0ac\uc6a9\n    request.extensions_mut().insert(auth_info);\n\n    Ok(next.run(request).await)\n}\n\n// AuthorizationError\ub97c HTTP \uc751\ub2f5\uc73c\ub85c \ubcc0\ud658\ud558\ub294 \uad6c\ud604\nimpl IntoResponse for AuthorizationError {\n    fn into_response(self) -> Response {\n        let status = StatusCode::from_u16(self.status_code).unwrap_or(StatusCode::FORBIDDEN);\n        (status, Json(json!({ "error": self.message }))).into_response()\n    }\n}\n'})})}function u(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="guards.rs"',children:"use crate::{AuthInfo, AuthorizationError, extract_bearer_token};\nuse crate::jwt_validator::JwtValidator;\nuse rocket::{\n    http::Status,\n    outcome::Outcome,\n    request::{self, FromRequest, Request},\n    State,\n};\n\n#[rocket::async_trait]\nimpl<'r> FromRequest<'r> for AuthInfo {\n    type Error = AuthorizationError;\n\n    async fn from_request(req: &'r Request<'_>) -> request::Outcome<Self, Self::Error> {\n        let validator = match req.guard::<&State<JwtValidator>>().await {\n            Outcome::Success(validator) => validator,\n            Outcome::Failure((status, _)) => {\n                return Outcome::Failure((\n                    status,\n                    AuthorizationError::with_status(\"JWT validator not found\", 500),\n                ))\n            }\n            Outcome::Forward(()) => {\n                return Outcome::Forward(())\n            }\n        };\n\n        let authorization = req.headers().get_one(\"authorization\");\n\n        match extract_bearer_token(authorization)\n            .and_then(|token| validator.validate_jwt(token))\n        {\n            Ok(auth_info) => Outcome::Success(auth_info),\n            Err(e) => {\n                let status = Status::from_code(e.status_code).unwrap_or(Status::Forbidden);\n                Outcome::Failure((status, e))\n            }\n        }\n    }\n}\n"})})}const d=Object.freeze({axum:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}),{}),"actix-web":(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}),{}),rocket:(0,r.jsx)((function(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}),{})}),p=[];function h(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\uc6b0\ub9ac\ub294 ",(0,r.jsx)(n.a,{href:"https://github.com/Keats/jsonwebtoken",children:"jsonwebtoken"})," \uc744 \uc0ac\uc6a9\ud558\uc5ec JWT \ub97c \uac80\uc99d\ud569\ub2c8\ub2e4. ",(0,r.jsx)(n.code,{children:"Cargo.toml"}),"\uc5d0 \ud544\uc694\ud55c \uc758\uc874\uc131\uc744 \ucd94\uac00\ud558\uc138\uc694:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'title="Cargo.toml"',children:'[dependencies]\njsonwebtoken = "9.0"\nserde = { version = "1.0", features = ["derive"] }\nserde_json = "1.0"\nreqwest = { version = "0.11", features = ["json"] }\ntokio = { version = "1.0", features = ["full"] }\n'})}),"\n",(0,r.jsx)(n.p,{children:"\uba3c\uc800, JWT \uac80\uc99d\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c \uacf5\ud1b5 \uc720\ud2f8\ub9ac\ud2f0\ub97c \ucd94\uac00\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="jwt_validator.rs"',children:'use crate::{AuthInfo, AuthorizationError, ISSUER, JWKS_URI};\nuse jsonwebtoken::{decode, decode_header, Algorithm, DecodingKey, Validation};\nuse serde_json::Value;\nuse std::collections::HashMap;\n\npub struct JwtValidator {\n    jwks: HashMap<String, DecodingKey>,\n}\n\nimpl JwtValidator {\n    pub async fn new() -> Result<Self, AuthorizationError> {\n        let jwks = Self::fetch_jwks().await?;\n        Ok(Self { jwks })\n    }\n\n    async fn fetch_jwks() -> Result<HashMap<String, DecodingKey>, AuthorizationError> {\n        let response = reqwest::get(JWKS_URI).await.map_err(|e| {\n            AuthorizationError::with_status(format!("Failed to fetch JWKS: {}", e), 401)\n        })?;\n\n        let jwks: Value = response.json().await.map_err(|e| {\n            AuthorizationError::with_status(format!("Failed to parse JWKS: {}", e), 401)\n        })?;\n\n        let mut keys = HashMap::new();\n\n        if let Some(keys_array) = jwks["keys"].as_array() {\n            for key in keys_array {\n                if let (Some(kid), Some(kty), Some(n), Some(e)) = (\n                    key["kid"].as_str(),\n                    key["kty"].as_str(),\n                    key["n"].as_str(),\n                    key["e"].as_str(),\n                ) {\n                    if kty == "RSA" {\n                        if let Ok(decoding_key) = DecodingKey::from_rsa_components(n, e) {\n                            keys.insert(kid.to_string(), decoding_key);\n                        }\n                    }\n                }\n            }\n        }\n\n        if keys.is_empty() {\n            return Err(AuthorizationError::with_status("No valid keys found in JWKS", 401));\n        }\n\n        Ok(keys)\n    }\n\n    pub fn validate_jwt(&self, token: &str) -> Result<AuthInfo, AuthorizationError> {\n        let header = decode_header(token).map_err(|e| {\n            AuthorizationError::with_status(format!("Invalid token header: {}", e), 401)\n        })?;\n\n        let kid = header.kid.ok_or_else(|| {\n            AuthorizationError::with_status("Token missing kid claim", 401)\n        })?;\n\n        let key = self.jwks.get(&kid).ok_or_else(|| {\n            AuthorizationError::with_status("Unknown key ID", 401)\n        })?;\n\n        let mut validation = Validation::new(Algorithm::RS256);\n        validation.set_issuer(&[ISSUER]);\n        validation.validate_aud = false; // \ub300\uc0c1 (Audience)\ub294 \uc218\ub3d9\uc73c\ub85c \uac80\uc99d\ud569\ub2c8\ub2e4.\n\n        let token_data = decode::<Value>(token, key, &validation).map_err(|e| {\n            AuthorizationError::with_status(format!("Invalid token: {}", e), 401)\n        })?;\n\n        let claims = token_data.claims;\n        self.verify_payload(&claims)?;\n\n        Ok(self.create_auth_info(claims))\n    }\n\n    fn verify_payload(&self, claims: &Value) -> Result<(), AuthorizationError> {\n        // \uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694.\n        // \uc544\ub798 \uad8c\ud55c \ubaa8\ub378 \uc139\uc158\uc5d0\uc11c \uc608\uc2dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n        Ok(())\n    }\n\n    fn create_auth_info(&self, claims: Value) -> AuthInfo {\n        let scopes = claims["scope"]\n            .as_str()\n            .map(|s| s.split(\' \').map(|s| s.to_string()).collect())\n            .unwrap_or_default();\n\n        let audience = match &claims["aud"] {\n            Value::Array(arr) => arr.iter().filter_map(|v| v.as_str().map(|s| s.to_string())).collect(),\n            Value::String(s) => vec![s.clone()],\n            _ => vec![],\n        };\n\n        AuthInfo::new(\n            claims["sub"].as_str().unwrap_or_default().to_string(),\n            claims["client_id"].as_str().map(|s| s.to_string()),\n            claims["organization_id"].as_str().map(|s| s.to_string()),\n            scopes,\n            audience,\n        )\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\uadf8 \ub2e4\uc74c, \uc561\uc138\uc2a4 \ud1a0\ud070\uc744 \uac80\uc99d\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",e.framework?d[e.framework]:(0,r.jsx)(s.A,{groupId:"api-framework",children:Object.entries(d).map((([e,n])=>(0,r.jsx)(i.A,{value:e,label:(0,a.My)(e),children:n},e)))}),"\n",(0,r.jsxs)(n.p,{children:["\uad8c\ud55c \ubaa8\ub378\uc5d0 \ub530\ub77c ",(0,r.jsx)(n.code,{children:"JwtValidator"}),"\uc5d0\uc11c \uc801\uc808\ud55c \uac80\uc99d \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uc138\uc694:"]}),"\n",(0,r.jsxs)(s.A,{groupId:"permission-models",children:[(0,r.jsx)(i.A,{value:"global-api-resources",label:"\uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="jwt_validator.rs"',children:'fn verify_payload(&self, claims: &Value) -> Result<(), AuthorizationError> {\n    // \ub300\uc0c1 (audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    let audiences = match &claims["aud"] {\n        Value::Array(arr) => arr.iter().filter_map(|v| v.as_str()).collect::<Vec<_>>(),\n        Value::String(s) => vec![s.as_str()],\n        _ => vec![],\n    };\n\n    if !audiences.contains(&"https://your-api-resource-indicator") {\n        return Err(AuthorizationError::new("Invalid audience"));\n    }\n\n    // \uae00\ub85c\ubc8c API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    let required_scopes = vec!["api:read", "api:write"]; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694.\n    let scopes = claims["scope"]\n        .as_str()\n        .map(|s| s.split(\' \').collect::<Vec<_>>())\n        .unwrap_or_default();\n\n    for required_scope in &required_scopes {\n        if !scopes.contains(required_scope) {\n            return Err(AuthorizationError::new("Insufficient scope"));\n        }\n    }\n\n    Ok(())\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-permissions",label:"\uc870\uc9c1 (\ube44-API) \uad8c\ud55c",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="jwt_validator.rs"',children:'fn verify_payload(&self, claims: &Value) -> Result<(), AuthorizationError> {\n    // \ub300\uc0c1 (audience) \ud074\ub808\uc784\uc774 \uc870\uc9c1 \ud615\uc2dd\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    let audiences = match &claims["aud"] {\n        Value::Array(arr) => arr.iter().filter_map(|v| v.as_str()).collect::<Vec<_>>(),\n        Value::String(s) => vec![s.as_str()],\n        _ => vec![],\n    };\n\n    let has_org_audience = audiences.iter().any(|aud| aud.starts_with("urn:logto:organization:"));\n    if !has_org_audience {\n        return Err(AuthorizationError::new("Invalid audience for organization permissions"));\n    }\n\n    // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    let expected_org_id = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    let expected_aud = format!("urn:logto:organization:{}", expected_org_id);\n    if !audiences.contains(&expected_aud.as_str()) {\n        return Err(AuthorizationError::new("Organization ID mismatch"));\n    }\n\n    // \uc870\uc9c1 \uad8c\ud55c\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    let required_scopes = vec!["invite:users", "manage:settings"]; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694.\n    let scopes = claims["scope"]\n        .as_str()\n        .map(|s| s.split(\' \').collect::<Vec<_>>())\n        .unwrap_or_default();\n\n    for required_scope in &required_scopes {\n        if !scopes.contains(required_scope) {\n            return Err(AuthorizationError::new("Insufficient organization scope"));\n        }\n    }\n\n    Ok(())\n}\n'})})}),(0,r.jsx)(i.A,{value:"organization-level-api-resources",label:"\uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="jwt_validator.rs"',children:'fn verify_payload(&self, claims: &Value) -> Result<(), AuthorizationError> {\n    // \ub300\uc0c1 (audience) \ud074\ub808\uc784\uc774 API \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\n    let audiences = match &claims["aud"] {\n        Value::Array(arr) => arr.iter().filter_map(|v| v.as_str()).collect::<Vec<_>>(),\n        Value::String(s) => vec![s.as_str()],\n        _ => vec![],\n    };\n\n    if !audiences.contains(&"https://your-api-resource-indicator") {\n        return Err(AuthorizationError::new("Invalid audience for organization-level API resources"));\n    }\n\n    // \uc870\uc9c1 ID\uac00 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778 (\uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c \ud544\uc694)\n    let expected_org_id = "your-organization-id"; // \uc694\uccad \ucee8\ud14d\uc2a4\ud2b8\uc5d0\uc11c \ucd94\ucd9c\n    let org_id = claims["organization_id"].as_str().unwrap_or_default();\n    if expected_org_id != org_id {\n        return Err(AuthorizationError::new("Organization ID mismatch"));\n    }\n\n    // \uc870\uc9c1 \ub808\ubca8 API \ub9ac\uc18c\uc2a4\uc5d0 \ud544\uc694\ud55c \uc2a4\ucf54\ud504 \ud655\uc778\n    let required_scopes = vec!["api:read", "api:write"]; // \uc2e4\uc81c \ud544\uc694\ud55c \uc2a4\ucf54\ud504\ub85c \uad50\uccb4\ud558\uc138\uc694.\n    let scopes = claims["scope"]\n        .as_str()\n        .map(|s| s.split(\' \').collect::<Vec<_>>())\n        .unwrap_or_default();\n\n    for required_scope in &required_scopes {\n        if !scopes.contains(required_scope) {\n            return Err(AuthorizationError::new("Insufficient organization-level API scopes"));\n        }\n    }\n\n    Ok(())\n}\n'})})})]})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},62910:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="lib.rs"',children:'use serde::{Deserialize, Serialize};\nuse std::fmt;\n\npub const JWKS_URI: &str = "https://your-tenant.logto.app/oidc/jwks";\npub const ISSUER: &str = "https://your-tenant.logto.app/oidc";\n\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct AuthInfo {\n    pub sub: String,\n    pub client_id: Option<String>,\n    pub organization_id: Option<String>,\n    pub scopes: Vec<String>,\n    pub audience: Vec<String>,\n}\n\nimpl AuthInfo {\n    pub fn new(\n        sub: String,\n        client_id: Option<String>,\n        organization_id: Option<String>,\n        scopes: Vec<String>,\n        audience: Vec<String>,\n    ) -> Self {\n        Self {\n            sub,\n            client_id,\n            organization_id,\n            scopes,\n            audience,\n        }\n    }\n}\n\n#[derive(Debug)]\npub struct AuthorizationError {\n    pub message: String,\n    pub status_code: u16,\n}\n\nimpl AuthorizationError {\n    pub fn new(message: impl Into<String>) -> Self {\n        Self {\n            message: message.into(),\n            status_code: 403,\n        }\n    }\n\n    pub fn with_status(message: impl Into<String>, status_code: u16) -> Self {\n        Self {\n            message: message.into(),\n            status_code,\n        }\n    }\n}\n\nimpl fmt::Display for AuthorizationError {\n    fn fmt(&self, f: &mut fmt::Formatter<\'_>) -> fmt::Result {\n        write!(f, "{}", self.message)\n    }\n}\n\nimpl std::error::Error for AuthorizationError {}\n\npub fn extract_bearer_token(authorization: Option<&str>) -> Result<&str, AuthorizationError> {\n    let auth_header = authorization.ok_or_else(|| {\n        AuthorizationError::with_status("Authorization header is missing", 401)\n    })?;\n\n    if !auth_header.starts_with("Bearer ") {\n        return Err(AuthorizationError::with_status(\n            "Authorization header must start with \\"Bearer \\"",\n            401,\n        ));\n    }\n\n    Ok(&auth_header[7..]) // \'Bearer \' \uc811\ub450\uc0ac\ub97c \uc81c\uac70\ud569\ub2c8\ub2e4\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},33820:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="main.rs"',children:'use actix_web::{middleware::Logger, web, App, HttpRequest, HttpServer, Result};\nuse serde_json::{json, Value};\nuse std::sync::Arc;\n\nmod lib;\nmod jwt_validator;\nmod middleware as jwt_middleware;\n\nuse lib::AuthInfo;\nuse jwt_validator::JwtValidator;\nuse jwt_middleware::JwtMiddleware;\n\n#[actix_web::main]\nasync fn main() -> std::io::Result<()> {\n    let validator = Arc::new(JwtValidator::new().await.expect("JWT \uac80\uc99d\uae30 \ucd08\uae30\ud654 \uc2e4\ud328 (Failed to initialize JWT validator)"));\n\n    HttpServer::new(move || {\n        App::new()\n            .app_data(web::Data::new(validator.clone()))\n            .wrap(Logger::default())\n            .service(\n                web::scope("/api/protected")\n                    .wrap(JwtMiddleware::new(validator.clone()))\n                    .route("", web::get().to(protected_handler))\n            )\n    })\n    .bind("127.0.0.1:8080")?\n    .run()\n    .await\n}\n\nasync fn protected_handler(req: HttpRequest) -> Result<web::Json<Value>> {\n    // \uc694\uccad \ud655\uc7a5\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\uc5d0 \uc811\uadfc\ud569\ub2c8\ub2e4\n    let auth = req.extensions().get::<AuthInfo>().unwrap();\n    Ok(web::Json(json!({ "auth": auth })))\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},33321:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="main.rs"',children:'use axum::{\n    extract::Extension,\n    http::StatusCode,\n    middleware,\n    response::Json,\n    routing::get,\n    Router,\n};\nuse serde_json::{json, Value};\nuse std::sync::Arc;\nuse tower_http::cors::CorsLayer;\n\nmod lib;\nmod jwt_validator;\nmod middleware as jwt_middleware;\n\nuse lib::AuthInfo;\nuse jwt_validator::JwtValidator;\n\n#[tokio::main]\nasync fn main() {\n    let validator = Arc::new(JwtValidator::new().await.expect("JWT \uac80\uc99d\uae30 \ucd08\uae30\ud654\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4"));\n\n    let app = Router::new()\n        .route("/api/protected", get(protected_handler))\n        .layer(middleware::from_fn(jwt_middleware::jwt_middleware))\n        .layer(Extension(validator))\n        .layer(CorsLayer::permissive());\n\n    let listener = tokio::net::TcpListener::bind("0.0.0.0:3000").await.unwrap();\n    axum::serve(listener, app).await.unwrap();\n}\n\nasync fn protected_handler(Extension(auth): Extension<AuthInfo>) -> Json<Value> {\n    // Extension\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud569\ub2c8\ub2e4\n    Json(json!({ "auth": auth }))\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},68730:(e,n,t)=>{t.d(n,{Ay:()=>s,RM:()=>a});var r=t(25105),o=t(79621);const a=[];function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",metastring:'title="main.rs"',children:'use rocket::{get, launch, routes, serde::json::Json};\nuse serde_json::{json, Value};\n\nmod lib;\nmod jwt_validator;\nmod guards;\n\nuse lib::AuthInfo;\nuse jwt_validator::JwtValidator;\n\n#[get("/api/protected")]\nfn protected_handler(auth: AuthInfo) -> Json<Value> {\n    // \uc694\uccad \uac00\ub4dc\uc5d0\uc11c \uc778\uc99d (Authentication) \uc815\ubcf4\ub97c \uc9c1\uc811 \uc811\uadfc\ud569\ub2c8\ub2e4\n    Json(json!({ "auth": auth }))\n}\n\n#[launch]\nasync fn rocket() -> _ {\n    let validator = JwtValidator::new().await.expect("JWT \uac80\uc99d\uae30 \ucd08\uae30\ud654\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4");\n\n    rocket::build()\n        .manage(validator)\n        .mount("/", routes![protected_handler])\n}\n'})})}function s(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},38552:(e,n,t)=>{t.d(n,{A:()=>i});t(58101);var r=t(13526);const o={tabItem:"tabItem_dgSZ"};var a=t(25105);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,i),hidden:t,children:n})}},22002:(e,n,t)=>{t.d(n,{A:()=>v});var r=t(58101),o=t(13526),a=t(60755),i=t(55234),s=t(6635),c=t(4100),l=t(35661),u=t(42752);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:o}}=e;return{value:n,label:t,attributes:r,default:o}}))}(t);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const o=(0,i.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,c.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(o.location.search);n.set(a,e),o.replace({...o.location,search:n.toString()})}),[a,o])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:o}=e,a=p(e),[i,c]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[l,d]=g({queryString:t,groupId:o}),[m,x]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[o,a]=(0,u.Dv)(t);return[o,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:o}),j=(()=>{const e=l??m;return h({value:e,tabValues:a})?e:null})();(0,s.A)((()=>{j&&c(j)}),[j]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);c(e),d(e),x(e)}),[d,x,a]),tabValues:a}}var x=t(21929);const j={tabList:"tabList_osvQ",tabItem:"tabItem_dc4O"};var f=t(25105);function A(e){let{className:n,block:t,selectedValue:r,selectValue:i,tabValues:s}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,a.a_)(),u=e=>{const n=e.currentTarget,t=c.indexOf(n),o=s[t].value;o!==r&&(l(n),i(o))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":t},n),children:s.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{c.push(e)},onKeyDown:d,onClick:u,...a,className:(0,o.A)("tabs__item",j.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function w(e){const n=m(e);return(0,f.jsxs)("div",{className:(0,o.A)("tabs-container",j.tabList),children:[(0,f.jsx)(A,{...n,...e}),(0,f.jsx)(y,{...n,...e})]})}function v(e){const n=(0,x.A)();return(0,f.jsx)(w,{...e,children:d(e.children)},String(n))}},33435:(e,n,t)=>{t.d(n,{Id:()=>i,My:()=>a});const r=Object.freeze({dotnet:{name:".NET"},go:{name:"Go"},java:{name:"Java"},nodejs:{name:"Node.js"},php:{name:"PHP"},python:{name:"Python"},ruby:{name:"Ruby"},rust:{name:"Rust"}}),o=Object.freeze({express:{name:"Express.js",language:"nodejs"},koa:{name:"Koa.js",language:"nodejs"},fastify:{name:"Fastify",language:"nodejs"},hapi:{name:"Hapi.js",language:"nodejs"},nestjs:{name:"NestJS",language:"nodejs"},gin:{name:"Gin",language:"go"},fiber:{name:"Fiber",language:"go"},echo:{name:"Echo",language:"go"},chi:{name:"Chi",language:"go"},"spring-boot":{name:"Spring Boot",language:"java"},quarkus:{name:"Quarkus",language:"java"},micronaut:{name:"Micronaut",language:"java"},"vertx-web":{name:"Vert.x Web",language:"java"},laravel:{name:"Laravel",language:"php"},symfony:{name:"Symfony",language:"php"},slim:{name:"Slim",language:"php"},rails:{name:"Ruby on Rails",language:"ruby"},sinatra:{name:"Sinatra",language:"ruby"},grape:{name:"Grape",language:"ruby"},fastapi:{name:"FastAPI",language:"python"},flask:{name:"Flask",language:"python"},django:{name:"Django",language:"python"},"django-rest":{name:"Django REST Framework",language:"python"},axum:{name:"Axum",language:"rust"},"actix-web":{name:"Actix Web",language:"rust"},rocket:{name:"Rocket",language:"rust"},"aspnet-core":{name:"ASP.NET Core",language:"dotnet"}}),a=e=>o[e].name,i=e=>r[o[e].language].name},79621:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>s});var r=t(58101);const o={},a=r.createContext(o);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);