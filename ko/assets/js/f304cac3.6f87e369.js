"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[2356],{63437:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"quick-starts/database/supabase/README","title":"Supabase \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 \uc778\uc99d (Authentication)\uc744 \ucd94\uac00\ud558\uc138\uc694","description":"Supabase \uae30\ubcf8 \uac1c\ub150 \\\\","source":"@site/i18n/ko/docusaurus-plugin-content-docs/current/quick-starts/database/supabase/README.mdx","sourceDirName":"quick-starts/database/supabase","slug":"/quick-starts/supabase","permalink":"/ko/quick-starts/supabase","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/ko/docusaurus-plugin-content-docs/current/quick-starts/database/supabase/README.mdx","tags":[],"version":"current","frontMatter":{"slug":"/quick-starts/supabase","sidebar_label":"Supabase","sidebar_custom_props":{"description":"Logto\ub97c Supabase\uc640 \ud1b5\ud569\ud558\uc138\uc694 (Integrate Logto with Supabase).","logoFilename":"supabase.svg"}},"sidebar":"quickStartSidebar","previous":{"title":"Hasura","permalink":"/ko/quick-starts/hasura"},"next":{"title":"OIDC (\uc11c\ub4dc\ud30c\ud2f0 \uc571)","permalink":"/ko/quick-starts/third-party-oidc"}}');var a=t(25105),o=t(79621);const r={slug:"/quick-starts/supabase",sidebar_label:"Supabase",sidebar_custom_props:{description:"Logto\ub97c Supabase\uc640 \ud1b5\ud569\ud558\uc138\uc694 (Integrate Logto with Supabase).",logoFilename:"supabase.svg"}},i="Supabase \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 \uc778\uc99d (Authentication)\uc744 \ucd94\uac00\ud558\uc138\uc694",c={},l=[{value:"Supabase \uae30\ubcf8 \uac1c\ub150",id:"supabase-basics",level:2},{value:"Supabase \uc694\uccad\uc5d0 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130 \ucd94\uac00\ud558\uae30",id:"add-user-data-to-the-supabase-requests",level:3},{value:"Row-Level Security \uc815\ucc45 \uc0dd\uc131\ud558\uae30",id:"create-row-level-security-policy",level:3},{value:"Logto\uc640\uc758 \uae30\ubcf8 \ud1b5\ud569 \ud504\ub85c\uc138\uc2a4",id:"basic-integration-process-with-logto",level:3},{value:"Logto \ud1b5\ud569",id:"logto-integration",level:2},{value:"\ub124\uc774\ud2f0\ube0c \uc571 \ub610\ub294 SPA",id:"native-app-or-spa",level:3},{value:"\uc804\ud1b5\uc801\uc778 \uc6f9 \uc571",id:"traditional-web-app",level:3},{value:"\uae30\uacc4 \uac04 (M2M) \uc571",id:"machine-to-machine-app",level:3}];function u(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"supabase-\uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0-\uc778\uc99d-authentication\uc744-\ucd94\uac00\ud558\uc138\uc694",children:"Supabase \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 \uc778\uc99d (Authentication)\uc744 \ucd94\uac00\ud558\uc138\uc694"})}),"\n",(0,a.jsx)(s.h2,{id:"supabase-basics",children:"Supabase \uae30\ubcf8 \uac1c\ub150"}),"\n",(0,a.jsxs)(s.p,{children:["Supabase\ub294 ",(0,a.jsx)(s.a,{href:"https://www.postgresql.org/docs/current/ddl-rowsecurity.html",children:"Postgres\uc758 Row-Level Security"}),"\ub97c \ud65c\uc6a9\ud558\uc5ec \ub370\uc774\ud130 \uc811\uadfc \uad8c\ud55c\uc744 \uc81c\uc5b4\ud569\ub2c8\ub2e4. \uac04\ub2e8\ud788 \ub9d0\ud574, \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \ud14c\uc774\ube14\uc5d0 Row Level Security \uc815\ucc45\uc744 \uc0dd\uc131\ud568\uc73c\ub85c\uc368, \ud14c\uc774\ube14\uc758 \ub370\uc774\ud130\ub97c \ub204\uac00 \uc77d\uace0, \uc4f0\uace0, \uc218\uc815\ud560 \uc218 \uc788\ub294\uc9c0 \uc81c\ud55c\ud558\uace0 \uad00\ub9ac\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(s.p,{children:'\uc608\ub97c \ub4e4\uc5b4, \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 "posts"\ub77c\ub294 \ud14c\uc774\ube14\uc774 \uc788\ub2e4\uace0 \uac00\uc815\ud574\ubd05\uc2dc\ub2e4. \ud14c\uc774\ube14\uc758 \ub0b4\uc6a9\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4:'}),"\n",(0,a.jsx)("img",{src:"/img/assets/posts-table.webp",alt:"Posts table"}),"\n",(0,a.jsxs)(s.p,{children:["\ud14c\uc774\ube14\uc758 ",(0,a.jsx)(s.code,{children:"user_id"})," \ud544\ub4dc\ub294 \uac01 \uac8c\uc2dc\uae00 \ub370\uc774\ud130\uac00 \uc5b4\ub5a4 \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc18d\ud558\ub294\uc9c0\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. ",(0,a.jsx)(s.code,{children:"user_id"})," \ud544\ub4dc\ub97c \uae30\ubc18\uc73c\ub85c \uac01 \uc0ac\uc6a9\uc790\uac00 \uc790\uc2e0\uc758 \uac8c\uc2dc\uae00 \ub370\uc774\ud130\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\ub3c4\ub85d \uc81c\ud55c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(s.p,{children:"\ud558\uc9c0\ub9cc, \uc774\ub97c \uad6c\ud604\ud558\uae30 \uc804\uc5d0 Supabase\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc811\uadfc\ud558\ub294 \ud604\uc7ac \uc0ac\uc6a9\uc790\ub97c \uc2dd\ubcc4\ud560 \uc218 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.h3,{id:"add-user-data-to-the-supabase-requests",children:"Supabase \uc694\uccad\uc5d0 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130 \ucd94\uac00\ud558\uae30"}),"\n",(0,a.jsx)(s.p,{children:"Supabase\uac00 JWT\ub97c \uc9c0\uc6d0\ud558\uae30 \ub54c\ubb38\uc5d0, \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 Supabase\uc640 \uc0c1\ud638\uc791\uc6a9\ud560 \ub54c Supabase\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 JWT \uc2dc\ud06c\ub9bf\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc0ac\uc6a9\uc790 \ub370\uc774\ud130\uac00 \ud3ec\ud568\ub41c JWT\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 JWT\ub97c \uc778\uc99d (Authentication) \ud5e4\ub354\ub85c \uc0ac\uc6a9\ud558\uc5ec \uc694\uccad\uc744 \ubcf4\ub0c5\ub2c8\ub2e4. Supabase\ub294 \uc694\uccad\uc744 \ubc1b\uc73c\uba74 JWT\uc758 \uc720\ud6a8\uc131\uc744 \uc790\ub3d9\uc73c\ub85c \uac80\uc99d\ud558\uace0, \uc774\ud6c4 \ud504\ub85c\uc138\uc2a4\uc5d0\uc11c \ud574\ub2f9 JWT\uc5d0 \ud3ec\ud568\ub41c \ub370\uc774\ud130\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\ub3c4\ub85d \ud5c8\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.p,{children:"\uba3c\uc800, Supabase \ub300\uc2dc\ubcf4\ub4dc\uc758 \u201cProject Settings\u201d\uc5d0\uc11c Supabase\uac00 \uc81c\uacf5\ud558\ub294 JWT \uc2dc\ud06c\ub9bf\uc744 \uc5bb\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"}),"\n",(0,a.jsx)("img",{src:"/img/assets/supabase-api-settings.webp",alt:"Supabase API settings page"}),"\n",(0,a.jsx)(s.p,{children:"\uadf8 \ub2e4\uc74c, Supabase SDK\ub97c \uc0ac\uc6a9\ud558\uc5ec Supabase\uc5d0 \uc694\uccad\uc744 \ubcf4\ub0bc \ub54c \uc774 \uc2dc\ud06c\ub9bf\uc744 \uc0ac\uc6a9\ud574 JWT\ub97c \uc0dd\uc131\ud558\uace0, \uc778\uc99d (Authentication) \ud5e4\ub354\uc5d0 \ucca8\ubd80\ud569\ub2c8\ub2e4. (\uc774 \uacfc\uc815\uc740 \ubc18\ub4dc\uc2dc \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758 \ubc31\uc5d4\ub4dc \uc11c\ube44\uc2a4 \ub0b4\uc5d0\uc11c \uc774\ub8e8\uc5b4\uc838\uc57c \ud558\uba70, JWT \uc2dc\ud06c\ub9bf\uc740 \uc808\ub300 \uc678\ubd80\uc5d0 \ub178\ucd9c\ub418\uc5b4\uc11c\ub294 \uc548 \ub429\ub2c8\ub2e4)."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"import { createClient } from '@supabase/supabase-js';\nimport { sign } from 'jsonwebtoken';\n\n/\n * \ucc38\uace0:\n * SUPABASE_URL, SUPABASE_ANON_KEY\ub294 JWT Secret\uc744 \ucc3e\ub294 \uacf3\uacfc \ub3d9\uc77c\ud55c \uc704\uce58\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n */\nconst SUPABASE_URL = process.env.SUPABASE_URL;\nconst SUPABASE_ANON_KEY = process.env.SUPABASE_ANON_KEY;\n\nconst SUPABASE_JWT_SECRET = process.env.SUPABASE_JWT_SECRET;\n\nexport const getSupabaseClient = (userId) => {\n  const jwtPayload = {\n    userId,\n  };\n\n  const jwt = sign(jwtPayload, SUPABASE_JWT_SECRET, {\n    expiresIn: '1h', // \ub370\ubaa8\uc6a9 \uc608\uc2dc\n  });\n\n  const client = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {\n    global: {\n      headers: {\n        Authorization: `Bearer ${jwt}`,\n      },\n    },\n  });\n\n  return client;\n};\n"})}),"\n",(0,a.jsx)(s.p,{children:"\ub2e4\uc74c\uc73c\ub85c, Supabase \ub300\uc2dc\ubcf4\ub4dc\uc758 SQL Editor\ub85c \uc774\ub3d9\ud558\uc5ec \uc694\uccad\uc5d0 \ub2f4\uae34 userId\ub97c \ucd94\ucd9c\ud558\ub294 \ud568\uc218\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4:"}),"\n",(0,a.jsx)("img",{src:"/img/assets/create-get-user-id-function.webp",alt:"Create get user ID function"}),"\n",(0,a.jsx)(s.p,{children:"\uc774\ubbf8\uc9c0\uc5d0\uc11c \uc0ac\uc6a9\ub41c \ucf54\ub4dc\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sql",children:"create or replace function auth.user_id() returns text as $$\n  select nullif(current_setting('request.jwt.claims', true)::json->>'userId', '')::text;\n$$ language sql stable;\n"})}),"\n",(0,a.jsxs)(s.p,{children:["\ucf54\ub4dc\uc5d0\uc11c \ubcfc \uc218 \uc788\ub4ef\uc774, Supabase\uc5d0\uc11c\ub294 ",(0,a.jsx)(s.code,{children:"request.jwt.claims"}),"\ub97c \ud638\ucd9c\ud558\uc5ec \uc6b0\ub9ac\uac00 \uc0dd\uc131\ud55c JWT\uc758 payload\ub97c \uac00\uc838\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4. payload \ub0b4\ubd80\uc758 ",(0,a.jsx)(s.code,{children:"userId"})," \ud544\ub4dc\ub294 \uc6b0\ub9ac\uac00 \uc124\uc815\ud55c \uac12\uc785\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(s.p,{children:"\uc774 \ud568\uc218\ub85c Supabase\ub294 \ud604\uc7ac \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc811\uadfc \uc911\uc778 \uc0ac\uc6a9\uc790\ub97c \uc2dd\ubcc4\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.h3,{id:"create-row-level-security-policy",children:"Row-Level Security \uc815\ucc45 \uc0dd\uc131\ud558\uae30"}),"\n",(0,a.jsxs)(s.p,{children:["\uc774\uc81c posts \ud14c\uc774\ube14\uc758 ",(0,a.jsx)(s.code,{children:"user_id"})," \ud544\ub4dc\ub97c \uae30\ubc18\uc73c\ub85c \uac01 \uc0ac\uc6a9\uc790\uac00 \uc790\uc2e0\uc758 \uac8c\uc2dc\uae00 \ub370\uc774\ud130\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\ub3c4\ub85d Row-Level Security \uc815\ucc45\uc744 \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Supabase \ub300\uc2dc\ubcf4\ub4dc\uc758 Table Editor \ud398\uc774\uc9c0\ub85c \uc774\ub3d9\ud558\uc5ec posts \ud14c\uc774\ube14\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.li,{children:'\ud14c\uc774\ube14 \uc0c1\ub2e8\uc758 "Add RLS Policy"\ub97c \ud074\ub9ad\ud569\ub2c8\ub2e4.'}),"\n",(0,a.jsx)(s.li,{children:'\ub098\ud0c0\ub098\ub294 \ucc3d\uc5d0\uc11c "Create policy"\ub97c \ud074\ub9ad\ud569\ub2c8\ub2e4.'}),"\n",(0,a.jsx)(s.li,{children:"Policy Name\uc744 \uc785\ub825\ud558\uace0 SELECT Policy \uba85\ub839\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.li,{children:["\uc544\ub798 \ucf54\ub4dc\uc758 ",(0,a.jsx)(s.code,{children:"using"})," \ube14\ub85d\uc5d0 \ub2e4\uc74c\uc744 \uc785\ub825\ud569\ub2c8\ub2e4:"]}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sql",children:"auth.user_id() = user_id\n"})}),"\n",(0,a.jsx)("img",{src:"/img/assets/create-rls-policy.webp",alt:"Create RLS policy"}),"\n",(0,a.jsx)(s.p,{children:"\uc774\uc640 \uac19\uc740 \uc815\ucc45\uc744 \ud65c\uc6a9\ud558\uba74 Supabase \ub0b4\uc5d0\uc11c \ub370\uc774\ud130 \uc811\uadfc \uc81c\uc5b4\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.p,{children:["\uc2e4\uc81c \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0\uc11c\ub294 \ub370\uc774\ud130 \uc0bd\uc785, \uc218\uc815 \ub4f1 \ub2e4\uc591\ud55c \uc0ac\uc6a9\uc790 \ud589\ub3d9\uc744 \uc81c\ud55c\ud558\ub294 \uc5ec\ub7ec \uc815\ucc45\uc744 \uc0dd\uc131\ud558\uac8c \ub429\ub2c8\ub2e4. \ud558\uc9c0\ub9cc \uc774\ub294 \ubcf8 \ubb38\uc11c\uc758 \ubc94\uc704\ub97c \ubc97\uc5b4\ub0a9\ub2c8\ub2e4. Row-Level Security (RLS)\uc5d0 \ub300\ud55c \uc790\uc138\ud55c \ub0b4\uc6a9\uc740 ",(0,a.jsx)(s.a,{href:"https://supabase.com/docs/guides/database/postgres/row-level-security",children:"Postgres Row Level Security\ub85c \ub370\uc774\ud130 \ubcf4\ud638\ud558\uae30"}),"\ub97c \ucc38\uace0\ud558\uc138\uc694."]}),"\n",(0,a.jsx)(s.h3,{id:"basic-integration-process-with-logto",children:"Logto\uc640\uc758 \uae30\ubcf8 \ud1b5\ud569 \ud504\ub85c\uc138\uc2a4"}),"\n",(0,a.jsx)(s.p,{children:"\uc55e\uc11c \uc5b8\uae09\ud588\ub4ef\uc774, Supabase\ub294 \uc811\uadfc \uc81c\uc5b4\uc5d0 RLS\ub97c \uc0ac\uc6a9\ud558\ubbc0\ub85c Logto (\ub610\ub294 \ub2e4\ub978 \uc778\uc99d (Authentication) \uc11c\ube44\uc2a4)\uc640\uc758 \ud1b5\ud569\uc758 \ud575\uc2ec\uc740 \uc778\uac00\ub41c \uc0ac\uc6a9\uc790\uc758 user id\ub97c \uc5bb\uc5b4 Supabase\ub85c \uc804\ub2ec\ud558\ub294 \uac83\uc785\ub2c8\ub2e4. \uc804\uccb4 \ud504\ub85c\uc138\uc2a4\ub294 \uc544\ub798 \ub2e4\uc774\uc5b4\uadf8\ub7a8\uacfc \uac19\uc2b5\ub2c8\ub2e4:"}),"\n",(0,a.jsx)(s.mermaid,{value:"sequenceDiagram\n\tParticipant U as \ucd5c\uc885 \uc0ac\uc6a9\uc790 (End user)\n\tParticipant Logto\n\tParticipant B as \uc571 \ubc31\uc5d4\ub4dc \uc11c\ube44\uc2a4 (App backend service)\n\tParticipant Supabase\n\n\tU->>Logto: Logto\ub85c \ub85c\uadf8\uc778 (Sign in with Logto)\n\tLogto--\x3e>U: `\uc561\uc138\uc2a4 \ud1a0\ud070 (access_token)`\n\tU->>B: `\uc561\uc138\uc2a4 \ud1a0\ud070 (access_token)`\uc73c\ub85c \ub370\uc774\ud130 \uc694\uccad (Request data with `access_token`)\n\tB->>B: `\uc561\uc138\uc2a4 \ud1a0\ud070 (access_token)`\uc5d0\uc11c `user_id` \ucd94\ucd9c (Retrieve `user_id` from `access_token`)\n\tB->>B: `user_id`\uc640 `Supabase JWT secret`\uc73c\ub85c jwt \uc0dd\uc131 (Generate jwt by `user_id` & `Supabase JWT secret`)\n\tB->>Supabase: jwt\ub85c \ub370\uc774\ud130 \uc694\uccad (Request data with jwt)\n\tSupabase--\x3e>B: \uc751\ub2f5 \ub370\uc774\ud130 (Responded data)\n\tB--\x3e>U: \uc751\ub2f5 \ub370\uc774\ud130 (Responded data)"}),"\n",(0,a.jsx)(s.p,{children:"\ub2e4\uc74c\uc73c\ub85c, \uc774 \ud504\ub85c\uc138\uc2a4 \ub2e4\uc774\uc5b4\uadf8\ub7a8\uc744 \uae30\ubc18\uc73c\ub85c Logto\uc640 Supabase\ub97c \ud1b5\ud569\ud558\ub294 \ubc29\ubc95\uc744 \uc124\uba85\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.h2,{id:"logto-integration",children:"Logto \ud1b5\ud569"}),"\n",(0,a.jsx)(s.p,{children:"Logto\ub294 \ub2e4\uc591\ud55c \ud504\ub808\uc784\uc6cc\ud06c \ubc0f \ud504\ub85c\uadf8\ub798\ubc0d \uc5b8\uc5b4\uc5d0 \ub300\ud55c \ud1b5\ud569 \uac00\uc774\ub4dc\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.p,{children:["\uc77c\ubc18\uc801\uc73c\ub85c \uc774\ub7ec\ud55c \ud504\ub808\uc784\uc6cc\ud06c\uc640 \uc5b8\uc5b4\ub85c \uad6c\ucd95\ub41c \uc571\uc740 \ub124\uc774\ud2f0\ube0c \uc571, SPA (\uc2f1\uae00 \ud398\uc774\uc9c0 \uc571), \uc804\ud1b5\uc801\uc778 \uc6f9 \uc571, \uae30\uacc4 \uac04 (M2M) \uc571 \ub4f1\uc73c\ub85c \ubd84\ub958\ub429\ub2c8\ub2e4. \uc0ac\uc6a9 \uc911\uc778 \uae30\uc220 \uc2a4\ud0dd\uc5d0 \ub530\ub77c ",(0,a.jsx)(s.a,{href:"/quick-starts",children:"Logto \ube60\ub978 \uc2dc\uc791"})," \ud398\uc774\uc9c0\ub97c \ubc29\ubb38\ud558\uc5ec \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 Logto\ub97c \ud1b5\ud569\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774\ud6c4, \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc720\ud615\uc5d0 \ub530\ub77c \uc544\ub798 \uc9c0\uce68\uc744 \ub530\ub77c Logto\ub97c \ud504\ub85c\uc81d\ud2b8\uc5d0 \ud1b5\ud569\ud558\uc138\uc694."]}),"\n",(0,a.jsx)(s.h3,{id:"native-app-or-spa",children:"\ub124\uc774\ud2f0\ube0c \uc571 \ub610\ub294 SPA"}),"\n",(0,a.jsx)(s.p,{children:"\ub124\uc774\ud2f0\ube0c \uc571\uacfc SPA \ubaa8\ub450 \uc0ac\uc6a9\uc790\uc758 \ub514\ubc14\uc774\uc2a4\uc5d0\uc11c \uc2e4\ud589\ub418\uba70, \ub85c\uadf8\uc778 \ud6c4 \ud68d\ub4dd\ud55c \uc790\uaca9 \uc99d\uba85 (\uc561\uc138\uc2a4 \ud1a0\ud070)\uc740 \ub85c\uceec\uc5d0 \uc800\uc7a5\ub429\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.p,{children:"\ub530\ub77c\uc11c, \uc571\uc744 Supabase\uc640 \ud1b5\ud569\ud560 \ub54c\ub294 \uac01 \uc0ac\uc6a9\uc790\uc758 \ub514\ubc14\uc774\uc2a4\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 (\uc608: Supabase JWT \uc2dc\ud06c\ub9bf)\ub97c \ub178\ucd9c\ud560 \uc218 \uc5c6\uc73c\ubbc0\ub85c \ubc18\ub4dc\uc2dc \ubc31\uc5d4\ub4dc \uc11c\ube44\uc2a4\ub97c \ud1b5\ud574 Supabase\uc640 \uc0c1\ud638\uc791\uc6a9\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.p,{children:["React\uc640 Express\ub85c SPA\ub97c \uad6c\ucd95\ud55c\ub2e4\uace0 \uac00\uc815\ud574\ubd05\uc2dc\ub2e4. ",(0,a.jsx)(s.a,{href:"/quick-starts/react",children:"Logto React SDK \uac00\uc774\ub4dc"}),"\ub97c \ub530\ub77c \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 Logto\ub97c \uc131\uacf5\uc801\uc73c\ub85c \ud1b5\ud569\ud588\ub2e4\uba74 (",(0,a.jsx)(s.a,{href:"https://github.com/logto-io/js/tree/master/packages/react-sample",children:"react \uc0d8\ud50c \ucf54\ub4dc"})," \ucc38\uace0), \ubc31\uc5d4\ub4dc \uc11c\ubc84\uc5d0\ub3c4 ",(0,a.jsx)(s.a,{href:"/authorization/validate-access-tokens",children:"\uc561\uc138\uc2a4 \ud1a0\ud070 \uac80\uc99d"})," \uac00\uc774\ub4dc\uc5d0 \ub530\ub77c Logto \uc561\uc138\uc2a4 \ud1a0\ud070 \uac80\uc99d\uc744 \ucd94\uac00\ud588\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(s.p,{children:"\uc774\uc81c Logto\uc5d0\uc11c \ud68d\ub4dd\ud55c \uc561\uc138\uc2a4 \ud1a0\ud070\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubc31\uc5d4\ub4dc \uc11c\ubc84\uc5d0 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub97c \uc694\uccad\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"import { useLogto } from '@logto/react';\nimport { useState, useEffect } from 'react';\nimport PostList from './PostList';\n\nconst endpoint = '<https://www.mysite.com/api/posts>';\nconst resource = '<https://www.mysite.com/api>';\n\nfunction PostPage() {\n  const { isAuthenticated, getAccessToken } = useLogto();\n  const [posts, setPosts] = useState();\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      const response = await fetch(endpoint, {\n        headers: {\n          Authorization: `Bearer ${await getAccessToken(resource)}`,\n        },\n      });\n      setPosts(response.json());\n    };\n\n    if (isAuthenticated) {\n      void fetchPosts();\n    }\n  }, [isAuthenticated, getAccessToken]);\n\n  return <PostList posts={posts} />;\n}\n\nexport default PostPage;\n"})}),"\n",(0,a.jsx)(s.p,{children:"\ubc31\uc5d4\ub4dc \uc11c\ubc84\uc5d0\uc11c\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \ud1b5\ud574 \uc561\uc138\uc2a4 \ud1a0\ud070\uc5d0\uc11c \ub85c\uadf8\uc778\ud55c \uc0ac\uc6a9\uc790\uc758 id\ub97c \ucd94\ucd9c\ud569\ub2c8\ub2e4:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"// auth-middleware.ts\nimport { createRemoteJWKSet, jwtVerify } from 'jose';\n\n//...\n\nexport const verifyAuthFromRequest = async (ctx, next) => {\n  // \ud1a0\ud070 \ucd94\ucd9c\n  const token = extractBearerTokenFromHeaders(ctx.request.headers);\n\n  const { payload } = await jwtVerify(\n    token, // \uc694\uccad \ud5e4\ub354\uc5d0\uc11c \ucd94\ucd9c\ud55c \uc6d0\ubcf8 Bearer Token\n    createRemoteJWKSet(new URL('https://<your-logto-domain>/oidc/jwks')), // Logto \uc11c\ubc84\uc5d0\uc11c \uc870\ud68c\ud55c jwks_uri\ub85c jwks \uc0dd\uc131\n    {\n      // \ud1a0\ud070\uc758 \uc608\uc0c1 \ubc1c\uae09\uc790, Logto \uc11c\ubc84\uc5ec\uc57c \ud568\n      issuer: 'https://<your-logto-domain>/oidc',\n      // \uc608\uc0c1 audience \ud1a0\ud070, \ud604\uc7ac API\uc758 \ub9ac\uc18c\uc2a4 \uc9c0\ud45c\uc5ec\uc57c \ud568\n      audience: '<your request listener resource indicator>',\n    }\n  );\n\n  // RBAC\uc744 \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0\n  assert(payload.scope.includes('some_scope'));\n\n  // \ucee4\uc2a4\ud140 payload \ub85c\uc9c1\n  ctx.auth = {\n    userId: payload.sub,\n  };\n\n  return next();\n};\n"})}),"\n",(0,a.jsxs)(s.p,{children:["\uc774\uc81c \uc704\uc5d0\uc11c \uc124\uba85\ud55c ",(0,a.jsx)(s.code,{children:"getSupabaseClient"}),"\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc774\ud6c4 Supabase \uc694\uccad\uc5d0 \uc0ac\uc6a9\ud560 JWT\uc5d0 ",(0,a.jsx)(s.code,{children:"userId"}),"\ub97c \ucca8\ubd80\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub610\ub294 Supabase\uc640 \uc0c1\ud638\uc791\uc6a9\uc774 \ud544\uc694\ud55c \uc694\uccad\uc5d0 \ub300\ud574 Supabase \ud074\ub77c\uc774\uc5b8\ud2b8\ub97c \uc0dd\uc131\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \ub9cc\ub4e4 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"export const withSupabaseClient = async (ctx, next) => {\n  ctx.supabase = getSupabaseClient(ctx.auth.userId);\n\n  return next();\n};\n"})}),"\n",(0,a.jsxs)(s.p,{children:["\uc774\ud6c4 \ucc98\ub9ac \ud750\ub984\uc5d0\uc11c\ub294 ",(0,a.jsx)(s.code,{children:"ctx.supabase"}),"\ub97c \uc9c1\uc811 \ud638\ucd9c\ud558\uc5ec Supabase\uc640 \uc0c1\ud638\uc791\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"const fetchPosts = async (ctx) => {\n  const { data } = await ctx.supabase.from('posts').select('*');\n\n  return data;\n};\n"})}),"\n",(0,a.jsx)(s.p,{children:"\uc774 \ucf54\ub4dc\uc5d0\uc11c Supabase\ub294 \ubbf8\ub9ac \uc124\uc815\ud55c \uc815\ucc45\uc5d0 \ub530\ub77c \ud604\uc7ac \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc18d\ud55c \uac8c\uc2dc\uae00 \ub370\uc774\ud130\ub9cc \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.h3,{id:"traditional-web-app",children:"\uc804\ud1b5\uc801\uc778 \uc6f9 \uc571"}),"\n",(0,a.jsx)(s.p,{children:"\uc804\ud1b5\uc801\uc778 \uc6f9 \uc571\uacfc \ub124\uc774\ud2f0\ube0c \uc571 \ub610\ub294 SPA\uc758 \uc8fc\uc694 \ucc28\uc774\uc810\uc740, \uc804\ud1b5\uc801\uc778 \uc6f9 \uc571\uc740 \uc6f9 \uc11c\ubc84\uc5d0\uc11c\ub9cc \ud398\uc774\uc9c0\ub97c \ub80c\ub354\ub9c1\ud558\uace0 \uac31\uc2e0\ud55c\ub2e4\ub294 \uc810\uc785\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc0ac\uc6a9\uc790 \uc790\uaca9 \uc99d\uba85\uc740 \uc6f9 \uc11c\ubc84\uc5d0\uc11c \uc9c1\uc811 \uad00\ub9ac\ub418\uba70, \ub124\uc774\ud2f0\ube0c \uc571 \ubc0f SPA\uc5d0\uc11c\ub294 \uc0ac\uc6a9\uc790\uc758 \ub514\ubc14\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub429\ub2c8\ub2e4."}),"\n",(0,a.jsx)(s.p,{children:"Supabase\uc5d0\uc11c \uc804\ud1b5\uc801\uc778 \uc6f9 \uc571\uacfc Logto\ub97c \ud1b5\ud569\ud560 \ub54c\ub294 \ubc31\uc5d4\ub4dc\uc5d0\uc11c \ub85c\uadf8\uc778\ud55c \uc0ac\uc6a9\uc790\uc758 id\ub97c \uc9c1\uc811 \uac00\uc838\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.p,{children:["Next.js \ud504\ub85c\uc81d\ud2b8\ub97c \uc608\ub85c \ub4e4\uba74, ",(0,a.jsx)(s.a,{href:"/quick-starts/next-app-router",children:"Next.js SDK \uac00\uc774\ub4dc"}),"\ub97c \ub530\ub77c \ud504\ub85c\uc81d\ud2b8\uc5d0 Logto\ub97c \ud1b5\ud569\ud55c \ud6c4, Logto SDK\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uc870\ud68c\ud558\uace0 Supabase\uc640 \uc0c1\ud638\uc791\uc6a9\ud560 JWT\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"import { getLogtoContext } from '@logto/next-server-actions';\nimport { logtoConfig } from '@/logto';\nimport { getSupabaseClient } from '@/utils';\nimport PostList from './PostList';\n\nexport default async function PostPage() {\n  const { cliams } = await getLogtoContext(logtoConfig);\n\n  // `cliams`\uc758 `sub` \uac12\uc774 user id\uc785\ub2c8\ub2e4.\n  const supabase = getSupabaseClient(cliams.sub);\n\n  const { data: posts } = await supabase.from('posts').select('*');\n\n  return <PostList posts={posts} />;\n}\n"})}),"\n",(0,a.jsx)(s.h3,{id:"machine-to-machine-app",children:"\uae30\uacc4 \uac04 (M2M) \uc571"}),"\n",(0,a.jsx)(s.p,{children:"\uae30\uacc4 \uac04 (M2M)\uc740 \uc571\uc774 \ub9ac\uc18c\uc2a4 \uc11c\ubc84\uc640 \uc9c1\uc811 \ud1b5\uc2e0\ud574\uc57c \ud560 \ub54c \uc790\uc8fc \uc0ac\uc6a9\ub429\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \uc815\uc801 \uc11c\ube44\uc2a4\uac00 \ub9e4\uc77c \uac8c\uc2dc\uae00\uc744 \uac00\uc838\uc624\ub294 \uacbd\uc6b0 \ub4f1\uc785\ub2c8\ub2e4."}),"\n",(0,a.jsxs)(s.p,{children:["\uae30\uacc4 \uac04 \uc571 \uc778\uc99d (Authentication)\uc5d0\ub294 ",(0,a.jsx)(s.a,{href:"/quick-starts/m2m",children:"\uae30\uacc4 \uac04: Logto\ub85c \uc778\uc99d (Authentication)"}),' \uac00\uc774\ub4dc\ub97c \ucc38\uace0\ud558\uc138\uc694. Supabase\uc640 \uae30\uacc4 \uac04 \uc571\uc758 \ud1b5\ud569 \ubc29\uc2dd\uc740 \ub124\uc774\ud2f0\ube0c \uc571 \ubc0f SPA\uc640 \uc720\uc0ac\ud569\ub2c8\ub2e4 ("',(0,a.jsx)(s.a,{href:"#native-app-or-spa",children:"\ub124\uc774\ud2f0\ube0c \uc571 \ub610\ub294 SPA"}),'" \uc139\uc158 \ucc38\uace0). Logto\uc5d0\uc11c \uc561\uc138\uc2a4 \ud1a0\ud070\uc744 \ud68d\ub4dd\ud55c \ud6c4, \ubcf4\ud638\ub41c \ubc31\uc5d4\ub4dc API\ub97c \ud1b5\ud574 \uac80\uc99d\ud558\ub294 \ubc29\uc2dd\uc785\ub2c8\ub2e4.']}),"\n",(0,a.jsxs)(s.p,{children:["\ub2e8, \ub124\uc774\ud2f0\ube0c \uc571\uacfc SPA\ub294 \uc77c\ubc18\uc801\uc73c\ub85c \ucd5c\uc885 \uc0ac\uc6a9\uc790\ub97c \uc704\ud55c \uac83\uc774\ubbc0\ub85c \ud68d\ub4dd\ud55c user id\uac00 \uc2e4\uc81c \uc0ac\uc6a9\uc790\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4. \ubc18\uba74, \uae30\uacc4 \uac04 \uc571\uc758 \uc561\uc138\uc2a4 \ud1a0\ud070\uc740 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc790\uccb4\ub97c \ub098\ud0c0\ub0b4\uba70, \uc561\uc138\uc2a4 \ud1a0\ud070 payload\uc758 ",(0,a.jsx)(s.code,{children:"sub"})," \ud544\ub4dc\ub294 \ud2b9\uc815 \uc0ac\uc6a9\uc790\uac00 \uc544\ub2c8\ub77c M2M \uc571\uc758 client id\uc785\ub2c8\ub2e4. \ub530\ub77c\uc11c \uac1c\ubc1c \uc2dc \uc5b4\ub5a4 \ub370\uc774\ud130\uac00 M2M \uc571\uc744 \uc704\ud55c \uac83\uc778\uc9c0 \uad6c\ubd84\ud558\ub294 \uac83\uc774 \uc911\uc694\ud569\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(s.p,{children:["\ub610\ud55c, \ud2b9\uc815 M2M \uc571\uc774 \uc804\uccb4 \uc11c\ube44\uc2a4\uc758 \ub300\ud45c\ub85c Supabase\uc5d0 \uc811\uadfc\ud558\uc5ec RLS \uc81c\ud55c\uc744 \uc6b0\ud68c\ud574\uc57c \ud558\ub294 \uacbd\uc6b0, Supabase\uc758 ",(0,a.jsx)(s.code,{children:"service_role"})," \uc2dc\ud06c\ub9bf\uc744 \uc0ac\uc6a9\ud558\uc5ec Supabase \ud074\ub77c\uc774\uc5b8\ud2b8\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774\ub294 \uac1c\ubcc4 \uc0ac\uc6a9\uc790\uc5d0 \ub300\ud55c Row-Level Security \uc815\ucc45\uc5d0 \uad6c\uc560\ubc1b\uc9c0 \uc54a\uace0 \ubaa8\ub4e0 \ub370\uc774\ud130\uc5d0 \uc811\uadfc\ud574\uc57c \ud558\ub294 \uad00\ub9ac \uc791\uc5c5\uc774\ub098 \uc790\ub3d9\ud654 \uc791\uc5c5\uc5d0 \uc720\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"service_role"})," \uc2dc\ud06c\ub9bf\uc740 JWT \uc2dc\ud06c\ub9bf\uacfc \ub3d9\uc77c\ud55c \ud398\uc774\uc9c0\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"]}),"\n",(0,a.jsx)("img",{src:"/img/assets/service-role-secret.webp",alt:"Service role secret"}),"\n",(0,a.jsxs)(s.p,{children:["Supabase \ud074\ub77c\uc774\uc5b8\ud2b8\ub97c \uc0dd\uc131\ud560 \ub54c ",(0,a.jsx)(s.code,{children:"service_role"})," \uc2dc\ud06c\ub9bf\uc744 \uc0ac\uc6a9\ud558\uba74, \uc774 \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \ubaa8\ub4e0 \ub370\uc774\ud130\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-jsx",children:"import { createClient } from '@supabase/supabase-js';\n\n// ...\nconst SUPABASE_SERVICE_ROLE_SCRET = process.env.SUPABASE_SERVICE_ROLE_SCRET;\n\nconst client = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_SCRET, {\n  // ...options\n});\n"})})]})}function p(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},79621:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>i});var n=t(58101);const a={},o=n.createContext(a);function r(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);